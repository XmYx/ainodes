/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.3.6 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, https://github.com/requirejs/requirejs/blob/master/LICENSE
 */
var requirejs,require,define;if(function(global,setTimeout){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.6",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var n;if(e)for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}function eachReverse(e,t){var n;if(e)for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,(function(t,r){!n&&hasProp(e,r)||(!i||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[r]=t:(e[r]||(e[r]={}),mixin(e[r],t,n,i)))})),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),(function(e){t=t[e]})),t}function makeError(e,t,n,i){var r=new Error(t+"\nhttps://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=i,n&&(r.originalError=n),r}if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var r,o,s=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=i):e=[]),o&&o.context&&(s=o.context),(r=getOwn(contexts,s))||(r=contexts[s]=req.s.newContext(s)),o&&r.configure(o),r.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],(function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}})),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var i=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return i.type=e.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i},req.load=function(e,t,n){var i,r=e&&e.config||{};if(isBrowser)return(i=req.createNode(r,t,n)).setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,r.onNodeCreated&&r.onNodeCreated(i,r,t,n),currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{setTimeout((function(){}),0),importScripts(n),e.completeLoad(t)}catch(i){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,i,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),(function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0})),define=function(e,t,n){var i,r;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,(function(e,n){t.push(n)})),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript())&&(e||(e=i.getAttribute("data-requiremodule")),r=contexts[i.getAttribute("data-requirecontext")]),r?(r.defQueue.push([e,t,n]),r.defQueueMap[e]=!0):globalDefQueue.push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}function newContext(e){var t,n,i,r,o,s={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},a={},c={},l={},u=[],h={},d={},f={},p=1,g=1;function m(e,t,n){var i,r,o,a,c,l,u,h,d,f,p=t&&t.split("/"),g=s.map,m=g&&g["*"];if(e&&(l=(e=e.split("/")).length-1,s.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&p&&(e=p.slice(0,p.length-1).concat(e)),function(e){var t,n;for(t=0;t<e.length;t++)if("."===(n=e[t]))e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),n&&g&&(p||m)){e:for(o=(r=e.split("/")).length;o>0;o-=1){if(c=r.slice(0,o).join("/"),p)for(a=p.length;a>0;a-=1)if((i=getOwn(g,p.slice(0,a).join("/")))&&(i=getOwn(i,c))){u=i,h=o;break e}!d&&m&&getOwn(m,c)&&(d=getOwn(m,c),f=o)}!u&&d&&(u=d,h=f),u&&(r.splice(0,h,u),e=r.join("/"))}return getOwn(s.pkgs,e)||e}function y(e){isBrowser&&each(scripts(),(function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===i.contextName)return t.parentNode.removeChild(t),!0}))}function x(e){var t=getOwn(s.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),i.require.undef(e),i.makeRequire(null,{skipMap:!0})([e]),!0}function b(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function v(e,t,n,r){var o,s,a,c,l=null,u=t?t.name:null,d=e,f=!0,y="";return e||(f=!1,e="_@r"+(p+=1)),l=(c=b(e))[0],e=c[1],l&&(l=m(l,u,r),s=getOwn(h,l)),e&&(l?y=n?e:s&&s.normalize?s.normalize(e,(function(e){return m(e,u,r)})):-1===e.indexOf("!")?m(e,u,r):e:(l=(c=b(y=m(e,u,r)))[0],y=c[1],n=!0,o=i.nameToUrl(y))),{prefix:l,name:y,parentMap:t,unnormalized:!!(a=!l||s||n?"":"_unnormalized"+(g+=1)),url:o,originalName:d,isDefine:f,id:(l?l+"!"+y:y)+a}}function w(e){var t=e.id,n=getOwn(a,t);return n||(n=a[t]=new i.Module(e)),n}function _(e,t,n){var i=e.id,r=getOwn(a,i);!hasProp(h,i)||r&&!r.defineEmitComplete?(r=w(e)).error&&"error"===t?n(r.error):r.on(t,n):"defined"===t&&n(h[i])}function S(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,(function(t){var n=getOwn(a,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))})),i||req.onError(e))}function C(){globalDefQueue.length&&(each(globalDefQueue,(function(e){var t=e[0];"string"==typeof t&&(i.defQueueMap[t]=!0),u.push(e)})),globalDefQueue=[])}function k(e){delete a[e],delete c[e]}function M(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,(function(i,r){var o=i.id,s=getOwn(a,o);!s||e.depMatched[r]||n[o]||(getOwn(t,o)?(e.defineDep(r,h[o]),e.check()):M(s,t,n))})),n[i]=!0)}function E(){var e,n,r=1e3*s.waitSeconds,a=r&&i.startTime+r<(new Date).getTime(),l=[],u=[],h=!1,d=!0;if(!t){if(t=!0,eachProp(c,(function(e){var t=e.map,i=t.id;if(e.enabled&&(t.isDefine||u.push(e),!e.error))if(!e.inited&&a)x(i)?(n=!0,h=!0):(l.push(i),y(i));else if(!e.inited&&e.fetched&&t.isDefine&&(h=!0,!t.prefix))return d=!1})),a&&l.length)return(e=makeError("timeout","Load timeout for modules: "+l,null,l)).contextName=i.contextName,S(e);d&&each(u,(function(e){M(e,{},{})})),a&&!n||!h||!isBrowser&&!isWebWorker||o||(o=setTimeout((function(){o=0,E()}),50)),t=!1}}function T(e){hasProp(h,e[0])||w(v(e[0],null,!0)).init(e[1],e[2])}function P(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function A(e){var t=e.currentTarget||e.srcElement;return P(t,i.onScriptLoad,"load","onreadystatechange"),P(t,i.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function O(){var e;for(C();u.length;){if(null===(e=u.shift())[0])return S(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));T(e)}i.defQueueMap={}}return r={require:function(e){return e.require?e.require:e.require=i.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?h[e.map.id]=e.exports:e.exports=h[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(s.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(n=function(e){this.events=getOwn(l,e.id)||{},this.map=e,this.shim=getOwn(s.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,(function(e){this.emit("error",e)}))),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,i.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,(function(){return e.prefix?this.callPlugin():this.load()})))}},load:function(){var e=this.map.url;d[e]||(d[e]=!0,i.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,r=this.depExports,o=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(s)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=i.execCb(n,s,r,o)}catch(t){e=t}else o=i.execCb(n,s,r,o);if(this.map.isDefine&&void 0===o&&((t=this.module)?o=t.exports:this.usingExports&&(o=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",S(this.error=e)}else o=s;if(this.exports=o,this.map.isDefine&&!this.ignore&&(h[n]=o,req.onResourceLoad)){var a=[];each(this.depMaps,(function(e){a.push(e.normalizedMap||e)})),req.onResourceLoad(i,this.map,a)}k(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(i.defQueueMap,n)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=v(e.prefix);this.depMaps.push(n),_(n,"defined",bind(this,(function(n){var r,o,c,l=getOwn(f,this.map.id),u=this.map.name,h=this.map.parentMap?this.map.parentMap.name:null,d=i.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(u=n.normalize(u,(function(e){return m(e,h,!0)}))||""),_(o=v(e.prefix+"!"+u,this.map.parentMap,!0),"defined",bind(this,(function(e){this.map.normalizedMap=o,this.init([],(function(){return e}),null,{enabled:!0,ignore:!0})}))),void((c=getOwn(a,o.id))&&(this.depMaps.push(o),this.events.error&&c.on("error",bind(this,(function(e){this.emit("error",e)}))),c.enable()))):l?(this.map.url=i.nameToUrl(l),void this.load()):((r=bind(this,(function(e){this.init([],(function(){return e}),null,{enabled:!0})}))).error=bind(this,(function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(a,(function(e){0===e.map.id.indexOf(t+"_unnormalized")&&k(e.map.id)})),S(e)})),r.fromText=bind(this,(function(n,o){var a=e.name,c=v(a),l=useInteractive;o&&(n=o),l&&(useInteractive=!1),w(c),hasProp(s.config,t)&&(s.config[a]=s.config[t]);try{req.exec(n)}catch(e){return S(makeError("fromtexteval","fromText eval for "+t+" failed: "+e,e,[t]))}l&&(useInteractive=!0),this.depMaps.push(c),i.completeLoad(a),d([a],r)})),void n.load(e.name,d,r,s))}))),i.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){c[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,(function(e,t){var n,o,s;if("string"==typeof e){if(e=v(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,s=getOwn(r,e.id))return void(this.depExports[t]=s(this));this.depCount+=1,_(e,"defined",bind(this,(function(e){this.undefed||(this.defineDep(t,e),this.check())}))),this.errback?_(e,"error",bind(this,this.errback)):this.events.error&&_(e,"error",bind(this,(function(e){this.emit("error",e)})))}n=e.id,o=a[n],hasProp(r,n)||!o||o.enabled||i.enable(e,this)}))),eachProp(this.pluginMaps,bind(this,(function(e){var t=getOwn(a,e.id);t&&!t.enabled&&i.enable(e,this)}))),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],(function(e){e(t)})),"error"===e&&delete this.events[e]}},(i={config:s,contextName:e,registry:a,defined:h,urlFetched:d,defQueue:u,defQueueMap:{},Module:n,makeModuleMap:v,nextTick:req.nextTick,onError:S,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,n){return(-1===n.indexOf("?")?"?":"&")+t}}var n=s.shim,r={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,(function(e,t){r[t]?(s[t]||(s[t]={}),mixin(s[t],e,!0,!0)):s[t]=e})),e.bundles&&eachProp(e.bundles,(function(e,t){each(e,(function(e){e!==t&&(f[e]=t)}))})),e.shim&&(eachProp(e.shim,(function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=i.makeShimExports(e)),n[t]=e})),s.shim=n),e.packages&&each(e.packages,(function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(s.paths[t]=e.location),s.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")})),eachProp(a,(function(e,t){e.inited||e.map.unnormalized||(e.map=v(t,null,!0))})),(e.deps||e.callback)&&i.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(t,n){function o(s,c,l){var u,d;return n.enableBuildCallback&&c&&isFunction(c)&&(c.__requireJsBuild=!0),"string"==typeof s?isFunction(c)?S(makeError("requireargs","Invalid require call"),l):t&&hasProp(r,s)?r[s](a[t.id]):req.get?req.get(i,s,t,o):(u=v(s,t,!1,!0).id,hasProp(h,u)?h[u]:S(makeError("notloaded",'Module name "'+u+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(O(),i.nextTick((function(){O(),(d=w(v(null,t))).skipMap=n.skipMap,d.init(s,c,l,{enabled:!0}),E()})),o)}return n=n||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var n,r=e.lastIndexOf("."),o=e.split("/")[0];return-1!==r&&(!("."===o||".."===o)||r>1)&&(n=e.substring(r,e.length),e=e.substring(0,r)),i.nameToUrl(m(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(h,v(e,t,!1,!0).id)},specified:function(e){return e=v(e,t,!1,!0).id,hasProp(h,e)||hasProp(a,e)}}),t||(o.undef=function(e){C();var n=v(e,t,!0),r=getOwn(a,e);r.undefed=!0,y(e),delete h[e],delete d[n.url],delete l[e],eachReverse(u,(function(t,n){t[0]===e&&u.splice(n,1)})),delete i.defQueueMap[e],r&&(r.events.defined&&(l[e]=r.events),k(e))}),o},enable:function(e){getOwn(a,e.id)&&w(e).enable()},completeLoad:function(e){var t,n,r,o=getOwn(s.shim,e)||{},c=o.exports;for(C();u.length;){if(null===(n=u.shift())[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);T(n)}if(i.defQueueMap={},r=getOwn(a,e),!t&&!hasProp(h,e)&&r&&!r.inited){if(!(!s.enforceDefine||c&&getGlobal(c)))return x(e)?void 0:S(makeError("nodefine","No define call for "+e,null,[e]));T([e,o.deps||[],o.exportsFn])}E()},nameToUrl:function(e,t,n){var r,o,a,c,l,u,h=getOwn(s.pkgs,e);if(h&&(e=h),u=getOwn(f,e))return i.nameToUrl(u,t,n);if(req.jsExtRegExp.test(e))c=e+(t||"");else{for(r=s.paths,a=(o=e.split("/")).length;a>0;a-=1)if(l=getOwn(r,o.slice(0,a).join("/"))){isArray(l)&&(l=l[0]),o.splice(0,a,l);break}c=o.join("/"),c=("/"===(c+=t||(/^data\:|^blob\:|\?/.test(c)||n?"":".js")).charAt(0)||c.match(/^[\w\+\.\-]+:/)?"":s.baseUrl)+c}return s.urlArgs&&!/^blob\:/.test(c)?c+s.urlArgs(e,c):c},load:function(e,t){req.load(i,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=A(e);i.completeLoad(t.id)}},onScriptError:function(e){var t=A(e);if(!x(t.id)){var n=[];return eachProp(a,(function(e,i){0!==i.indexOf("_@r")&&each(e.depMaps,(function(e){if(e.id===t.id)return n.push(i),!0}))})),S(makeError("scripterror",'Script error for "'+t.id+(n.length?'", needed by: '+n.join(", "):'"'),e,[t.id]))}}}).require=i.makeRequire(),i}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState||eachReverse(scripts(),(function(e){if("interactive"===e.readyState)return interactiveScript=e})),interactiveScript}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),void 0===requirejs)var requirejs=function(e){requirejs=e};requirejs({baseUrl:"scripts",urlArgs:"undefined"==typeof window||"file:"!==window.location.protocol&&!window.location.hostname.includes("localhost")?"":"bust="+Date.now(),paths:{toxilibs:"../toxilibs",toxiworlds:"../toxiworlds",jquery:"../toxilibs/extlibs/jquery-3.6.0"},shim:{"toxilibs/embedded_extlibs/ace/ace":{exports:"ace"}}});var developmentEnvironment="undefined"!=typeof document&&!document.getElementById("build_version");function requireDevelopment(e,t){developmentEnvironment&&requirejs(e,t)}define("toxilibs/embedded_extlibs/alea",[],(function(){function e(e,t){let n=function(){let e=3941471299;function t(t){for(let n=0;n<t.length;n++){e+=t.charCodeAt(n);let i=.02519603282416938*e;e=i>>>0,i=(i-e)*e,e=i>>>0,e+=4294967296*(i-e)}return 2.3283064365386963e-10*(e>>>0)}return t}();e.c=1,e.s0=.8633289230056107-n(t),e.s0<0&&(e.s0+=1),e.s1=.15019597788341343-n(t),e.s1<0&&(e.s1+=1),e.s2=.9176952994894236-n(t),e.s2<0&&(e.s2+=1),n=null}return function(t){let n={};function i(){let e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)}return i.state=function(){return{c:n.c,s0:n.s0,s1:n.s1,s2:n.s2}},i.setState=function({c:e,s0:t,s1:i,s2:r}){n.c=e,n.s0=t,n.s1=i,n.s2=r},i.setSeed=function(t){e(n,String(t))},"object"==typeof t&&"s0"in t?(i.setState(t),i):(e(n,String(t)),i)}})),define("toxilibs/random",["./embedded_extlibs/alea"],(function(e){const t="abcdefghijklmnopqrstuvwxyz",n="defghijkmnpqrtuvwxyz",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ"+t,r="defghijkmnpqrtuvwxyz23456789",o=t.length,s=n.length,a=i.length;function c(e=10){let t="";for(let n=0;n<e;n++)t+=i[Math.floor(Math.random()*a)];return t}return function l(u){let h=e(u),d=u;function f(e=c()){return d=e,h.setSeed(e),e}function p(){return h.state()}function g(e,t){return e+(t-e)*h()}function m(e,t){return Math.floor(g(e,t+1))}function y(){return t[m(0,o-1)]}function x(){return n[m(0,s-1)]}function b(e){let t=[],n=0;for(let i=0;i<e.length;i++){n+=e[i][1],t.push(n)}if(0===n)throw new Error("impossible choice !");let i=h()*n;for(let n=0;n<t.length;n++)if(i<t[n])return e[n][0]}let v={};function w(e,t={}){let n,{name:i="default"}=t,r=v[i];if(r){n=b(function(e,t){let n=[],i=0;for(let n=0;n<t.length;n++)i+=e[t[n]]||0;0===i&&(i=1);let r=i/t.length;for(let i=0;i<t.length;i++){let o=t[i],s=(e[o]||0)-r;n.push([o,Math.max(0,r-s)])}return n}(function(e){let t=e.length,n={};for(let i=1;i<=t;i++){let r=e[t-i];n[r]=(n[r]||0)+Math.pow(i,-.3)}return n}(r),e)),r.push(n)}else{n=e[m(0,e.length-1)],v[i]=[n]}return n}function _(){return h()}return _.reset=f,_.setSeed=f,_.getSeed=function(){return d},_.getState=p,_.setState=function(e){h.setState(e)},_.generateSeed=c,_.hash=function(e=10){let t="";for(let n=0;n<e;n++)t+=i[m(0,a-1)];return t},_.oneChanceIn=function(e){return h()<1/e},_.around=function(e,t){let n,i,r=2;for(;r>=1;)n=2*h()-1,i=2*h()-1,r=n*n+i*i;return r=Math.sqrt(-2*Math.log(r)/r),e+n*r*t},_.overrideAroundWithEqual=function(){_.around=e=>e},_.between=g,_.intBetween=m,_.letter=y,_.letters=function(e){let t="";for(let n=0;n<e;n++)t+=y();return t},_.unmistakableLetter=x,_.unmistakableLetters=function(e){let t="";for(let n=0;n<e;n++)t+=x();return t},_.unmistakableHash=function(e=10){let t="";for(let n=0;n<e;n++)t+=r[m(0,r.length-1)];return t},_.shuffleArray=function(e){for(let t=e.length-1;t>0;t--){let n=Math.floor(h()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}},_.pick=function(...e){return 1===e.length&&(e=e[0]),e[m(0,e.length-1)]},_.weightedChoice=b,_.getFastWeightedChooser=function(e){let t=[],n=[],i=0;return e.forEach((([e,r])=>{t.push(e),i+=r,n.push(i)})),function(){let e=h()*i;for(let i=0;i<n.length;i++)if(e<n[i])return t[i]}},_.fairChoice=w,_.fairChoiceInt=function(e,t,n){let i=[];for(let n=e;n<=t;n++)i.push(n);return w(i,n)},_.resetFairChoice=function(e){delete v[e]},_.resetAllFairChoices=function(){v={}},_.createNew=function(e=c()){return l(e)},_.fork=function(){return l(p())},_}(c())})),define("toxilibs/event_capabilities_queued",["./random"],(function(e){function t(i,{parent:r,nameSpace:o,onError:s}={}){let a=r||i;r||(!function(e){let n={},i={};e.blockedNameSpaces=i,e.block=function({from:e,to:t}){i[e]=i[e]||[],i[e].push(t)},e.twoWayBlock=function(t,n){e.block({from:t,to:n}),e.block({from:n,to:t})},e.createOrFindEventNameSpace=function(i){return n[i]||(n[i]={},t(n[i],{parent:e,nameSpace:i})),n[i]}}(i),i.listenersFor={},i.emitQueue=[]),i.on=function(e,t){a.listenersFor[e]||(a.listenersFor[e]=[]);let i={origin:n(),nameSpace:o,callback:t};return a.listenersFor[e].push(i),i},i.when=i.on,i.removeListener=function(e,t){let n=a.listenersFor[e];if(n){let e;e="function"==typeof t?function(e,t){for(let n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1}(n,t):function(e,t){for(let n=0;n<e.length;n++)if(e[n]===t)return n;return-1}(n,t),e>=0&&n.splice(e,1)}},i.removeAllListenersFor=function(e){a.listenersFor[e]&&(a.listenersFor[e]=[])},i.removeAllListeners=function(){a.listenersFor={}};let{emitQueue:c}=a;function l(e,t,n,i){let r=a.blockedNameSpaces[o]||[],s=a.listenersFor[e]||[];for(let o=0;o<s.length;o++)if(-1===r.indexOf(s[o].nameSpace))try{s[o].callback.stackTraceRecord=n,s[o].callback.stackTraceRecordFromEmitter=i,s[o].callback.apply(a,t)}catch(t){u({eventName:e,error:t,listenerOrigin:s[o].origin,emitOrigin:n})}}function u({eventName:e,error:t,listenerOrigin:n,emitOrigin:i}){var r;(function(e,t){let n="The error displayed below is on event '"+e+"'.";t&&(n+="\n  The faulty listener for '"+e+"' was attached : \n"+t),console.warn(n)})((r={eventName:e,error:t,listenerOrigin:n,emitOrigin:i}).eventName,r.listenerOrigin),function(e,t){if(!t||!t.stack)return;let n=t.stack.split("\n").splice(2).join("\n");console.warn("The emit '"+e+"' that triggered the error below was called from : \n"+n)}(r.eventName,r.emitOrigin),console.error(t),s&&s(t)}i.emit=function(e,...t){let n=new Error;c.push({emitSync:l,eventName:e,arguments:t,stackTraceRecord:n,stackTraceRecordFromEmitter:i.lastStackTraceRecordFromEmitter}),delete i.lastStackTraceRecordFromEmitter,1===c.length&&function(){for(;c.length>0;){let e=c[0];e.emitSync(e.eventName,e.arguments,e.stackTraceRecord,e.stackTraceRecordFromEmitter),c.shift()}}()},i.enterTestMode=function({seed:t,maxDelay:n=100}={}){const r=e.createNew(t);console.log("Event test mode with seed : ",r.getSeed());let o=i.emit;i.emit=function(...e){let t=r.intBetween(0,n);setTimeout((()=>o(...e)),t)}},i.emitSync=function(e,...t){console.warn("Please try to avoid calling emitSync. Here it was called for event '"+e+"'. Note that emitSync won't have the nice callstacks that classic emit has..."),l(e,t)},i.emitter=function(e,{sync:t,filter:n}={}){let r,o;return t?r=i.emitSync:(r=i.emit,o=new Error),function(...t){if(n)for(let e=0;e<t.length;e++)t[e]=n(t[e]);i.lastStackTraceRecordFromEmitter=o,r.call(i,e,...t)}}}function n(){let e=new Error("fake error");return e.stack?e.stack.split("\n")[3]:void 0}return t})),define("raw_event_bus",["toxilibs/event_capabilities_queued"],(function(e){function t(e){return t.createOrFindEventNameSpace(e)}return e(t,{onError(e){t.emit("error happened",e)}}),t})),
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,(function(e,t){var n=[],i=Object.getPrototypeOf,r=n.slice,o=n.flat?function(e){return n.flat.call(e)}:function(e){return n.concat.apply([],e)},s=n.push,a=n.indexOf,c={},l=c.toString,u=c.hasOwnProperty,h=u.toString,d=h.call(Object),f={},p=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},g=function(e){return null!=e&&e===e.window},m=e.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function x(e,t,n){var i,r,o=(n=n||m).createElement("script");if(o.text=e,t)for(i in y)(r=t[i]||t.getAttribute&&t.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function b(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[l.call(e)]||"object":typeof e}var v="3.6.0",w=function(e,t){return new w.fn.init(e,t)};function _(e){var t=!!e&&"length"in e&&e.length,n=b(e);return!p(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}w.fn=w.prototype={jquery:v,constructor:w,length:0,toArray:function(){return r.call(this)},get:function(e){return null==e?r.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(w.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,i,r,o,s=arguments[0]||{},a=1,c=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||p(s)||(s={}),a===c&&(s=this,a--);a<c;a++)if(null!=(e=arguments[a]))for(t in e)i=e[t],"__proto__"!==t&&s!==i&&(l&&i&&(w.isPlainObject(i)||(r=Array.isArray(i)))?(n=s[t],o=r&&!Array.isArray(n)?[]:r||w.isPlainObject(n)?n:{},r=!1,s[t]=w.extend(l,o,i)):void 0!==i&&(s[t]=i));return s},w.extend({expando:"jQuery"+(v+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==l.call(e))&&(!(t=i(e))||"function"==typeof(n=u.call(t,"constructor")&&t.constructor)&&h.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){x(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,i=0;if(_(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(_(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:a.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,s=!n;r<o;r++)!t(e[r],r)!==s&&i.push(e[r]);return i},map:function(e,t,n){var i,r,s=0,a=[];if(_(e))for(i=e.length;s<i;s++)null!=(r=t(e[s],s,n))&&a.push(r);else for(s in e)null!=(r=t(e[s],s,n))&&a.push(r);return o(a)},guid:1,support:f}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){c["[object "+t+"]"]=t.toLowerCase()}));var S=
/*!
 * Sizzle CSS Selector Engine v2.3.6
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2021-02-16
 */
function(e){var t,n,i,r,o,s,a,c,l,u,h,d,f,p,g,m,y,x,b,v="sizzle"+1*new Date,w=e.document,_=0,S=0,C=ce(),k=ce(),M=ce(),E=ce(),T=function(e,t){return e===t&&(h=!0),0},P={}.hasOwnProperty,A=[],O=A.pop,D=A.push,R=A.push,L=A.slice,N=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",q="\\[[\\x20\\t\\r\\n\\f]*("+I+")(?:"+j+"*([*^$|!~]?=)"+j+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+j+"*\\]",B=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",z=new RegExp(j+"+","g"),G=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),H=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),V=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),W=new RegExp(j+"|>"),U=new RegExp(B),$=new RegExp("^"+I+"$"),Y={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,J=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},ie=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,re=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){d()},se=ve((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{R.apply(A=L.call(w.childNodes),w.childNodes),A[w.childNodes.length].nodeType}catch(e){R={apply:A.length?function(e,t){D.apply(e,L.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function ae(e,t,i,r){var o,a,l,u,h,p,y,x=t&&t.ownerDocument,w=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return i;if(!r&&(d(t),t=t||f,g)){if(11!==w&&(h=Z.exec(e)))if(o=h[1]){if(9===w){if(!(l=t.getElementById(o)))return i;if(l.id===o)return i.push(l),i}else if(x&&(l=x.getElementById(o))&&b(t,l)&&l.id===o)return i.push(l),i}else{if(h[2])return R.apply(i,t.getElementsByTagName(e)),i;if((o=h[3])&&n.getElementsByClassName&&t.getElementsByClassName)return R.apply(i,t.getElementsByClassName(o)),i}if(n.qsa&&!E[e+" "]&&(!m||!m.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(y=e,x=t,1===w&&(W.test(e)||V.test(e))){for((x=ee.test(e)&&ye(t.parentNode)||t)===t&&n.scope||((u=t.getAttribute("id"))?u=u.replace(ie,re):t.setAttribute("id",u=v)),a=(p=s(e)).length;a--;)p[a]=(u?"#"+u:":scope")+" "+be(p[a]);y=p.join(",")}try{return R.apply(i,x.querySelectorAll(y)),i}catch(t){E(e,!0)}finally{u===v&&t.removeAttribute("id")}}}return c(e.replace(G,"$1"),t,i,r)}function ce(){var e=[];return function t(n,r){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function le(e){return e[v]=!0,e}function ue(e){var t=f.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function he(e,t){for(var n=e.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=t}function de(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return le((function(t){return t=+t,le((function(n,i){for(var r,o=e([],n.length,t),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))}))}))}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=ae.support={},o=ae.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!X.test(t||n&&n.nodeName||"HTML")},d=ae.setDocument=function(e){var t,r,s=e?e.ownerDocument||e:w;return s!=f&&9===s.nodeType&&s.documentElement?(p=(f=s).documentElement,g=!o(f),w!=f&&(r=f.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",oe,!1):r.attachEvent&&r.attachEvent("onunload",oe)),n.scope=ue((function(e){return p.appendChild(e).appendChild(f.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),n.attributes=ue((function(e){return e.className="i",!e.getAttribute("className")})),n.getElementsByTagName=ue((function(e){return e.appendChild(f.createComment("")),!e.getElementsByTagName("*").length})),n.getElementsByClassName=Q.test(f.getElementsByClassName),n.getById=ue((function(e){return p.appendChild(e).id=v,!f.getElementsByName||!f.getElementsByName(v).length})),n.getById?(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,i,r,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(r=t.getElementsByName(e),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},y=[],m=[],(n.qsa=Q.test(f.querySelectorAll))&&(ue((function(e){var t;p.appendChild(e).innerHTML="<a id='"+v+"'></a><select id='"+v+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+F+")"),e.querySelectorAll("[id~="+v+"-]").length||m.push("~="),(t=f.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+v+"+*").length||m.push(".#.+[+~]"),e.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ue((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=f.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Q.test(x=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ue((function(e){n.disconnectedMatch=x.call(e,"*"),x.call(e,"[s!='']:x"),y.push("!=",B)})),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),t=Q.test(p.compareDocumentPosition),b=t||Q.test(p.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},T=t?function(e,t){if(e===t)return h=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e==f||e.ownerDocument==w&&b(w,e)?-1:t==f||t.ownerDocument==w&&b(w,t)?1:u?N(u,e)-N(u,t):0:4&i?-1:1)}:function(e,t){if(e===t)return h=!0,0;var n,i=0,r=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!r||!o)return e==f?-1:t==f?1:r?-1:o?1:u?N(u,e)-N(u,t):0;if(r===o)return de(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[i]===a[i];)i++;return i?de(s[i],a[i]):s[i]==w?-1:a[i]==w?1:0},f):f},ae.matches=function(e,t){return ae(e,null,null,t)},ae.matchesSelector=function(e,t){if(d(e),n.matchesSelector&&g&&!E[t+" "]&&(!y||!y.test(t))&&(!m||!m.test(t)))try{var i=x.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){E(t,!0)}return ae(t,f,null,[e]).length>0},ae.contains=function(e,t){return(e.ownerDocument||e)!=f&&d(e),b(e,t)},ae.attr=function(e,t){(e.ownerDocument||e)!=f&&d(e);var r=i.attrHandle[t.toLowerCase()],o=r&&P.call(i.attrHandle,t.toLowerCase())?r(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},ae.escape=function(e){return(e+"").replace(ie,re)},ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ae.uniqueSort=function(e){var t,i=[],r=0,o=0;if(h=!n.detectDuplicates,u=!n.sortStable&&e.slice(0),e.sort(T),h){for(;t=e[o++];)t===e[o]&&(r=i.push(o));for(;r--;)e.splice(i[r],1)}return u=null,e},r=ae.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=r(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=r(t);return n},(i=ae.selectors={cacheLength:50,createPseudo:le,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ae.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ae.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&U.test(n)&&(t=s(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"("+j+"|$)"))&&C(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(i){var r=ae.attr(i,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace(z," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,c){var l,u,h,d,f,p,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),x=!c&&!a,b=!1;if(m){if(o){for(;g;){for(d=t;d=d[g];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&x){for(b=(f=(l=(u=(h=(d=m)[v]||(d[v]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===_&&l[1])&&l[2],d=f&&m.childNodes[f];d=++f&&d&&d[g]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===t){u[e]=[_,f,b];break}}else if(x&&(b=f=(l=(u=(h=(d=t)[v]||(d[v]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]||[])[0]===_&&l[1]),!1===b)for(;(d=++f&&d&&d[g]||(b=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++b||(x&&((u=(h=d[v]||(d[v]={}))[d.uniqueID]||(h[d.uniqueID]={}))[e]=[_,b]),d!==t)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ae.error("unsupported pseudo: "+e);return r[v]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?le((function(e,n){for(var i,o=r(e,t),s=o.length;s--;)e[i=N(e,o[s])]=!(n[i]=o[s])})):function(e){return r(e,0,n)}):r}},pseudos:{not:le((function(e){var t=[],n=[],i=a(e.replace(G,"$1"));return i[v]?le((function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))})):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}})),has:le((function(e){return function(t){return ae(e,t).length>0}})),contains:le((function(e){return e=e.replace(te,ne),function(t){return(t.textContent||r(t)).indexOf(e)>-1}})),lang:le((function(e){return $.test(e||"")||ae.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return J.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me((function(){return[0]})),last:me((function(e,t){return[t-1]})),eq:me((function(e,t,n){return[n<0?n+t:n]})),even:me((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:me((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:me((function(e,t,n){for(var i=n<0?n+t:n>t?t:n;--i>=0;)e.push(i);return e})),gt:me((function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e}))}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=pe(t);function xe(){}function be(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function ve(e,t,n){var i=t.dir,r=t.next,o=r||i,s=n&&"parentNode"===o,a=S++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,r);return!1}:function(t,n,c){var l,u,h,d=[_,a];if(c){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,c))return!0}else for(;t=t[i];)if(1===t.nodeType||s)if(u=(h=t[v]||(t[v]={}))[t.uniqueID]||(h[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[i]||t;else{if((l=u[o])&&l[0]===_&&l[1]===a)return d[2]=l[2];if(u[o]=d,d[2]=e(t,n,c))return!0}return!1}}function we(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function _e(e,t,n,i,r){for(var o,s=[],a=0,c=e.length,l=null!=t;a<c;a++)(o=e[a])&&(n&&!n(o,i,r)||(s.push(o),l&&t.push(a)));return s}function Se(e,t,n,i,r,o){return i&&!i[v]&&(i=Se(i)),r&&!r[v]&&(r=Se(r,o)),le((function(o,s,a,c){var l,u,h,d=[],f=[],p=s.length,g=o||function(e,t,n){for(var i=0,r=t.length;i<r;i++)ae(e,t[i],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:_e(g,d,e,a,c),y=n?r||(o?e:p||i)?[]:s:m;if(n&&n(m,y,a,c),i)for(l=_e(y,f),i(l,[],a,c),u=l.length;u--;)(h=l[u])&&(y[f[u]]=!(m[f[u]]=h));if(o){if(r||e){if(r){for(l=[],u=y.length;u--;)(h=y[u])&&l.push(m[u]=h);r(null,y=[],l,c)}for(u=y.length;u--;)(h=y[u])&&(l=r?N(o,h):d[u])>-1&&(o[l]=!(s[l]=h))}}else y=_e(y===s?y.splice(p,y.length):y),r?r(null,s,y,c):R.apply(s,y)}))}function Ce(e){for(var t,n,r,o=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],c=s?1:0,u=ve((function(e){return e===t}),a,!0),h=ve((function(e){return N(t,e)>-1}),a,!0),d=[function(e,n,i){var r=!s&&(i||n!==l)||((t=n).nodeType?u(e,n,i):h(e,n,i));return t=null,r}];c<o;c++)if(n=i.relative[e[c].type])d=[ve(we(d),n)];else{if((n=i.filter[e[c].type].apply(null,e[c].matches))[v]){for(r=++c;r<o&&!i.relative[e[r].type];r++);return Se(c>1&&we(d),c>1&&be(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(G,"$1"),n,c<r&&Ce(e.slice(c,r)),r<o&&Ce(e=e.slice(r)),r<o&&be(e))}d.push(n)}return we(d)}return xe.prototype=i.filters=i.pseudos,i.setFilters=new xe,s=ae.tokenize=function(e,t){var n,r,o,s,a,c,l,u=k[e+" "];if(u)return t?0:u.slice(0);for(a=e,c=[],l=i.preFilter;a;){for(s in n&&!(r=H.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=V.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(G," ")}),a=a.slice(n.length)),i.filter)!(r=Y[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ae.error(e):k(e,c).slice(0)},a=ae.compile=function(e,t){var n,r=[],o=[],a=M[e+" "];if(!a){for(t||(t=s(e)),n=t.length;n--;)(a=Ce(t[n]))[v]?r.push(a):o.push(a);(a=M(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,s,a,c,u){var h,p,m,y=0,x="0",b=o&&[],v=[],w=l,S=o||r&&i.find.TAG("*",u),C=_+=null==w?1:Math.random()||.1,k=S.length;for(u&&(l=s==f||s||u);x!==k&&null!=(h=S[x]);x++){if(r&&h){for(p=0,s||h.ownerDocument==f||(d(h),a=!g);m=e[p++];)if(m(h,s||f,a)){c.push(h);break}u&&(_=C)}n&&((h=!m&&h)&&y--,o&&b.push(h))}if(y+=x,n&&x!==y){for(p=0;m=t[p++];)m(b,v,s,a);if(o){if(y>0)for(;x--;)b[x]||v[x]||(v[x]=O.call(c));v=_e(v)}R.apply(c,v),u&&!o&&v.length>0&&y+t.length>1&&ae.uniqueSort(c)}return u&&(_=C,l=w),b};return n?le(o):o}(o,r))).selector=e}return a},c=ae.select=function(e,t,n,r){var o,c,l,u,h,d="function"==typeof e&&e,f=!r&&s(e=d.selector||e);if(n=n||[],1===f.length){if((c=f[0]=f[0].slice(0)).length>2&&"ID"===(l=c[0]).type&&9===t.nodeType&&g&&i.relative[c[1].type]){if(!(t=(i.find.ID(l.matches[0].replace(te,ne),t)||[])[0]))return n;d&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(o=Y.needsContext.test(e)?0:c.length;o--&&(l=c[o],!i.relative[u=l.type]);)if((h=i.find[u])&&(r=h(l.matches[0].replace(te,ne),ee.test(c[0].type)&&ye(t.parentNode)||t))){if(c.splice(o,1),!(e=r.length&&be(c)))return R.apply(n,r),n;break}}return(d||a(e,f))(r,t,!g,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},n.sortStable=v.split("").sort(T).join("")===v,n.detectDuplicates=!!h,d(),n.sortDetached=ue((function(e){return 1&e.compareDocumentPosition(f.createElement("fieldset"))})),ue((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||he("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),n.attributes&&ue((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||he("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),ue((function(e){return null==e.getAttribute("disabled")}))||he(F,(function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null})),ae}(e);w.find=S,w.expr=S.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=S.uniqueSort,w.text=S.getText,w.isXMLDoc=S.isXML,w.contains=S.contains,w.escapeSelector=S.escape;var C=function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&w(e).is(n))break;i.push(e)}return i},k=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},M=w.expr.match.needsContext;function E(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var T=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function P(e,t,n){return p(t)?w.grep(e,(function(e,i){return!!t.call(e,i,e)!==n})):t.nodeType?w.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?w.grep(e,(function(e){return a.call(t,e)>-1!==n})):w.filter(t,e,n)}w.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?w.find.matchesSelector(i,e)?[i]:[]:w.find.matches(e,w.grep(t,(function(e){return 1===e.nodeType})))},w.fn.extend({find:function(e){var t,n,i=this.length,r=this;if("string"!=typeof e)return this.pushStack(w(e).filter((function(){for(t=0;t<i;t++)if(w.contains(r[t],this))return!0})));for(n=this.pushStack([]),t=0;t<i;t++)w.find(e,r[t],n);return i>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(P(this,e||[],!1))},not:function(e){return this.pushStack(P(this,e||[],!0))},is:function(e){return!!P(this,"string"==typeof e&&M.test(e)?w(e):e||[],!1).length}});var A,O=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var i,r;if(!e)return this;if(n=n||A,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:O.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:m,!0)),T.test(i[1])&&w.isPlainObject(t))for(i in t)p(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(r=m.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):p(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,A=w(m);var D=/^(?:parents|prev(?:Until|All))/,R={children:!0,contents:!0,next:!0,prev:!0};function L(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0}))},closest:function(e,t){var n,i=0,r=this.length,o=[],s="string"!=typeof e&&w(e);if(!M.test(e))for(;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?a.call(w(e),this[0]):a.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return C(e,"parentNode")},parentsUntil:function(e,t,n){return C(e,"parentNode",n)},next:function(e){return L(e,"nextSibling")},prev:function(e){return L(e,"previousSibling")},nextAll:function(e){return C(e,"nextSibling")},prevAll:function(e){return C(e,"previousSibling")},nextUntil:function(e,t,n){return C(e,"nextSibling",n)},prevUntil:function(e,t,n){return C(e,"previousSibling",n)},siblings:function(e){return k((e.parentNode||{}).firstChild,e)},children:function(e){return k(e.firstChild)},contents:function(e){return null!=e.contentDocument&&i(e.contentDocument)?e.contentDocument:(E(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},(function(e,t){w.fn[e]=function(n,i){var r=w.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=w.filter(i,r)),this.length>1&&(R[e]||w.uniqueSort(r),D.test(e)&&r.reverse()),this.pushStack(r)}}));var N=/[^\x20\t\r\n\f]+/g;function F(e){return e}function j(e){throw e}function I(e,t,n,i){var r;try{e&&p(r=e.promise)?r.call(e).done(t).fail(n):e&&p(r=e.then)?r.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(N)||[],(function(e,n){t[n]=!0})),t}(e):w.extend({},e);var t,n,i,r,o=[],s=[],a=-1,c=function(){for(r=r||e.once,i=t=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=o.length,n=!1);e.memory||(n=!1),t=!1,r&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(a=o.length-1,s.push(n)),function t(n){w.each(n,(function(n,i){p(i)?e.unique&&l.has(i)||o.push(i):i&&i.length&&"string"!==b(i)&&t(i)}))}(arguments),n&&!t&&c()),this},remove:function(){return w.each(arguments,(function(e,t){for(var n;(n=w.inArray(t,o,n))>-1;)o.splice(n,1),n<=a&&a--})),this},has:function(e){return e?w.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=s=[],n||t||(o=n=""),this},locked:function(){return!!r},fireWith:function(e,n){return r||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||c()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return r.then(null,e)},pipe:function(){var e=arguments;return w.Deferred((function(t){w.each(n,(function(n,i){var r=p(e[i[4]])&&e[i[4]];o[i[1]]((function(){var e=r&&r.apply(this,arguments);e&&p(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[i[0]+"With"](this,r?[e]:arguments)}))})),e=null})).promise()},then:function(t,i,r){var o=0;function s(t,n,i,r){return function(){var a=this,c=arguments,l=function(){var e,l;if(!(t<o)){if((e=i.apply(a,c))===n.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,p(l)?r?l.call(e,s(o,n,F,r),s(o,n,j,r)):(o++,l.call(e,s(o,n,F,r),s(o,n,j,r),s(o,n,F,n.notifyWith))):(i!==F&&(a=void 0,c=[e]),(r||n.resolveWith)(a,c))}},u=r?l:function(){try{l()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,u.stackTrace),t+1>=o&&(i!==j&&(a=void 0,c=[e]),n.rejectWith(a,c))}};t?u():(w.Deferred.getStackHook&&(u.stackTrace=w.Deferred.getStackHook()),e.setTimeout(u))}}return w.Deferred((function(e){n[0][3].add(s(0,e,p(r)?r:F,e.notifyWith)),n[1][3].add(s(0,e,p(t)?t:F)),n[2][3].add(s(0,e,p(i)?i:j))})).promise()},promise:function(e){return null!=e?w.extend(e,r):r}},o={};return w.each(n,(function(e,t){var s=t[2],a=t[5];r[t[1]]=s.add,a&&s.add((function(){i=a}),n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),s.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=s.fireWith})),r.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,i=Array(n),o=r.call(arguments),s=w.Deferred(),a=function(e){return function(n){i[e]=this,o[e]=arguments.length>1?r.call(arguments):n,--t||s.resolveWith(i,o)}};if(t<=1&&(I(e,s.done(a(n)).resolve,s.reject,!t),"pending"===s.state()||p(o[n]&&o[n].then)))return s.then();for(;n--;)I(o[n],a(n),s.reject);return s.promise()}});var q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&q.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout((function(){throw t}))};var B=w.Deferred();function z(){m.removeEventListener("DOMContentLoaded",z),e.removeEventListener("load",z),w.ready()}w.fn.ready=function(e){return B.then(e).catch((function(e){w.readyException(e)})),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||B.resolveWith(m,[w]))}}),w.ready.then=B.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?e.setTimeout(w.ready):(m.addEventListener("DOMContentLoaded",z),e.addEventListener("load",z));var G=function(e,t,n,i,r,o,s){var a=0,c=e.length,l=null==n;if("object"===b(n))for(a in r=!0,n)G(e,t,a,n[a],!0,o,s);else if(void 0!==i&&(r=!0,p(i)||(s=!0),l&&(s?(t.call(e,i),t=null):(l=t,t=function(e,t,n){return l.call(w(e),n)})),t))for(;a<c;a++)t(e[a],n,s?i:i.call(e[a],a,t(e[a],n)));return r?e:l?t.call(e):c?t(e[0],n):o},H=/^-ms-/,V=/-([a-z])/g;function W(e,t){return t.toUpperCase()}function U(e){return e.replace(H,"ms-").replace(V,W)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Y(){this.expando=w.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,r=this.cache(e);if("string"==typeof t)r[U(t)]=n;else for(i in t)r[U(i)]=t[i];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][U(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(U):(t=U(t))in i?[t]:t.match(N)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||w.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var X=new Y,J=new Y,K=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function Z(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(Q,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:K.test(e)?JSON.parse(e):e)}(n)}catch(e){}J.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return J.hasData(e)||X.hasData(e)},data:function(e,t,n){return J.access(e,t,n)},removeData:function(e,t){J.remove(e,t)},_data:function(e,t,n){return X.access(e,t,n)},_removeData:function(e,t){X.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=J.get(o),1===o.nodeType&&!X.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=U(i.slice(5)),Z(o,i,r[i]));X.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each((function(){J.set(this,e)})):G(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=J.get(o,e))||void 0!==(n=Z(o,e))?n:void 0;this.each((function(){J.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){J.remove(this,e)}))}}),w.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=X.get(e,t),n&&(!i||Array.isArray(n)?i=X.access(e,t,w.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),i=n.length,r=n.shift(),o=w._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,(function(){w.dequeue(e,t)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return X.get(e,n)||X.access(e,n,{empty:w.Callbacks("once memory").add((function(){X.remove(e,[t+"queue",n])}))})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each((function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){w.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=w.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=X.get(o[s],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],ie=m.documentElement,re=function(e){return w.contains(e.ownerDocument,e)},oe={composed:!0};ie.getRootNode&&(re=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var se=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&re(e)&&"none"===w.css(e,"display")};function ae(e,t,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return w.css(e,t,"")},c=a(),l=n&&n[3]||(w.cssNumber[t]?"":"px"),u=e.nodeType&&(w.cssNumber[t]||"px"!==l&&+c)&&te.exec(w.css(e,t));if(u&&u[3]!==l){for(c/=2,l=l||u[3],u=+c||1;s--;)w.style(e,t,u+l),(1-o)*(1-(o=a()/c||.5))<=0&&(s=0),u/=o;u*=2,w.style(e,t,u+l),n=n||[]}return n&&(u=+u||+c||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=u,i.end=r)),r}var ce={};function le(e){var t,n=e.ownerDocument,i=e.nodeName,r=ce[i];return r||(t=n.body.appendChild(n.createElement(i)),r=w.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),ce[i]=r,r)}function ue(e,t){for(var n,i,r=[],o=0,s=e.length;o<s;o++)(i=e[o]).style&&(n=i.style.display,t?("none"===n&&(r[o]=X.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&se(i)&&(r[o]=le(i))):"none"!==n&&(r[o]="none",X.set(i,"display",n)));for(o=0;o<s;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}w.fn.extend({show:function(){return ue(this,!0)},hide:function(){return ue(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){se(this)?w(this).show():w(this).hide()}))}});var he,de,fe=/^(?:checkbox|radio)$/i,pe=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ge=/^$|^module$|\/(?:java|ecma)script/i;he=m.createDocumentFragment().appendChild(m.createElement("div")),(de=m.createElement("input")).setAttribute("type","radio"),de.setAttribute("checked","checked"),de.setAttribute("name","t"),he.appendChild(de),f.checkClone=he.cloneNode(!0).cloneNode(!0).lastChild.checked,he.innerHTML="<textarea>x</textarea>",f.noCloneChecked=!!he.cloneNode(!0).lastChild.defaultValue,he.innerHTML="<option></option>",f.option=!!he.lastChild;var me={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&E(e,t)?w.merge([e],n):n}function xe(e,t){for(var n=0,i=e.length;n<i;n++)X.set(e[n],"globalEval",!t||X.get(t[n],"globalEval"))}me.tbody=me.tfoot=me.colgroup=me.caption=me.thead,me.th=me.td,f.option||(me.optgroup=me.option=[1,"<select multiple='multiple'>","</select>"]);var be=/<|&#?\w+;/;function ve(e,t,n,i,r){for(var o,s,a,c,l,u,h=t.createDocumentFragment(),d=[],f=0,p=e.length;f<p;f++)if((o=e[f])||0===o)if("object"===b(o))w.merge(d,o.nodeType?[o]:o);else if(be.test(o)){for(s=s||h.appendChild(t.createElement("div")),a=(pe.exec(o)||["",""])[1].toLowerCase(),c=me[a]||me._default,s.innerHTML=c[1]+w.htmlPrefilter(o)+c[2],u=c[0];u--;)s=s.lastChild;w.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(t.createTextNode(o));for(h.textContent="",f=0;o=d[f++];)if(i&&w.inArray(o,i)>-1)r&&r.push(o);else if(l=re(o),s=ye(h.appendChild(o),"script"),l&&xe(s),n)for(u=0;o=s[u++];)ge.test(o.type||"")&&n.push(o);return h}var we=/^([^.]*)(?:\.(.+)|)/;function _e(){return!0}function Se(){return!1}function Ce(e,t){return e===function(){try{return m.activeElement}catch(e){}}()==("focus"===t)}function ke(e,t,n,i,r,o){var s,a;if("object"==typeof t){for(a in"string"!=typeof n&&(i=i||n,n=void 0),t)ke(e,a,n,i,t[a],o);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Se;else if(!r)return e;return 1===o&&(s=r,(r=function(e){return w().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=w.guid++)),e.each((function(){w.event.add(this,t,r,i,n)}))}function Me(e,t,n){n?(X.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var i,o,s=X.get(this,t);if(1&e.isTrigger&&this[t]){if(s.length)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(s=r.call(arguments),X.set(this,t,s),i=n(this,t),this[t](),s!==(o=X.get(this,t))||i?X.set(this,t,!1):o={},s!==o)return e.stopImmediatePropagation(),e.preventDefault(),o&&o.value}else s.length&&(X.set(this,t,{value:w.event.trigger(w.extend(s[0],w.Event.prototype),s.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===X.get(e,t)&&w.event.add(e,t,_e)}w.event={global:{},add:function(e,t,n,i,r){var o,s,a,c,l,u,h,d,f,p,g,m=X.get(e);if($(e))for(n.handler&&(n=(o=n).handler,r=o.selector),r&&w.find.matchesSelector(ie,r),n.guid||(n.guid=w.guid++),(c=m.events)||(c=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(N)||[""]).length;l--;)f=g=(a=we.exec(t[l])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=w.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=w.event.special[f]||{},u=w.extend({type:f,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&w.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=c[f])||((d=c[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,i,p,s)||e.addEventListener&&e.addEventListener(f,s)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),w.event.global[f]=!0)},remove:function(e,t,n,i,r){var o,s,a,c,l,u,h,d,f,p,g,m=X.hasData(e)&&X.get(e);if(m&&(c=m.events)){for(l=(t=(t||"").match(N)||[""]).length;l--;)if(f=g=(a=we.exec(t[l])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=w.event.special[f]||{},d=c[f=(i?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!r&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,p,m.handle)||w.removeEvent(e,f,m.handle),delete c[f])}else for(f in c)w.event.remove(e,f+t[l],n,i,!0);w.isEmptyObject(c)&&X.remove(e,"handle events")}},dispatch:function(e){var t,n,i,r,o,s,a=new Array(arguments.length),c=w.event.fix(e),l=(X.get(this,"events")||Object.create(null))[c.type]||[],u=w.event.special[c.type]||{};for(a[0]=c,t=1;t<arguments.length;t++)a[t]=arguments[t];if(c.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,c)){for(s=w.event.handlers.call(this,c,l),t=0;(r=s[t++])&&!c.isPropagationStopped();)for(c.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==o.namespace&&!c.rnamespace.test(o.namespace)||(c.handleObj=o,c.data=o.data,void 0!==(i=((w.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a))&&!1===(c.result=i)&&(c.preventDefault(),c.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,i,r,o,s,a=[],c=t.delegateCount,l=e.target;if(c&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],s={},n=0;n<c;n++)void 0===s[r=(i=t[n]).selector+" "]&&(s[r]=i.needsContext?w(r,this).index(l)>-1:w.find(r,this,null,[l]).length),s[r]&&o.push(i);o.length&&a.push({elem:l,handlers:o})}return l=this,c<t.length&&a.push({elem:l,handlers:t.slice(c)}),a},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:p(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return fe.test(t.type)&&t.click&&E(t,"input")&&Me(t,"click",_e),!1},trigger:function(e){var t=this||e;return fe.test(t.type)&&t.click&&E(t,"input")&&Me(t,"click"),!0},_default:function(e){var t=e.target;return fe.test(t.type)&&t.click&&E(t,"input")&&X.get(t,"click")||E(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?_e:Se,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:Se,isPropagationStopped:Se,isImmediatePropagationStopped:Se,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=_e,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=_e,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=_e,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(e,t){w.event.special[e]={setup:function(){return Me(this,e,Ce),!1},trigger:function(){return Me(this,e),!0},_default:function(){return!0},delegateType:t}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return r&&(r===i||w.contains(i,r))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}})),w.fn.extend({on:function(e,t,n,i){return ke(this,e,t,n,i)},one:function(e,t,n,i){return ke(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Se),this.each((function(){w.event.remove(this,e,n,t)}))}});var Ee=/<script|<style|<link/i,Te=/checked\s*(?:[^=]|=\s*.checked.)/i,Pe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ae(e,t){return E(e,"table")&&E(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function Oe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function De(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Re(e,t){var n,i,r,o,s,a;if(1===t.nodeType){if(X.hasData(e)&&(a=X.get(e).events))for(r in X.remove(t,"handle events"),a)for(n=0,i=a[r].length;n<i;n++)w.event.add(t,r,a[r][n]);J.hasData(e)&&(o=J.access(e),s=w.extend({},o),J.set(t,s))}}function Le(e,t){var n=t.nodeName.toLowerCase();"input"===n&&fe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Ne(e,t,n,i){t=o(t);var r,s,a,c,l,u,h=0,d=e.length,g=d-1,m=t[0],y=p(m);if(y||d>1&&"string"==typeof m&&!f.checkClone&&Te.test(m))return e.each((function(r){var o=e.eq(r);y&&(t[0]=m.call(this,r,o.html())),Ne(o,t,n,i)}));if(d&&(s=(r=ve(t,e[0].ownerDocument,!1,e,i)).firstChild,1===r.childNodes.length&&(r=s),s||i)){for(c=(a=w.map(ye(r,"script"),Oe)).length;h<d;h++)l=r,h!==g&&(l=w.clone(l,!0,!0),c&&w.merge(a,ye(l,"script"))),n.call(e[h],l,h);if(c)for(u=a[a.length-1].ownerDocument,w.map(a,De),h=0;h<c;h++)l=a[h],ge.test(l.type||"")&&!X.access(l,"globalEval")&&w.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&!l.noModule&&w._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},u):x(l.textContent.replace(Pe,""),l,u))}return e}function Fe(e,t,n){for(var i,r=t?w.filter(t,e):e,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||w.cleanData(ye(i)),i.parentNode&&(n&&re(i)&&xe(ye(i,"script")),i.parentNode.removeChild(i));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var i,r,o,s,a=e.cloneNode(!0),c=re(e);if(!(f.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(s=ye(a),i=0,r=(o=ye(e)).length;i<r;i++)Le(o[i],s[i]);if(t)if(n)for(o=o||ye(e),s=s||ye(a),i=0,r=o.length;i<r;i++)Re(o[i],s[i]);else Re(e,a);return(s=ye(a,"script")).length>0&&xe(s,!c&&ye(e,"script")),a},cleanData:function(e){for(var t,n,i,r=w.event.special,o=0;void 0!==(n=e[o]);o++)if($(n)){if(t=n[X.expando]){if(t.events)for(i in t.events)r[i]?w.event.remove(n,i):w.removeEvent(n,i,t.handle);n[X.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Fe(this,e,!0)},remove:function(e){return Fe(this,e)},text:function(e){return G(this,(function(e){return void 0===e?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ne(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ae(this,e).appendChild(e)}))},prepend:function(){return Ne(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ae(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ne(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ne(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return w.clone(this,e,t)}))},html:function(e){return G(this,(function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ee.test(e)&&!me[(pe.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ne(this,arguments,(function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(ye(this)),n&&n.replaceChild(t,this))}),e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){w.fn[e]=function(e){for(var n,i=[],r=w(e),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),w(r[a])[t](n),s.apply(i,n.get());return this.pushStack(i)}}));var je=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Ie=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},qe=function(e,t,n){var i,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in i=n.call(e),t)e.style[r]=o[r];return i},Be=new RegExp(ne.join("|"),"i");function ze(e,t,n){var i,r,o,s,a=e.style;return(n=n||Ie(e))&&(""!==(s=n.getPropertyValue(t)||n[t])||re(e)||(s=w.style(e,t)),!f.pixelBoxStyles()&&je.test(s)&&Be.test(t)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function Ge(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ie.appendChild(l).appendChild(u);var t=e.getComputedStyle(u);i="1%"!==t.top,c=12===n(t.marginLeft),u.style.right="60%",s=36===n(t.right),r=36===n(t.width),u.style.position="absolute",o=12===n(u.offsetWidth/3),ie.removeChild(l),u=null}}function n(e){return Math.round(parseFloat(e))}var i,r,o,s,a,c,l=m.createElement("div"),u=m.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle="content-box"===u.style.backgroundClip,w.extend(f,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),c},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,n,i,r;return null==a&&(t=m.createElement("table"),n=m.createElement("tr"),i=m.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",i.style.height="9px",i.style.display="block",ie.appendChild(t).appendChild(n).appendChild(i),r=e.getComputedStyle(n),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===n.offsetHeight,ie.removeChild(t)),a}}))}();var He=["Webkit","Moz","ms"],Ve=m.createElement("div").style,We={};function Ue(e){var t=w.cssProps[e]||We[e];return t||(e in Ve?e:We[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=He.length;n--;)if((e=He[n]+t)in Ve)return e}(e)||e)}var $e=/^(none|table(?!-c[ea]).+)/,Ye=/^--/,Xe={position:"absolute",visibility:"hidden",display:"block"},Je={letterSpacing:"0",fontWeight:"400"};function Ke(e,t,n){var i=te.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function Qe(e,t,n,i,r,o){var s="width"===t?1:0,a=0,c=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(c+=w.css(e,n+ne[s],!0,r)),i?("content"===n&&(c-=w.css(e,"padding"+ne[s],!0,r)),"margin"!==n&&(c-=w.css(e,"border"+ne[s]+"Width",!0,r))):(c+=w.css(e,"padding"+ne[s],!0,r),"padding"!==n?c+=w.css(e,"border"+ne[s]+"Width",!0,r):a+=w.css(e,"border"+ne[s]+"Width",!0,r));return!i&&o>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-c-a-.5))||0),c}function Ze(e,t,n){var i=Ie(e),r=(!f.boxSizingReliable()||n)&&"border-box"===w.css(e,"boxSizing",!1,i),o=r,s=ze(e,t,i),a="offset"+t[0].toUpperCase()+t.slice(1);if(je.test(s)){if(!n)return s;s="auto"}return(!f.boxSizingReliable()&&r||!f.reliableTrDimensions()&&E(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===w.css(e,"display",!1,i))&&e.getClientRects().length&&(r="border-box"===w.css(e,"boxSizing",!1,i),(o=a in e)&&(s=e[a])),(s=parseFloat(s)||0)+Qe(e,t,n||(r?"border":"content"),o,i,s)+"px"}function et(e,t,n,i,r){return new et.prototype.init(e,t,n,i,r)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=ze(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s,a=U(t),c=Ye.test(t),l=e.style;if(c||(t=Ue(a)),s=w.cssHooks[t]||w.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(e,!1,i))?r:l[t];"string"===(o=typeof n)&&(r=te.exec(n))&&r[1]&&(n=ae(e,t,r),o="number"),null!=n&&n==n&&("number"!==o||c||(n+=r&&r[3]||(w.cssNumber[a]?"":"px")),f.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,i))||(c?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,i){var r,o,s,a=U(t);return Ye.test(t)||(t=Ue(a)),(s=w.cssHooks[t]||w.cssHooks[a])&&"get"in s&&(r=s.get(e,!0,n)),void 0===r&&(r=ze(e,t,i)),"normal"===r&&t in Je&&(r=Je[t]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),w.each(["height","width"],(function(e,t){w.cssHooks[t]={get:function(e,n,i){if(n)return!$e.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Ze(e,t,i):qe(e,Xe,(function(){return Ze(e,t,i)}))},set:function(e,n,i){var r,o=Ie(e),s=!f.scrollboxSize()&&"absolute"===o.position,a=(s||i)&&"border-box"===w.css(e,"boxSizing",!1,o),c=i?Qe(e,t,i,a,o):0;return a&&s&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Qe(e,t,"border",!1,o)-.5)),c&&(r=te.exec(n))&&"px"!==(r[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(0,n,c)}}})),w.cssHooks.marginLeft=Ge(f.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(ze(e,"marginLeft"))||e.getBoundingClientRect().left-qe(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(e,t){w.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[e+ne[i]+t]=o[i]||o[i-2]||o[0];return r}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)})),w.fn.extend({css:function(e,t){return G(this,(function(e,t,n){var i,r,o={},s=0;if(Array.isArray(t)){for(i=Ie(e),r=t.length;s<r;s++)o[t[s]]=w.css(e,t[s],!1,i);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)}),e,t,arguments.length>1)}}),w.Tween=et,et.prototype={constructor:et,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}},et.prototype.init.prototype=et.prototype,et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[Ue(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},et.propHooks.scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=et.prototype.init,w.fx.step={};var tt,nt,it=/^(?:toggle|show|hide)$/,rt=/queueHooks$/;function ot(){nt&&(!1===m.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(ot):e.setTimeout(ot,w.fx.interval),w.fx.tick())}function st(){return e.setTimeout((function(){tt=void 0})),tt=Date.now()}function at(e,t){var n,i=0,r={height:e};for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=ne[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function ct(e,t,n){for(var i,r=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,t,e))return i}function lt(e,t,n){var i,r,o=0,s=lt.prefilters.length,a=w.Deferred().always((function(){delete c.elem})),c=function(){if(r)return!1;for(var t=tt||st(),n=Math.max(0,l.startTime+l.duration-t),i=1-(n/l.duration||0),o=0,s=l.tweens.length;o<s;o++)l.tweens[o].run(i);return a.notifyWith(e,[l,i,n]),i<1&&s?n:(s||a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:tt||st(),duration:n.duration,tweens:[],createTween:function(t,n){var i=w.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){var n=0,i=t?l.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)l.tweens[n].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),u=l.props;for(!function(e,t){var n,i,r,o,s;for(n in e)if(r=t[i=U(n)],o=e[n],Array.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(s=w.cssHooks[i])&&"expand"in s)for(n in o=s.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=r);else t[i]=r}(u,l.opts.specialEasing);o<s;o++)if(i=lt.prefilters[o].call(l,e,u,l.opts))return p(i.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return w.map(u,ct,l),p(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(c,{elem:e,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ae(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){p(e)?(t=e,e=["*"]):e=e.match(N);for(var n,i=0,r=e.length;i<r;i++)n=e[i],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,r,o,s,a,c,l,u,h="width"in t||"height"in t,d=this,f={},p=e.style,g=e.nodeType&&se(e),m=X.get(e,"fxshow");for(i in n.queue||(null==(s=w._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,w.queue(e,"fx").length||s.empty.fire()}))}))),t)if(r=t[i],it.test(r)){if(delete t[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}f[i]=m&&m[i]||w.style(e,i)}if((c=!w.isEmptyObject(t))||!w.isEmptyObject(f))for(i in h&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(l=m&&m.display)&&(l=X.get(e,"display")),"none"===(u=w.css(e,"display"))&&(l?u=l:(ue([e],!0),l=e.style.display||l,u=w.css(e,"display"),ue([e]))),("inline"===u||"inline-block"===u&&null!=l)&&"none"===w.css(e,"float")&&(c||(d.done((function(){p.display=l})),null==l&&(u=p.display,l="none"===u?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),c=!1,f)c||(m?"hidden"in m&&(g=m.hidden):m=X.access(e,"fxshow",{display:l}),o&&(m.hidden=!g),g&&ue([e],!0),d.done((function(){for(i in g||ue([e]),X.remove(e,"fxshow"),f)w.style(e,i,f[i])}))),c=ct(g?m[i]:0,i,d),i in m||(m[i]=c.start,g&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),w.speed=function(e,t,n){var i=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||p(e)&&e,duration:e,easing:n&&t||t&&!p(t)&&t};return w.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in w.fx.speeds?i.duration=w.fx.speeds[i.duration]:i.duration=w.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){p(i.old)&&i.old.call(this),i.queue&&w.dequeue(this,i.queue)},i},w.fn.extend({fadeTo:function(e,t,n,i){return this.filter(se).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=w.isEmptyObject(e),o=w.speed(t,n,i),s=function(){var t=lt(this,w.extend({},e),o);(r||X.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,r=null!=e&&e+"queueHooks",o=w.timers,s=X.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&rt.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));!t&&n||w.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=X.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=w.timers,s=i?i.length:0;for(n.finish=!0,w.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish}))}}),w.each(["toggle","show","hide"],(function(e,t){var n=w.fn[t];w.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(at(t,!0),e,i,r)}})),w.each({slideDown:at("show"),slideUp:at("hide"),slideToggle:at("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){w.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}})),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),tt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){nt||(nt=!0,ot())},w.fx.stop=function(){nt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx&&w.fx.speeds[t]||t,n=n||"fx",this.queue(n,(function(n,i){var r=e.setTimeout(n,t);i.stop=function(){e.clearTimeout(r)}}))},function(){var e=m.createElement("input"),t=m.createElement("select").appendChild(m.createElement("option"));e.type="checkbox",f.checkOn=""!==e.value,f.optSelected=t.selected,(e=m.createElement("input")).value="t",e.type="radio",f.radioValue="t"===e.value}();var ut,ht=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return G(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){w.removeAttr(this,e)}))}}),w.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(r=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?ut:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=w.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!f.radioValue&&"radio"===t&&E(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,r=t&&t.match(N);if(r&&1===e.nodeType)for(;n=r[i++];)e.removeAttribute(n)}}),ut={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=ht[t]||w.find.attr;ht[t]=function(e,t,i){var r,o,s=t.toLowerCase();return i||(o=ht[s],ht[s]=r,r=null!=n(e,t,i)?s:null,ht[s]=o),r}}));var dt=/^(?:input|select|textarea|button)$/i,ft=/^(?:a|area)$/i;function pt(e){return(e.match(N)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(N)||[]}w.fn.extend({prop:function(e,t){return G(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[w.propFix[e]||e]}))}}),w.extend({prop:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(e)||(t=w.propFix[t]||t,r=w.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):dt.test(e.nodeName)||ft.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),f.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(e){var t,n,i,r,o,s,a,c=0;if(p(e))return this.each((function(t){w(this).addClass(e.call(this,t,gt(this)))}));if((t=mt(e)).length)for(;n=this[c++];)if(r=gt(n),i=1===n.nodeType&&" "+pt(r)+" "){for(s=0;o=t[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(a=pt(i))&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,i,r,o,s,a,c=0;if(p(e))return this.each((function(t){w(this).removeClass(e.call(this,t,gt(this)))}));if(!arguments.length)return this.attr("class","");if((t=mt(e)).length)for(;n=this[c++];)if(r=gt(n),i=1===n.nodeType&&" "+pt(r)+" "){for(s=0;o=t[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(a=pt(i))&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e,i="string"===n||Array.isArray(e);return"boolean"==typeof t&&i?t?this.addClass(e):this.removeClass(e):p(e)?this.each((function(n){w(this).toggleClass(e.call(this,n,gt(this),t),t)})):this.each((function(){var t,r,o,s;if(i)for(r=0,o=w(this),s=mt(e);t=s[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||((t=gt(this))&&X.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":X.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+pt(gt(n))+" ").indexOf(t)>-1)return!0;return!1}});var yt=/\r/g;w.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=p(e),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?e.call(this,n,w(this).val()):e)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=w.map(r,(function(e){return null==e?"":e+""}))),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))}))):r?(t=w.valHooks[r.type]||w.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(yt,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:pt(w.text(e))}},select:{get:function(e){var t,n,i,r=e.options,o=e.selectedIndex,s="select-one"===e.type,a=s?null:[],c=s?o+1:r.length;for(i=o<0?c:s?o:0;i<c;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!E(n.parentNode,"optgroup"))){if(t=w(n).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=w.makeArray(t),s=r.length;s--;)((i=r[s]).selected=w.inArray(w.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},f.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),f.focusin="onfocusin"in e;var xt=/^(?:focusinfocus|focusoutblur)$/,bt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,i,r){var o,s,a,c,l,h,d,f,y=[i||m],x=u.call(t,"type")?t.type:t,b=u.call(t,"namespace")?t.namespace.split("."):[];if(s=f=a=i=i||m,3!==i.nodeType&&8!==i.nodeType&&!xt.test(x+w.event.triggered)&&(x.indexOf(".")>-1&&(b=x.split("."),x=b.shift(),b.sort()),l=x.indexOf(":")<0&&"on"+x,(t=t[w.expando]?t:new w.Event(x,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:w.makeArray(n,[t]),d=w.event.special[x]||{},r||!d.trigger||!1!==d.trigger.apply(i,n))){if(!r&&!d.noBubble&&!g(i)){for(c=d.delegateType||x,xt.test(c+x)||(s=s.parentNode);s;s=s.parentNode)y.push(s),a=s;a===(i.ownerDocument||m)&&y.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=y[o++])&&!t.isPropagationStopped();)f=s,t.type=o>1?c:d.bindType||x,(h=(X.get(s,"events")||Object.create(null))[t.type]&&X.get(s,"handle"))&&h.apply(s,n),(h=l&&s[l])&&h.apply&&$(s)&&(t.result=h.apply(s,n),!1===t.result&&t.preventDefault());return t.type=x,r||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(y.pop(),n)||!$(i)||l&&p(i[x])&&!g(i)&&((a=i[l])&&(i[l]=null),w.event.triggered=x,t.isPropagationStopped()&&f.addEventListener(x,bt),i[x](),t.isPropagationStopped()&&f.removeEventListener(x,bt),w.event.triggered=void 0,a&&(i[l]=a)),t.result}},simulate:function(e,t,n){var i=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(i,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each((function(){w.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),f.focusin||w.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var i=this.ownerDocument||this.document||this,r=X.access(i,t);r||i.addEventListener(e,n,!0),X.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=X.access(i,t)-1;r?X.access(i,t,r):(i.removeEventListener(e,n,!0),X.remove(i,t))}}}));var vt=e.location,wt={guid:Date.now()},_t=/\?/;w.parseXML=function(t){var n,i;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){}return i=n&&n.getElementsByTagName("parsererror")[0],n&&!i||w.error("Invalid XML: "+(i?w.map(i.childNodes,(function(e){return e.textContent})).join("\n"):t)),n};var St=/\[\]$/,Ct=/\r?\n/g,kt=/^(?:submit|button|image|reset|file)$/i,Mt=/^(?:input|select|textarea|keygen)/i;function Et(e,t,n,i){var r;if(Array.isArray(t))w.each(t,(function(t,r){n||St.test(e)?i(e,r):Et(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,n,i)}));else if(n||"object"!==b(t))i(e,t);else for(r in t)Et(e+"["+r+"]",t[r],n,i)}w.param=function(e,t){var n,i=[],r=function(e,t){var n=p(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,(function(){r(this.name,this.value)}));else for(n in e)Et(n,e[n],t,r);return i.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&Mt.test(this.nodeName)&&!kt.test(e)&&(this.checked||!fe.test(e))})).map((function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,(function(e){return{name:t.name,value:e.replace(Ct,"\r\n")}})):{name:t.name,value:n.replace(Ct,"\r\n")}})).get()}});var Tt=/%20/g,Pt=/#.*$/,At=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,Dt=/^(?:GET|HEAD)$/,Rt=/^\/\//,Lt={},Nt={},Ft="*/".concat("*"),jt=m.createElement("a");function It(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(N)||[];if(p(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function qt(e,t,n,i){var r={},o=e===Nt;function s(a){var c;return r[a]=!0,w.each(e[a]||[],(function(e,a){var l=a(t,n,i);return"string"!=typeof l||o||r[l]?o?!(c=l):void 0:(t.dataTypes.unshift(l),s(l),!1)})),c}return s(t.dataTypes[0])||!r["*"]&&s("*")}function Bt(e,t){var n,i,r=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&w.extend(!0,e,i),e}jt.href=vt.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:vt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(vt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ft,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Bt(Bt(e,w.ajaxSettings),t):Bt(w.ajaxSettings,e)},ajaxPrefilter:It(Lt),ajaxTransport:It(Nt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,r,o,s,a,c,l,u,h,d,f=w.ajaxSetup({},n),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?w(p):w.event,y=w.Deferred(),x=w.Callbacks("once memory"),b=f.statusCode||{},v={},_={},S="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(l){if(!s)for(s={};t=Ot.exec(o);)s[t[1].toLowerCase()+" "]=(s[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=s[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return l?o:null},setRequestHeader:function(e,t){return null==l&&(e=_[e.toLowerCase()]=_[e.toLowerCase()]||e,v[e]=t),this},overrideMimeType:function(e){return null==l&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)C.always(e[C.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||S;return i&&i.abort(t),k(0,t),this}};if(y.promise(C),f.url=((t||f.url||vt.href)+"").replace(Rt,vt.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(N)||[""],null==f.crossDomain){c=m.createElement("a");try{c.href=f.url,c.href=c.href,f.crossDomain=jt.protocol+"//"+jt.host!=c.protocol+"//"+c.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=w.param(f.data,f.traditional)),qt(Lt,f,n,C),l)return C;for(h in(u=w.event&&f.global)&&0==w.active++&&w.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Dt.test(f.type),r=f.url.replace(Pt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Tt,"+")):(d=f.url.slice(r.length),f.data&&(f.processData||"string"==typeof f.data)&&(r+=(_t.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(At,"$1"),d=(_t.test(r)?"&":"?")+"_="+wt.guid+++d),f.url=r+d),f.ifModified&&(w.lastModified[r]&&C.setRequestHeader("If-Modified-Since",w.lastModified[r]),w.etag[r]&&C.setRequestHeader("If-None-Match",w.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||n.contentType)&&C.setRequestHeader("Content-Type",f.contentType),C.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ft+"; q=0.01":""):f.accepts["*"]),f.headers)C.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,C,f)||l))return C.abort();if(S="abort",x.add(f.complete),C.done(f.success),C.fail(f.error),i=qt(Nt,f,n,C)){if(C.readyState=1,u&&g.trigger("ajaxSend",[C,f]),l)return C;f.async&&f.timeout>0&&(a=e.setTimeout((function(){C.abort("timeout")}),f.timeout));try{l=!1,i.send(v,k)}catch(e){if(l)throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,s,c){var h,d,m,v,_,S=n;l||(l=!0,a&&e.clearTimeout(a),i=void 0,o=c||"",C.readyState=t>0?4:0,h=t>=200&&t<300||304===t,s&&(v=function(e,t,n){for(var i,r,o,s,a=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){c.unshift(r);break}if(c[0]in n)o=c[0];else{for(r in n){if(!c[0]||e.converters[r+" "+c[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==c[0]&&c.unshift(o),n[o]}(f,C,s)),!h&&w.inArray("script",f.dataTypes)>-1&&w.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),v=function(e,t,n,i){var r,o,s,a,c,l={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!c&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=o,o=u.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(s=l[c+" "+o]||l["* "+o]))for(r in l)if((a=r.split(" "))[1]===o&&(s=l[c+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[r]:!0!==l[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+c+" to "+o}}}return{state:"success",data:t}}(f,v,C,h),h?(f.ifModified&&((_=C.getResponseHeader("Last-Modified"))&&(w.lastModified[r]=_),(_=C.getResponseHeader("etag"))&&(w.etag[r]=_)),204===t||"HEAD"===f.type?S="nocontent":304===t?S="notmodified":(S=v.state,d=v.data,h=!(m=v.error))):(m=S,!t&&S||(S="error",t<0&&(t=0))),C.status=t,C.statusText=(n||S)+"",h?y.resolveWith(p,[d,S,C]):y.rejectWith(p,[C,S,m]),C.statusCode(b),b=void 0,u&&g.trigger(h?"ajaxSuccess":"ajaxError",[C,f,h?d:m]),x.fireWith(p,[C,S]),u&&(g.trigger("ajaxComplete",[C,f]),--w.active||w.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],(function(e,t){w[t]=function(e,n,i,r){return p(n)&&(r=r||i,i=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:r,data:n,success:i},w.isPlainObject(e)&&e))}})),w.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),w._evalUrl=function(e,t,n){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,n)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(p(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return p(e)?this.each((function(t){w(this).wrapInner(e.call(this,t))})):this.each((function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=p(e);return this.each((function(n){w(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var zt={0:200,1223:204},Gt=w.ajaxSettings.xhr();f.cors=!!Gt&&"withCredentials"in Gt,f.ajax=Gt=!!Gt,w.ajaxTransport((function(t){var n,i;if(f.cors||Gt&&!t.crossDomain)return{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(s,r[s]);n=function(e){return function(){n&&(n=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(zt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),i=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout((function(){n&&i()}))},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}})),w.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),w.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,r){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),m.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Ht,Vt=[],Wt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Vt.pop()||w.expando+"_"+wt.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",(function(t,n,i){var r,o,s,a=!1!==t.jsonp&&(Wt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=p(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Wt,"$1"+r):!1!==t.jsonp&&(t.url+=(_t.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||w.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){s=arguments},i.always((function(){void 0===o?w(e).removeProp(r):e[r]=o,t[r]&&(t.jsonpCallback=n.jsonpCallback,Vt.push(r)),s&&p(o)&&o(s[0]),s=o=void 0})),"script"})),f.createHTMLDocument=((Ht=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ht.childNodes.length),w.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(f.createHTMLDocument?((i=(t=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,t.head.appendChild(i)):t=m),o=!n&&[],(r=T.exec(e))?[t.createElement(r[1])]:(r=ve([e],t,o),o&&o.length&&w(o).remove(),w.merge([],r.childNodes)));var i,r,o},w.fn.load=function(e,t,n){var i,r,o,s=this,a=e.indexOf(" ");return a>-1&&(i=pt(e.slice(a)),e=e.slice(0,a)),p(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&w.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done((function(e){o=arguments,s.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)})).always(n&&function(e,t){s.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,(function(t){return e===t.elem})).length},w.offset={setOffset:function(e,t,n){var i,r,o,s,a,c,l=w.css(e,"position"),u=w(e),h={};"static"===l&&(e.style.position="relative"),a=u.offset(),o=w.css(e,"top"),c=w.css(e,"left"),("absolute"===l||"fixed"===l)&&(o+c).indexOf("auto")>-1?(s=(i=u.position()).top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(c)||0),p(t)&&(t=t.call(e,n,w.extend({},a))),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+r),"using"in t?t.using.call(e,h):u.css(h)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){w.offset.setOffset(this,e,t)}));var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],r={top:0,left:0};if("fixed"===w.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((r=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),r.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-w.css(i,"marginTop",!0),left:t.left-r.left-w.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||ie}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;w.fn[e]=function(i){return G(this,(function(e,i,r){var o;if(g(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r)return o?o[t]:e[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):e[i]=r}),e,i,arguments.length)}})),w.each(["top","left"],(function(e,t){w.cssHooks[t]=Ge(f.pixelPosition,(function(e,n){if(n)return n=ze(e,t),je.test(n)?w(e).position()[t]+"px":n}))})),w.each({Height:"height",Width:"width"},(function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,i){w.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return G(this,(function(t,n,r){var o;return g(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===r?w.css(t,n,a):w.style(t,n,r,a)}),t,s?r:void 0,s)}}))})),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){w.fn[t]=function(e){return this.on(t,e)}})),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var Ut=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var n,i,o;if("string"==typeof t&&(n=e[t],t=e,e=n),p(e))return i=r.call(arguments,2),(o=function(){return e.apply(t||this,i.concat(r.call(arguments)))}).guid=e.guid=e.guid||w.guid++,o},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=E,w.isFunction=p,w.isWindow=g,w.camelCase=U,w.type=b,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Ut,"")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return w}));var $t=e.jQuery,Yt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Yt),t&&e.jQuery===w&&(e.jQuery=$t),w},void 0===t&&(e.jQuery=e.$=w),w})),define("editor/snippet_tools",[],(function(){function e(t,n={i:1,level:1}){let i=[];for(let r in t){let o=t[r];null===o&&(o=" "),"object"==typeof o?(n.level++,i.push(r+": {\n"+"\t".repeat(n.level)+e(o,n)+"\n"+"\t".repeat(n.level-1)+"}"),n.level--):("string"==typeof o&&"'"===o[0]?i.push(r+": '${"+n.i+":"+o.slice(1,-1)+"}'"):i.push(r+": ${"+n.i+":"+o+"}"),n.i++)}let r=",\n"+"\t".repeat(n.level);return i.join(r)}return{snippetizeParam:e,addMethodSnippet:function(t,n,i){t._snippet="number"==typeof i||"string"==typeof i?"simpleFunction"===i?n+"()":n+"(${1:"+i+"})":n+"({\n\t"+e(i)+"\n})"}}})),define("toxilibs/color_oklab",[],(function(){function e({red:e,green:t,blue:n}){e=l(e),t=l(t),n=l(n);const i=Math.cbrt(.4122214708*e+.5363325363*t+.0514459929*n),r=Math.cbrt(.2119034982*e+.6806995451*t+.1073969566*n),o=Math.cbrt(.0883024619*e+.2817188376*t+.6299787005*n),s=.2104542553*i+.793617785*r-.0040720468*o,a=1.9779984951*i-2.428592205*r+.4505937099*o,c=.0259040371*i+.7827717662*r-.808675766*o,u=Math.sqrt(a*a+c*c);let h=Math.atan2(c,a)/(2*Math.PI);return h<0&&(h+=1),{L:s,a:a,b:c,C:u,h:h}}function t(e){const{red:t,green:i,blue:r}=n(e),{opacity:o=1}=e;return{red:u(t),green:u(i),blue:u(r),opacity:o}}function n({L:e,a:t,b:n,C:r,h:o=!1}){if(!1!==o){let e=2*o*Math.PI;t=r*Math.cos(e),n=r*Math.sin(e)}let s=e+.3963377774*t+.2158037573*n,a=e-.1055613458*t-.0638541728*n,c=e-.0894841775*t-1.291485548*n;return s*=s*s,a*=a*a,c*=c*c,i(s,a,c)}function i(e,t,n){return{red:4.0767416621*e-3.3077115913*t+.2309699292*n,green:-1.2684380046*e+2.6097574011*t-.3413193965*n,blue:-.0041960863*e-.7034186147*t+1.707614701*n}}function r(e,t){let i=function(e,t){let n,i,r,o,s,a,c,l;-1.88170328*e-.80936493*t>1?(n=1.19086277,i=1.76576728,r=.59662641,o=.75515197,s=.56771245,a=4.0767416621,c=-3.3077115913,l=.2309699292):1.81444104*e-1.19445276*t>1?(n=.73956515,i=-.45954404,r=.08285427,o=.1254107,s=.14503204,a=-1.2684380046,c=2.6097574011,l=-.3413193965):(n=1.35733652,i=-.00915799,r=-1.1513021,o=-.50559606,s=.00692167,a=-.0041960863,c=-.7034186147,l=1.707614701);let u=n+i*e+r*t+o*e*e+s*e*t,h=.3963377774*e+.2158037573*t,d=-.1055613458*e-.0638541728*t,f=-.0894841775*e-1.291485548*t;{let e=1+u*h,t=1+u*d,n=1+u*f,i=a*(e*e*e)+c*(t*t*t)+l*(n*n*n),r=a*(3*h*e*e)+c*(3*d*t*t)+l*(3*f*n*n);u-=i*r/(r*r-.5*i*(a*(6*h*h*e)+c*(6*d*d*t)+l*(6*f*f*n)))}return u}(e,t);const{red:r,green:o,blue:s}=n({L:1,a:i*e,b:i*t});let a=Math.cbrt(1/Math.max(r,o,s));return[a,a*i]}const o=1.1708737864;function s(e){let t=o*e-.206;return.5*(t+Math.sqrt(t*t+.12*o*e))}function a(e){return e*(e+.206)/(o*(e+.03))}function c(e,t,n=r(e,t)){const[i,o]=n;return[o/i,o/(1-i)]}function l(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function u(e){return e<0?0:e<=.0031308?12.92*e:Math.min(1,1.055*Math.pow(e,.4166666666666667)-.055)}return{convertSRGBToOklab:e,convertSRGBToOkHSV:function(t){let{L:i,a:r,b:o}=e(t);if(0===i)return{hue:0,saturation:0,value:0};let l=Math.sqrt(r*r+o*o),u=r/l,h=o/l,d=.5+.5*Math.atan2(-o,-r)/Math.PI,[f,p]=c(u,h),g=1-.5/f,m=p/(l+i*p),y=m*i,x=m*l,b=a(y),v=x*b/y,{red:w,green:_,blue:S}=n({L:b,a:u*v,b:h*v}),C=Math.cbrt(1/Math.max(w,_,S,0));return i/=C,l/=C,l=l*s(i)/i,i=s(i),{hue:d,saturation:(.5+p)*x/(.5*p+p*g*x),value:i/y}},convertOklabToSRGB:t,convertOkHSVToSRGB:function({hue:e,saturation:i,value:r,opacity:o=1}){if(r<.003)return{red:0,green:0,blue:0};const s=2*Math.PI*e,l=Math.cos(s),u=Math.sin(s);let h=c(l,u),d=h[0],f=.5,p=h[1],g=1-f/d,m=1-i*f/(f+p-p*g*i),y=i*p*f/(f+p-p*g*i),x=r*m,b=r*y,v=a(m),w=y*v/m,_=a(x);b=b*_/x,x=_;let{red:S,green:C,blue:k}=n({L:v,a:l*w,b:u*w}),M=Math.cbrt(1/Math.max(S,C,k,0));return x*=M,b*=M,t({L:x,a:b*l,b:b*u,opacity:o})},convertOkHSLToSRGB:function({hue:e,saturation:n,lightness:o,opacity:s=1}){if(o>.997)return{red:1,green:1,blue:1};if(o<.003)return{red:0,green:0,blue:0};const l=2*Math.PI*e,u=Math.cos(l),h=Math.sin(l),d=a(o),{C0:f,Cmid:p,Cmax:g}=function(e,t,n){const o=r(t,n);let s=function(e,t,n,o,s,a=r(e,t)){const[c,l]=a;let u;if((n-s)*l-(c-s)*o<=0)u=l*s/(o*c+l*(s-n));else{u=l*(s-1)/(o*(c-1)+l*(s-n));{let r=n-s,a=.3963377774*e+.2158037573*t,c=-.1055613458*e-.0638541728*t,l=-.0894841775*e-1.291485548*t,h=r+o*a,d=r+o*c,f=r+o*l;{let e=s*(1-u)+u*n,t=u*o,r=e+t*a,p=e+t*c,g=e+t*l,m=r*r*r,y=p*p*p,x=g*g*g,b=3*h*r*r,v=3*d*p*p,w=3*f*g*g,_=6*h*h*r,S=6*d*d*p,C=6*f*f*g,{red:k,green:M,blue:E}=i(m,y,x);k-=1,M-=1,E-=1;let{red:T,green:P,blue:A}=i(b,v,w),{red:O,green:D,blue:R}=i(_,S,C),L=1/(T-.5*k*O/T),N=L<0?1e6:-k*L,F=1/(P-.5*M*D/P),j=F<0?1e6:-M*F,I=1/(A-.5*E*R/A),q=I<0?1e6:-E*I;u+=Math.min(N,j,q)}}}return u}(t,n,e,1,e,o),a=c(t,n,o);const l=.11516993+1/(7.4477897+4.1590124*n+t*(1.75198401*n-2.19557347+t*(-2.13704948-10.02301043*n+t*(5.38770819*n-4.24894561+4.69891013*t)))),u=.11239642+1/(1.6132032-.68124379*n+t*(.40370612+.90148123*n+t*(.6122399*n-.27087943+t*(.00299215-.45399568*n-.14661872*t))));let h=s/Math.min(e*a[0],(1-e)*a[1]),d=e*l,f=(1-e)*u;const p=1/(1/(d*d*d*d)+1/(f*f*f*f));let g=.9*h*Math.sqrt(Math.sqrt(p));d=.4*e,f=.8*(1-e);const m=1/(d*d)+1/(f*f);return{C0:Math.sqrt(1/m),Cmid:g,Cmax:s}}(d,u,h);let m,y,x,b;n<.8?(m=1.25*n,y=0,x=.8*f,b=1-x/p):(m=5*(n-.8),y=p,x=.3125*p*p/f,b=1-x/(g-p));let v=y+m*x/(1-b*m);return t({L:d,a:v*u,b:v*h,opacity:s})}}})),define("toxilibs/color",["./color_oklab"],(function(e){const{convertSRGBToOklab:t,convertSRGBToOkHSV:n,convertOklabToSRGB:i,convertOkHSLToSRGB:r,convertOkHSVToSRGB:o}=e;function s(e,t,n,i=1){const r=typeof e;if("number"===r)this.red=e,this.green=t,this.blue=n,this.opacity=i;else if("object"===r){const{opacity:t=1}=e;if(this.opacity=t,"red"in e)this.red=e.red,this.green=e.green,this.blue=e.blue;else if("hue"in e){const{hue:t,saturation:n=1,lightness:i=.5}=e,r=d(t,n,i);this.red=r.red,this.green=r.green,this.blue=r.blue,this.hslValues={hue:t,saturation:n,lightness:i}}else if("light"in e){const{light:t}=e;this.red=t,this.green=t,this.blue=t}else"red255"in e?(this.red=e.red255/255,this.green=e.green255/255,this.blue=e.blue255/255):function(e,t){if("lightLinear"in t){const n=y(t.lightLinear);e.red=n,e.green=n,e.blue=n}else"redLinear"in t&&(e.red=y(t.redLinear),e.green=y(t.greenLinear),e.blue=y(t.blueLinear))}(this,e)}else{const t=_(e);this.red=t.red,this.green=t.green,this.blue=t.blue,this.opacity=t.opacity}}function a(e){return{red:e,green:e,blue:e}}function c(e){return{red:e=g(e),green:e,blue:e}}function l(e){let{red:t,green:n,blue:i}=e;const r=Math.max(t,n,i),o=Math.min(t,n,i),s=(r+o)/2,a=r-o;e.hslValues=0===a?{lightness:s,hue:0,saturation:0}:{lightness:s,hue:h(r,t,n,i,a),saturation:u(s,a,o,r)}}function u(e,t,n,i){return e>.5?t/(2-i-n):t/(i+n)}function h(e,t,n,i,r){return e===i?(4+(t-n)/r)/6:e===n?(2+(i-t)/r)/6:n<i?1+(n-i)/(6*r):(n-i)/(6*r)}function d(e,t,n){const i=v(n,t),r=2*n-i;return{red:w(r,i,(e*=6)+2),green:w(r,i,e),blue:w(r,i,e-2)}}function f({red:e,green:t,blue:n}){return{red:g(e),green:g(t),blue:g(n)}}function p(e,t,n){const i=v(n,t),r=2*n-i;return{red:g(w(r,i,(e*=6)+2)),green:g(w(r,i,e)),blue:g(w(r,i,e-2))}}function g(e){return Math.floor(255.999*e)}function m(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}s.createFromOklab=function(e){return new s(i(e))},s.createFromOkHSL=function(e){return new s(r(e))},s.createFromOkHSV=function(e){return new s(o(e))},s.autoConvertToRGB=function(e,t,n){const i=typeof e;if("object"===i){if("red"in e)return e;if("hue"in e){const{hue:t,saturation:n=1,lightness:i=.5}=e;return d(t,n,i)}if("red255"in e)return{red:e.red255/255,green:e.green255/255,blue:e.blue255/255};if("light"in e)return a(e.light);if("lightLinear"in e)return a(y(e.lightLinear));if("redLinear"in e)return{red:y((r=e).redLinear),green:y(r.greenLinear),blue:y(r.blueLinear)}}else if("string"===i)return _(e);var r;return{red:e,green:t,blue:n}},s.convertHexToRGB=C,s.convertCSSToRGB=_,s.autoConvertToRGB255=function(e,t,n){const i=typeof e;if("object"===i){if("red"in e)return f(e);if("red255"in e)return{red:e.red255,green:e.green255,blue:e.blue255};if("hue"in e){const{hue:t,saturation:n=1,lightness:i=.5}=e;return p(t,n,i)}if("light"in e)return c(e.light);if("lightLinear"in e)return c(y(e.lightLinear));if("redLinear"in e)return{red:x((r=e).redLinear),green:x(r.greenLinear),blue:x(r.blueLinear)}}else if("string"===i)return f(_(e));var r;return f({red:e,green:t,blue:n})},s.convertTo255=g,s.convertToSRGB=y,s.convertSRGBToOklab=t,s.convertSRGBToOkHSV=n,s.convertOklabToSRGB=i,s.isCSSColor=function(e){return e in s.allCSSColors||M.test(e)||E.test(e)},s.modifyHSLOfRGB255=function(e,t,n,i={}){const r=function(e,t,n){e/=255,t/=255,n/=255;const i=Math.max(e,t,n),r=Math.min(e,t,n),o=(i+r)/2,s=i-r;if(0===s)return{hue:0,saturation:0,lightness:o};{const a=u(o,s,r,i);return{hue:h(i,e,t,n,s),saturation:a,lightness:o}}}(e,t,n);if("function"==typeof i){const e=i(r.hue,r.saturation,r.lightness);return p(e[0],e[1],e[2])}return P(r,i),p(r.hue,r.saturation,r.lightness)},Object.defineProperty(s.prototype,"hue",{enumerable:!0,get:function(){return this.hslValues||l(this),this.hslValues.hue}}),Object.defineProperty(s.prototype,"saturation",{enumerable:!0,get:function(){return this.hslValues||l(this),this.hslValues.saturation}}),Object.defineProperty(s.prototype,"lightness",{enumerable:!0,get:function(){return this.hslValues||l(this),this.hslValues.lightness}}),Object.defineProperty(s.prototype,"luminance",{enumerable:!0,get:function(){return b(this)}}),Object.defineProperty(s.prototype,"perceptualLightness",{enumerable:!0,get:function(){const e=b(this);return e<=.008856?903.3*e:116*Math.pow(e,.333)-16}}),Object.defineProperty(s.prototype,"red255",{enumerable:!0,get:function(){return g(this.red)}}),Object.defineProperty(s.prototype,"green255",{enumerable:!0,get:function(){return g(this.green)}}),Object.defineProperty(s.prototype,"blue255",{enumerable:!0,get:function(){return g(this.blue)}}),Object.defineProperty(s.prototype,"redLinear",{enumerable:!0,get:function(){return m(this.red)}}),Object.defineProperty(s.prototype,"greenLinear",{enumerable:!0,get:function(){return m(this.green)}}),Object.defineProperty(s.prototype,"blueLinear",{enumerable:!0,get:function(){return m(this.blue)}}),s.prototype.toOklab=function(){return t(this)},s.prototype.toString=function(){return 1===this.opacity?"rgb("+g(this.red)+","+g(this.green)+","+g(this.blue)+")":"rgba("+g(this.red)+","+g(this.green)+","+g(this.blue)+","+this.opacity+")"},s.prototype.toCSSString=s.prototype.toString,s.prototype.getHSL=function(){this.hslValues||l(this);const{hslValues:e}=this;return{hue:e.hue,saturation:e.saturation,lightness:e.lightness}},s.prototype.modifyHSL=function(e={}){const t=this.getHSL();return P(t,e),t.opacity=this.opacity,new s(t)},s.prototype.modifyHSLA=function(e={}){const t=this.getHSL();return P(t,e),t.opacity=function(e,t){"opacity"in t&&(e=t.opacity);"fadeOut"in t&&(e-=e*t.fadeOut);"fadeIn"in t&&(e+=(1-e)*t.fadeIn);return T(e)}(this.opacity,e),new s(t)},s.prototype.writeOnItWithDark=function(){return this.perceptualLightness>50},s.prototype.clone=function(){const e=new s(this.red,this.green,this.blue,this.opacity);return"hslValues"in this&&(e.hslValues=this.hslValues),e},s.prototype.isCloseTo=function(e){"string"==typeof e&&(e=new s(e));const t=s.convertSRGBToOkHSV(this),n=s.convertSRGBToOkHSV(e);let i=t.value-n.value,r=(t.value+n.value)/2,o=Math.min(t.value,n.value);if(o>.2){if(Math.abs(i)>.2)return!1}else if(o>.1){if(Math.abs(i)>.1)return!1}else if(Math.abs(i)>.06)return!1;if(Math.min(t.value,n.value)<.1)return!0;let a=t.saturation-n.saturation;if(Math.abs(a)>.4)return!1;if(Math.min(t.value,n.value)<.15)return!0;if(Math.max(t.saturation,n.saturation)>.1+.15*r){let e=((.5+t.hue-n.hue)%(c=1)+c)%c-.5;if(Math.abs(e)>.1)return!1}var c;return!0};function y(e){return e<0?0:e<=.0031308?12.92*e:Math.min(1,1.055*Math.pow(e,.4166666666666667)-.055)}function x(e){return g(y(e))}function b(e){return.2126*m(e.red)+.7152*m(e.green)+.0722*m(e.blue)}function v(e,t){return e<.5?e*(1+t):e+t-e*t}function w(e,t,n){return n<0?n+=6:n>6&&(n-=6),n<1?e+(t-e)*n:n<3?t:n<4?e+(t-e)*(4-n):e}function _(e){if("#"===e[0])return C(e);if(e.startsWith("rgb"))return function(e){const t=e.match(k)[1],[n,i,r,o="1"]=t.split(",");return{red:parseInt(n,10)/255,green:parseInt(i,10)/255,blue:parseInt(r,10)/255,opacity:parseFloat(o,10)}}(e);const t=s.allCSSColors[e];if(t)return C(t);throw new Error('color "'+e+'" not recognized')}const S=16/17;function C(e){return e.length<6?{red:D[e[1]],green:D[e[2]],blue:D[e[3]],opacity:1}:{red:D[e[1]]*S+D[e[2]]/17,green:D[e[3]]*S+D[e[4]]/17,blue:D[e[5]]*S+D[e[6]]/17,opacity:1}}const k=/^rgba?\((.*)\)$/,M=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,E=/^rgba?\([0-9\s,.]*\)$/;function T(e){return Math.max(Math.min(e,1),0)}function P(e,t){"hue"in t&&(e.hue=t.hue),"addHue"in t&&(e.hue+=t.addHue),e.saturation=function(e,t){return"saturation"in t&&(e=t.saturation),"unsaturate"in t&&(e-=e*t.unsaturate),"saturate"in t&&(e+=(1-e)*t.saturate),T(e)}(e.saturation,t),e.lightness=function(e,t){return"lightness"in t&&(e=t.lightness),"darken"in t&&(e-=e*t.darken),"enlight"in t&&(e+=(1-e)*t.enlight),T(e)}(e.lightness,t)}const A={a:{phase:[0,.33,.67]},dark:{phase:[.55,.45,.45]},dark2:{frequency:[.7,.7,.7],phase:[.55,.45,.45]}},O=2*Math.PI;s.getColorMapper=function({colorCount:e=300,palette:t="dark2",cycle:n=!1,useIndexes:i=!1,outputAsRGB255:r=!0}={}){let o=[],{zero:s=[.5,.5,.5],amplitude:a=[.5,.5,.5],frequency:c=[1,1,1],phase:l}=A[t];function u(e,t){return s[t]+a[t]*Math.cos(O*(c[t]*e+l[t]))}function h(e,t){return g(u(e,t))}const d=e-1;for(let t=0;t<e;t++){let e=t/d;r?o.push({red255:h(e,0),green255:h(e,1),blue255:h(e,2)}):o.push({red:u(e,0),green:u(e,1),blue:u(e,2)})}return n?i?t=>(t>=e?t%=e:t<0&&(t=e+t%e),o[0|t]):t=>(t>=1?t%=1:t<0&&(t=1+t%1),o[e*t|0]):i?e=>o[Math.max(0,Math.min(0|e,d))]:t=>o[e*Math.max(0,Math.min(t,.99999))|0]},s.allCSSColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};const D={0:0,1:1/15,2:2/15,3:.2,4:4/15,5:5/15,6:.4,7:7/15,8:8/15,9:.6,a:10/15,b:11/15,c:.8,d:13/15,e:14/15,f:1,A:10/15,B:11/15,C:.8,D:13/15,E:14/15,F:1};return s})),define("toxilibs/vector",[],(function(){let e=Math.PI/180;function t(t,n=!1){if(!1!==n)this.x=t,this.y=n;else if("x"in t)this.x=t.x,this.y=t.y;else if("from"in t){const{from:e,to:n}=t;this.x=n.x-e.x,this.y=n.y-e.y,"length"in t&&this.setLength$(t.length)}else if("direction"in t){const n=e*t.direction,{length:i=1}=t;this.x=i*Math.cos(n),this.y=i*Math.sin(n)}}function n(){return Math.atan2(this.y,this.x)/e}function i(){return Math.atan2(this.y,this.x)}function r(t){const n=t*e;return this.setDirectionRad$(n)}function o(e){const{length:t}=this;return this.x=t*Math.cos(e),this.y=t*Math.sin(e),this}function s(e,t){if(0===t)throw new Error("can not change length of a 0 length vector")}return Object.defineProperty(t.prototype,"length",{enumerable:!0,get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set:function(e){this.setLength$(e)}}),Object.defineProperty(t.prototype,"angle",{enumerable:!1,get:n,set:r}),Object.defineProperty(t.prototype,"angleRad",{enumerable:!1,get:i,set:o}),Object.defineProperty(t.prototype,"direction",{enumerable:!0,get:n,set:r}),Object.defineProperty(t.prototype,"directionRad",{enumerable:!1,get:i,set:o}),t.prototype.isNull=function(){return 0===this.x&&0===this.y},t.prototype.clone=function(){return new t(this)},t.prototype.plus=function({x:e,y:n}){return new t(this.x+e,this.y+n)},t.prototype.add=function({x:e,y:t}){return this.x+=e,this.y+=t,this},t.prototype.plus$=t.prototype.add,t.prototype.minus=function({x:e,y:n}){return new t(this.x-e,this.y-n)},t.prototype.substract=function({x:e,y:t}){return this.x-=e,this.y-=t,this},t.prototype.minus$=t.prototype.substract,t.prototype.multiply=function(e){return new t(this.x*e,this.y*e)},t.prototype.multiply$=function(e){return this.x*=e,this.y*=e,this},t.prototype.setLength=function(e){if(0===e)return new t(0,0);const{length:n}=this;return s(this,n),this.multiply(e/n)},t.prototype.setLength$=function(e){if(0===e)return this.x=0,this.y=0,this;const{length:t}=this;return s(this,t),this.multiply$(e/t)},t.prototype.normalize=function(){const{length:e}=this;return s(this,e),this.multiply(1/e)},t.prototype.normalize$=function(){const{length:e}=this;return s(this,e),this.multiply$(1/e)},t.prototype.addToLength=function(e){const{length:t}=this;return s(this,t),this.multiply((t+e)/t)},t.prototype.addToLength$=function(e){const{length:t}=this;return s(this,t),this.multiply$((t+e)/t)},t.prototype.rotate90=function(){return new t(-this.y,this.x)},t.prototype.rotate90$=function(){const e=this.x;return this.x=-this.y,this.y=e,this},t.prototype.rotate=function(t){return this.rotateRad(t*e)},t.prototype.rotate$=function(t){return this.rotateRad$(t*e)},t.prototype.rotateRad=function(e){const n=Math.sin(e),i=Math.cos(e);return new t(this.x*i-this.y*n,this.x*n+this.y*i)},t.prototype.rotateRad$=function(e){const t=Math.sin(e),n=Math.cos(e),i=this.x;return this.x=this.x*n-this.y*t,this.y=i*t+this.y*n,this},t.prototype.setDirection=function(e){return new t({length:this.length,direction:e})},t.prototype.setDirection$=r,t.prototype.setDirectionRad$=o,t.prototype.dotProduct=function({x:e,y:t}){return this.x*e+this.y*t},t.prototype.crossProduct=function({x:e,y:t}){return this.x*t-this.y*e},t.prototype.projectOn=function(e){return e.multiply(this.dotProduct(e))},t})),define("toxilibs/grid",["./random"],(function(e){function t(){return!0}function n(e,t){return this.cells[e+"_"+t]}function i(e,t){return(e%t+t)%t}function r(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height}function o(e,t){return t>=0&&t<this.height}function s(e){return e>=0&&e<this.width}const a={},c={};function l(e,{x:t,y:n,step:i,filter:r,range:o=!1,includeStart:s=!0,includeUndefined:a=!1},{findFirst:c=!1,withCoords:l=!1}){const u=[],{x:h=0,y:d=0}=i;o=function(e,{xOrigin:t,yOrigin:n,stepX:i,stepY:r,range:o}){if(!1===o){if(0!==i&&(e.toricX||e.width===1/0))throw new Error("Range must be specified to search in the x direction");if(0!==r&&(e.toricY||e.height===1/0))throw new Error("Range must be specified to search in the x direction");if(o=i>0?Math.floor((e.width-1-t)/i):i<0?Math.floor(t/-i):1/0,r>0)o=Math.min(o,Math.floor((e.height-1-n)/r));else if(r<0)o=Math.min(o,Math.floor(n/-r));else if(0===i)throw new Error("Step can not be x: 0 and y: 0")}return o}(e,{xOrigin:t,yOrigin:n,stepX:h,stepY:d,range:o});for(let i=s?0:1;i<=o;i++){let o=t+i*h,s=n+i*d;if(!e.isInside(o,s))continue;e.toricCoordX&&(o=e.toricCoordX(o)),e.toricCoordY&&(s=e.toricCoordY(s));const f=e.getCell(o,s);if((void 0!==f||a)&&(!r||r(f,o,s))){const e=l?{cell:f,x:o,y:s}:f;if(c)return e;u.push(e)}}return c?null:u}return a.setCell=function(e,t,n){return!!this.isInside(e,t)&&(this.cells[this.coordKey(e,t)]=n,!0)},a.setCellFast=function(e,t,n){this.cells[this.coordKey(e,t)]=n},c.setCell=function(e,t,n){return!!this.isInside(e,t)&&this.setCellInfinity(e,t,n)},c.setCellFast=function(e,t,n){this.setCellInfinity(e,t,n)},a.forEachDefinedCell=function(e){for(let t=0;t<this.cells.length;t++)void 0!==this.cells[t]&&e(this.cells[t])},c.forEachDefinedCell=function(e){for(let t in this.cells)e(this.cells[t])},a.forEachDefinedCellWithCoords=function(e){for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++){let i=this.cells[this.coordKey(t,n)];void 0!==i&&e(i,t,n)}},c.forEachDefinedCellWithCoords=function(e){for(let t in this.cells){let n=t.split("_");e(this.cells[t],parseInt(n[0],10),parseInt(n[1],10))}},a.definedCellsCount=function(){let e=0;for(let t=0;t<this.cells.length;t++)void 0!==this.cells[t]&&e++;return e},c.definedCellsCount=function(){return Object.keys(this.cells).length},a.someCellMatch=function(e){for(let t=0;t<this.cells.length;t++)if(e(this.cells[t]))return!0;return!1},c.someCellMatch=function(e){for(let t in this.cells)if(e(this.cells[t]))return!0;return!1},a.everyCellMatch=function(e){for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++)if(!e(this.cells[this.coordKey(t,n)],t,n))return!1;return!0},c.everyCellMatch=function(e){for(let t in this.cells)if(!e(this.cells[t]))return!1;return!0},a.clear=function(){this.cells=new Array(this.width*this.height)},c.clear=function(){this.cells={}},function(u,h){u.width=h.width,u.height=h.height,function(e,{toric:t,toricX:n,toricY:i}){e.toric=t,e.toricX=t||n,e.toricY=t||i}(u,h);let d=function(e,t){return e.width!==1/0&&e.height!==1/0&&!t.dontUseArray}(u,h);!function(e,t){t?(e.cells=new Array(e.width*e.height),e.nonToricCoordKey=function(e,t){return e+this.width*t}):(e.cells={},e.nonToricCoordKey=function(e,t){return e+"_"+t});function n(e,t){return l(e)+this.width*u(t)}function r(e,t){return l(e)+"_"+u(t)}function o(e,t){return l(e)+this.width*t}function s(e,t){return l(e)+"_"+t}function a(e,t){return e+this.width*u(t)}function c(e,t){return e+"_"+u(t)}e.toric?e.coordKey=t?n:r:e.toricX?e.coordKey=t?o:s:e.toricY?e.coordKey=t?a:c:e.coordKey=e.nonToricCoordKey;(e.toric||e.toricX)&&(e.toricCoordX=l);(e.toric||e.toricY)&&(e.toricCoordY=u);function l(t){return i(t,e.width)}function u(t){return i(t,e.height)}}(u,d),function(e){let n=e.width===1/0||e.toricX,i=e.height===1/0||e.toricY;e.isInside=n&&i?t:n?o:i?s:r}(u);let{random:f=e}=h;u.getCell=function(e,t){return this.isInside(e,t)?this.cells[this.coordKey(e,t)]:void 0},u.getCellFast=function(e,t){return this.cells[this.coordKey(e,t)]},u.width===1/0&&u.height===1/0&&(u.getCell=n),u.getOrCreateCell=function(e,t,n){if(this.isInside(e,t)){let i=this.coordKey(e,t),r=this.cells[i];return r||(this.cells[i]=n),r||n}},u.deleteCell=function(e,t){this.setCell(e,t,void 0)},u.deleteCellFast=function(e,t){this.setCellFast(e,t,void 0)};let p=d?a:c;u.forEachDefinedCell=p.forEachDefinedCell,u.forEachDefinedCellWithCoords=p.forEachDefinedCellWithCoords,u.setCell=p.setCell,u.setCellFast=p.setCellFast,u.everyCellMatch=p.everyCellMatch,u.someCellMatch=p.someCellMatch,u.definedCellsCount=p.definedCellsCount,u.clear=p.clear,d?function(e){e.forEachCell=function(e){for(let t=0;t<this.cells.length;t++)e(this.cells[t])},e.forEachCellWithCoords=function(e){for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++)e(this.cells[this.coordKey(t,n)],t,n)},e.setCells=function(t){let{cells:n}=this;this.forEachCellWithCoords((function(i,r,o){n[e.coordKey(r,o)]="function"==typeof t?t(r,o):t}))}}(u):function(e){e.setCellInfinity=function(e,t,n){return void 0===n?delete this.cells[this.coordKey(e,t)]:this.cells[this.coordKey(e,t)]=n,!0},e.width===1/0&&e.height===1/0&&(e.setCell=e.setCellInfinity)}(u),u.addCellToSelection=function(e,t,n){let i=this.getCell(e,t);return void 0!==i&&n.push(i),n},u.neighboursOf=function(e,t){let n=[];return this.addCellToSelection(e-1,t,n),this.addCellToSelection(e+1,t,n),this.addCellToSelection(e,t-1,n),this.addCellToSelection(e,t+1,n),n},u.forEachCellWithinRange=function({x:e,y:t,range:n=0,includeUndefined:i},r){let o=Math.floor(e-n),s=Math.floor(e+n),a=Math.floor(t-n),c=Math.floor(t+n);for(let e=o;e<=s;e++)for(let t=a;t<=c;t++){let n=u.getCell(e,t);(i||n)&&r(n,e,t)}},u.forEachCellWithinBox=function({xMin:e,xMax:t,yMin:n,yMax:i,includeUndefined:r},o){e=Math.floor(e),t=Math.floor(t),n=Math.floor(n),i=Math.floor(i);for(let s=e;s<=t;s++)for(let e=n;e<=i;e++){let t=u.getCell(s,e);(r||t)&&o(t,s,e)}},u.findFirstInSequence=function(e){return l(this,e,{findFirst:!0})},u.findFirstInSequenceWithCoords=function(e){return l(this,e,{findFirst:!0,withCoords:!0})},u.findAllInSequence=function(e){return l(this,e,{findFirst:!1})},u.findAllInSequenceWithCoords=function(e){return l(this,e,{findFirst:!1,withCoords:!0})},u.forEachDefinedCellInSequence=function({x:e,y:t,step:n,filter:i,range:r,includeStart:o},s){l(this,{x:e,y:t,step:n,filter:i,range:r,includeStart:o,includeUndefined:!1},{findFirst:!1,withCoords:!0}).forEach((({cell:e,x:t,y:n})=>{s(e,t,n)}))},u.forEachCellInSequence=function({x:e,y:t,step:n,filter:i,range:r,includeStart:o},s){l(this,{x:e,y:t,step:n,filter:i,range:r,includeStart:o,includeUndefined:!0},{findFirst:!1,withCoords:!0}).forEach((({cell:e,x:t,y:n})=>{s(e,t,n)}))},u.import=function(e,{cellImporter:t,clear:n=!0}={}){n&&u.clear(),function({width:e,height:t,toricX:n,toricY:i}){void 0!==e&&(u.width=e);void 0!==t&&(u.height=t);void 0!==n&&(u.toricX=n);void 0!==i&&(u.toricY=i)}(e),t=t||u.cellImporter;const{cells:i}=e;for(let e in i){let[n,r]=e.split("_");n=parseInt(n,10),r=parseInt(r,10);let o=i[e];u.importCell?u.importCell(o,n,r):(t&&(o=t(o,n,r)),u.setCell(n,r,o))}},u.serialize=function({cellSerializer:e}={}){const t={};this.forEachDefinedCellWithCoords(((n,i,r)=>{const o=i+"_"+r;e?t[o]=e(n,i,r):"object"==typeof n&&n.serialize?t[o]=n.serialize():t[o]=n}));const{width:n,height:i,toricX:r,toricY:o}=this;return{width:n,height:i,toricX:r,toricY:o,cells:t}},h.content&&u.setCells(h.content)}})),define("toxilibs/interpolate",[],(function(){function e(e,n,i){return t(e,n,i)}function t(e,n,i,r){let o=typeof e;return o!==typeof n&&function({labelName:e,type:t,b:n}){let i="a("+t+") and b("+typeof n+") should have the same type";e&&(i="For "+e+" : "+i);throw new Error(i)}({labelName:r,type:o,b:n}),"number"===o?function(e,t,n){return e+(t-e)*n}(e,n,i):Array.isArray(e)?function(e,n,i){if(e.length!==n.length)throw new Error("arrays should have the same length");return e.map(((e,r)=>t(e,n[r],i,r)))}(e,n,i):"object"===o?function(e,n,i){let r={};for(let o in e)r[o]=t(e[o],n[o],i,o);return r}(e,n,i):e}return e.remap=function(e,{start:t=0,end:n=1,clamp:i=!0,easing:r}={}){let o=(e-t)/(n-t);return(r||i)&&(o=Math.max(Math.min(o,1),0)),"easeIn"===r?o*o:"easeOut"===r?o*(2-o):"easeInOut"===r?o*o*(3-2*o):o},e.closestEndValueWithModulo=function({start:e,end:t,modulo:n}){let i=(t-e)%n;return i=(i+n)%n,i>n/2&&(i-=n),e+i},e})),define("toxilibs/smooth_state",["./interpolate"],(function(e){const{remap:t}=e,n=()=>{};function i(e,{hook:t=n}={}){this.current=e,this.hook=t}function r(e){e.timer&&(clearTimeout(e.timer),delete e.timer)}function o(e){return"function"==typeof e?e():e}return i.prototype.change=function(n,i=0,{easing:s="easeInOut",whenEnded:a}={}){if(r(this),0===i)return this.current=n,void(a&&a());let c=this.current,l=function(e,n){let i=Date.now(),r=i+e;function o(e){return t(e,{start:i,end:r,easing:n})}return o.end=r,o}(i,s),{end:u}=l,h=this;a&&(this.timer=setTimeout(a,i)),this.current=function t(i=Date.now()){let r=o(n);if(i>=u)return h.current===t&&(n.isFreezeState?h.current=r:h.current=n),r;let s=o(c);return h.hook(s,r),e(s,r,l(i))}},i.prototype.freeze=function(e=0){if(r(this),0===e)return void this.change(o(this.current));let t=this;function n(){return t.lastEvaluatedValue}n.isFreezeState=!0,this.change(n,e)},i.prototype.currentValue=function(){return this.lastEvaluatedValue=o(this.current),this.lastEvaluatedValue},i.prototype.isChanging=function(){return"function"==typeof this.current},i})),define("toxilibs/screen_canvas_style",[],(function(){let e=1;const t={};const n={normal:"source-over","new || old":"source-over","old || new":"destination-over","old && new":"source-in","new && old":"destination-in","!old && new":"source-out","!new && old":"destination-out","old && (new || old)":"source-atop","new && (old || new)":"destination-atop","old + new":"lighter","old * new":"multiply","min(old, new)":"darken",min:"darken","max(old, new)":"lighten",max:"lighten","abs(old - new)":"difference","abs(new - old)":"difference","old ^ new":"xor","old XOR new":"xor",new:"copy"};return function(i){const{cx:r}=i;r.id||(r.id=e++,t[r.id]={});const o=t[r.id];i.currentCxStyle=o,self.previousGlobalAlpha=r.globalAlpha,function(e,{currentCxStyle:t,cx:i,screen:r}){e.setDefaultStyles=function(){t.blendMode="source-over",t.filter="none",i.lineJoin="round"},e.resetStyle=function(){for(let e in t)delete t[e];e.setDefaultStyles()},e.setStrokeStyle=function({color:e,strokeColor:n=e}){const r=n||"#000";t.stroke!==r&&(t.stroke=r,i.strokeStyle=r)},e.setFillStyle=function(e){const{linearGradient:t,radialGradient:n,fillColor:i,color:o}=e;t||n?function(e,{linearGradient:t,radialGradient:n,fillColor:i,color:r}){let o,s;t?(o=t,s=function(e,{origin:t,end:n}){return e.cx.createLinearGradient(t.x,t.y,n.x,n.y)}(e,o)):(o=n||{x:0,y:0,radius:10},s=function(e,{innerCircle:t,outerCircle:n,center:i,radius:r}){let o,s,a,c;if(t){o=t,s=t.radius||0,a=n;const{radius:e=r}=n;c=e}else o=i,s=0,a=o,c=r;return e.cx.createRadialGradient(o.x,o.y,s,a.x,a.y,c)}(e,o));(function(e,t){t.length?function(e,t){const n=t.length;for(let i=0;i<n;i++)e.addColorStop(i/(n-1),t[i])}(e,t):function(e,t){for(let n in t)e.addColorStop(n,t[n])}(e,t)})(s,o.colors||function({color:e,fillColor:t=e}){return["#000",t||"#FFF"]}({fillColor:i,color:r})),e.cx.fillStyle=s,e.currentCxStyle.fill=s}(r,e):function(e,{color:t,fillColor:n=t}={}){const i=n||"#000";e.currentCxStyle.fill!==i&&(e.currentCxStyle.fill=i,e.cx.fillStyle=i)}(r,{fillColor:i,color:o})},e.setLineWidth=function({lineWidth:e=2}){t.lineWidth!==e&&(t.lineWidth=e,i.lineWidth=e)},e.setFont=function({font:e="20px serif"}){t.font!==e&&(t.font=e,i.font=e)},e.stroke=function({lineWidth:t,strokeColor:n,color:r}){0!==t&&(e.setStrokeStyle({strokeColor:n,color:r}),e.setLineWidth({lineWidth:t}),i.stroke())},e.fill=function(t={}){e.setFillStyle(t),i.fill()},e.setSpecialStyles=function({opacity:t,blendMode:r,filter:o}){if(1!==t&&(e.previousGlobalAlpha=i.globalAlpha,i.globalAlpha*=t),r){let e=n[r];e&&(r=e),i.globalCompositeOperation=r}o&&(i.filter=o)},e.resetSpecialStyles=function(){i.globalAlpha=e.previousGlobalAlpha,i.globalCompositeOperation=t.blendMode,i.filter=t.filter},e.setOpacity=function(t=1){e.previousGlobalAlpha=t,i.globalAlpha=t},e.setSmoothing=function(e){t.smoothing!==e&&(i.imageSmoothingEnabled=e,i.mozImageSmoothingEnabled=e,i.msImageSmoothingEnabled=e)},e.strokeAndFill=function(t){t&&(t.strokeColor&&e.stroke(t),(t.fillColor||t.linearGradient||t.radialGradient)&&e.fill(t))}}(this,{currentCxStyle:o,cx:r,screen:i}),this.setDefaultStyles()}})),define("toxilibs/topleft_and_pivot",[],(function(){const e=Math.PI/180,t=["topLeft","center","topRight","bottomLeft","bottomRight","left","right","bottom","top","centerLeft","centerRight","bottomCenter","topCenter"];function n(e){return e._positionKey?"none"!==e._positionKey&&e._positionKey:t.find((t=>t in e))}function i(e,t,n){let{_positionKey:i}=e;if(i&&"topLeft"!==i)return function(e,t,n,i){if("none"===e)return null;"function"==typeof n&&(n=n());"function"==typeof i&&(i=i());const{x:r,y:s}=a(t[e]);return o[e]({x:r,y:s,width:-n,height:-i})}(i,e,t,n);if(e.topLeft){const{x:t,y:n}=a(e.topLeft);return{x:t,y:n}}if("function"==typeof t&&(t=t()),"function"==typeof n&&(n=n()),e.center){const{x:i,y:r}=a(e.center);return{x:i-t/2,y:r+n/2}}if(e.topRight){const{x:n,y:i}=a(e.topRight);return{x:n-t,y:i}}if(e.bottomLeft){const{x:t,y:i}=a(e.bottomLeft);return{x:t,y:i+n}}if(e.bottomRight){const{x:i,y:r}=a(e.bottomRight);return{x:i-t,y:r+n}}if(e.centerLeft){const{x:t,y:i}=a(e.centerLeft);return{x:t,y:i+n/2}}if(e.centerRight){const{x:i,y:r}=a(e.centerRight);return{x:i-t,y:r+n/2}}if(e.bottomCenter){const{x:i,y:r}=a(e.bottomCenter);return{x:i-t/2,y:r+n}}if(e.topCenter){const{x:n,y:i}=a(e.topCenter);return{x:n-t/2,y:i}}if(e.left){const{x:t,y:i}=a(e.left);return{x:t,y:i+n/2}}if(e.right){const{x:i,y:r}=a(e.right);return{x:i-t,y:r+n/2}}if(e.bottom){const{x:i,y:r}=a(e.bottom);return{x:i-t/2,y:r+n}}if(e.top){const{x:n,y:i}=a(e.top);return{x:n-t/2,y:i}}return null}function r(e,t,n){let{_positionKey:i}=e;if(i&&"center"!==i)return function(e,t,n,i){if("none"===e)return null;"function"==typeof n&&(n=n());"function"==typeof i&&(i=i());const{x:r,y:s}=a(t[e]),c=o[e]({x:r,y:s,width:-n,height:-i});return{x:c.x+n/2,y:c.y-i/2}}(i,e,t,n);if(e.center){const{x:t,y:n}=a(e.center);return{x:t,y:n}}if("function"==typeof t&&(t=t()),"function"==typeof n&&(n=n()),e.topLeft){const{x:i,y:r}=a(e.topLeft);return{x:i+t/2,y:r-n/2}}if(e.topRight){const{x:i,y:r}=a(e.topRight);return{x:i-t/2,y:r-n/2}}if(e.bottomLeft){const{x:i,y:r}=a(e.bottomLeft);return{x:i+t/2,y:r+n/2}}if(e.bottomRight){const{x:i,y:r}=a(e.bottomRight);return{x:i-t/2,y:r+n/2}}if(e.centerLeft){const{x:n,y:i}=a(e.centerLeft);return{x:n+t/2,y:i}}if(e.centerRight){const{x:n,y:i}=a(e.centerRight);return{x:n-t/2,y:i}}if(e.bottomCenter){const{x:t,y:i}=a(e.bottomCenter);return{x:t,y:i+n/2}}if(e.topCenter){const{x:t,y:i}=a(e.topCenter);return{x:t,y:i-n/2}}if(e.left){const{x:n,y:i}=a(e.left);return{x:n+t/2,y:i}}if(e.right){const{x:n,y:i}=a(e.right);return{x:n-t/2,y:i}}if(e.bottom){const{x:t,y:i}=a(e.bottom);return{x:t,y:i+n/2}}if(e.top){const{x:t,y:i}=a(e.top);return{x:t,y:i-n/2}}return null}const o={topLeft:({x:e,y:t})=>({x:e,y:t}),top:({x:e,y:t,width:n})=>({x:e+n/2,y:t}),topRight:({x:e,y:t,width:n})=>({x:e+n,y:t}),left:({x:e,y:t,height:n})=>({x:e,y:t-n/2}),center:({x:e,y:t,width:n,height:i})=>({x:e+n/2,y:t-i/2}),right:({x:e,y:t,width:n,height:i})=>({x:e+n,y:t-i/2}),bottomLeft:({x:e,y:t,height:n})=>({x:e,y:t-n}),bottom:({x:e,y:t,width:n,height:i})=>({x:e+n/2,y:t-i}),bottomRight:({x:e,y:t,width:n,height:i})=>({x:e+n,y:t-i})};function s(e,t,{whenChanged:n}={}){if(t in e){if(n){let i=a(e[t]);Object.defineProperty(e,t,{get:()=>i,set:e=>{i=a(e),n({positionName:t,value:i})}})}return}function a(i){if(!n)return i;let{x:r,y:o}=i;const s={};return Object.defineProperty(s,"x",{get:()=>r,set:i=>{if(r!==i){r=i;let{_positionKey:a}=e;t===a?n({positionName:t,value:s}):e[t]={x:r,y:o}}}}),Object.defineProperty(s,"y",{get:()=>o,set:i=>{if(o!==i){o=i;let{_positionKey:a}=e;t===a?n({positionName:t,value:s}):e[t]={x:r,y:o}}}}),s}let c;if("topLeft"===t)c=()=>{const{width:t,height:n}=e;return a(i(e,t,n))};else if("center"===t)c=()=>{const{width:t,height:n}=e;return a(r(e,t,n))};else{let n=o[t];c=()=>{const{width:t,height:r}=e,{x:o,y:s}=i(e,t,r);return a(n({x:o,y:s,width:t,height:r}))}}Object.defineProperty(e,t,{get:c,set:i=>{let{_positionKey:r}=e;delete e[t],e[t]=i,r&&(delete e[r],s(e,r),n&&s(e,t,{whenChanged:n})),e._positionKey=t,n&&n({positionName:t,value:e[t]})},configurable:!0})}function a(e){return"function"==typeof e?e():e}return o.centerRight=o.right,o.centerLeft=o.left,o.bottomCenter=o.bottom,o.topCenter=o.top,{getTopLeftPoint:i,getCenterPoint:r,getPivot:function(e,t,n){return e.pivot?e.pivot:!e.topLeft&&(e.topRight?{x:t,y:0}:e.bottomLeft?{x:0,y:-n}:e.bottomRight?{x:t,y:-n}:e.center?{x:t/2,y:-n/2}:e.centerLeft?{x:0,y:-n/2}:e.centerRight?{x:t,y:-n/2}:e.bottomCenter?{x:t/2,y:-n}:e.topCenter?{x:t/2,y:0}:e.centerLeft||e.left?{x:0,y:-n/2}:e.centerRight||e.right?{x:t,y:-n/2}:e.bottomCenter||e.bottom?{x:t/2,y:-n}:!(!e.topCenter&&!e.top)&&{x:t/2,y:0})},topLeftPointWithPivot:function(t,n,i){"function"==typeof t&&(t=t()),"function"==typeof n&&(n=n()),"function"==typeof i&&(i=i());let r=function({x:t,y:n},i){let r=i*e,o=Math.cos(r),s=Math.sin(r);return{x:t*o-n*s,y:t*s+n*o}}(i,n);return{x:t.x+i.x-r.x,y:t.y+i.y-r.y}},containsPositionParam:n,copyPositionParam:function(e,t,{replace:i}={}){const r=n(e);if(r){const{x:n,y:o}=a(e[r]);return r in t&&!i?(t[r].x=n,t[r].y=o):t[r]={x:n,y:o},!0}return!1},getCoordsFor:function(e,t){let{width:n,height:r}=t;"function"==typeof n&&(n=n()),"function"==typeof r&&(r=r());const{x:s,y:a}=i(t,n,r);return o[e]({x:s,y:a,width:n,height:r})},addPositionAccessors:function(e,{whenChanged:i}={}){let r=n(e);r||(r="none"),e._positionKey=r,t.forEach((t=>s(e,t,{whenChanged:i})))}}})),define("toxilibs/bezier",[],(function(){function e({origin:e,end:t,controlOrigin:n,controlEnd:i,interpolationSteps:r=50}){this.stepsCount=r,this.interpolationStep=1/r,this.origin=e,this.end=t,this.controlOrigin=n,this.controlEnd=i}e.pointsWithDefaultControlPoints=function({points:e,smooth:t=1,close:n}){t/=2.8;let i=function(e,t){const n=e.map(o);t&&e.length>0&&n.push(o(e[0]));return n}(e,n),a=i.length;if(a<1)return!1;for(let e=1;e<a-1;e++)r(i[e],i[e-1],i[e+1],t);return n&&(r(i[a-1],i[a-2],i[1],t),s(i[0],"controlNext",i[a-1].controlNext)),i},e.autoParamsFromPoints=function({points:t,smooth:n=0,close:i}){n&&(t=e.pointsWithDefaultControlPoints({points:t,smooth:n,close:i}));let r=[],o=t.length;for(let e=1;e<o;e++){let n=t[e-1],i=t[e];r.push({origin:{x:n.x,y:n.y},controlOrigin:n.controlNext,end:{x:i.x,y:i.y},controlEnd:i.controlPrevious})}return r},e.prototype.length=function(){return"computedLength"in this||i(this),this.computedLength},e.prototype.boundingBox=function(){return"computedBoundingBox"in this||i(this),this.computedBoundingBox},e.prototype.coords=function(e,{withAngle:i=!1}={}){"distanceTable"in this||n(this);let r=t(this,e);return this.parametricCoords(r,{withAngle:i})};function t(e,t){const{computedLength:n,distanceTable:i,tDistributedDistanceTable:r,interpolationStep:o}=e;if(t>=n)return 1;let s=i[Math.floor(t/(o*n))],a=r[s],c=r[s+1];for(;c<t;)s+=1,a=c,c=r[s+1];return(s+(t-a)/(c-a))*o}function n(e){"tDistributedDistanceTable"in e||i(e);const{interpolationStep:t,computedLength:n,tDistributedDistanceTable:r,stepsCount:o}=e,s=n*t,a=[0];let c=s;for(let e=0;e<o;e++){let t=r[e+1];for(;t>=c;)a.push(e),c+=s}e.distanceTable=a}function i(e){let t=0;const n=[];let i,r=1/0,o=-1/0,s=1/0,c=-1/0;const{interpolationStep:l}=e,u=1+l/2;for(let h=0;h<=u;h+=l){const l=e.parametricCoords(h),{x:u,y:d}=l;r=Math.min(r,u),o=Math.max(o,u),s=Math.min(s,d),c=Math.max(c,d),i&&(t+=a(i,l)),n.push(t),i=l}e.computedLength=t,e.computedBoundingBox={xMin:r,yMin:s,xMax:o,yMax:c},e.tDistributedDistanceTable=n}function r(e,t,n,i){if(e.controlPrevious&&e.controlNext)return;const r=e.x-t.x,o=e.y-t.y,a=Math.sqrt(r*r+o*o),c=n.x-e.x,l=n.y-e.y,u=Math.sqrt(c*c+l*l);if(0===a||0===u)s(e,"controlPrevious",e),s(e,"controlNext",e);else{const t=a/u;let n=c*t+r,s=l*t+o;const h=Math.sqrt(n*n+s*s);n/=h,s/=h,e.controlPrevious||(e.controlPrevious={x:e.x-i*n*a,y:e.y-i*s*a}),e.controlNext||(e.controlNext={x:e.x+i*n*u,y:e.y+i*s*u})}}function o({x:e,y:t,controlNext:n,controlPrevious:i}){return{x:e,y:t,controlNext:n,controlPrevious:i}}function s(e,t,n){e[t]=e[t]||n}function a({x:e,y:t},{x:n,y:i}){const r=n-e,o=i-t;return Math.sqrt(r*r+o*o)}return e.prototype.parametricCoords=function(e,{withAngle:t=!1}={}){const n=1-e,i=n*n*n,r=n*n*e*3,o=n*e*e*3,s=e*e*e;let a=i*this.origin.x+r*this.controlOrigin.x+o*this.controlEnd.x+s*this.end.x,c=i*this.origin.y+r*this.controlOrigin.y+o*this.controlEnd.y+s*this.end.y;if(t){let t=this.parametricCoords(e+1e-5);return{x:a,y:c,angle:Math.atan2(t.y-c,t.x-a)}}return{x:a,y:c}},e.prototype.path=function(e=this.stepsCount){const t=1/e,n=1+t/2,i=Math.ceil(n/t),r=new Array(i);for(let e=0;e<i;e+=1)r[e]=this.parametricCoords(e*t);return r},e.prototype.steppedPath=function({distanceStepsCount:e=this.stepsCount}={}){"tDistributedDistanceTable"in this||i(this);const{origin:t,interpolationStep:n,computedLength:r,tDistributedDistanceTable:o,stepsCount:s}=this,a=r/e;let c=a;const l=[{x:t.x,y:t.y}];let u=0;for(let e=0;e<s;e++){let t=o[e+1];for(;t>=c;){const i=(e+(c-u)/(t-u))*n;l.push(this.parametricCoords(i)),c=a*l.length}u=t}return l},e.prototype.derivative=function(e){const t=3*e*e,n=6*e-3-t,i=3*t-12*e+3,r=6*e-3*t;return{x:n*this.origin.x+i*this.controlOrigin.x+r*this.controlEnd.x+t*this.end.x,y:n*this.origin.y+i*this.controlOrigin.y+r*this.controlEnd.y+t*this.end.y}},e.prototype.secondDerivative=function(e){const t=6*e,n=6-t,i=3*t-12,r=6-3*t;return{x:n*this.origin.x+i*this.controlOrigin.x+r*this.controlEnd.x+t*this.end.x,y:n*this.origin.y+i*this.controlOrigin.y+r*this.controlEnd.y+t*this.end.y}},e.prototype.normal=function(e){const{x:t,y:n}=this.derivative(e),i=Math.sqrt(t*t+n*n);return{x:-n/i,y:t/i}},e.prototype.paramAtDistance=function(e){return"distanceTable"in this||n(this),t(this,e)},e})),define("toxilibs/auto_dimensions",[],(function(){return function({width:e,height:t,sourceWidth:n,sourceHeight:i,preventConflict:r}){let o={sourceWidth:n,sourceHeight:i};if(void 0===e&&void 0===t)e=n,t=i;else if(void 0===e)e=function(e,{sourceWidth:t,sourceHeight:n}){return void 0===e?t:t*e/n}(t,o);else if(void 0===t)t=function(e,{sourceWidth:t,sourceHeight:n}){return void 0===e?n:n*e/t}(e,o);else if(r){const r=n/i,o=e/t;if(Math.abs(r-o)>Number.EPSILON)throw new Error("Mismatched dimensions")}return{width:e,height:t}}})),define("toxilibs/screen_image_utils",["./topleft_and_pivot","./auto_dimensions"],(function(e,t){const{getTopLeftPoint:n,containsPositionParam:i,copyPositionParam:r}=e;function o({width:e,height:t},n){if(!n)return{topLeftX:0,topLeftY:0,width:e,height:t,cropped:!1};let{topLeftX:i,topLeftY:r,width:o,height:s}=function(e,t){if(e.topLeft){let{fullWidth:n,fullHeight:i,width:r=Math.max(0,n-e.topLeft.x),height:o=Math.max(0,i-e.topLeft.y)}=t;return{topLeftX:e.topLeft.x,topLeftY:e.topLeft.y,width:r,height:o}}if(e.center){let{fullWidth:n,fullHeight:i,width:r=Math.max(0,2*Math.min(e.center.x,n-e.center.x)),height:o=Math.max(0,2*Math.min(e.center.y,i-e.center.y))}=t;return{topLeftX:e.center.x-r/2,topLeftY:e.center.y-o/2,width:r,height:o}}if(e.topRight){let{fullHeight:n,width:i=Math.max(0,e.topRight.x),height:r=Math.max(0,n-e.topRight.y)}=t;return{topLeftX:e.topRight.x-i,topLeftY:e.topRight.y,width:i,height:r}}if(e.bottomLeft){let{fullWidth:n,width:i=Math.max(0,n-e.bottomLeft.x),height:r=Math.max(0,e.bottomLeft.y)}=t;return{topLeftX:e.bottomLeft.x,topLeftY:e.bottomLeft.y-r,width:i,height:r}}if(e.bottomRight){let{width:n=Math.max(0,e.bottomRight.x),height:i=Math.max(0,e.bottomRight.y)}=t;return{topLeftX:e.bottomRight.x-n,topLeftY:e.bottomRight.y-i,width:n,height:i}}if(e.centerLeft||e.left){let{x:n,y:i}=e.centerLeft||e.left,{fullWidth:r,fullHeight:o,width:s=Math.max(0,r-n),height:a=Math.max(0,2*Math.min(i,o-i))}=t;return{topLeftX:n,topLeftY:i-a/2,width:s,height:a}}if(e.centerRight||e.right){let{x:n,y:i}=e.centerRight||e.right,{fullHeight:r,width:o=Math.max(0,n),height:s=Math.max(0,2*Math.min(i,r-i))}=t;return{topLeftX:n-o,topLeftY:i-s/2,width:o,height:s}}if(e.bottomCenter||e.bottom){let{x:n,y:i}=e.bottomCenter||e.bottom,{fullWidth:r,width:o=Math.max(0,2*Math.min(n,r-n)),height:s=Math.max(0,i)}=t;return{topLeftX:n-o/2,topLeftY:i-s,width:o,height:s}}if(e.topCenter||e.top){let{x:n,y:i}=e.topCenter||e.top,{fullWidth:r,fullHeight:o,width:s=Math.max(0,2*Math.min(n,r-n)),height:a=Math.max(0,o-i)}=t;return{topLeftX:n-s/2,topLeftY:i,width:s,height:a}}{let{fullWidth:e,fullHeight:n,width:i=e,height:r=n}=t;return{topLeftX:0,topLeftY:0,width:i,height:r}}}(n,{width:n.width,height:n.height,fullWidth:e,fullHeight:t});return{topLeftX:i,topLeftY:r,width:o,height:s,cropped:0!==i||0!==r||o!==e||s!==t}}const s={};function a(e,{errorHandler:t}={}){let n=new Image;n.crossOrigin="Anonymous",n.addEventListener("load",(()=>{s[e].forEach((e=>{e(n)})),s[e]=n})),n.addEventListener("error",(()=>{s[e]="error";const n=new Error("Cannot load image "+e);if(n.toxiTrace=["Toxilibs - screen.js - fetchImage"],!t)throw n;t(n)})),n.src=e}return{fetchImage:a,getImageByUrl:function({url:e,errorHandler:t,callback:n}){const i=s[e];i?Array.isArray(i)?i.push(n):"error"!==i&&n(i):(s[e]=[n],a(e,{errorHandler:t}))},getCropParams:o,getUsableImageAndPositionParams:function(e,i,{reverseY:s,forceTopLeft:a}={}){var c;if(e.screen?e=e.screen:(c=e,"[object Object]"===Object.prototype.toString.call(c)&&e.image&&(e=e.image)),!e)throw new Error("An image must be specified");const l=function(e,i,{reverseY:s,forceTopLeft:a}={}){let c=e;e.getCamera&&(c=e.getCamera());let{width:l,height:u,cropSource:h,flip:d,orientation:f}=i;void 0===l&&void 0===u&&(l=c.width,u=c.height),h=e.imageData?o({width:e.widthInPixels,height:e.heightInPixels},h):o(e,h||e.cropSource);const{width:p,height:g}=t({width:l,height:u,sourceWidth:h.width,sourceHeight:h.height}),m={cropSource:h,width:p,height:g,orientation:f,flip:d};if(a){let e=g;s&&(e=-g),m.topLeft=n(i,p,e)||n(c,p,e)}else r(i,m)||r(c,m);return m}(e,i,{reverseY:s,forceTopLeft:a});return{image:e,positionParams:l}},addImageDefaultPositionParams:function(e,t){let n=t;t.getCamera&&(n=t.getCamera()),i(e)||r(n,e),"width"in e||"height"in e||(e.width=n.width,e.height=n.height)}}})),define("toxilibs/discretizer",[],(function(){return function(e,{xMin:t,xMax:n,yMin:i,yMax:r,cellSize:o,xCellsCount:s=e.width,yCellsCount:a=e.height}){let c,l;if(o)c=1/o,l=c,s=Math.ceil((n-t)*c),a=Math.ceil((r-i)*l);else{if(!s)throw new Error("Discretizer needs a cellSize or a xCellsCount param or a width on the object");if(!a)throw new Error("Discretizer needs a cellSize or a yCellsCount param or a height on the object");c=s/(n-t),l=a/(r-i)}return e.discretize=function({x:e,y:o}){return e<t||n<e||o<i||r<o?null:{x:(e-t)*c|0,y:(r-o)*l|0}},e.gridIndexToGridCoords=function(e){let t=Math.floor(e/s);return{x:e-t*s,y:t}},e.gridIndexToCoords=function(e){let n=Math.floor(e/s);return{x:t+(e-n*s)/c,y:r-n/l}},e.gridCoordsToCoords=function({x:e,y:n}){return{x:t+e/c,y:r-n/l}},{xCellsCount:s,yCellsCount:a}}})),define("toxilibs/download",[],(function(){function e({name:e,fileName:t=e,url:n,mimeType:i}){let r=window.document.createElement("a");r.download=t,r.href=n,r.dataset.downloadurl=[i,t,n].join(":");let{body:o}=window.document;o.appendChild(r),r.click(),setTimeout((function(){o.removeChild(r),window.URL.revokeObjectURL(n)}),0)}return{downloadAsFile:function({name:t,fileName:n=t,content:i}){let r,o="text/plain";n.endsWith(".json")&&(o="application/json"),i instanceof Blob?r=i:("object"==typeof i?i=JSON.stringify(i):"string"!=typeof i&&(i=i.toString()),r=new Blob([i],{type:o+";charset=utf-8"})),e({url:URL.createObjectURL(r),fileName:n,mimeType:o})},downloadCanvasAsPNG:function(t,n){const i="image/png";e({fileName:n,mimeType:i,url:t.toDataURL(i)})}}})),define("toxilibs/screen_image_import_export",["./topleft_and_pivot","./auto_dimensions","./screen_image_utils","./download"],(function(e,t,n,i){const{downloadCanvasAsPNG:r,downloadAsFile:o}=i,{containsPositionParam:s,copyPositionParam:a}=e,{getCropParams:c}=n;let l,u;const h={};function d(e,t,n){"string"==typeof t?function(e,t,n){if(t.endsWith(".mp4"))return void function(e,t,n){const i=document.createElement("video");let r;i.crossOrigin="Anonymous",i.src=t,e.queueForAfterLoad=[],i.addEventListener("canplay",(()=>{i.muted=!0,i.width=i.videoWidth,i.height=i.videoHeight,i.play()})),i.addEventListener("timeupdate",(function(){r||(r=!0,m(e,i,n))}),!1)}(e,t,n);const i=new Image;i.crossOrigin="Anonymous",i.src=t,p(e,i,n)}(e,t,n):t instanceof l?f(e,t,n):t instanceof HTMLImageElement?p(e,t,n):t instanceof HTMLVideoElement?function(e,t,n){t.readyState>=1?m(e,t,n):t.addEventListener("canplay",(()=>m(e,t,n)))}(e,t,n):t instanceof HTMLCanvasElement?function(e,t,n){let{cropSource:i,whenLoaded:r=(()=>{})}=n;const o=_(t,n),{cropped:s,rescaled:a}=o;e.syncFromSource=function(){(s||a)&&(t=b(t,o),i={}),v(e,t,i),u(e,n)},e.syncFromSource(),r(e)}(e,t,n):t instanceof ImageData?g(e,t,n):t.toImageData&&function(e,t,n){const{whenLoaded:i=(()=>{})}=n;(function(e){const{cropSource:t}=e;t&&(s(e)||a(t,e),w(e,t))})(n=Object.assign({},n)),function(e,t){if("getCamera"in t){const n=t.getCamera();s(e)||(e.center=n.center),w(e,n)}}(n,t),delete n.cropSource,delete n.whenLoaded,e.syncFromSource=function(){const i=t.toImageData(n.cropSource);g(e,i,n)},e.syncFromSource(),i(e)}(e,t,n)}function f(e,t,n){const{whenLoaded:i=(()=>{})}=n,{queueForAfterLoad:r}=t;r?(e.queueForAfterLoad=[],r.push((()=>f(e,t,n)))):(function(e,t){s(e)||a(t,e);w(e,t)}(n=Object.assign({},n),t),delete n.whenLoaded,e.syncFromSource=function(){const{imageData:i}=t;g(e,i,n)},e.syncFromSource(),y(e),i(e))}function p(e,t,n){t.complete?m(e,t,n):(e.queueForAfterLoad=[],t.addEventListener("load",(()=>m(e,t,n))))}function g(e,t,n){const{whenLoaded:i=(()=>{})}=n;let r=_(t,n);const{cropped:o,rescaled:s}=r;function a(){if(o||s){const{cropSource:n,widthInPixels:i,heightInPixels:o}=r;let s=x(t,n);r=_(s,{widthInPixels:i,heightInPixels:o}),r.rescaled&&(s=b(s,r)),v(e,s)}else e.imageData=t}a(),e.syncFromSource||(e.syncFromSource=a),u(e,n),i(e)}function m(e,t,n){const{whenLoaded:i=(()=>{})}=n;e.syncFromSource=function(){t.originalBlob&&(e.originalBlob=t.originalBlob);const i=b(t,_(t,n));v(e,i),u(e,n)},e.syncFromSource(),y(e),i(e)}function y(e){const{queueForAfterLoad:t=[]}=e;delete e.queueForAfterLoad,t.forEach((t=>t(e)))}function x(e,t={}){const{width:n=e.width,height:i=e.height,topLeftX:r=0,topLeftY:o=0}=t,s=document.createElement("canvas");s.width=n,s.height=i;return s.getContext("2d").putImageData(e,-r,-o),s}function b(e,{cropSource:t,widthInPixels:n,heightInPixels:i}){const{width:r,height:o,topLeftX:s,topLeftY:a}=t,c=document.createElement("canvas");c.width=n,c.height=i;const l=c.getContext("2d");return function(e){e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1}(l),l.drawImage(e,s,a,r,o,0,0,n,i),c}function v(e,t,n={}){const i=t.getContext("2d"),{topLeft:r={},width:o=t.width,height:s=t.height}=n,{x:a=0,y:c=0}=r,l=i.getImageData(a,c,o,s);e.imageData=l,e.imageDataData=l.data}function w(e,{width:t,height:n}){void 0===e.width&&void 0===e.height&&(void 0!==t&&(e.width=t),void 0!==n&&(e.height=n))}function _(e,n){const i=c(e,n.cropSource);let{widthInPixels:r,heightInPixels:o}=n,s=t({width:r,height:o,sourceWidth:i.width,sourceHeight:i.height});r=Math.round(s.width),o=Math.round(s.height);const a=r!==e.width||o!==e.height,{cropped:l}=i;return{cropSource:i,widthInPixels:r,heightInPixels:o,rescaled:a,cropped:l}}return h.toCanvas=function(e={}){let t=x(this.imageData);const n=_(t,e),{cropped:i,rescaled:r}=n;return(i||r)&&(t=b(t,n)),t},h.toScreenCanvas=function(e={}){const{ScreenCanvas:t}=l;if(!t)throw new Error("You should add the ScreenCanvas lib to your project to be able to export with toScreenCanvas()");return new t(this.toCanvas(e))},h.toScreen=function(e={}){const{Screen:t}=l;if(!t)throw new Error("You should add the Screen lib to your project to be able to export with toScreen()");const n=this.toCanvas(e),i=new t(n),{center:r,width:o}=this.getPosition();return i.setCamera({center:r,scale:n.width/o}),i},h.toBlob=function(e={}){const{type:t="image/png",quality:n}=e,i=this.toCanvas(e);return new Promise((e=>{i.toBlob(e,t,n)}))},h.toPNGImage=function(e={}){const t=this.toCanvas(e),n=new Image;return e.whenLoaded&&n.addEventListener("load",(()=>e.whenLoaded(n))),n.src=t.toDataURL("image/png"),n},h.downloadAsPNG=function(e={}){const{name:t="screen_image.png",fileName:n=t}=e;let i=()=>{!this.touched&&this.originalBlob?o({name:n,content:this.originalBlob}):r(this.toCanvas(e),n)};this.queueForAfterLoad?this.queueForAfterLoad.push(i):i()},h.getCompanionScreen=function(){return this.companionScreen||(this.companionScreen=this.toScreen()),this.companionScreen},function(e,t){l=e,u=t;for(let e in h)l.prototype[e]=h[e];return{importFromSource:d}}})),define("toxilibs/screen_image",["./topleft_and_pivot","./discretizer","./auto_dimensions","./color","./screen_image_import_export"],(function(e,t,n,i,r){const{getTopLeftPoint:o,copyPositionParam:s,addPositionAccessors:a}=e,{autoConvertToRGB255:c,convertTo255:l}=i;function u(e){"onLoad"in e&&(e.whenLoaded=e.onLoad,console.warn("Deprecation for screen images - onLoad has been replaced with whenLoaded"));const{source:t,whenLoaded:n=(()=>{})}=e;t?h(this,t,e):(d(this,e),n(this)),this.syncFromSource||(this.syncFromSource=()=>{})}const{importFromSource:h}=r(u,d);function d(e,t){let{widthInPixels:n,heightInPixels:r,useOpacity:o}=t;const{imageData:s}=e;s&&(n=s.width,r=s.height,e.widthInPixels=n,e.heightInPixels=r),function(e,t,{widthInPixels:n,heightInPixels:i}){f(e,t,{widthInPixels:n,heightInPixels:i});const{pixelSize:r}=t,{xCellsCount:o,yCellsCount:s}=p(e,{widthInPixels:n,heightInPixels:i,pixelSize:r});e.widthInPixels=o,e.heightInPixels=s,e.pixelsCount=o*s,function(e){let{width:t,height:n}=e;Object.defineProperty(e,"width",{get:()=>t,set:n=>{t!==n&&(t=n,p(e))},configurable:!0}),Object.defineProperty(e,"height",{get:()=>n,set:t=>{n!==t&&(n=t,p(e))},configurable:!0})}(e)}(e,t,{widthInPixels:n,heightInPixels:r}),t.bare||(s||function(e){const{widthInPixels:t,heightInPixels:n}=e;e.imageData=new ImageData(t,n),e.imageDataData=e.imageData.data,e.makeOpaque()}(e),function(e){let{widthInPixels:t,imageDataData:n}=e;e.getFastColorAtIndex=function(e){return{red:n[e*=4]/255,green:n[e+1]/255,blue:n[e+2]/255,opacity:n[e+3]/255}},e.getFastColorAtPixelCoords=function(n){e.getFastColorAtIndex(n.x+n.y*t)},e.getFastColorAt=function(n){const i=this.discretize(n);i&&e.getFastColorAtIndex(i.x+i.y*t)},e.getColorAtIndex=function(e){return new i(n[e*=4]/255,n[e+1]/255,n[e+2]/255,n[e+3]/255)},e.getColorAtPixelCoords=function(n){e.getColorAtIndex(n.x+n.y*t)},e.getColorAt=function(n){const i=this.discretize(n);i&&e.getColorAtIndex(i.x+i.y*t)}}(e),function(e,{useOpacity:t}){let{widthInPixels:n,imageDataData:i}=e,r=!0;e.setColorAtIndex=t?function(t,n){r&&(e.touched=!0,r=!1),t*=4;const o=c(n),{opacity:s=1}=n;i[t]=o.red,i[t+1]=o.green,i[t+2]=o.blue,i[t+3]=l(s)}:function(t,n){r&&(e.touched=!0,r=!1),t*=4;const o=c(n);i[t]=o.red,i[t+1]=o.green,i[t+2]=o.blue};const{setColorAtIndex:o}=e;e.setLight255AtIndex=function(t,n){r&&(e.touched=!0,r=!1),i[t*=4]=n,i[t+1]=n,i[t+2]=n},e.setColorAtPixelCoords=function(e,t){o(e.x+e.y*n,t)},e.setColorAt=function(t,i){const r=e.discretize(t);r&&o(r.x+r.y*n,i)}}(e,{useOpacity:o}),a(e,{whenChanged:()=>p(e)}))}function f(e,t,{widthInPixels:i,heightInPixels:r}){const{width:o=e.width,height:a=e.height,orientation:c}=t;if(c)throw new Error("orientation not yet implemented for ScreenImage");const l=n({width:o,height:a,sourceWidth:i,sourceHeight:r});e.width=l.width,e.height=l.height,s(t,e,{replace:!0})}function p(e,{pixelSize:n,widthInPixels:i=e.widthInPixels,heightInPixels:r=e.heightInPixels}={}){const o=e.getPosition();if(!o)return{xCellsCount:i,yCellsCount:r};const{width:s,height:a,topLeft:c}=o,{x:l,y:u}=c;return t(e,{xMin:l,xMax:l+s,yMin:u-a,yMax:u,xCellsCount:i,yCellsCount:r,cellSize:n})}return u.prototype.setColorForEachPixel=function(e){const{pixelsCount:t,gridIndexToCoords:n,setColorAtIndex:i}=this;for(let r=0;r<t;r++){const{x:t,y:o}=n(r);i(r,e(t,o))}},u.prototype.setColorForEachPixelUsingPixelCoords=function(e){const{pixelsCount:t,gridIndexToGridCoords:n,setColorAtIndex:i}=this;for(let r=0;r<t;r++){const{x:t,y:o}=n(r);i(r,e(t,o))}},u.prototype.setColorForEachPixelUsingIndex=function(e){const{pixelsCount:t,setColorAtIndex:n}=this;for(let i=0;i<t;i++)n(i,e(i))},u.prototype.applyFilter=function(e){const{pixelsCount:t,getColorAtIndex:n,setColorAtIndex:i}=this;for(let r=0;r<t;r++)i(r,e(n(r)))},u.prototype.makeOpaque=function(){const{pixelsCount:e,imageDataData:t}=this,n=4*e;for(let e=0;e<n;e+=4)t[e+3]=255},u.prototype.fillWithColor=function(...e){this.touched=!0;const{red:t,green:n,blue:i}=c(...e),{pixelsCount:r,imageDataData:o}=this,s=4*r;for(let e=0;e<s;e+=4)o[e]=t,o[e+1]=n,o[e+2]=i},u.prototype.fillWithCheckers=function(){this.touched=!0;const{pixelsCount:e,imageDataData:t,gridIndexToGridCoords:n}=this;for(let i=0;i<e;i++){const e=4*i,{x:r,y:o}=n(i);let s=0;r%2+o%2==1&&(s=255),t[e]=s,t[e+1]=s,t[e+2]=s}},u.prototype.getPosition=function(){const{width:e,height:t}=this,n=o(this,e,t);return n?{topLeft:n,center:{x:n.x+e/2,y:n.y-t/2},width:e,height:t,orientation:0}:null},u.prototype.updatePosition=function(e){console.warn("ScreenImage.updatePosition is deprecated... Now you can just do screenImage.center = {x, y} or screenImage.width = 56"),f(this,e,this)},u})),define("toxilibs/screen_canvas",["./screen_canvas_style","./topleft_and_pivot","./bezier","./auto_dimensions","./screen_image_utils","./screen_image","./color","./download"],(function(e,t,n,i,r,o,s,a){const{downloadCanvasAsPNG:c}=a,{getCropParams:l,getUsableImageAndPositionParams:u,getImageByUrl:h}=r,d=Math.PI/180;let f,p;function g(t){f||(f=document.createElement("canvas"),p=f.getContext("2d")),this.canvas=t,this.cx=t.getContext("2d"),this.canvasStyle=new e(this)}o.ScreenCanvas=g,g.prototype.updatedDimensions=function(){this.canvasStyle.resetStyle();let{width:e,height:t}=this.canvas;return{width:e,height:t}},g.prototype.clear=function(e={}){let{x:t=0,y:n=0,width:i=this.canvas.width,height:r=this.canvas.height,fillColor:o,color:s}=e;t=Math.floor(t),n=Math.floor(n),i=Math.ceil(i),r=Math.ceil(r),o||s?function(e,{x:t,y:n,width:i,height:r},o){let{cx:s,canvasStyle:a}=e;a.setSpecialStyles(o),a.setFillStyle(o),"opacity"in o&&s.clearRect(t,n,i,r);e.cx.fillRect(t,n,i,r),a.resetSpecialStyles()}(this,{x:t,y:n,width:i,height:r},e):this.cx.clearRect(t,n,i,r)},g.prototype.resetStyle=function(){this.canvasStyle.resetStyle()},g.prototype.setOpacity=function(e){this.canvasStyle.setOpacity(e)},g.prototype.getOpacity=function(){return this.cx.globalAlpha},g.prototype.isInside=function({x:e,y:t}){return e>=0&&t>=0&&e<this.canvas.width&&t<this.canvas.height};function m(e,t={}){let{canvas:n}=e,{topLeftX:i,topLeftY:r,width:o,height:s,cropped:a}=l(n,t);return a?(f.width=o,f.height=s,p.drawImage(n,-i,-r),f):n}g.prototype.getPixelColor=function(e){if(!this.isInside(e))return!1;let t=this.cx.getImageData(0|e.x,0|e.y,1,1).data;return new s({red255:t[0],green255:t[1],blue255:t[2],opacity:t[3]/255})},g.prototype.toImageData=function(e={}){const{topLeftX:t,topLeftY:n,width:i,height:r}=l(this.canvas,e);return this.cx.getImageData(t,n,i,r)},g.prototype.toBlob=function(e={}){const t=m(this,e),{type:n="image/png",quality:i}=e;return new Promise((e=>{t.toBlob(e,n,i)}))},g.prototype.toPNGImage=function(e={}){const t=m(this,e),n=new Image;return n.src=t.toDataURL("image/png"),n},g.prototype.downloadAsPNG=function(e={}){const t=m(this,e),{name:n="screen.png",fileName:i=n}=e;c(t,i)},g.prototype.drawRectangle=function(e){let{width:n,height:i}=e,{cx:r,canvasStyle:o}=this,s=t.getTopLeftPoint(e,n,-i);o.setSpecialStyles(e),(e.fillColor||e.linearGradient||e.radialGradient)&&(o.setFillStyle(e),r.fillRect(s.x,s.y,n,i)),e.strokeColor&&(o.setLineWidth(e),o.setStrokeStyle(e),r.strokeRect(s.x,s.y,n,i)),o.resetSpecialStyles()},g.prototype.drawPolygon=function(e){e.close=!0,this.drawCurve(e)},g.prototype.drawLine=function(e){let{origin:t,end:n,vector:i}=e;if(!t)throw new Error('"origin" param is missing');let{cx:r,canvasStyle:o}=this;if(!n){if(!i)throw new Error('"end" or "vector" param is missing');n={x:t.x+i.x,y:t.y+i.y}}o.setSpecialStyles(e),r.beginPath(),r.moveTo(t.x,t.y),r.lineTo(n.x,n.y),r.closePath(),o.stroke(e),o.resetSpecialStyles()},g.prototype.drawArc=function(e){let{cx:t,canvasStyle:n}=this;n.setSpecialStyles(e),t.beginPath(),v(t,e),t.closePath(),n.strokeAndFill(e),n.resetSpecialStyles()},g.prototype.drawPie=function(e){let{center:t,radius:n,innerRadius:i,startAngle:r,endAngle:o}=e,{cx:s,canvasStyle:a}=this;if(!t)throw new Error('"center" param is missing');if(a.setSpecialStyles(e),s.beginPath(),!i&&(r||o&&360!==o)&&s.moveTo(t.x,t.y),v(s,{center:t,radius:n,startAngle:r,endAngle:o}),i){let e={center:t,radius:i,startAngle:o,endAngle:r,antiClockWise:!0};e.startAngle||e.endAngle||(e.endAngle=-360,s.moveTo(t.x+this.cosAngle*i,t.y-this.sinAngle*i)),v(s,e)}s.closePath(),a.strokeAndFill(e),a.resetSpecialStyles()},g.prototype.drawCircle=g.prototype.drawPie,g.prototype.drawCurve=function(e){let{points:t,smooth:i=0,close:r}=e;if(!t)throw new Error('"points" param is missing');if(!Array.isArray(t))throw new Error('"points" must be an array');t.length<2||(t.length<3&&(r=!1),_(this,e,n.autoParamsFromPoints({points:t,smooth:i,close:r}),r))},g.prototype.drawLines=g.prototype.drawCurve,g.prototype.drawBezier=function(e){_(this,e,[e])},g.prototype.drawBezierPath=function(e){_(this,e,e.beziers)},g.prototype.drawText=function(e){let{text:t,orientation:n,flip:i}=e,{canvasStyle:r}=this;r.setFont(e),r.setSpecialStyles(e);let o=function({topLeft:e,topRight:t,bottomLeft:n,bottomRight:i,center:r,bottom:o,bottomCenter:s=o,top:a,topCenter:c=a,right:l,centerRight:u=l,left:h,centerLeft:d=h}){if(e)return{origin:e,textAlign:"left",textBaseline:"top"};if(t)return{origin:t,textAlign:"right",textBaseline:"top"};if(n)return{origin:n,textAlign:"left",textBaseline:"alphabetic"};if(i)return{origin:i,textAlign:"right",textBaseline:"alphabetic"};if(r)return{origin:r,textAlign:"center",textBaseline:"middle"};if(s)return{origin:s,textAlign:"center",textBaseline:"alphabetic"};if(c)return{origin:c,textAlign:"center",textBaseline:"top"};if(u)return{origin:u,textAlign:"right",textBaseline:"middle"};if(d)return{origin:d,textAlign:"left",textBaseline:"middle"};return!1}(e);if(o.text=t,o.userParams=e,!o.origin)throw new Error('a position param is missing. Include one, for example "center", "topLeft"...');if(function(e,t){"horizontal"===e?"right"===t.textAlign?t.textAlign="left":"left"===t.textAlign&&(t.textAlign="right"):"vertical"===e&&("top"===t.textBaseline?t.textBaseline="alphabetic":"alphabetic"===t.textBaseline&&(t.textBaseline="top"))}(i,o),n||i){let e=this;S(this,{origin:o.origin,orientation:n,flip:i,execute:function(){o.origin={x:0,y:0},w(e,o)}})}else w(this,o);r.resetSpecialStyles()},g.prototype.drawImage=function(e){let{image:t,url:n}=e;if(n&&console.warn("'url' param in drawImage has been replaced with 'image'"),n||"string"==typeof t){const{errorHandler:i}=this;h({url:n||t,errorHandler:i,callback:t=>x(this,e,t)})}else x(this,e)},g.prototype.drawImageData=function(e){let{imageData:n,smoothing:r=!0,opacity:o=1}=e,{cx:s,canvasStyle:a}=this,{width:c,height:l,sourceWidth:u,sourceHeight:h,pixelSize:d}=function(e,{width:t,height:n,pixelSize:r=!1}){let{width:o,height:s}=e;if(r)t=o*r,n=s*r;else{r=1;let e=i({width:t,height:n,sourceWidth:o,sourceHeight:s});t=e.width,n=e.height}return{width:t,height:n,sourceWidth:o,sourceHeight:s,pixelSize:r}}(n,e),f=t.getTopLeftPoint(e,c,-l)||{x:0,y:0};c===u&&l===h&&1===o?s.putImageData(n,f.x,f.y):(a.setSpecialStyles(e),this.canvasStyle.setSmoothing(r),b(this,{pixelSize:d,width:u,height:h}),this.ghostUnscaledCx.putImageData(n,0,0),s.drawImage(this.ghostUnscaledCanvas,f.x,f.y,c,l)),a.resetSpecialStyles()};const y={forceTopLeft:!0,reverseY:!0};function x(e,n,i){let r=i||n.image;const{image:o,positionParams:s}=u(r,n,y),{scale:a,modifier:c,modifierPixelBox:l,smoothing:h=!0}=n;let{cx:d,canvasStyle:g}=e;if(g.setSmoothing(h),c&&(d=p),g.setSpecialStyles(n),s.orientation)!function(e,{image:n,positionParams:i,params:r}){let{cx:o}=e,{topLeft:s,width:a,height:c,orientation:l,flip:u,cropSource:h}=i;if(!s)throw new Error("Cannot display the image : position is missing");let d=t.getPivot(r,a,-c);d&&(s=t.topLeftPointWithPivot(s,-l,d));function f(){const t=n.imageData||n.toImageData&&n.toImageData();t?(b(e,{pixelSize:1,width:h.width,height:h.height}),e.ghostUnscaledCx.putImageData(t,-h.topLeftX,-h.topLeftY),o.drawImage(e.ghostUnscaledCanvas,0,0,a,c)):o.drawImage(n,h.topLeftX,h.topLeftY,h.width,h.height,0,0,a,c)}S(e,{origin:s,orientation:l,execute:f,flip:u,width:a,height:c})}(e,{image:o,params:n,positionParams:s});else{if(a)throw new Error("Do you really need a scale param ? Talk to Pierre L");!function(e,{image:t,positionParams:n}){let{cx:i}=e,{topLeft:r,width:o,height:s,cropSource:a,flip:c}=n;if(!r)throw new Error("Cannot display the image : position is missing");let l=Math.floor(r.x),u=Math.floor(r.y);const h=t.imageData||t.toImageData&&t.toImageData();"horizontal"===c?(i.save(),i.translate(o+2*l,0),i.scale(-1,1)):"vertical"===c&&(i.save(),i.translate(0,s+2*u),i.scale(1,-1));h?(b(e,{pixelSize:1,width:a.width,height:a.height}),e.ghostUnscaledCx.putImageData(h,-a.topLeftX,-a.topLeftY),i.drawImage(e.ghostUnscaledCanvas,l,u,o,s)):i.drawImage(t,a.topLeftX,a.topLeftY,a.width,a.height,l,u,Math.ceil(o),Math.ceil(s));"horizontal"!==c&&"vertical"!==c||i.restore()}(e,{image:o,positionParams:s})}g.resetSpecialStyles(),c&&(c(f),function(e,t){let n=new Image;n.crossOrigin="Anonymous",n.src=e.toDataURL(),n.complete?t(n):n.addEventListener("load",(function(){t(n)}),!1)}(f,(function(e){d.drawImage(e,l.x,l.y)})))}function b(e,{width:t,height:n}){e.ghostUnscaledCanvas||(e.ghostUnscaledCanvas=document.createElement("canvas"),e.ghostUnscaledCx=e.ghostUnscaledCanvas.getContext("2d")),e.ghostUnscaledCanvas.width=t,e.ghostUnscaledCanvas.height=n}function v(e,{center:t,radius:n,startAngle:i=0,endAngle:r=360,antiClockWise:o}){[i,r]=[-r,-i],n<0&&(n=0),e.arc(t.x,t.y,n,i*d,r*d,o)}function w(e,{text:t,textAlign:n,textBaseline:i,origin:r,userParams:o}){const{cx:s}=e;s.textAlign=n,s.textBaseline=i;let a={text:t,origin:r,userParams:o};!function(e,{text:t,origin:n,userParams:i}){if(i.fillColor||i.color||!i.strokeColor){let{cx:r,canvasStyle:o}=e;o.setFillStyle(i),r.fillText(t,n.x,n.y)}}(e,a),function(e,{text:t,origin:n,userParams:i}){if(i.strokeColor){let{cx:r,canvasStyle:o}=e;o.setStrokeStyle(i),r.strokeText(t,n.x,n.y)}}(e,a)}function _(e,t,n,i=t.close){let{cx:r,canvasStyle:o}=e;o.setSpecialStyles(t);let{origin:s}=n[0];r.beginPath(),r.moveTo(s.x,s.y),n.forEach((e=>{e.controlOrigin||e.controlEnd?function(e,{origin:t,end:n,controlOrigin:i=t,controlEnd:r=n}){e.bezierCurveTo(i.x,i.y,r.x,r.y,n.x,n.y)}(r,e):r.lineTo(e.end.x,e.end.y)})),i&&r.closePath(),o.strokeAndFill(t),o.resetSpecialStyles()}function S(e,{origin:t,orientation:n=0,execute:i,flip:r,width:o=0,height:s=0}){const{cx:a,canvasStyle:c}=e,{x:l,y:u}=t;a.save(),a.translate(l,u),n&&a.rotate(-n*d),"horizontal"===r?(a.translate(o,0),a.scale(-1,1)):"vertical"===r&&(a.translate(0,s),a.scale(1,-1)),i(),a.restore(),c.resetStyle()}return g})),define("toxilibs/local_2D",[],(function(){const e={o:{x:0,y:0},i:{x:1,y:0},localLengthToGlobal:1},t=Math.PI/180,n=1/t;function i(e){this.initialize2D(e)}function r({relativeTo:t=e,x:n,y:r,orientation:o,scale:s=1,link:a}={}){"function"==typeof t&&(t=t()),"localLengthToGlobal"in t||(t=new i(t)),this.referenceFrame=t,this.xAsChild="function"==typeof n?n():n||0,this.yAsChild="function"==typeof r?r():r||0,this.orientationAsChild="function"==typeof o?o():o||0,this.scaleAsChild="function"==typeof s?s():s,C(this),a&&t&&("children"in t?t.children.push(this):t.children=[this])}function o({x:e=null,y:t=null,orientation:n=null,scale:i=null}={}){if(null!==e&&(this.xAsChild=e),null!==t&&(this.yAsChild=t),null!==n&&(this.orientationAsChild=n),null!==i&&(this.scaleAsChild=i),C(this),delete this._cachedFrameGlobalOrientation,delete this._inverseSquarelocalLengthToGlobal,this.children)for(let e of this.children)e.updateReference()}function s(){let{i:e}=this;return{x:-e.y,y:e.x}}function a(e,t){return t*e.localLengthToGlobal/this.localLengthToGlobal}function c(e){return this.localLengthToGlobal*e}function l(e){return e/this.localLengthToGlobal}function u(e,t){return k(e)+t-k(this)}function h(e=0){return k(this)+e}function d(e=0){return e-k(this)}function f(e,t,n){let{i:i}=e,r=i.x*t-i.y*n,o=i.y*t+i.x*n;return this.localVector(r,o)}function p(e,t){this._inverseSquareLocalLengthToGlobal||(this._inverseSquareLocalLengthToGlobal=1/(this.localLengthToGlobal*this.localLengthToGlobal));let{i:n}=this;return{x:(n.x*e+n.y*t)*this._inverseSquareLocalLengthToGlobal,y:(n.x*t-n.y*e)*this._inverseSquareLocalLengthToGlobal}}function g(e,t,n){let{i:i,o:r}=e,o=r.x+i.x*t-i.y*n,s=r.y+i.y*t+i.x*n;return this.localVector(o-this.o.x,s-this.o.y)}function m(e,t){return this.localVector(e-this.o.x,t-this.o.y)}function y(...e){let t=e.shift();return e.map((e=>this.pointFromFrame(t,e[0],e[1])))}function x(...e){return e.map((e=>this.globalPoint(e[0],e[1])))}function b(...e){return e.map((e=>this.localPoint(e[0],e[1])))}function v(e){if("localLengthToGlobal"in e){const{x:t,y:n}=e.o;return new i({x:t,y:n,orientation:k(e),scale:e.localLengthToGlobal,relativeTo:this})}{const{x:t,y:n,orientation:r,scale:o}=e;return new i({x:t,y:n,orientation:r,scale:o,relativeTo:this})}}function w(e){Object.assign(e,{initialize2D:r,updateReference:o,j:s,lengthFromFrame:a,globalLength:c,localLength:l,orientationFromFrame:u,globalOrientation:h,localOrientation:d,vectorFromFrame:f,globalVector:function(e,t){return _(this,e,t)},localVector:p,pointFromFrame:g,globalPoint:function(e,t){return S(this,e,t)},localPoint:m,pointsFromFrame:y,globalPoints:x,localPoints:b,globalBase:v})}function _(e,t,n){let{i:i}=e;return{x:i.x*t-i.y*n,y:i.y*t+i.x*n}}function S(e,t,n){let{o:i,i:r}=e;return{x:i.x+r.x*t-r.y*n,y:i.y+r.y*t+r.x*n}}function C(e){let{referenceFrame:n,orientationAsChild:i,scaleAsChild:r}=e,o=t*i;if(e.o=S(n,e.xAsChild,e.yAsChild),e.i=_(n,r*Math.cos(o),r*Math.sin(o)),"localLengthToGlobal"in n)e.localLengthToGlobal=n.localLengthToGlobal*r;else{let{x:t,y:n}=e.i;e.localLengthToGlobal=Math.sqrt(t*t+n*n)}}function k(e){if(!("_cachedFrameGlobalOrientation"in e)){let{i:t}=e;e._cachedFrameGlobalOrientation=Math.atan2(t.y,t.x)*n}return e._cachedFrameGlobalOrientation}return w(i.prototype),{ReferenceFrame:i,addLocal2DCapabilities:w,referenceFrameFromGroupParams:function(e){const{x:t,y:n,orientation:r,scale:o}=e;if(t||n||r||o)return new i(e);let{relativeTo:s}=e;return"function"==typeof s&&(s=s()),s&&!("localLengthToGlobal"in s)?new i(s):s},globalPointFromReferenceFrame:function(e,n,i){if("globalPoint"in e)return e.globalPoint(n,i);let{scale:r=1,orientation:o=0,x:s=0,y:a=0}=e;if(0===o)return{x:s+r*n,y:a+r*i};{const e=o*t;let c=Math.cos(e),l=Math.sin(e);return{x:s+r*(n*c-i*l),y:a+r*(n*l+i*c)}}},localPointInReferenceFrame:function e(n,i,r){if("localPoint"in n)return n.localPoint(i,r);let{scale:o=1,orientation:s=0,x:a=0,y:c=0,relativeTo:l}=n;if(l&&({x:i,y:r}=e(l,i,r)),0===s)return{x:(i-a)/o,y:(r-c)/o};{const e=s*t;let n=Math.cos(e),l=Math.sin(e),u=(i-a)/o,h=(r-c)/o;return{x:u*n+h*l,y:-u*l+h*n}}}}})),define("toxilibs/stroke",[],(function(){function e({leftPath:e,rightPath:t,point:n,delta:i,angle:r}){let o=i*Math.cos(r),s=i*Math.sin(r),{x:a,y:c}=n;e.push({x:a+o,y:c+s}),t.push({x:a-o,y:c-s})}function t({x:e,y:t},n,i){let r;if(n&&(r=Math.atan2(t-n.y,e-n.x)),!i)return r-Math.PI/2;let o=Math.atan2(t-i.y,e-i.x);if(!n)return o+Math.PI/2;let s=(r+o)/2;return s<o&&(s+=Math.PI),s}return function({points:n,width:i=.1,widthEnvelope:r=!1,pointyEnds:o=!1}){this.width=i,this.widthEnvelope=r,this.envelope=function({points:n,width:i,widthEnvelope:r,pointyEnds:o}){let s=n[0],a=n[n.length-1],c=i/2,l=[s],u=[s],h=o?1:0,d=n.length-h;for(let i=h;i<d;i++){let o=n[i],s=t(o,n[i-1],n[i+1]),a=c;if(r){a*=r({ratio:i/n.length,point:o})}e({leftPath:l,rightPath:u,point:o,delta:a,angle:s})}return o?[...l,a,...u.reverse()]:[...l,...u.reverse()]}({points:n,width:i,widthEnvelope:r,pointyEnds:o})}})),define("toxilibs/screen_shapes",["./topleft_and_pivot","./local_2D","./stroke","./screen_image_utils"],(function(e,t,n,i){const{referenceFrameFromGroupParams:r,localPointInReferenceFrame:o}=t,{addImageDefaultPositionParams:s}=i,a=Math.PI/180;const c={};let l=["drawPolygon","drawLines","drawLine","drawArc","drawPie","drawCircle","drawBezier","drawBezierPath","drawCurve","drawText"];c.drawRectangle=function(e){const t=function(e,t){let{topLeftPoint:n,width:i,height:r,orientation:o}=e.normalizedParamsForRectangle(t);const{x:s,y:a}=n;if(o){const{x:t,y:n}=L({x:i,y:0},o),{x:c,y:l}=L({x:0,y:-e.yDir*r},o);return[{x:s,y:a},{x:s+t,y:a+n},{x:s+t+c,y:a+n+l},{x:s+c,y:a+l}]}{const t=a-e.yDir*r;return[{x:s,y:a},{x:s+i,y:a},{x:s+i,y:t},{x:s,y:t}]}}(this,e);let{relativeTo:n,roundedCorners:i,lineWidth:r,opacity:o,blendMode:s,filter:a,fillColor:c,strokeColor:l,linearGradient:u,radialGradient:h}=e;R(this,e={points:t,relativeTo:n,roundedCorners:i,lineWidth:r,opacity:o,blendMode:s,filter:a,fillColor:c,strokeColor:l,linearGradient:u,radialGradient:h}),e.roundedCorners?function(e){const{points:t,roundedCorners:n}=e,i=[];t.forEach((function(e,r){let o=t[(r+1)%t.length],s=_(e,o,n),a=_(o,e,n);s.controlPrevious=S(s,e,v),s.controlNext=S(s,e,w),a.controlPrevious=S(a,o,w),a.controlNext=S(a,o,v),i.push(s,a)})),i.push(i[0]),e.points=i}(e):e.close=!0,this.drawAdapter.drawCurve(e)},c.drawStroke=function(e){let{relativeTo:t,opacity:i,blendMode:r,filter:o,strokeColor:s,color:a=s}=e,c=F(e.stroke);if(!c){const t=F(e.points),i=F(e.width),r=F(e.pointyEnds),{widthEnvelope:o}=e;c=new n({points:t,width:i,widthEnvelope:o,pointyEnds:r})}R(this,e={relativeTo:t,points:c.envelope,fillColor:a,opacity:i,blendMode:r,filter:o}),this.drawAdapter.drawCurve(e)};const u=.1,h=30,d=.02;c.drawArrow=function(e){let{branchLength:t=u,branchAngle:n=h,relativeTo:i}=e;"function"==typeof n&&(n=n()),"function"==typeof t&&(t=t()),n+=180;const r=F(e.origin);if(!r)throw new Error('"origin" param is missing');let o=F(e.vector);if(!o){const t=F(e.end);if(!t)throw new Error('"end" or "vector" param is missing');o={x:t.x-r.x,y:t.y-r.y}}let{lineWidth:s=d*N(o.x,o.y)}=e;"function"==typeof s&&(s=s());const a=F(e.opacity),c=F(e.blendMode),l=F(e.filter),f=F(e.strokeColor);let p={x:o.x*t,y:o.y*t},g=L(p,n),m=L(p,-n),y={origin:r,vector:o,lineWidth:s,strokeColor:f,opacity:a,blendMode:c,filter:l,relativeTo:i};this.drawLine(y),y.origin={x:r.x+o.x,y:r.y+o.y},y.vector=g,this.drawLine(y),y.vector=m,this.drawLine(y)};const f=.01;c.drawAxes=function(e){const{xMin:t,yMin:n,width:i,height:r}=this.boundingBoxForWholeView();let{lineWidth:o=Math.min(i,r)*f}=e;"function"==typeof o&&(o=o());const s=F(e.color)||"#06F",a=F(e.opacity),c=F(e.blendMode),l=F(e.filter);this.drawLine({origin:{x:t,y:0},vector:{x:i,y:0},strokeColor:s,opacity:a,blendMode:c,filter:l,lineWidth:o}),this.drawLine({origin:{x:0,y:n},vector:{x:0,y:r},strokeColor:s,opacity:a,blendMode:c,filter:l,lineWidth:o})},c.drawGrid=function(e={}){const t=F(e.orientation),n=F(e.center)||{x:0,y:0};let i,r=this;function s(){return i||(i=function(e,{center:t,orientation:n=0}){let i=e.pixToCoords({x:0,y:0}),r=o({x:t.x,y:t.y,orientation:n},i.x,i.y);return e.boundingBox({topLeft:r,width:e.width/e.scale,height:e.height/e.scale,orientation:-n-e.orientation})}(r,{center:n,orientation:t})),i}const a=F(e.step)||function({width:e,height:t}){let n=Math.min(e,t)/6;return Math.max(y(n,1),y(n,2),y(n,5))}(s());if(a*this.scale<1)return;const c=F(e.color),l=F(e.opacityLimit),u=F(e.noAxes);let h,d=F(e.localXMin),f=F(e.localXMax);void 0!==d&&void 0!==f?h=f-d:(h=F(e.width),void 0===h?(h=s().width,void 0===d&&(d=s().xMin)):void 0===d&&(d=-h/2));let p,g=F(e.localYMin),m=F(e.localYMax);void 0!==g&&void 0!==m?p=m-g:(p=F(e.height),void 0===p?(p=s().height,void 0===g&&(g=s().yMin)):void 0===g&&(g=-p/2)),function(e,{height:t,width:n,localXMin:i,localYMin:r,step:o,color:s,center:a,orientation:c=0,opacityLimit:l,noAxes:u}){let h=L({x:1,y:0},c),d=L({x:0,y:1},c),f=Math.ceil(i/o),p=Math.floor((i+n)/o);x(e,{noAxes:u,startIndex:f,endIndex:p,center:{x:a.x+d.x*r,y:a.y+d.y*r},lineVector:{x:d.x*t,y:d.y*t},stepVector:{x:h.x*o,y:h.y*o},color:s,opacityLimit:l}),f=Math.ceil(r/o),p=Math.floor((r+t)/o),x(e,{noAxes:u,startIndex:f,endIndex:p,center:{x:a.x+h.x*i,y:a.y+h.y*i},lineVector:{x:h.x*n,y:h.y*n},stepVector:{x:d.x*o,y:d.y*o},color:s,opacityLimit:l})}(this,{width:h,height:p,localXMin:d,localYMin:g,step:a,center:n,color:c,opacityLimit:l,noAxes:u,orientation:t})};c.drawPointsGrid=function(e){const t=F(e.step)||1,n=F(e.color)||"#EEE",i=F(e.boundingBox)||this.boundingBoxForWholeView();if(t*this.scale<8)return;const{xMin:r,yMin:o,width:s,height:a}=i,c=Math.floor(r/t),l=Math.floor(o/t),u=c+s/t+1,h=l+a/t+1;for(let e=l;e<h;e++)for(let i=c;i<u;i++){let r=t*(i%2==0||e%2==0?.06:.1);this.drawCircle({center:{x:i*t,y:e*t},radius:r,fillColor:n})}};function p(e,t){t=j(t);const{image:n}=t;n&&s(t,n),R(e,t),e.drawAdapter.drawImage(t)}c.drawDebugReference=function(e={}){const t=F(e.o)||{x:0,y:0},n=F(e.i)||{x:1,y:0},i=F(e.j)||{x:0,y:1},r=F(e.color)||"#B20000",o=F(e.scale)||1;this.drawCircle({center:t,radius:.05*o,fillColor:r}),this.drawArrow({origin:t,vector:{x:n.x*o,y:n.y*o},strokeColor:r}),this.drawArrow({origin:t,vector:{x:i.x*o,y:i.y*o},strokeColor:r})},c.drawDebugGrid=function({color:e,step:t}={}){this.drawGrid({color:e,step:t,opacityLimit:{max:.5,min:.1}})},c.drawVectorFrame=function({scale:e,color:t="#F00"}={}){this.drawDebugReference({color:t,scale:e})},c.drawCameraBox=function(e,t={}){"function"==typeof e&&(e=e());const{center:n,orientation:i,scale:r}=e,{strokeColor:o="#FA0",fillColor:s=!1}=t;let a=this.width/r,c=this.height/r;this.drawRectangle({center:n,width:a,height:c,orientation:i,strokeColor:o,fillColor:s,lineWidth:10/r})},c.drawImage=function(e){let t=e;e.image||(t={image:e});let{queueForAfterLoad:n}=t.image||{};n?n.push((()=>p(this,t))):p(this,t)};let g=0;function m(e,t){let n,i=e.relativeTo;return n=i?t.globalBase(i):t,Object.assign({},e,{relativeTo:n})}function y(e,t){return Math.pow(10,Math.floor(Math.log10(e/t)))*t}c.drawGroup=function(e){let{maxDepth:t=this.groupMaxDepth}=e;if("function"==typeof t&&(t=t()),g>=Math.min(t,this.groupMaxDepth))return;const{group:n}=e;let i,{opacity:o=1}=e;o=F(o),1!==o&&(i=this.drawAdapter.getOpacity(),this.drawAdapter.setOpacity(i*o));let s,{elements:a,rasterization:c}=F(n),l=r(e);if(c)return l&&(c=m(c,l)),void this.drawImage(c);g+=1;let u,h=this;u=l?function([e,t],n){s=n,h[e](m(t,l))}:function([e,t],n){s=n,h[e](t)};const{cx:d}=this.drawAdapter;let f=d.globalCompositeOperation;try{a.forEach(u)}catch(e){a.length=s,e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Toxilibs - screen_group.js - render");const{errorHandler:t}=this;if(!t)throw g-=1,e;t(e)}1!==o&&this.drawAdapter.setOpacity(i),d.globalCompositeOperation!==f&&(d.globalCompositeOperation=f),g-=1};function x(e,{noAxes:t,startIndex:n,endIndex:i,center:r,lineVector:o,stepVector:s,color:a="#888",opacityLimit:c={max:1,min:.4}}){let l=.02*N(s.x,s.y);"number"==typeof c&&(c={max:c,min:c});for(let u=n;u<=i;u+=1){let n={x:r.x+s.x*u,y:r.y+s.y*u},i=t||0!==u?c.min:c.max;e.drawLine({origin:n,vector:o,strokeColor:a,opacity:i,lineWidth:l})}}function b(t){let{width:n,height:i,orientation:r=0}=t;if(void 0===n)throw new Error('"width" param is missing');if(void 0===i)throw new Error('"height" param is missing');"function"==typeof n&&(n=n()),"function"==typeof i&&(i=i()),"function"==typeof r&&(r=r());let o=function(t,n,i,r){return e.getTopLeftPoint(n,i,t.yDir*r)}(this,t,n,i);if(!o)throw new Error('a position param is missing. Include one, for example "center", "topLeft"...');if(r){const s=t.pivot||e.getPivot(t,n,i);s&&(o=e.topLeftPointWithPivot(o,r,s))}return{topLeftPoint:o,width:n,height:i,orientation:r}}const v=.5,w=-.25;function _(e,t,n){let i=N(t.x-e.x,t.y-e.y);return S(e,t,0===i?0:n/i)}function S(e,t,n){return{x:e.x*(1-n)+t.x*n,y:e.y*(1-n)+t.y*n}}function C(e,t,n){if(n){if("globalLength"in n)return e.scale*n.globalLength(t);{let{scale:i=1}=n;return e.scale*t*i}}return e.scale*t}function k(e,t,n){return n?"globalLength"in n?e.orientation+n.globalOrientation(t):e.orientation+(n.orientation||0)+t:e.orientation+t}function M(e,t,n){return(t=j(t)).relativeTo=n,R(e,t),t}const E=/((\d+\.\d+)|(\d+\.?)|(\.\d+))u\b/g;let T={relativeTo:"referenceFrame",origin:"coords",end:"coords",controlOrigin:"coords",controlEnd:"coords",topLeft:"coords",topRight:"coords",bottomLeft:"coords",bottomRight:"coords",center:"coords",topCenter:"coords",bottomCenter:"coords",centerRight:"coords",centerLeft:"coords",top:"coords",bottom:"coords",right:"coords",left:"coords",innerCircle:"coordsAndRadius",outerCircle:"coordsAndRadius",radius:"length",innerRadius:"length",lineWidth:"length",vector:"vector",pivot:"vector",orientation:"angle",angle:"angle",startAngle:"angle",endAngle:"angle",points:"points",beziers:"beziers",linearGradient:"linearGradient",radialGradient:"radialGradient",font:"textWithUSyntax",step:"length",offset:"length",width:"length",height:"length",roundedCorners:"length",x:"length",y:"length",stroke:"stroke",widthEnvelope:"function",smoothing:"boolean",close:"boolean",pointyEnds:"boolean",branchLength:"factor",smooth:"factor",opacity:"factor",scale:"factor",blendMode:"text",filter:"textWithUSyntax",flip:"text",color:"color",fillColor:"color",strokeColor:"color",image:"image",imageData:"imageData",group:"group",text:"text",url:"text",name:"text",fileName:"text",type:"string",cropSource:"cropParams",quality:"number",layer:"number",maxDepth:"number"},P={coords:function(e,t,n){return e.coordsToPix(t,n)},coordsAndRadius:function(e,t,n){let i=e.coordsToPix(t,n);return i.radius=C(e,t.radius,n),i},length:C,vector:function(e,t,n){let i=e.coordsToPix({x:0,y:0},n),r=e.coordsToPix(t,n);return{x:r.x-i.x,y:r.y-i.y}},angle:k,orientation:k,points:function(e,t,n){return t.map((function({x:t,y:i,controlPrevious:r,controlNext:o}){let s=e.coordsToPix({x:t,y:i},n);return r&&(s.controlPrevious=e.coordsToPix(r,n)),o&&(s.controlNext=e.coordsToPix(o,n)),s}))},beziers:function(e,t,n){return t.map((function({origin:t,end:i,controlOrigin:r,controlEnd:o}){return{origin:e.coordsToPix(t,n),end:e.coordsToPix(i,n),controlOrigin:e.coordsToPix(r,n),controlEnd:e.coordsToPix(o,n)}}))},linearGradient:M,radialGradient:M,textWithUSyntax:function(e,t,n){return t.replace(E,(function(t,i){return Math.round(C(e,parseFloat(i,10),n))+"px"}))}},A={};for(let e in T)A[e]=P[T[e]];function O(e,t){T[e]=t,A[e]=P[t]}function D(e,t){let n={};return R(e,t,n),n}function R(e,t,n){let i=!1;n||(n=t,i=!0);const r=F(t.relativeTo);for(let o in t){if(!(o in T))continue;let s=t[o];if(void 0===s)continue;let a=A[o];"function"==typeof s&&(s="relativeTo"===o?r:s(),i&&!a&&(n[o]=s)),a?n[o]=a(e,s,r):i||(n[o]=s)}"orientation"in t||!e.orientation&&!r||(n.orientation=k(e,0,r)),"alpha"in n&&(n.opacity=n.alpha,console.warn("Screen - alpha param is deprecated. Replace with opacity"))}function L({x:e,y:t},n){let i=n*a,r=Math.cos(i),o=Math.sin(i);return{x:e*r-t*o,y:e*o+t*r}}function N(e,t){return Math.sqrt(e*e+t*t)}function F(e){return"function"==typeof e?e():e}function j(e){let t={};for(let n in e)t[n]=e[n];return t}return function(e){e.drawingMethods=l.concat(Object.keys(c)),e.paramsTypes=T,e.addParamType=O,e.cloneAndConvert=D,function(e){l.forEach((function(t){var n;e.prototype[t]=(n=t,function(e){e=D(this,e),this.drawAdapter[n](e)})}))}(e);for(let t in c)e.prototype[t]=c[t];e.prototype.normalizedParamsForRectangle=b}})),define("toxilibs/deprecation",[],(function(){function e({messagePrefix:e,object:t,deprecated:n,updated:i,handler:r,onlyWhenCalled:o}){let s;function a(){if(!s){!1!==r({messagePrefix:e,deprecated:n,updated:i})&&(s=!0)}}o&&"function"==typeof t[i]?t[n]=function(...e){return a(),t[i](...e)}:n in t?(a(),t[i]=t[n]):Object.defineProperty(t,n,{enumerable:!0,configurable:!0,set:function(e){a(),t[i]=e},get:function(){return a(),t[i]}})}function t({messagePrefix:e,deprecated:t,updated:n}){console.warn(e+' : you are using deprecated property "'+t+'". Use "'+n+'" instead.')}return{add:function(n,i,r,{handler:o=t,onlyWhenCalled:s}={}){for(let t in r){e({messagePrefix:n,object:i,deprecated:t,updated:r[t],handler:o,onlyWhenCalled:s})}}}})),define("toxilibs/screen",["./event_capabilities_queued","./screen_canvas","./screen_shapes","./local_2D","./screen_image","./deprecation"],(function(e,t,n,i,r,o){const{globalPointFromReferenceFrame:s}=i;function a(n,{crispCanvas:i,errorHandler:r,adapter:o=t}={}){Object.getPrototypeOf(n).jquery&&(n=n[0]),this.canvas=n,this.crispCanvas=i,this.drawAdapter=new o(n),r&&(this.errorHandler=r,this.drawAdapter.errorHandler=r),this.groupMaxDepth=20,this.updateCanvasSize(),this.yDir=1,this.setScale(1),this.setCenter({x:0,y:0}),this.setOrientation(0),this.internalEventBus={},e(this.internalEventBus)}r.Screen=a,n(a),a.prototype.updateCanvasSize=function(){let{width:e,height:t}=this.drawAdapter.updatedDimensions();this.width=e,this.height=t,this.centerPix={x:e/2,y:t/2}},a.prototype.clear=function(e){e=Object.assign({},e);let{x:t,y:n,width:i,height:r}=function(e,t={}){let{topLeft:n,pixelZone:i}=t;if(n){let{xMin:n,yMax:i,width:r,height:o}=e.pixBoundingBox(t);return{x:n,y:i,width:r,height:o}}return i||{x:0,y:0,width:e.width,height:e.height}}(this,e);e.x=t,e.y=n,e.width=i,e.height=r,this.drawAdapter.clear(e)},a.prototype.isInside=function(e,t){return this.drawAdapter.isInside(this.coordsToPix(e,t))},a.prototype.isOutside=function(e,t){return!this.isInside(e,t)},a.prototype.getPixelColor=function(e,t){return this.drawAdapter.getPixelColor(this.coordsToPix(e,t))},a.prototype.toImageData=function(e={}){return e=a.cloneAndConvert(this,e),this.drawAdapter.toImageData(e)},a.prototype.toBlob=function(e={}){return e=a.cloneAndConvert(this,e),this.drawAdapter.toBlob(e)},a.prototype.toPNGImage=function(e={}){return e=a.cloneAndConvert(this,e),this.drawAdapter.toPNGImage(e)},a.prototype.downloadAsPNG=function(e={}){e=a.cloneAndConvert(this,e),this.drawAdapter.downloadAsPNG(e)},a.prototype.toScreenImage=function(e={}){return(e=Object.assign({},e)).source=this,e.cropSource=e,new r(e)};const c=Math.PI/180;function l(e,t){return t?s(t,e.x,e.y):e}function u(e){return e}function h({topLeft:e,width:t,height:n,orientation:i,yInversion:r}){let{x:o,y:s}=e,a=r?-1:1;if(!i){let e=s-a*n;return{x:o,y:s,topLeft:{x:o,y:s},center:{x:o+t/2,y:e+n/2},width:t,height:n,xMin:o,yMax:s,xMax:o+t,yMin:e}}let l=i*c,u=Math.cos(l),h=Math.sin(l),d=o+u*t,f=d+h*n,p=o+h*n,g=Math.min(o,d,f,p),m=Math.max(o,d,f,p),y=s+a*h*t,x=y-a*u*n,b=s-a*u*n,v=Math.min(s,y,x,b),w=Math.max(s,y,x,b),_=r?v:w;return{x:g,y:_,topLeft:{x:g,y:_},center:{x:g+(t=m-g)/2,y:v+(n=w-v)/2},width:t,height:n,xMin:g,yMin:v,xMax:m,yMax:w}}return a.prototype.coordsToPix=function({x:e,y:t},n){n&&({x:e,y:t}=s(n,e,t));let i=e-this.center.x,r=t-this.center.y;return{x:this.centerPix.x+this.scale*(i*this.cosOrientation-r*this.sinOrientation),y:this.centerPix.y-this.scaleY*(i*this.sinOrientation+r*this.cosOrientation)}},a.prototype.pixToCoords=function({x:e,y:t}){let n=(e-this.centerPix.x)/this.scale,i=(t-this.centerPix.y)/this.scaleY;return{x:this.center.x+(n*this.cosOrientation-i*this.sinOrientation),y:this.center.y-(n*this.sinOrientation+i*this.cosOrientation)}},a.prototype.coordsToDomPix=function({x:e,y:t},n){const{x:i,y:r}=this.coordsToPix({x:e,y:t},n),{canvas:o,width:s,height:a}=this,c=o.clientWidth/s,l=o.clientHeight/a,{left:u,top:h}=o.getBoundingClientRect();return{x:u+i*c,y:h+r*l}},a.prototype.domPixToCoords=function({x:e,y:t}){const{canvas:n,width:i,height:r}=this,o=i/n.clientWidth,s=r/n.clientHeight,{left:a,top:c}=n.getBoundingClientRect();return this.pixToCoords({x:(e+.5-a)*o,y:(t+.5-c)*s})},a.prototype.mouseEventToCoords=function(e){const{clientX:t,clientY:n}=e;return this.domPixToCoords({x:t,y:n})},a.prototype.mouseEventToSmartTrimmedCoords=function(e){const{clientX:t,clientY:n}=e;return this.smartTrimCoords(this.domPixToCoords({x:t,y:n}))},a.prototype.smartTrimCoords=function({x:e,y:t}){const{smartTrimRatio:n}=this;return{x:Math.round(e*n)/n,y:Math.round(t*n)/n}},o.add("Screen",a.prototype,{mouseEvent2Coords:"mouseEventToCoords",domPix2coords:"domPixToCoords",coords2domPix:"coordsToDomPix",pix2coords:"pixToCords",coords2pix:"coordsToPix"}),a.prototype.boxToPixBox=function(e){let{topLeftPoint:t,width:n,height:i,orientation:r}=this.normalizedParamsForRectangle(e);if(r)throw new Error("orientation not supported");const{x:o,y:s}=this.coordsToPix(t);return n*=this.scale,i*=this.scaleY,{x:o,y:s,width:n,height:i}},a.prototype.boxToDomStyle=function(e){let{x:t,y:n,width:i,height:r}=this.boxToPixBox(e);return{position:"absolute",top:n+"px",left:t+"px",width:i+"px",height:r+"px"}},a.prototype.getCamera=function(){let{center:e,scale:t,orientation:n,width:i,height:r}=this,{x:o,y:s}=e;return{center:{x:o,y:s},scale:t,width:i/t,height:r/t,orientation:0===n?0:-n}},a.prototype.setCamera=function({center:e,scale:t,orientation:n=!1}){t&&this.setScale(t),e&&this.setCenter(e),!1!==n&&this.setOrientation(-n)},a.prototype.setScale=function(e){this.crispCanvas&&(e*=2),this.scale=e,this.scaleY=e*this.yDir,this.smartTrimRatio=Math.pow(10,Math.ceil(Math.log10(e)))},a.prototype.invertY=function(e){this.yDir=e?-1:1,this.setScale(this.scale),this.sinOrientation=Math.sin(this.orientation*c)*this.yDir},a.prototype.multiplyScale=function(e){this.setScale(this.scale*e)},a.prototype.setCenter=function({x:e=this.center.x,y:t=this.center.y}){this.center={x:e,y:t}},a.prototype.translateCenter=function({x:e=0,y:t=0}){this.center.x+=e,this.center.y+=t},a.prototype.setOrientation=function(e){if(e===this.orientation)return;this.orientation=e;let t=e*c;this.cosOrientation=Math.cos(t),this.sinOrientation=Math.sin(t)*this.yDir},a.prototype.rotate=function(e){this.setOrientation(this.orientation+e)},a.prototype.usePixelCoordinates=function(){this.setCenter({x:0,y:0}),this.setOrientation(0),this.invertY(!0),this.coordsToPix=l,this.pixToCoords=u},a.prototype.optimalViewParamsFor=function(e,{radius:t=0,minScale:n,maxScale:i,margin:r=0,marginRatio:o,snap:s}={}){let a={xMin:1/0,xMax:-1/0,yMin:1/0,yMax:-1/0};e.forEach((({x:e,y:n,radius:i=t})=>{let r=this.coordsToPix({x:e,y:n});r.radius=i*this.scale,function(e,{x:t,y:n,radius:i}){e.xMin=Math.min(t-i,e.xMin),e.xMax=Math.max(t+i,e.xMax),e.yMin=Math.min(n-i,e.yMin),e.yMax=Math.max(n+i,e.yMax)}(a,r)})),r&&(r*=this.scale,a.xMin-=r,a.xMax+=r,a.yMin-=r,a.yMax+=r);let c={x:(a.xMin+a.xMax)/2,y:(a.yMin+a.yMax)/2},l=function(e,{xMin:t,xMax:n,yMin:i,yMax:r},{minScale:o,maxScale:s,marginRatio:a=1}){let c=(n-t)/e.width,l=(r-i)/e.height,u=Math.max(c,l)*a;if(u>0){let t=e.scale/u;return void 0!==o&&(t=Math.max(o,t)),void 0!==s&&(t=Math.min(s,t)),t}return e.scale}(this,a,{minScale:n,maxScale:i,marginRatio:o});return s&&(l=Math.round(l)),{center:this.pixToCoords(c),scale:l}},a.prototype.setOptimalView=function(e,t={}){let{center:n,scale:i}=this.optimalViewParamsFor(e,t);if(this.setCamera({center:n,scale:i}),t.snap){let{x:e,y:t}=this.coordsToPix({x:0,y:0});n.x-=e%1/i,n.y-=t%1/i,this.setCenter(n)}return{center:n,scale:i}},a.prototype.boundingBox=h,a.prototype.pixBoundingBox=function({topLeft:e,width:t,height:n,orientation:i,relativeTo:r}){if(e=this.coordsToPix(e,r),r)if("globalOrientation"in r)i=r.globalOrientation(i),t=r.globalLength(t),n=r.globalLength(n);else{let{orientation:e=0,scale:o=1}=r;i+=e,t*=o,n*=o}return i+=this.orientation,h({width:t*=this.scale,height:n*=Math.abs(this.scaleY),topLeft:e,orientation:i,yInversion:!0})},a.prototype.boundingBoxForPixelZone=function({topLeft:e,width:t,height:n}){return h({topLeft:e=this.pixToCoords(e),width:t/=this.scale,height:n/=Math.abs(this.scaleY),orientation:-this.orientation,yInversion:-1===this.yDir})},a.prototype.boundingBoxForWholeView=function(){let{width:e,height:t}=this;return this.boundingBoxForPixelZone({topLeft:{x:0,y:0},width:e,height:t})},a})),define("toxilibs/2D_tools",[],(function(){const e=180/Math.PI;return{distanceAndDirection:function({x:t,y:n},{x:i,y:r}){const o=i-t,s=r-n;return{distance:Math.sqrt(o*o+s*s),direction:Math.atan2(s,o)*e}},squaredDistance:function({x:e,y:t},{x:n,y:i}){const r=n-e,o=i-t;return r*r+o*o},distance:function({x:e,y:t},{x:n,y:i}){const r=n-e,o=i-t;return Math.sqrt(r*r+o*o)},length:function({x:e,y:t}){return Math.sqrt(e*e+t*t)},fastLength:(e,t)=>Math.sqrt(e*e+t*t)}})),define("toxilibs/collision_detector",["./2D_tools","./local_2D","./topleft_and_pivot"],(function(e,t,n){const{getCenterPoint:i,getTopLeftPoint:r}=n,{localPointInReferenceFrame:o}=t,{distance:s,squaredDistance:a,fastLength:c}=e;function l(e,t){for(let n of t)if(d(e,n))return!0;return!1}function u(e,t,n){let i=n,r=!0;for(let n of t)if("subShapes"in n)r=!1;else{const t=y(e,n);t<i&&(i=t)}return r?i:function(e,t,n){for(let i of t){let{subShapes:t}=i;if(t){y(e,i)<n&&(n=Math.min(n,u(e,i.subShapes,n)))}}return n}(e,t,i)}function h(e,t){for(let n=t.length-1;n>=0;n--){const i=f(e,t[n]);if(i)return i}return!1}function d(e,t){const n=function(e,t){const n=p[t.type];if(n)return n(e,t);throw new Error('Shape type "'+t.type+'" not supported')}(e,t),{subShapes:i}=t;return i&&n?l(e,i):n}function f(e,[t,n]){const i=m[t],r=i&&i(e,n);return!!r&&(!0===r?[n]:(r.push(n),r))}const p={circle:S,rectangle:b,polygon:w,segment:()=>!1},g={circle:_,rectangle:x,polygon:v,segment:function({x:e,y:t},{origin:n,end:i,relativeTo:r}){r&&({x:e,y:t}=o(r,e,t));let s=i.x-n.x,a=i.y-n.y,c=e-n.x,l=t-n.y;return Math.sqrt(k(c,l,s,a))}},m={drawCircle:S,drawImage:b,drawIcon:function(e,t){let{x:n,y:i}=C(e,t);return Math.max(Math.abs(n),Math.abs(i))<=t.size/2},drawRectangle:b,drawPolygon:w,drawGroup:function(e,t){const{group:n}=t;return h(e=o(t,e.x,e.y),n.collisionShapes||n.elements)}};function y(e,t){const n=g[t.type];if(n)return n(e,t);throw new Error('Shape type "'+t.type+'" not supported')}function x(e,t){let{x:n,y:i}=C(e,t);return n=Math.abs(n)-t.width/2,i=Math.abs(i)-t.height/2,n>0&&i>0?c(n,i):Math.max(n,i)}function b(e,t){let{x:n,y:i}=C(e,t);return Math.abs(n)<=t.width/2&&Math.abs(i)<=t.height/2}function v({x:e,y:t},{points:n,relativeTo:i}){i&&({x:e,y:t}=o(i,e,t));let r=1/0,s=1,a=n[n.length-1];for(let i=0;i<n.length;i++){let o=n[i];const c=a.x-o.x,l=a.y-o.y,u=e-o.x,h=t-o.y,d=k(u,h,c,l);d<r&&(r=d);const f=h>=0,p=h<l,g=c*h>l*u;(f&&p&&g||!f&&!p&&!g)&&(s*=-1),a=o}return s*Math.sqrt(r)}function w({x:e,y:t},{points:n,relativeTo:i}){i&&({x:e,y:t}=o(i,e,t));let r=!1,s=n[n.length-1];for(let i=0;i<n.length;i++){let o=n[i];const a=s.x-o.x,c=s.y-o.y,l=e-o.x,u=t-o.y,h=u>=0,d=u<c,f=a*u>c*l;(h&&d&&f||!h&&!d&&!f)&&(r=!r),s=o}return r}function _(e,{center:t,radius:n,relativeTo:i}){return i&&(e=o(i,e.x,e.y)),s(t,e)-n}function S(e,{center:t,radius:n,relativeTo:i}){return i&&(e=o(i,e.x,e.y)),a(t,e)<=n*n}function C(e,t){let{center:n,orientation:r,relativeTo:s}=t,{x:a,y:c}=("function"==typeof(l=n)?l():l)||i(t,t.width,t.height);var l;return o({x:a,y:c,orientation:r,relativeTo:s},e.x,e.y)}function k(e,t,n,i){let r=function(e){if(e>1)return 1;if(e<0)return 0;return e}((e*n+t*i)/(n*n+i*i)),o=e-n*r,s=t-i*r;return o*o+s*s}return{distance:u,isInside:l,isInsideForScreenGroup:h,isInsideRectangle:b,distanceToRectangle:x,isInsidePolygon:w,distanceToPolygon:v,isInsideCircle:S,distanceToCircle:_,isInsideShape:d,distanceToShape:function(e,t,{resolveIfUnder:n=!1,maxDistance:i=1/0}={}){const{subShapes:r}=t;if(r&&!1===n)return u(e,r,i);const o=y(e,t);return r&&o<=n?u(e,r,i):o},rectangleIntersectsWithRectangle:function(e,t){if("relativeTo"in e||"relativeTo"in t)throw new Error("relativeTo not supported yet");if(e.orientation||t.orientation)throw new Error("orientation not supported yet");let{width:n,height:i}=e,{width:o,height:s}=t,{x:a,y:c}=r(e,n,i),{x:l,y:u}=r(t,o,s);return a+n>l&&l+o>a&&c-i<u&&u-s<c},detect:function({origin:e,orientation:t,shapes:n}){let{x:i,y:r}=e,o=Math.cos(t),s=Math.sin(t),a=0,c=1/0;for(;a<1e3;){let e=u({x:i+a*o,y:r+a*s},n,c);if(a+=e,e<.001)break;c=2*e}return{x:i+a*o,y:r+a*s}}}})),define("toxilibs/screen_group",["./screen","./local_2D","./topleft_and_pivot","./screen_image_utils","./collision_detector"],(function(e,t,n,i,r){const{getCenterPoint:o,containsPositionParam:s,copyPositionParam:a}=n,{referenceFrameFromGroupParams:c,ReferenceFrame:l}=t,{getUsableImageAndPositionParams:u,getImageByUrl:h}=i;let d;function f({dynamic:t,failFast:n,watch:i,errorHandler:r}={}){this.parentsToWarn=[],this.elements=[],this.dynamic=t,i||(this.collisionShapes=[]),this.lastChange=1,n&&(this.failFast=!0,function(t,n){let i=document.createElement("canvas");t.testScreen=new e(i,{errorHandler:n})}(this,r))}f.prototype.render=function(){throw new Error("screenGroup.render has been removed removed, use screen.drawGroup() instead")},f.prototype.reset=function(){this.elements.length=0,this.collisionShapes&&(this.collisionShapes.length=0)};const p=500;f.prototype.toScreen=function(t){const{backgroundColor:n,width:i,height:r,orientation:s=0,canvas:a=document.createElement("canvas")}=t;let c;i&&r&&(c=o(t,i,r)),c||(c={x:0,y:0});const{widthInPixels:l,heightInPixels:u,scale:h}=function({widthInPixels:e,heightInPixels:t,width:n,height:i,scale:r}){if(!e&&!t&&!r&&(i||n))throw new Error('Can not use "width" or "height" params without specifying one of : "widthInPixels", "heightInPixels" or "scale"');let o;o=e&&t?e/t:n&&i?n/i:1;i?n=i*o:n&&(i=n/o);t?e=Math.round(t*o):e&&(t=Math.round(e/o));e&&n?r=e/n:t&&i?r=t/i:r||(r=1);t||(e=p,t=p);return{widthInPixels:e,heightInPixels:t,scale:r}}(t);a.width=l,a.height=u;const d=new e(a);return d.setCamera({center:c,scale:h,orientation:s}),n&&d.clear({color:n}),d.drawGroup({group:this}),d},f.prototype.toScreenCanvas=function(e){return this.toScreen(e).drawAdapter},f.prototype.toScreenImage=function(e){return this.toScreen(e).toScreenImage()},f.prototype.toCanvas=function(e){return this.toScreen(e).canvas},f.prototype.toPNGImage=function(e){return this.toScreen(e).toPNGImage()},f.prototype.downloadAsPNG=function(e={}){const{name:t="group",fileName:n=t}=e;this.toScreen(e).downloadAsPNG({fileName:n})},f.prototype.rasterize=function(e){return d||(d=document.createElement("canvas")),e=Object.assign({},e,{canvas:d}),this.rasterization=this.toScreenImage(e),this.rasterization},f.prototype.toJSON=function(){return JSON.stringify(this.elements)},f.prototype.importJSON=function(e){this.elements.push(...JSON.parse(e))};const g=["drawCircle","drawRectangle","drawImage","drawPolygon","drawGroup"];function m(e,{watchable:t}={}){const n=e.replace("draw","add");t=t||g.includes(e),f.prototype[n]=t?function(t={}){const{dynamic:n=this.dynamic,draggable:i}=t;this.failFast&&this.testScreen[e](t);const r=this.collisionShapes&&(t.watch||i||t.whenClicked||t.whenMouseButtonPressed||t.whenMouseButtonReleased||t.whenMouseMoved||t.whenMouseMovedIn||t.whenMouseMovedOut);n||i||(t=E(t)),this.lastChange++,this.elements.push([e,t]),r&&b(this,e,t)}:function(t={}){const{dynamic:n=this.dynamic}=t;this.failFast&&this.testScreen[e](t),n||(t=E(t)),this.lastChange++,this.elements.push([e,t])}}e.drawingMethods.forEach(m),f.proxify=m;let{addGroup:y}=f.prototype;f.prototype.addGroup=function(e){if(y.call(this,e),!this.collisionShapes)return;const{group:t}=e;if(!t)throw new Error("'group' param missing");{const e=this.collisionShapes[this.collisionShapes.length-1],n=this.elements.length-1;if(!e||e[2]!==n)if(t.hasSomeWatches()){const[e,t]=this.elements[n];b(this,e,t)}else t.parentsToWarn.push({parent:this,index:n})}};let{addImage:x}=f.prototype;function b(e,t,n){const{collisionShapes:i,elements:r}=e;0===i.length&&e.warnParentsOfColliding(),i.push([t,n,r.length-1])}f.prototype.addImage=function(e){e.image||(e={image:e}),x.call(this,e);const[,t]=this.elements[this.elements.length-1];let{image:n}=t,{queueForAfterLoad:i}=n||{};function r(){const{positionParams:e}=u(n,t);let{width:i,height:r}=e;t.width=i,t.height=r,s(t)||a(e,t)}i?i.push(r):"string"==typeof n?h({url:n,callback:e=>{n=e,r()}}):r()},f.prototype.warnParentsOfColliding=function(){this.parentsToWarn.forEach((({parent:e,index:t})=>{const{collisionShapes:n,elements:i}=e,[r,o]=i[t];let s=[r,o,t];if(0===n.length)n.push(s),e.warnParentsOfColliding();else{const e=n.findIndex((([,,e])=>e>t));-1===e?n.push(s):n.splice(e,0,s)}}))},f.prototype.isPointInside=function(e){return Boolean(r.isInsideForScreenGroup(e,this.collisionShapes||this.elements))},f.prototype.shapesAt=function(e){return r.isInsideForScreenGroup(e,this.collisionShapes||this.elements)||null},f.prototype.hasSomeWatches=function(){return!this.collisionShapes||this.collisionShapes.length>0},f.prototype.scanForWatchableGroups=function(){const{collisionShapes:e}=this;this.elements.forEach((t=>{"drawGroup"===t[0]&&t[1].group.hasSomeWatches()&&!e.includes(t)&&e.push(t)}))};function v({group:e,referenceFrame:t,depth:n},{elementQueue:i,groupQueue:r,maxDepth:o}){const{elements:s}=e;n+=1;for(let e=0;e<s.length;e++){const a=s[e],l=a[0];if("drawGroup"===l){if(n>o)continue;const e=a[1];let{group:s}=e;"function"==typeof s&&(s=s(n));let l=c(e);t&&(l=t.globalBase(l));const u={group:s,referenceFrame:l,depth:n};r?r.push(u):v(u,{elementQueue:i,maxDepth:o})}else t?i.push([l,w(t,a[1])]):i.push(a);if(i.length>4e3)break}}function w(e,t){let n,i=t.relativeTo;return n=i?e.globalBase(i):e,Object.assign({},t,{relativeTo:n})}function _({x:e,y:t}){return{x:e,y:t}}function S({x:e,y:t,controlNext:n,controlPrevious:i}){const r={x:e,y:t};return n&&(r.controlNext=_(n)),i&&(r.controlPrevious=_(i)),r}f.prototype.flatten=function({maxDepth:e=20}={}){const t=[];v({group:this,depth:0},{elementQueue:t,maxDepth:e});const n=new f;return n.elements=t,n},f.prototype.flattenReordered=function({maxDepth:e=20}={}){const t=[],n=[];let i={group:this,depth:0},r=0;for(;i&&r<1e3;)r+=1,v(i,{elementQueue:t,groupQueue:n,maxDepth:e}),i=n.shift();const o=new f;return o.elements=t,o},f.prototype.triggerCoordMethodOnShapes=function(e,t,n){let i=this.shapesAt({x:t,y:n});i&&i.forEach((i=>{e in i&&i[e](t,n,i)}))};let C={coords:_,coordsAndRadius:function({x:e,y:t,radius:n}){return{x:e,y:t,radius:n}},vector:_,points:function(e){return e.map(S)},referenceFrame:function(e){if("localLengthToGlobal"in e)return new l({relativeTo:e});{const{x:t,y:n,orientation:i,scale:r}=e;return{x:t,y:n,orientation:i,scale:r}}},function:"identity",length:"identity",angle:"identity",orientation:"identity",boolean:"identity",factor:"identity",text:"identity",textWithUSyntax:"identity",color:"identity",number:"identity",imageData:"identity",image:"identity",stroke:"identity",group:"identity",cropParams:"identity",linearGradient:function({origin:e,end:t,colors:n}){return{origin:e,end:t,colors:n}},radialGradient:function({innerCircle:e,outerCircle:t,center:n,radius:i,colors:r}){return{innerCircle:e,outerCircle:t,center:n,radius:i,colors:r}}};const k={};for(let t in e.paramsTypes){let n=e.paramsTypes[t];k[t]=C[n]}f.addParamType=function(e,t){k[e]=C[t]};const M=["whenClicked","whenMouseButtonPressed","whenMouseButtonReleased","whenMouseMoved","whenMouseMovedIn","whenMouseMovedOut"];function E(e){let t={};for(let n in e){let i=k[n];if(!i)continue;let r=e[n];r&&"identity"!==i&&"function"!=typeof r&&(r=i(e[n])),t[n]=r}return t}return f.mouseEvents=M,M.forEach((e=>{k[e]="identity"})),f})),define("toxilibs/http_loader",["jquery"],(function(e){let t={jpg:"image",png:"image",gif:"image",bmp:"image",html:"xhr",txt:"xhr",css:"xhr",glsl:"xhr",json:"json",mp3:"audio"};let n={};function i(e,i,r){(function(e){let t=n[e]||null;if(!t)throw new Error("No loader found for "+e);return t})(function(e){let n=function(e){return e.split("?").shift().split(".").pop().toLowerCase()}(e),i=t[n]||null;if(!i)throw new Error("No loader type found for "+n);return i}(e))(e,i,r||function(e){let t=new Error("Could not load "+e);return function(){throw t}}(e))}return n.image=function(e,t,n){let i=new Image;i.crossOrigin="Anonymous",i.addEventListener("load",(function(...e){t(i,...e)})),i.addEventListener("error",n),i.src=e},n.xhr=function(t,n,i){e.get(t,n).fail(i)},n.json=function(e,t,i){n.xhr(e,(function(...e){"string"==typeof e[0]&&(e[0]=JSON.parse(e[0])),t(...e)}),i)},Object.assign(i,n),i})),define("toxilibs/source_map",[],(function(){let e=/\/\/\*\* Source Map New Name : (.+)/;return{fileSeparation:function(e){return"\n//** Source Map New Name : "+e+"\n"},getLineMapper:function(t){const n=[],i=t.split("\n"),r={};let o=0,s="anonymous";return i.forEach(((t,i)=>{let a=t.match(e);a&&(r[s]=i-o,s=a[1],o=i+1-(r[s]||0)),n[i]={lineDelta:o,name:s}})),function(e){let{name:t,lineDelta:i}=n[e-1];return{line:e-i,name:t}}}}})),define("toxilibs/glsl_source",["./source_map"],(function(e){const{fileSeparation:t}=e,n="\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\nvarying vec2 coord;\n";function i({name:e="main",skipGeneralPrefix:r,prefix:s,suffix:a,source:c,moduleIncluder:l=i.requireJsIncluder()},u){o({source:c=function({name:e,prefix:i,source:r,suffix:o,skipGeneralPrefix:s}){r=t(e)+r,i&&(r=t("prefix")+i+r);s||(r=n+r);o&&(r+=t("suffix")+o);return r}({name:e,prefix:s,suffix:a,source:c,skipGeneralPrefix:r}),name:e,moduleIncluder:l},u)}i.requireJsIncluder=function({baseUrl:e=""}={}){return function(t,n){require(["text!"+e+t+".glsl"],(function(e){n(e)}))}},i.generalPrefix=n;let r=/[^/]include\('([^)]*)'\);/;function o({source:e,name:n,moduleIncluder:i},s){let a=e.match(r);if(a){let c=a[1];i(c,(function(a){a=t(c)+a+t(n),o({source:e=e.replace(r,a),name:c,moduleIncluder:i},s)}))}else s(e)}return i})),define("toxilibs/webgl_manager",["./glsl_source","./source_map"],(function(e,t){const n="\nattribute vec2 vertexPosition;\nvarying vec2 coord;\nvoid main(void) {\n    gl_Position = vec4(vertexPosition, 0, 1);\n    coord       = vertexPosition.xy;\n}",{getLineMapper:i,fileSeparation:r}=t;function o({canvas:e,data:t}){this.storedData={},this.dataMapper={},this.textures={},this.frameIndex=0;try{this.gl=e.getContext("webgl")||e.getContext("experimental-webgl"),this.gl.viewportWidth=e.width,this.gl.viewportHeight=e.height}catch(e){console.error("Canvas error")}this.gl||console.error("Could not initialize WebGL"),t&&this.setData(t)}o.prototype.initSource=function(t){this.dataMapper={},this.textures={};const{callback:i}=t;t=Object.assign({skipGeneralPrefix:!0},t),e(t,(t=>{let o=s(this.storedData,t);o+=s({pixToPlot:1,screenScaleX:1,screenScaleY:1},t),""!==o&&(t=r("autoDataPrefix")+o+t),t=e.generalPrefix+t,this.source=t,function(e,t){const{gl:i}=e;let r=u(i,t,"fragment"),o=u(i,n,"vertex");const s=i.createProgram();i.attachShader(s,o),i.attachShader(s,r),i.linkProgram(s),e.shaderProgram=s,i.getProgramParameter(s,i.LINK_STATUS)||console.error("Could not initialise shaders");i.useProgram(s),e.vertexPosition=i.getAttribLocation(s,"vertexPosition"),i.enableVertexAttribArray(e.vertexPosition)}(this,t),function(e){const{gl:t,vertexPosition:n}=e;e.vertexPositionBuffer=function(e,{position:t,positionBuffer:n=e.createBuffer(),vertices:i}){e.bindBuffer(e.ARRAY_BUFFER,n),i&&e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW);return e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),n}(t,{position:n,vertices:h})}(this),i()}))},o.prototype.drawScene=function({data:e={}}={}){const{gl:t}=this;a(this,e);const n=Object.assign({},this.storedData,e),i=l(n.zoom||1),r=i*t.viewportWidth;this.setUniformValues(n),this.setUniformValues({pixToPlot:2/r,screenScaleX:1/i,screenScaleY:t.viewportHeight/r}),t.drawArrays(t.TRIANGLE_STRIP,0,4),this.frameIndex+=1},o.prototype.setData=function(e){a(this,e),Object.assign(this.storedData,e)},o.prototype.setUniformValues=function(e){for(let t in e)this.setUniformValue(t,e[t])},o.prototype.setUniformValue=function(e,t){const{dataMapper:n}=this,i=n[e]||function(e,t){const{gl:n,dataMapper:i,shaderProgram:r,source:o,frameIndex:s}=e,a=c(o,t)||"float",l=n.getUniformLocation(r,t);let u;if("float"===a)u=e=>n.uniform1f(l,e);else if("int"===a)u=e=>n.uniform1i(l,e);else if("vec2"===a||"vec3"===a||"vec4"===a)u=e=>n[`uniform${a[3]}f`](l,...e);else{if("sampler2D"!==a)throw new Error(`Unsupported type '${a}' when setting '${t}'`);u=n=>e.setTexture(t,n)}const h={setter:u,lastChanged:s};return i[t]=h,h}(this,e),{setter:r,lastChanged:o=1/0}=i;"function"==typeof t?r(t()):o>=this.frameIndex&&r(t)};function s(e,t){let n="";for(let r in e)if(!c(t,r)){let t,o=l(e[r]);if("number"==typeof o)t="float";else if(Array.isArray(o)&&o.length<=4)t="vec"+o.length;else{if(!(i=o)||!("imageData"in i||i instanceof ImageData||i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap||i instanceof Uint8Array)){if(void 0===o)continue;throw new Error(`Unsupported type for '${r}'`)}t="sampler2D"}n+=`uniform ${t} ${r};\n`}var i;return n}function a(e,t){const{dataMapper:n,frameIndex:i}=e;for(let e in t)e in n&&(n[e].lastChanged=i)}function c(e,t){const n=e.match(new RegExp("uniform\\s+(.*)\\s+"+t+";"));return n&&n[1]}function l(e){return"function"==typeof e?e():e}function u(e,t,n){let r;if("fragment"===n)r=e.createShader(e.FRAGMENT_SHADER);else{if("vertex"!==n)return null;r=e.createShader(e.VERTEX_SHADER)}e.shaderSource(r,t),e.compileShader(r);const o=e.getShaderParameter(r,e.COMPILE_STATUS);return function({all:e,errors:t}){if(e.forEach(f),1===t.length)throw new Error("Shader compilation error");if(t.length>1)throw new Error("Shader compilation errors")}(function(e,t,n){const r=e.getShaderInfoLog(t),o=n.split("\n"),s=i(n),a={all:[],errors:[],warnings:[]};return r.replace(d,(function(e,t,n,i){n=parseInt(n,10);const r=o[n-1],{name:c,line:l}=s(n),u={sourceLine:r,line:l,sourceName:c,message:i};a.all.push(u),"WARNING"===t?(u.severity="warning",a.warnings.push(u)):(u.severity="error",a.errors.push(u))})),a}(e,r,t)),o?r:null}o.prototype.setTexture=function(e,t){const{gl:n,textures:i}=this;e in i||function(e,t){const{gl:n,shaderProgram:i,textures:r}=e,o=Object.keys(r).length,s="TEXTURE"+o;n.uniform1i(n.getUniformLocation(i,t),o),n.activeTexture(n[s]);const a=n.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),r[t]={index:s}}(this,e);const{index:r}=i[e];t.imageData&&(t=t.imageData),n.activeTexture(n[r]),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)};const h=[1,1,-1,1,1,-1,-1,-1];const d=/(.*):\s0:(\d*):\s(.*)/g;function f({line:e,sourceName:t,sourceLine:n,message:i,severity:r}){const o=`[${t}, line ${e}] ${n}`+"\n "+i;"warning"===r?console.warn(o):console.error(o),console.log("\n")}return o})),define("toxilibs/webgl_image",["./screen_image","./webgl_manager","./source_map"],(function(e,t,n){const{fileSeparation:i}=n,r="\n\nvec2 dimensionsInPixels = vec2(widthInPixels, heightInPixels);\n\n\nvec2 pixelCoordsToTextureCoords (float x, float y) {\n    return vec2(x, y) / dimensionsInPixels;\n}\nvec2 pixelCoordsToTextureCoords (vec2 pixelCoords) {\n    return pixelCoords / dimensionsInPixels;\n}\n\n\n\nvec2 textureCoordsToPixelCoords (float x, float y) {\n    return vec2(x, y) * dimensionsInPixels;\n}\nvec2 textureCoordsToPixelCoords (vec2 textureCoords) {\n    return textureCoords * dimensionsInPixels;\n}\n\n",o="\n\nvec4 colorAtPixel(vec2 pixelCoords) {\n    return texture2D(source, pixelCoords / dimensionsInPixels);\n}\nvec4 colorAtPixel(float x, float y) {\n    return texture2D(source, pixelCoordsToTextureCoords(x, y));\n}\n\n",s="\nvoid main(void) {\n\n    vec2 textureCoords = vec2(1. + coord.x, 1. - coord.y) * 0.5;\n    vec2 coords        = centerInScreenSpace + coord * semiDimensionsInScreenSpace;\n    vec2 pixelCoords   = textureCoords * dimensionsInPixels;\n",a="\n\n    gl_FragColor = vec4(pixelColor,1.0);\n}\n\n";function c(n){const{whenLoaded:i}=n;n=Object.assign({bare:!0},n,{whenLoaded:e=>{n.whenLoaded=i,function(e,n,i){"source"in i&&(e.sourceScreenImage=n);let{widthInPixels:r,heightInPixels:o,width:s,height:a,topLeft:c}=n;c=c||{x:-s/2,y:a/2},e.widthInPixels=r,e.heightInPixels=o,e.width=s,e.height=a,e.topLeft=c,function(e){const t=document.createElement("canvas");t.width=e.widthInPixels,t.height=e.heightInPixels,e.canvas=t}(e),e.image=e.canvas,e.webGLManager=new t({canvas:e.canvas});const l={time:()=>(Date.now()-e.launchedAt)/1e3,width:s,height:a,centerInScreenSpace:[c.x+s/2,c.y-a/2],semiDimensionsInScreenSpace:[s/2,a/2],widthInPixels:r,heightInPixels:o};e.webGLManager.setData(l),e.launchedAt=Date.now(),e.update(i)}(this,e,n)}}),new e(n)}return c.prototype.update=function(e={}){const{webGLManager:t,sourceScreenImage:n}=this,{data:c,syncFromSource:l=!1}=e;let u;!n||t.storedData.source&&!l||(n.syncFromSource(),t.storedData.source!==n.imageData&&t.setData({source:n.imageData})),c&&t.setData(c),"shader"in e&&(this.shader=e.shader,u=!0),"shaderPrefix"in e&&(this.shaderPrefix=e.shaderPrefix,u=!0),u||!this.shader?function(e,t){const{webGLManager:n,shader:c="",shaderPrefix:l="",sourceScreenImage:u}=e;let h=r,d=s;u?(h+=o,d+="\tvec3 pixelColor = texture2D(source, textureCoords).rgb;\n"):d+="\tvec3 pixelColor = vec3(0.);\n";n.initSource({source:c,prefix:h+i("shaderPrefix")+l+i("prefixForMainFunction")+d,suffix:a,callback:t})}(this,(()=>t.drawScene())):t.drawScene()},c})),define("toxilibs/noise_2D",["./random"],(function(e){const t=(Math.sqrt(3)-1)/2,n=(3-Math.sqrt(3))/6,i=2*n-1,r=[];function o(e){this.setSeed(e)}o.prototype.setSeed=function(t=!1){let n;n=!1===t?e:e.createNew(t),0===r.length&&function(){const e=Math.sqrt(2);for(let t=0;t<32;t++){let n=2*t*Math.PI/32;r[t]={x:e*Math.cos(n),y:e*Math.sin(n)}}}();const i=[],o=[];for(let e=0;e<256;e++)i.push(e),o.push(r[e%32]);n.shuffleArray(i),n.shuffleArray(o),i.push(i[0]);const s=new Array(512);for(let e=0;e<256;e++){let t=o[e];s[e]=t,s[e+256]=t}this.perm=i,this.gradPerm=s},o.prototype.perlin=function(e,t){const{gradPerm:n,perm:i}=this;let r=Math.floor(e),o=Math.floor(t);e-=r,t-=o,r&=255,o&=255;const s=r+i[o],a=r+i[o+1];return function(e,t,n,i,r,o){const s=l(r);return u(u(e,t,s),u(n,i,s),l(o))}(c(n[s],e,t),c(n[s+1],e-1,t),c(n[a],e,t-1),c(n[a+1],e-1,t-1),e,t)},o.prototype.simplex=function(e,r){const{gradPerm:o,perm:c}=this,l=(e+r)*t;let u=Math.floor(e+l),h=Math.floor(r+l);const d=(u+h)*n,f=e-u+d,p=r-h+d;let g=0;f>p&&(g=1);let m=1-g;u&=255,h&=255;const y=u+c[h],x=u+g+c[h+m],b=u+1+c[h+1],v=o[y],w=o[x],_=o[b];return s*(a(f,p,v)+a(f-g+n,p-m+n,w)+a(f+i,p+i,_))};const s=70.148;function a(e,t,n){let i=.5-e*e-t*t;return i<0?0:(i*=i,i*i*c(n,e,t))}function c({x:e,y:t},n,i){return e*n+t*i}function l(e){return e*e*e*(e*(6*e-15)+10)}function u(e,t,n){return(1-n)*e+n*t}return o})),define("toxilibs/bezier_path",["./bezier"],(function(e){function t({origin:e}={}){this.portions=[],this.origin=e,this.end=e}return t.prototype.length=function(){var e;return"computedLength"in this||((e=this).computedLength=0,e.portions.forEach((t=>{t.startingDistance=e.computedLength,e.computedLength+=t.length()}))),this.computedLength},t.prototype.appendBezier=function(e){this.portions.push(e),this.beforeEnd=this.end,this.end=e.end},t.prototype.appendPortion=function({nextPoint:t,controlOrigin:n=this.end,controlEnd:i=t}){let r=new e({origin:this.end,end:t,controlOrigin:n,controlEnd:i});this.appendBezier(r),this.end=t},t.prototype.addPoint=function(e,t){this.addPoints([e],t)},t.prototype.addPoints=function(t,{smooth:n=0,smoothJunction:i=!0}={}){let r=!1;n&&i&&this.beforeEnd?this.end.controlPrevious?(this.end.controlNext=function({x:e,y:t},n){return{x:2*n.x-e,y:2*n.y-t}}(this.end.controlPrevious,this.end),t=[this.end,...t]):(r=!0,t=[this.beforeEnd,this.end,...t]):t=[this.end,...t],t=e.pointsWithDefaultControlPoints({points:t,smooth:n}),r&&(t.shift(),this.lastPortion().controlEnd=t[0].controlPrevious);let o=t[0].controlNext;for(let e=1;e<t.length;e++){let n=t[e],i=o;this.appendPortion({controlOrigin:i,nextPoint:n,controlEnd:n.controlPrevious}),o=n.controlNext}},t.prototype.lastPortion=function(){return this.portions[this.portions.length-1]},t.prototype.coords=function(e){let{portion:t,relativeDistance:n}=function(e,t){let{portions:n,length:i}=e;if(t>i)return!1;let r=0;for(let e=0;e<n.length;e++){let i=n[e],o=r+i.length();if(o>t)return{portion:i,relativeDistance:t-r};r=o}return!1}(this,e);return t.coords(n)},t})),define("toxilibs/sprite_collection",["./topleft_and_pivot"],(function(e){const{getTopLeftPoint:t}=e;function n(e={}){let{whenSequenceCompleted:t}=e;this.whenSequenceCompleted=t,this.sequences={},"frames"in e?(this.default={},this.add(e)):(this.defaults=e,"names"in e&&function(e,t){let{names:n}=t,{index:i=0}=e.defaults;n.forEach(((t,n)=>{e.add({name:t,index:n+i})}))}(this,e))}function i(e,{screen:t,scale:n,drawnImages:i}){let{sprites:r}=e;r.forEach(((o,s)=>{let{image:a,cropSource:c}=o,{topLeft:l}=i.get(a),{topLeft:u,width:h,height:d}=c,{x:f,y:p}=u;u={x:l.x+f*n,y:l.y-p*n},h*=n,d*=n;let g=e.name;r.length>1&&(g+="#"+s),t.drawText({text:g,topLeft:u,color:"red"}),t.drawRectangle({width:h,height:d,topLeft:u,strokeColor:"red"})}))}function r(e){let t=e.currentSequence.getCurrent();if(!t)return;let{image:n,cropSource:i}=t;return e.image=n,e.cropSource=i,e}function o(e){let{image:t}=e;if(!t)throw new Error("An image must be specified");let{width:n=t.width,height:i=t.height}=e;return{image:t,width:n,height:i}}function s(e,t){this.name=t,this.sprites=e,this.length=e.length,this.currentFrame=0}function a(e,t){let{length:n}=e;return(Math.floor(t)%n+n)%n}return n.prototype.add=function(e){e=Object.assign({},this.defaults,e);let n,{name:i="main",frames:r=1}=e;"all"===r&&(r=function(e){let{image:t,width:n,height:i}=o(e),{index:r=0}=e,s=Math.floor(t.width/n),a=Math.floor(t.height/i);return s*a-r}(e)),"number"==typeof r&&(r=[...Array(r).keys()]),n="number"==typeof r[0]?function(e,t){let{image:n,width:i,height:r}=o(t),{x:s=0,y:a=0,index:c=0}=t,l=s/i,u=Math.floor(n.width/i);return e.map((e=>{let t=(l+(e+=c))%u*i,o=a+Math.floor(e/u)*r;return{image:n,cropSource:{topLeft:{x:t,y:o},width:i,height:r}}}))}(r,e):r.map((n=>function(e,n){e=Object.assign({},n,e);let{image:i}=e;if(!i)throw new Error("An image must be specified");let{width:r=i.width,height:o=i.height}=e,s=t(e);if(!s){let{x:t=0,y:n=0}=e;s={x:t,y:n}}return{image:i,cropSource:{topLeft:s,width:r,height:o}}}(n,e))),this.sequences[i]=new s(n,i),this.currentSequenceName||this.switchTo(i)},n.prototype.get=function(e=this.currentSequenceName,t){"number"==typeof e&&(t=e,e=this.currentSequenceName);const n=this.sequences[e];return n&&n.get(t)},n.prototype.switchTo=function(e,t=0){"number"==typeof e&&(t=e,e=this.currentSequenceName);const n=this.sequences[e];return this.currentSequence=n,this.currentSequenceName=e,this.currentSequence.goTo(t),r(this)},n.prototype.goTo=n.prototype.switchTo,n.prototype.next=function(e){if(!this.currentSequence)return;return function(e,t){0===t&&e.whenSequenceCompleted&&e.whenSequenceCompleted(e.currentSequenceName)}(this,this.currentSequence.next(e)),r(this)},n.prototype.previous=function(e){if(this.currentSequence)return this.currentSequence.previous(e),r(this)},n.prototype.drawDebug=function(e,n={}){let{sequences:r}=this,{name:o}=n;o&&(r={},r[o]=this.sequences[o]);let{drawnImages:s,scale:a,debugTopLeft:c}=function(e,n,i){let r=new Map,o=n.boundingBoxForWholeView(),s=t(i)||o.topLeft,{width:a=o.width}=i,c=0;for(let t in e){let{sprites:n}=e[t];for(let e=0;e<n.length;e++){let{image:t}=n[e];r.has(t)||(r.set(t,!0),c+=t.width)}}return{drawnImages:r,scale:a/c,debugTopLeft:s}}(r,e,n),l=c.x;function u(t){let n={x:l,y:c.y},i=t.width*a;l+=i,e.drawImage({image:t,width:i,topLeft:n}),s.set(t,{topLeft:n})}for(const e of s.keys())u(e);for(o in r)i(this.sequences[o],{screen:e,scale:a,drawnImages:s})},s.prototype.get=function(e=this.currentFrame){return e=a(this,e),this.sprites[e]},s.prototype.next=function(e=1){return this.goTo(this.currentFrame+e)},s.prototype.previous=function(e=1){return this.goTo(this.currentFrame-e)},s.prototype.goTo=function(e){return this.currentFrame=a(this,e),this.currentFrame},s.prototype.getCurrent=function(){return this.sprites[this.currentFrame]},n})),define("toxilibs/recorder",[],(function(){function e({autoStart:e}={}){this.autoStart=e,this.elements=[]}function t(e,n){const i=e.elements[e.playIndex];if(!i)return;const{params:r,time:o}=i;function s(){n(...r),e.playIndex+=1,t(e,n)}const a=o-(Date.now()-e.startedPlayingAt);a>0?e.currentTimer=setTimeout(s,a):s()}return e.prototype.start=function(){this.startedAt=Date.now(),this.started=!0},e.prototype.stop=function(){delete this.startedAt,this.started=!1,this.currentTimer&&clearTimeout(this.currentTimer)},e.prototype.toJson=function(){const e=[];let t=0;return this.elements.forEach((({params:n,time:i})=>{e.push([i-t,...n]),t=i})),e},e.prototype.fromJson=function(e){let t=0;this.elements.length=0,e.forEach((([e,...n])=>{t+=e,this.elements.push({time:t,params:n})}))},e.prototype.send=function(...e){if(!this.started){if(!this.autoStart)return;this.start()}this.elements.push({params:e,time:Date.now()-this.startedAt})},e.prototype.play=function(e){this.currentTimer&&clearTimeout(this.currentTimer),this.playIndex=0,this.startedPlayingAt=Date.now(),t(this,e)},e})),define("render/font_awesome_codes",[],(function(){return{ad:"","address-book":"","address-card":"",adjust:"","air-freshener":"","align-center":"","align-justify":"","align-left":"","align-right":"",allergies:"",ambulance:"","american-sign-language-interpreting":"",anchor:"","angle-double-down":"","angle-double-left":"","angle-double-right":"","angle-double-up":"","angle-down":"","angle-left":"","angle-right":"","angle-up":"",angry:"",ankh:"","apple-alt":"",archive:"",archway:"","arrow-alt-circle-down":"","arrow-alt-circle-left":"","arrow-alt-circle-right":"","arrow-alt-circle-up":"","arrow-circle-down":"","arrow-circle-left":"","arrow-circle-right":"","arrow-circle-up":"","arrow-down":"","arrow-left":"","arrow-right":"","arrow-up":"","arrows-alt":"","arrows-alt-h":"","arrows-alt-v":"","assistive-listening-systems":"",asterisk:"",at:"",atlas:"",atom:"","audio-description":"",award:"",baby:"","baby-carriage":"",backspace:"",backward:"",bacon:"",bacteria:"",bacterium:"",bahai:"","balance-scale":"","balance-scale-left":"","balance-scale-right":"",ban:"","band-aid":"",barcode:"",bars:"","baseball-ball":"","basketball-ball":"",bath:"","battery-empty":"","battery-full":"","battery-half":"","battery-quarter":"","battery-three-quarters":"",bed:"",beer:"",bell:"","bell-slash":"","bezier-curve":"",bible:"",bicycle:"",biking:"",binoculars:"",biohazard:"","birthday-cake":"",blender:"","blender-phone":"",blind:"",blog:"",bold:"",bolt:"",bomb:"",bone:"",bong:"",book:"","book-dead":"","book-medical":"","book-open":"","book-reader":"",bookmark:"","border-all":"","border-none":"","border-style":"","bowling-ball":"",box:"","box-open":"","box-tissue":"",boxes:"",braille:"",brain:"","bread-slice":"",briefcase:"","briefcase-medical":"","broadcast-tower":"",broom:"",brush:"",bug:"",building:"",bullhorn:"",bullseye:"",burn:"",bus:"","bus-alt":"","business-time":"",calculator:"",calendar:"","calendar-alt":"","calendar-check":"","calendar-day":"","calendar-minus":"","calendar-plus":"","calendar-times":"","calendar-week":"",camera:"","camera-retro":"",campground:"","candy-cane":"",cannabis:"",capsules:"",car:"","car-alt":"","car-battery":"","car-crash":"","car-side":"",caravan:"","caret-down":"","caret-left":"","caret-right":"","caret-square-down":"","caret-square-left":"","caret-square-right":"","caret-square-up":"","caret-up":"",carrot:"","cart-arrow-down":"","cart-plus":"","cash-register":"",cat:"",certificate:"",chair:"",chalkboard:"","chalkboard-teacher":"","charging-station":"","chart-area":"","chart-bar":"","chart-line":"","chart-pie":"",check:"","check-circle":"","check-double":"","check-square":"",cheese:"",chess:"","chess-bishop":"","chess-board":"","chess-king":"","chess-knight":"","chess-pawn":"","chess-queen":"","chess-rook":"","chevron-circle-down":"","chevron-circle-left":"","chevron-circle-right":"","chevron-circle-up":"","chevron-down":"","chevron-left":"","chevron-right":"","chevron-up":"",child:"",church:"",circle:"","circle-notch":"",city:"","clinic-medical":"",clipboard:"","clipboard-check":"","clipboard-list":"",clock:"",clone:"","closed-captioning":"",cloud:"","cloud-download-alt":"","cloud-meatball":"","cloud-moon":"","cloud-moon-rain":"","cloud-rain":"","cloud-showers-heavy":"","cloud-sun":"","cloud-sun-rain":"","cloud-upload-alt":"",cocktail:"",code:"","code-branch":"",coffee:"",cog:"",cogs:"",coins:"",columns:"",comment:"","comment-alt":"","comment-dollar":"","comment-dots":"","comment-medical":"","comment-slash":"",comments:"","comments-dollar":"","compact-disc":"",compass:"",compress:"","compress-alt":"","compress-arrows-alt":"","concierge-bell":"",cookie:"","cookie-bite":"",copy:"",copyright:"",couch:"","credit-card":"",crop:"","crop-alt":"",cross:"",crosshairs:"",crow:"",crown:"",crutch:"",cube:"",cubes:"",cut:"",database:"",deaf:"",democrat:"",desktop:"",dharmachakra:"",diagnoses:"",dice:"","dice-d20":"","dice-d6":"","dice-five":"","dice-four":"","dice-one":"","dice-six":"","dice-three":"","dice-two":"","digital-tachograph":"",directions:"",disease:"",divide:"",dizzy:"",dna:"",dog:"","dollar-sign":"",dolly:"","dolly-flatbed":"",donate:"","door-closed":"","door-open":"","dot-circle":"",dove:"",download:"","drafting-compass":"",dragon:"","draw-polygon":"",drum:"","drum-steelpan":"","drumstick-bite":"",dumbbell:"",dumpster:"","dumpster-fire":"",dungeon:"",edit:"",egg:"",eject:"","ellipsis-h":"","ellipsis-v":"",envelope:"","envelope-open":"","envelope-open-text":"","envelope-square":"",equals:"",eraser:"",ethernet:"","euro-sign":"","exchange-alt":"",exclamation:"","exclamation-circle":"","exclamation-triangle":"",expand:"","expand-alt":"","expand-arrows-alt":"","external-link-alt":"","external-link-square-alt":"",eye:"","eye-dropper":"","eye-slash":"",fan:"","fast-backward":"","fast-forward":"",faucet:"",fax:"",feather:"","feather-alt":"",female:"","fighter-jet":"",file:"","file-alt":"","file-archive":"","file-audio":"","file-code":"","file-contract":"","file-csv":"","file-download":"","file-excel":"","file-export":"","file-image":"","file-import":"","file-invoice":"","file-invoice-dollar":"","file-medical":"","file-medical-alt":"","file-pdf":"","file-powerpoint":"","file-prescription":"","file-signature":"","file-upload":"","file-video":"","file-word":"",fill:"","fill-drip":"",film:"",filter:"",fingerprint:"",fire:"","fire-alt":"","fire-extinguisher":"","first-aid":"",fish:"","fist-raised":"",flag:"","flag-checkered":"","flag-usa":"",flask:"",flushed:"",folder:"","folder-minus":"","folder-open":"","folder-plus":"",font:"","football-ball":"",forward:"",frog:"",frown:"","frown-open":"","funnel-dollar":"",futbol:"",gamepad:"","gas-pump":"",gavel:"",gem:"",genderless:"",ghost:"",gift:"",gifts:"","glass-cheers":"","glass-martini":"","glass-martini-alt":"","glass-whiskey":"",glasses:"",globe:"","globe-africa":"","globe-americas":"","globe-asia":"","globe-europe":"","golf-ball":"",gopuram:"","graduation-cap":"","greater-than":"","greater-than-equal":"",grimace:"",grin:"","grin-alt":"","grin-beam":"","grin-beam-sweat":"","grin-hearts":"","grin-squint":"","grin-squint-tears":"","grin-stars":"","grin-tears":"","grin-tongue":"","grin-tongue-squint":"","grin-tongue-wink":"","grin-wink":"","grip-horizontal":"","grip-lines":"","grip-lines-vertical":"","grip-vertical":"",guitar:"","h-square":"",hamburger:"",hammer:"",hamsa:"","hand-holding":"","hand-holding-heart":"","hand-holding-medical":"","hand-holding-usd":"","hand-holding-water":"","hand-lizard":"","hand-middle-finger":"","hand-paper":"","hand-peace":"","hand-point-down":"","hand-point-left":"","hand-point-right":"","hand-point-up":"","hand-pointer":"","hand-rock":"","hand-scissors":"","hand-sparkles":"","hand-spock":"",hands:"","hands-helping":"","hands-wash":"",handshake:"","handshake-alt-slash":"","handshake-slash":"",hanukiah:"","hard-hat":"",hashtag:"","hat-cowboy":"","hat-cowboy-side":"","hat-wizard":"",hdd:"","head-side-cough":"","head-side-cough-slash":"","head-side-mask":"","head-side-virus":"",heading:"",headphones:"","headphones-alt":"",headset:"",heart:"","heart-broken":"",heartbeat:"",helicopter:"",highlighter:"",hiking:"",hippo:"",history:"","hockey-puck":"","holly-berry":"",home:"",horse:"","horse-head":"",hospital:"","hospital-alt":"","hospital-symbol":"","hospital-user":"","hot-tub":"",hotdog:"",hotel:"",hourglass:"","hourglass-end":"","hourglass-half":"","hourglass-start":"","house-damage":"","house-user":"",hryvnia:"","i-cursor":"","ice-cream":"",icicles:"",icons:"","id-badge":"","id-card":"","id-card-alt":"",igloo:"",image:"",images:"",inbox:"",indent:"",industry:"",infinity:"",info:"","info-circle":"",italic:"",jedi:"",joint:"","journal-whills":"",kaaba:"",key:"",keyboard:"",khanda:"",kiss:"","kiss-beam":"","kiss-wink-heart":"","kiwi-bird":"",landmark:"",language:"",laptop:"","laptop-code":"","laptop-house":"","laptop-medical":"",laugh:"","laugh-beam":"","laugh-squint":"","laugh-wink":"","layer-group":"",leaf:"",lemon:"","less-than":"","less-than-equal":"","level-down-alt":"","level-up-alt":"","life-ring":"",lightbulb:"",link:"","lira-sign":"",list:"","list-alt":"","list-ol":"","list-ul":"","location-arrow":"",lock:"","lock-open":"","long-arrow-alt-down":"","long-arrow-alt-left":"","long-arrow-alt-right":"","long-arrow-alt-up":"","low-vision":"","luggage-cart":"",lungs:"","lungs-virus":"",magic:"",magnet:"","mail-bulk":"",male:"",map:"","map-marked":"","map-marked-alt":"","map-marker":"","map-marker-alt":"","map-pin":"","map-signs":"",marker:"",mars:"","mars-double":"","mars-stroke":"","mars-stroke-h":"","mars-stroke-v":"",mask:"",medal:"",medkit:"",meh:"","meh-blank":"","meh-rolling-eyes":"",memory:"",menorah:"",mercury:"",meteor:"",microchip:"",microphone:"","microphone-alt":"","microphone-alt-slash":"","microphone-slash":"",microscope:"",minus:"","minus-circle":"","minus-square":"",mitten:"",mobile:"","mobile-alt":"","money-bill":"","money-bill-alt":"","money-bill-wave":"","money-bill-wave-alt":"","money-check":"","money-check-alt":"",monument:"",moon:"","mortar-pestle":"",mosque:"",motorcycle:"",mountain:"",mouse:"","mouse-pointer":"","mug-hot":"",music:"","network-wired":"",neuter:"",newspaper:"","not-equal":"","notes-medical":"","object-group":"","object-ungroup":"","oil-can":"",om:"",otter:"",outdent:"",pager:"","paint-brush":"","paint-roller":"",palette:"",pallet:"","paper-plane":"",paperclip:"","parachute-box":"",paragraph:"",parking:"",passport:"",pastafarianism:"",paste:"",pause:"","pause-circle":"",paw:"",peace:"",pen:"","pen-alt":"","pen-fancy":"","pen-nib":"","pen-square":"","pencil-alt":"","pencil-ruler":"","people-arrows":"","people-carry":"","pepper-hot":"",percent:"",percentage:"","person-booth":"",phone:"","phone-alt":"","phone-slash":"","phone-square":"","phone-square-alt":"","phone-volume":"","photo-video":"","piggy-bank":"",pills:"","pizza-slice":"","place-of-worship":"",plane:"","plane-arrival":"","plane-departure":"","plane-slash":"",play:"","play-circle":"",plug:"",plus:"","plus-circle":"","plus-square":"",podcast:"",poll:"","poll-h":"",poo:"","poo-storm":"",poop:"",portrait:"","pound-sign":"","power-off":"",pray:"","praying-hands":"",prescription:"","prescription-bottle":"","prescription-bottle-alt":"",print:"",procedures:"","project-diagram":"","pump-medical":"","pump-soap":"","puzzle-piece":"",qrcode:"",question:"","question-circle":"",quidditch:"","quote-left":"","quote-right":"",quran:"",radiation:"","radiation-alt":"",rainbow:"",random:"",receipt:"","record-vinyl":"",recycle:"",redo:"","redo-alt":"",registered:"","remove-format":"",reply:"","reply-all":"",republican:"",restroom:"",retweet:"",ribbon:"",ring:"",road:"",robot:"",rocket:"",route:"",rss:"","rss-square":"","ruble-sign":"",ruler:"","ruler-combined":"","ruler-horizontal":"","ruler-vertical":"",running:"","rupee-sign":"","sad-cry":"","sad-tear":"",satellite:"","satellite-dish":"",save:"",school:"",screwdriver:"",scroll:"","sd-card":"",search:"","search-dollar":"","search-location":"","search-minus":"","search-plus":"",seedling:"",server:"",shapes:"",share:"","share-alt":"","share-alt-square":"","share-square":"","shekel-sign":"","shield-alt":"","shield-virus":"",ship:"","shipping-fast":"","shoe-prints":"","shopping-bag":"","shopping-basket":"","shopping-cart":"",shower:"","shuttle-van":"",sign:"","sign-in-alt":"","sign-language":"","sign-out-alt":"",signal:"",signature:"","sim-card":"",sink:"",sitemap:"",skating:"",skiing:"","skiing-nordic":"",skull:"","skull-crossbones":"",slash:"",sleigh:"","sliders-h":"",smile:"","smile-beam":"","smile-wink":"",smog:"",smoking:"","smoking-ban":"",sms:"",snowboarding:"",snowflake:"",snowman:"",snowplow:"",soap:"",socks:"","solar-panel":"",sort:"","sort-alpha-down":"","sort-alpha-down-alt":"","sort-alpha-up":"","sort-alpha-up-alt":"","sort-amount-down":"","sort-amount-down-alt":"","sort-amount-up":"","sort-amount-up-alt":"","sort-down":"","sort-numeric-down":"","sort-numeric-down-alt":"","sort-numeric-up":"","sort-numeric-up-alt":"","sort-up":"",spa:"","space-shuttle":"","spell-check":"",spider:"",spinner:"",splotch:"","spray-can":"",square:"","square-full":"","square-root-alt":"",stamp:"",star:"","star-and-crescent":"","star-half":"","star-half-alt":"","star-of-david":"","star-of-life":"","step-backward":"","step-forward":"",stethoscope:"","sticky-note":"",stop:"","stop-circle":"",stopwatch:"","stopwatch-20":"",store:"","store-alt":"","store-alt-slash":"","store-slash":"",stream:"","street-view":"",strikethrough:"",stroopwafel:"",subscript:"",subway:"",suitcase:"","suitcase-rolling":"",sun:"",superscript:"",surprise:"",swatchbook:"",swimmer:"","swimming-pool":"",synagogue:"",sync:"","sync-alt":"",syringe:"",table:"","table-tennis":"",tablet:"","tablet-alt":"",tablets:"","tachometer-alt":"",tag:"",tags:"",tape:"",tasks:"",taxi:"",teeth:"","teeth-open":"","temperature-high":"","temperature-low":"",tenge:"",terminal:"","text-height":"","text-width":"",th:"","th-large":"","th-list":"","theater-masks":"",thermometer:"","thermometer-empty":"","thermometer-full":"","thermometer-half":"","thermometer-quarter":"","thermometer-three-quarters":"","thumbs-down":"","thumbs-up":"",thumbtack:"","ticket-alt":"",times:"","times-circle":"",tint:"","tint-slash":"",tired:"","toggle-off":"","toggle-on":"",toilet:"","toilet-paper":"","toilet-paper-slash":"",toolbox:"",tools:"",tooth:"",torah:"","torii-gate":"",tractor:"",trademark:"","traffic-light":"",trailer:"",train:"",tram:"",transgender:"","transgender-alt":"",trash:"","trash-alt":"","trash-restore":"","trash-restore-alt":"",tree:"",trophy:"",truck:"","truck-loading":"","truck-monster":"","truck-moving":"","truck-pickup":"",tshirt:"",tty:"",tv:"",umbrella:"","umbrella-beach":"",underline:"",undo:"","undo-alt":"","universal-access":"",university:"",unlink:"",unlock:"","unlock-alt":"",upload:"",user:"","user-alt":"","user-alt-slash":"","user-astronaut":"","user-check":"","user-circle":"","user-clock":"","user-cog":"","user-edit":"","user-friends":"","user-graduate":"","user-injured":"","user-lock":"","user-md":"","user-minus":"","user-ninja":"","user-nurse":"","user-plus":"","user-secret":"","user-shield":"","user-slash":"","user-tag":"","user-tie":"","user-times":"",users:"","users-cog":"","users-slash":"","utensil-spoon":"",utensils:"","vector-square":"",venus:"","venus-double":"","venus-mars":"",vest:"","vest-patches":"",vial:"",vials:"",video:"","video-slash":"",vihara:"",virus:"","virus-slash":"",viruses:"",voicemail:"","volleyball-ball":"","volume-down":"","volume-mute":"","volume-off":"","volume-up":"","vote-yea":"","vr-cardboard":"",walking:"",wallet:"",warehouse:"",water:"","wave-square":"",weight:"","weight-hanging":"",wheelchair:"",wifi:"",wind:"","window-close":"","window-maximize":"","window-minimize":"","window-restore":"","wine-bottle":"","wine-glass":"","wine-glass-alt":"","won-sign":"",wrench:"","x-ray":"","yen-sign":"","yin-yang":""}})),define("render/icon_for_screen",["./font_awesome_codes"],(function(e){const t=.8;return function(n){const{backgroundColor:i,name:r,size:o=1}=n;if(n.text=function(t){"function"==typeof t&&(t=t());let n=e[t];if(!n){if(!t)throw new Error('"name" param is missing');throw new Error('Icon named "'+t+'" does not exist')}return n}(r),n.font=function(e){return"function"==typeof e?()=>String(e()*t)+"u FontAwesomeForScreen":String(e*t)+"u FontAwesomeForScreen"}(o),i){let e=Object.assign({},n);e.fillColor=i,e.width=o,e.height=o,this.drawRectangle(e)}this.drawText(n)}})),define("render/screen",["toxilibs/screen","toxilibs/screen_group","./icon_for_screen"],(function(e,t,n){return e.prototype.drawIcon=n,e.drawingMethods.push("drawIcon"),e.addParamType("backgroundColor","color"),t.addParamType("backgroundColor","color"),e.addParamType("size","length"),t.addParamType("size","length"),t.proxify("drawIcon",{watchable:!0}),e}));var getJasmineRequireObj=function(e){var t;function n(){return t}return"undefined"!=typeof module&&module.exports&&"undefined"!=typeof exports?(e="undefined"!=typeof global?global:{},t=exports):("undefined"!=typeof window&&"function"==typeof window.toString&&"[object GjsGlobal]"===window.toString()&&(e=window),t=e.jasmineRequire={}),n().core=function(t){var n={};return t.base(n,e),n.util=t.util(n),n.errors=t.errors(),n.formatErrorMsg=t.formatErrorMsg(),n.Any=t.Any(n),n.Anything=t.Anything(n),n.CallTracker=t.CallTracker(n),n.MockDate=t.MockDate(n),n.getClearStack=t.clearStack(n),n.Clock=t.Clock(),n.DelayedFunctionScheduler=t.DelayedFunctionScheduler(n),n.Deprecator=t.Deprecator(n),n.Env=t.Env(n),n.StackTrace=t.StackTrace(n),n.ExceptionFormatter=t.ExceptionFormatter(n),n.ExpectationFilterChain=t.ExpectationFilterChain(),n.Expector=t.Expector(n),n.Expectation=t.Expectation(n),n.buildExpectationResult=t.buildExpectationResult(n),n.JsApiReporter=t.JsApiReporter(n),n.makePrettyPrinter=t.makePrettyPrinter(n),n.basicPrettyPrinter_=n.makePrettyPrinter(),n.MatchersUtil=t.MatchersUtil(n),n.ObjectContaining=t.ObjectContaining(n),n.ArrayContaining=t.ArrayContaining(n),n.ArrayWithExactContents=t.ArrayWithExactContents(n),n.MapContaining=t.MapContaining(n),n.SetContaining=t.SetContaining(n),n.QueueRunner=t.QueueRunner(n),n.NeverSkipPolicy=t.NeverSkipPolicy(n),n.SkipAfterBeforeAllErrorPolicy=t.SkipAfterBeforeAllErrorPolicy(n),n.CompleteOnFirstErrorSkipPolicy=t.CompleteOnFirstErrorSkipPolicy(n),n.ReportDispatcher=t.ReportDispatcher(n),n.Spec=t.Spec(n),n.Spy=t.Spy(n),n.SpyFactory=t.SpyFactory(n),n.SpyRegistry=t.SpyRegistry(n),n.SpyStrategy=t.SpyStrategy(n),n.StringMatching=t.StringMatching(n),n.StringContaining=t.StringContaining(n),n.UserContext=t.UserContext(n),n.Suite=t.Suite(n),n.Timer=t.Timer(),n.TreeProcessor=t.TreeProcessor(),n.version=t.version(),n.Order=t.Order(),n.DiffBuilder=t.DiffBuilder(n),n.NullDiffBuilder=t.NullDiffBuilder(n),n.ObjectPath=t.ObjectPath(n),n.MismatchTree=t.MismatchTree(n),n.GlobalErrors=t.GlobalErrors(n),n.Truthy=t.Truthy(n),n.Falsy=t.Falsy(n),n.Empty=t.Empty(n),n.NotEmpty=t.NotEmpty(n),n.Is=t.Is(n),n.matchers=t.requireMatchers(t,n),n.asyncMatchers=t.requireAsyncMatchers(t,n),n},n}(this);getJasmineRequireObj().requireMatchers=function(e,t){for(var n=["nothing","toBe","toBeCloseTo","toBeDefined","toBeInstanceOf","toBeFalse","toBeFalsy","toBeGreaterThan","toBeGreaterThanOrEqual","toBeLessThan","toBeLessThanOrEqual","toBeNaN","toBeNegativeInfinity","toBeNull","toBePositiveInfinity","toBeTrue","toBeTruthy","toBeUndefined","toContain","toEqual","toHaveSize","toHaveBeenCalled","toHaveBeenCalledBefore","toHaveBeenCalledOnceWith","toHaveBeenCalledTimes","toHaveBeenCalledWith","toHaveClass","toHaveSpyInteractions","toMatch","toThrow","toThrowError","toThrowMatching"],i={},r=0;r<n.length;r++){var o=n[r];i[o]=e[o](t)}return i},getJasmineRequireObj().base=function(e,t){e.unimplementedMethod_=function(){throw new Error("unimplemented method")},e.MAX_PRETTY_PRINT_DEPTH=8,e.MAX_PRETTY_PRINT_ARRAY_LENGTH=50,e.MAX_PRETTY_PRINT_CHARS=1e3;var n=5e3;Object.defineProperty(e,"DEFAULT_TIMEOUT_INTERVAL",{get:function(){return n},set:function(t){e.util.validateTimeout(t,"jasmine.DEFAULT_TIMEOUT_INTERVAL"),n=t}}),e.getGlobal=function(){return t},e.getEnv=function(t){return e.currentEnv_=e.currentEnv_||new e.Env(t)},e.isArray_=function(t){return e.isA_("Array",t)},e.isObject_=function(t){return!e.util.isUndefined(t)&&null!==t&&e.isA_("Object",t)},e.isString_=function(t){return e.isA_("String",t)},e.isNumber_=function(t){return e.isA_("Number",t)},e.isFunction_=function(t){return e.isA_("Function",t)},e.isAsyncFunction_=function(t){return e.isA_("AsyncFunction",t)},e.isGeneratorFunction_=function(t){return e.isA_("GeneratorFunction",t)},e.isTypedArray_=function(t){return e.isA_("Float32Array",t)||e.isA_("Float64Array",t)||e.isA_("Int16Array",t)||e.isA_("Int32Array",t)||e.isA_("Int8Array",t)||e.isA_("Uint16Array",t)||e.isA_("Uint32Array",t)||e.isA_("Uint8Array",t)||e.isA_("Uint8ClampedArray",t)},e.isA_=function(t,n){return e.getType_(n)==="[object "+t+"]"},e.isError_=function(e){return!!e&&(e instanceof Error||"string"==typeof e.stack&&"string"==typeof e.message)},e.isAsymmetricEqualityTester_=function(t){return!!t&&e.isA_("Function",t.asymmetricMatch)},e.getType_=function(e){return Object.prototype.toString.apply(e)},e.isDomNode=function(e){return void 0!==t.Node?e instanceof t.Node:null!==e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},e.isMap=function(e){return null!=e&&e.constructor===t.Map},e.isSet=function(e){return null!=e&&e.constructor===t.Set},e.isWeakMap=function(e){return null!=e&&e.constructor===t.WeakMap},e.isURL=function(e){return null!=e&&e.constructor===t.URL},e.isIterable_=function(e){return e&&!!e[Symbol.iterator]},e.isDataView=function(e){return null!=e&&e.constructor===t.DataView},e.isPromise=function(e){return!!e&&e.constructor===t.Promise},e.isPromiseLike=function(t){return!!t&&e.isFunction_(t.then)},e.fnNameFor=function(e){if(e.name)return e.name;var t=e.toString().match(/^\s*function\s*(\w+)\s*\(/)||e.toString().match(/^\s*\[object\s*(\w+)Constructor\]/);return t?t[1]:"<anonymous>"},e.isPending_=function(e){var t={};return Promise.race([e,Promise.resolve(t)]).then((function(e){return e===t}),(function(){return!1}))},e.any=function(t){return new e.Any(t)},e.anything=function(){return new e.Anything},e.truthy=function(){return new e.Truthy},e.falsy=function(){return new e.Falsy},e.empty=function(){return new e.Empty},e.is=function(t){return new e.Is(t)},e.notEmpty=function(){return new e.NotEmpty},e.objectContaining=function(t){return new e.ObjectContaining(t)},e.stringMatching=function(t){return new e.StringMatching(t)},e.stringContaining=function(t){return new e.StringContaining(t)},e.arrayContaining=function(t){return new e.ArrayContaining(t)},e.arrayWithExactContents=function(t){return new e.ArrayWithExactContents(t)},e.mapContaining=function(t){return new e.MapContaining(t)},e.setContaining=function(t){return new e.SetContaining(t)},e.isSpy=function(t){return!!t&&(t.and instanceof e.SpyStrategy&&t.calls instanceof e.CallTracker)},e.debugLog=function(t){e.getEnv().debugLog(t)}},getJasmineRequireObj().util=function(e){var t,n={};function i(){}return n.inherit=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},n.argsToArray=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},n.isUndefined=function(e){return void 0===e},n.arrayContains=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},n.clone=function(e){if("[object Array]"===Object.prototype.toString.apply(e))return e.slice();var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},n.cloneArgs=function(t){for(var n=[],i=e.util.argsToArray(t),r=0;r<i.length;r++){var o=Object.prototype.toString.apply(i[r]);!i[r]||o.match(/^\[object (Boolean|String|RegExp|Number)/)?n.push(i[r]):"[object Date]"===o?n.push(new Date(i[r].valueOf())):n.push(e.util.clone(i[r]))}return n},n.getPropertyDescriptor=function(e,t){var n,i=e;do{n=Object.getOwnPropertyDescriptor(i,t),i=Object.getPrototypeOf(i)}while(!n&&i);return n},n.has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.errorWithStack=function(){return new Error},n.jasmineFile=function(){return t||(t=new e.StackTrace(n.errorWithStack()).frames[2].file),t},i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,n.validateTimeout=function(e,t){var n=2147483647;if(e>n)throw new Error((t||"Timeout value")+" cannot be greater than "+n)},n},getJasmineRequireObj().Spec=function(e){function t(t){this.expectationFactory=t.expectationFactory,this.asyncExpectationFactory=t.asyncExpectationFactory,this.resultCallback=t.resultCallback||function(){},this.id=t.id,this.description=t.description||"",this.queueableFn=t.queueableFn,this.beforeAndAfterFns=t.beforeAndAfterFns||function(){return{befores:[],afters:[]}},this.userContext=t.userContext||function(){return{}},this.onStart=t.onStart||function(){},this.autoCleanClosures=void 0===t.autoCleanClosures||!!t.autoCleanClosures,this.getSpecName=t.getSpecName||function(){return""},this.onLateError=t.onLateError||function(){},this.queueRunnerFactory=t.queueRunnerFactory||function(){},this.catchingExceptions=t.catchingExceptions||function(){return!0},this.throwOnExpectationFailure=!!t.throwOnExpectationFailure,this.timer=t.timer||new e.Timer,this.queueableFn.fn||this.exclude(),this.result={id:this.id,description:this.description,fullName:this.getFullName(),failedExpectations:[],passedExpectations:[],deprecationWarnings:[],pendingReason:"",duration:null,properties:null,debugLogs:null},this.reportedDone=!1}t.prototype.addExpectationResult=function(t,n,i){const r=e.buildExpectationResult(n);if(t)this.result.passedExpectations.push(r);else if(this.reportedDone?this.onLateError(r):this.result.failedExpectations.push(r),this.throwOnExpectationFailure&&!i)throw new e.errors.ExpectationFailed},t.prototype.setSpecProperty=function(e,t){this.result.properties=this.result.properties||{},this.result.properties[e]=t},t.prototype.expect=function(e){return this.expectationFactory(e,this)},t.prototype.expectAsync=function(e){return this.asyncExpectationFactory(e,this)},t.prototype.execute=function(t,n,i){var r=this,o={fn:function(e){r.timer.start(),r.onStart(r,e)}},s={fn:function(e){r.autoCleanClosures&&(r.queueableFn.fn=null),r.result.status=r.status(n,i),r.result.duration=r.timer.elapsed(),"failed"!==r.result.status&&(r.result.debugLogs=null),r.resultCallback(r.result,e)},type:"specCleanup"},a=this.beforeAndAfterFns(),c={isLeaf:!0,queueableFns:[...a.befores,this.queueableFn,...a.afters],onException:function(){r.handleException.apply(r,arguments)},onMultipleDone:function(){r.onLateError(new Error("An asynchronous spec, beforeEach, or afterEach function called its 'done' callback more than once.\n(in spec: "+r.getFullName()+")"))},onComplete:function(){"failed"===r.result.status?t(new e.StopExecutionError("spec failed")):t()},userContext:this.userContext(),runnableName:this.getFullName.bind(this)};(this.markedPending||!0===n)&&(c.queueableFns=[]),c.queueableFns.unshift(o),c.queueableFns.push(s),this.queueRunnerFactory(c)},t.prototype.reset=function(){this.result={id:this.id,description:this.description,fullName:this.getFullName(),failedExpectations:[],passedExpectations:[],deprecationWarnings:[],pendingReason:this.excludeMessage,duration:null,properties:null,debugLogs:null},this.markedPending=this.markedExcluding,this.reportedDone=!1},t.prototype.handleException=function(i){t.isPendingSpecException(i)?this.pend(n(i)):i instanceof e.errors.ExpectationFailed||this.addExpectationResult(!1,{matcherName:"",passed:!1,expected:"",actual:"",error:i},!0)},t.prototype.pend=function(e){this.markedPending=!0,e&&(this.result.pendingReason=e)},t.prototype.exclude=function(e){this.markedExcluding=!0,this.message&&(this.excludeMessage=e),this.pend(e)},t.prototype.getResult=function(){return this.result.status=this.status(),this.result},t.prototype.status=function(e,t){return!0===e?"excluded":this.markedPending?"pending":this.result.failedExpectations.length>0||t&&this.result.failedExpectations.length+this.result.passedExpectations.length===0?"failed":"passed"},t.prototype.getFullName=function(){return this.getSpecName(this)},t.prototype.addDeprecationWarning=function(t){"string"==typeof t&&(t={message:t}),this.result.deprecationWarnings.push(e.buildExpectationResult(t))},t.prototype.debugLog=function(e){this.result.debugLogs||(this.result.debugLogs=[]),this.result.debugLogs.push({message:e,timestamp:this.timer.elapsed()})};var n=function(e){var n=e.toString(),i=n.indexOf(t.pendingSpecExceptionMessage)+t.pendingSpecExceptionMessage.length;return n.slice(i)};return t.pendingSpecExceptionMessage="=> marked Pending",t.isPendingSpecException=function(e){return!(!e||!e.toString||-1===e.toString().indexOf(t.pendingSpecExceptionMessage))},Object.defineProperty(t.prototype,"metadata",{get:function(){return this.metadata_||(this.metadata_={id:this.id,description:this.description,getFullName:this.getFullName.bind(this)}),this.metadata_}}),t},getJasmineRequireObj().Order=function(){return function(e){this.random=!("random"in e)||e.random;var t=this.seed=e.seed||String(Math.random()).slice(-5);function n(e){var t,n;for(t=n=0;n<e.length;++n)t+=e.charCodeAt(n),t+=t<<10,t^=t>>6;return t+=t<<3,t^=t>>11,t+=t<<15}this.sort=this.random?function(e){var i=e.slice();return i.sort((function(e,i){return n(t+e.id)-n(t+i.id)})),i}:function(e){return e}}},getJasmineRequireObj().Env=function(e){return function(t){var n=this,i=(t=t||{}).global||e.getGlobal(),r=0,o=i.setTimeout,s=i.clearTimeout,a=e.getClearStack(i);this.clock=new e.Clock(i,(function(){return new e.DelayedFunctionScheduler}),new e.MockDate(i));var c={},l=null,u=[],h=null,d=!1,f={random:!0,seed:null,stopOnSpecFailure:!1,failSpecWithNoExpectations:!1,stopSpecOnExpectationFailure:!1,specFilter:function(){return!0},hideDisabled:!1,autoCleanClosures:!0,verboseDeprecations:!1},p=function(){return u[u.length-1]},g=function(){return l||p()},m=null,y=function(){m||(m=new e.GlobalErrors).install()};t.suppressLoadErrors||(y(),m.pushListener((function(e,t,n,i,r){O.result.failedExpectations.push({passed:!1,globalErrorType:"load",message:e,stack:r&&r.stack,filename:t,lineno:n})}))),this.configure=function(e){["random","failSpecWithNoExpectations","hideDisabled","stopOnSpecFailure","stopSpecOnExpectationFailure","autoCleanClosures"].forEach((function(t){void 0!==e[t]&&(f[t]=!!e[t])})),e.specFilter&&(f.specFilter=e.specFilter),void 0!==e.seed&&(f.seed=e.seed),e.hasOwnProperty("verboseDeprecations")&&(f.verboseDeprecations=e.verboseDeprecations,D.verboseDeprecations(f.verboseDeprecations))},this.configuration=function(){var e={};for(var t in f)e[t]=f[t];return e},this.setDefaultSpyStrategy=function(e){if(!g())throw new Error("Default spy strategy must be set in a before function or a spec");c[g().id].defaultStrategyFn=e},this.addSpyStrategy=function(e,t){if(!g())throw new Error("Custom spy strategies must be added in a before function or a spec");c[g().id].customSpyStrategies[e]=t},this.addCustomEqualityTester=function(e){if(!g())throw new Error("Custom Equalities must be added in a before function or a spec");c[g().id].customEqualityTesters.push(e)},this.addMatchers=function(e){if(!g())throw new Error("Matchers must be added in a before function or a spec");var t=c[g().id].customMatchers;for(var n in e)t[n]=e[n]},this.addAsyncMatchers=function(e){if(!g())throw new Error("Async Matchers must be added in a before function or a spec");var t=c[g().id].customAsyncMatchers;for(var n in e)t[n]=e[n]},this.addCustomObjectFormatter=function(e){if(!g())throw new Error("Custom object formatters must be added in a before function or a spec");c[g().id].customObjectFormatters.push(e)},e.Expectation.addCoreMatchers(e.matchers),e.Expectation.addAsyncCoreMatchers(e.asyncMatchers);var x=0,b=0,v=function(){return"suite"+b++},w=function(){var t=c[g().id].customObjectFormatters;return e.makePrettyPrinter(t)},_=function(){const t=g();if(t){const n=c[t.id].customEqualityTesters;return new e.MatchersUtil({customTesters:n,pp:w()})}return new e.MatchersUtil({pp:e.basicPrettyPrinter_})};const S=function(t,n){return e.Expectation.factory({matchersUtil:_(),customMatchers:c[n.id].customMatchers,actual:t,addExpectationResult:function(e,t){return n.addExpectationResult(e,t)}})};function C(t){!function(e){for(let t=g();t;t=t.parentSuite)if(!t.reportedDone)return t===O&&(e.globalErrorType="lateError"),void t.result.failedExpectations.push(e);console.error("Jasmine received a result after the suite finished:"),console.error(e)}(void 0!==t.matcherName&&void 0!==t.passed?t:e.buildExpectationResult({error:t,passed:!1,matcherName:"",expected:"",actual:""}))}const k=function(t,n,i){return e.Expectation.asyncFactory({matchersUtil:_(),customAsyncMatchers:c[n.id].customAsyncMatchers,actual:t,addExpectationResult:function(e,t){g()!==n&&function(e,t,n){var i={};Object.keys(n).forEach((function(e){i[e]=n[e]})),i.passed=!1,i.globalErrorType="lateExpectation",i.message=t+' "'+e.getFullName()+'" ran a "'+n.matcherName+'" expectation after it finished.\n',n.message&&(i.message+='Message: "'+n.message+'"\n'),i.message+="1. Did you forget to return or await the result of expectAsync?\n2. Was done() invoked before an async operation completed?\n3. Did an expectation follow a call to done()?",O.result.failedExpectations.push(i)}(n,i,t);return n.addExpectationResult(e,t)}})},M=function(e,t){return k(e,t,"Suite")},E=function(e,t){return k(e,t,"Spec")};var T=function(t,n){var i={spies:[],customEqualityTesters:[],customMatchers:{},customAsyncMatchers:{},customSpyStrategies:{},defaultStrategyFn:void 0,customObjectFormatters:[]};c[n]&&(i.customEqualityTesters=e.util.clone(c[n].customEqualityTesters),i.customMatchers=e.util.clone(c[n].customMatchers),i.customAsyncMatchers=e.util.clone(c[n].customAsyncMatchers),i.customObjectFormatters=e.util.clone(c[n].customObjectFormatters),i.customSpyStrategies=e.util.clone(c[n].customSpyStrategies),i.defaultStrategyFn=c[n].defaultStrategyFn),c[t]=i},P=function(e){N.clearSpies(),delete c[e]};this.deprecated=function(e,t){var n=g()||O;D.addDeprecationWarning(n,e,t)};var A=function(t,i){t.isLeaf?t.SkipPolicy=e.CompleteOnFirstErrorSkipPolicy:t.isReporter?t.SkipPolicy=e.NeverSkipPolicy:f.stopOnSpecFailure?t.SkipPolicy=e.CompleteOnFirstErrorSkipPolicy:t.SkipPolicy=e.SkipAfterBeforeAllErrorPolicy,t.clearStack=t.clearStack||a,t.timeout={setTimeout:o,clearTimeout:s},t.fail=n.fail,t.globalErrors=m,t.onException=t.onException||function(e){(g()||O).handleException(e)},t.deprecated=n.deprecated,new e.QueueRunner(t).execute(i)},O=new e.Suite({id:v(),description:"Jasmine__TopLevel__Suite",expectationFactory:S,asyncExpectationFactory:M,autoCleanClosures:f.autoCleanClosures,onLateError:C}),D=new e.Deprecator(O);h=O,this.topSuite=function(){return O.metadata};var R=new e.ReportDispatcher(["jasmineStarted","jasmineDone","suiteStarted","suiteDone","specStarted","specDone"],A,C);this.execute=function(t,n){this._executedBefore&&O.reset(),this._executedBefore=!0,T(O.id),y(),t||(t=B.length?B:[O.id]);var i=new e.Order({random:f.random,seed:f.seed}),o=new e.TreeProcessor({tree:O,runnableIds:t,queueRunnerFactory:A,failSpecWithNoExpectations:f.failSpecWithNoExpectations,nodeStart:function(e,t){u.push(e),T(e.id,e.parentSuite.id),R.suiteStarted(e.result,t),e.startTimer()},nodeComplete:function(e,t,n){if(e!==p())throw new Error("Tried to complete the wrong suite");P(e.id),u.pop(),"failed"===t.status&&(d=!0),e.endTimer(),e.hadBeforeAllFailure?a(e).then((function(){W(e,t,n)})):W(e,t,n)},orderChildren:function(e){return i.sort(e.children)},excludeNode:function(e){return!f.specFilter(e)}});if(!o.processTree().valid)throw new Error("Invalid order: would cause a beforeAll or afterAll to be run multiple times");var s=new e.Timer;return s.start(),new Promise((function(e){var t;t=function(t){n&&n(),e(t)},R.jasmineStarted({totalSpecsDefined:r,order:i},(function(){u.push(O),o.execute((function(){!async function(){var e,n;O.hadBeforeAllFailure&&await a(O),P(O.id),u.pop(),d||O.result.failedExpectations.length>0?e="failed":B.length>0?(e="incomplete",n="fit() or fdescribe() was found"):0===r?(e="incomplete",n="No specs found"):e="passed";const o={overallStatus:e,totalTime:s.elapsed(),incompleteReason:n,order:i,failedExpectations:O.result.failedExpectations,deprecationWarnings:O.result.deprecationWarnings};O.reportedDone=!0,R.jasmineDone(o,(function(){t(o)}))}()}))}))}));async function a(t){for(const n of t.children)n instanceof e.Suite?(await new Promise((function(e){R.suiteStarted(n.result,e)})),await a(n),n.result.status="passed",await new Promise((function(e){R.suiteDone(n.result,e)}))):(await new Promise((function(e){R.specStarted(n.result,e)})),n.addExpectationResult(!1,{passed:!1,message:"Not run because a beforeAll function failed. The beforeAll failure will be reported on the suite that caused it."},!0),n.result.status="failed",await new Promise((function(e){V(n,n.result,e)})))}},this.addReporter=function(e){R.addReporter(e)},this.provideFallbackReporter=function(e){R.provideFallbackReporter(e)},this.clearReporters=function(){R.clearReporters()};var L=new e.SpyFactory((function(){var e=g();return e?c[e.id].customSpyStrategies:{}}),(function(){var e=g();if(e)return c[e.id].defaultStrategyFn}),_),N=new e.SpyRegistry({currentSpies:function(){if(!g())throw new Error("Spies must be created in a before function or a spec");return c[g().id].spies},createSpy:function(e,t){return n.createSpy(e,t)}});this.allowRespy=function(e){N.allowRespy(e)},this.spyOn=function(){return N.spyOn.apply(N,arguments)},this.spyOnProperty=function(){return N.spyOnProperty.apply(N,arguments)},this.spyOnAllFunctions=function(){return N.spyOnAllFunctions.apply(N,arguments)},this.createSpy=function(t,n){return 1===arguments.length&&e.isFunction_(t)&&(t=(n=t).name),L.createSpy(t,n)},this.createSpyObj=function(e,t,n){return L.createSpyObj(e,t,n)};var F=function(t,n){if(!e.isFunction_(t))throw new Error(n+" expects a function argument; received "+e.getType_(t))},j=function(t,n){if(!e.isFunction_(t)&&!e.isAsyncFunction_(t))throw new Error(n+" expects a function argument; received "+e.getType_(t))};function I(e){var t=g();if(null!=t)throw new Error("'"+e+"' should only be used in 'describe' function")}var q=function(t){return new e.Suite({id:v(),description:t,parentSuite:h,timer:new e.Timer,expectationFactory:S,asyncExpectationFactory:M,throwOnExpectationFailure:f.stopSpecOnExpectationFailure,autoCleanClosures:f.autoCleanClosures,onLateError:C})};this.describe=function(e,t){I("describe"),F(t,"describe");var n=q(e);if(t.length>0)throw new Error("describe does not expect any arguments");if(h.markedExcluding&&n.exclude(),z(n,t),n.parentSuite&&!n.children.length)throw new Error("describe with no children (describe() or it()): "+n.getFullName());return n.metadata},this.xdescribe=function(e,t){I("xdescribe"),F(t,"xdescribe");var n=q(e);return n.exclude(),z(n,t),n.metadata};var B=[];function z(e,t){var n=h;n.addChild(e),h=e;var i=null;try{t()}catch(e){i=e}i&&e.handleException(i),h=n}function G(){var e=function(e){for(;e;){if(e.isFocused)return e.id;e=e.parentSuite}return null}(h);if(e)for(var t=0;t<B.length;t++)if(B[t]===e){B.splice(t,1);break}}this.fdescribe=function(e,t){I("fdescribe"),F(t,"fdescribe");var n=q(e);return n.isFocused=!0,B.push(n.id),G(),z(n,t),n.metadata};var H=function(t,n,i,o){r++;var s,a=new e.Spec({id:"spec"+x++,beforeAndAfterFns:(s=i,function(){for(var e=[],t=[],n=s;n;)e=e.concat(n.beforeFns),t=t.concat(n.afterFns),n=n.parentSuite;return{befores:e.reverse(),afters:t}}),expectationFactory:S,asyncExpectationFactory:E,onLateError:C,resultCallback:function(e,t){P(a.id),l=null,"failed"===e.status&&(d=!0);V(a,e,t)},getSpecName:function(e){return function(e,t){var n=[e.description],i=t.getFullName();return""!==i&&n.unshift(i),n.join(" ")}(e,i)},onStart:function(e,t){l=e,T(e.id,i.id),R.specStarted(e.result,t)},description:t,queueRunnerFactory:A,userContext:function(){return i.clonedSharedUserContext()},queueableFn:{fn:n,timeout:o||0},throwOnExpectationFailure:f.stopSpecOnExpectationFailure,autoCleanClosures:f.autoCleanClosures,timer:new e.Timer});return a};function V(e,t,n){e.reportedDone=!0,R.specDone(t,n)}function W(e,t,n){e.reportedDone=!0,R.suiteDone(t,n)}this.it_=function(t,n,i){I("it"),arguments.length>1&&void 0!==n&&j(n,"it"),i&&e.util.validateTimeout(i);var r=H(t,n,h,i);return h.markedExcluding&&r.exclude(),h.addChild(r),r},this.it=function(e,t,n){return this.it_(e,t,n).metadata},this.xit=function(e,t,n){I("xit"),arguments.length>1&&void 0!==t&&j(t,"xit");var i=this.it_.apply(this,arguments);return i.exclude("Temporarily disabled with xit"),i.metadata},this.fit=function(t,n,i){I("fit"),j(n,"fit"),i&&e.util.validateTimeout(i);var r=H(t,n,h,i);return h.addChild(r),B.push(r.id),G(),r.metadata},this.setSpecProperty=function(e,t){if(!g()||g()==p())throw new Error("'setSpecProperty' was used when there was no current spec");g().setSpecProperty(e,t)},this.setSuiteProperty=function(e,t){if(!p())throw new Error("'setSuiteProperty' was used when there was no current suite");p().setSuiteProperty(e,t)},this.debugLog=function(e){var t=g();if(!t||!t.debugLog)throw new Error("'debugLog' was called when there was no current spec");t.debugLog(e)},this.expect=function(e){if(!g())throw new Error("'expect' was used when there was no current spec, this could be because an asynchronous test timed out");return g().expect(e)},this.expectAsync=function(e){if(!g())throw new Error("'expectAsync' was used when there was no current spec, this could be because an asynchronous test timed out");return g().expectAsync(e)},this.beforeEach=function(t,n){I("beforeEach"),j(t,"beforeEach"),n&&e.util.validateTimeout(n),h.beforeEach({fn:t,timeout:n||0})},this.beforeAll=function(t,n){I("beforeAll"),j(t,"beforeAll"),n&&e.util.validateTimeout(n),h.beforeAll({fn:t,timeout:n||0})},this.afterEach=function(t,n){I("afterEach"),j(t,"afterEach"),n&&e.util.validateTimeout(n),t.isCleanup=!0,h.afterEach({fn:t,timeout:n||0})},this.afterAll=function(t,n){I("afterAll"),j(t,"afterAll"),n&&e.util.validateTimeout(n),h.afterAll({fn:t,timeout:n||0})},this.pending=function(t){var n=e.Spec.pendingSpecExceptionMessage;throw t&&(n+=t),n},this.fail=function(t){if(!g())throw new Error("'fail' was used when there was no current spec, this could be because an asynchronous test timed out");var n="Failed";if(t&&(n+=": ",t.message?n+=t.message:e.isString_(t)?n+=t:n+=w()(t)),g().addExpectationResult(!1,{matcherName:"",passed:!1,expected:"",actual:"",message:n,error:t&&t.message?t:null}),f.stopSpecOnExpectationFailure)throw new Error(n)},this.cleanup_=function(){m&&m.uninstall()}}},getJasmineRequireObj().JsApiReporter=function(e){return function(t){var n,i=t.timer||new e.Timer,r="loaded";this.started=!1,this.finished=!1,this.runDetails={},this.jasmineStarted=function(){this.started=!0,r="started",i.start()},this.jasmineDone=function(e){this.finished=!0,this.runDetails=e,n=i.elapsed(),r="done"},this.status=function(){return r};var o=[],s={};this.suiteStarted=function(e){s[e.id]=e},this.suiteDone=function(e){!function(e){o.push(e),s[e.id]=e}(e)},this.suiteResults=function(e,t){return o.slice(e,e+t)},this.suites=function(){return s};var a=[];this.specDone=function(e){a.push(e)},this.specResults=function(e,t){return a.slice(e,e+t)},this.specs=function(){return a},this.executionTime=function(){return n}}},getJasmineRequireObj().Any=function(e){function t(e){if(void 0===e)throw new TypeError("jasmine.any() expects to be passed a constructor function. Please pass one or use jasmine.anything() to match any object.");this.expectedObject=e}return t.prototype.asymmetricMatch=function(e){return this.expectedObject==String?"string"==typeof e||e instanceof String:this.expectedObject==Number?"number"==typeof e||e instanceof Number:this.expectedObject==Function?"function"==typeof e||e instanceof Function:this.expectedObject==Object?null!==e&&"object"==typeof e:this.expectedObject==Boolean?"boolean"==typeof e:"undefined"!=typeof Symbol&&this.expectedObject==Symbol?"symbol"==typeof e:e instanceof this.expectedObject},t.prototype.jasmineToString=function(){return"<jasmine.any("+e.fnNameFor(this.expectedObject)+")>"},t},getJasmineRequireObj().Anything=function(e){function t(){}return t.prototype.asymmetricMatch=function(t){return!e.util.isUndefined(t)&&null!==t},t.prototype.jasmineToString=function(){return"<jasmine.anything>"},t},getJasmineRequireObj().ArrayContaining=function(e){function t(e){this.sample=e}return t.prototype.asymmetricMatch=function(t,n){if(!e.isArray_(this.sample))throw new Error("You must provide an array to arrayContaining, not "+e.basicPrettyPrinter_(this.sample)+".");if(!e.isArray_(t)&&this.sample.length>0)return!1;for(var i=0;i<this.sample.length;i++){var r=this.sample[i];if(!n.contains(t,r))return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.arrayContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().ArrayWithExactContents=function(e){function t(e){this.sample=e}return t.prototype.asymmetricMatch=function(t,n){if(!e.isArray_(this.sample))throw new Error("You must provide an array to arrayWithExactContents, not "+e.basicPrettyPrinter_(this.sample)+".");if(this.sample.length!==t.length)return!1;for(var i=0;i<this.sample.length;i++){var r=this.sample[i];if(!n.contains(t,r))return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.arrayWithExactContents("+e(this.sample)+")>"},t},getJasmineRequireObj().Empty=function(e){function t(){}return t.prototype.asymmetricMatch=function(t){return e.isString_(t)||e.isArray_(t)||e.isTypedArray_(t)?0===t.length:e.isMap(t)||e.isSet(t)?0===t.size:!!e.isObject_(t)&&0===Object.keys(t).length},t.prototype.jasmineToString=function(){return"<jasmine.empty>"},t},getJasmineRequireObj().Falsy=function(e){function t(){}return t.prototype.asymmetricMatch=function(e){return!e},t.prototype.jasmineToString=function(){return"<jasmine.falsy>"},t},getJasmineRequireObj().Is=function(e){return class{constructor(e){this.expected_=e}asymmetricMatch(e){return e===this.expected_}jasmineToString(e){return`<jasmine.is(${e(this.expected_)})>`}}},getJasmineRequireObj().MapContaining=function(e){function t(t){if(!e.isMap(t))throw new Error("You must provide a map to `mapContaining`, not "+e.basicPrettyPrinter_(t));this.sample=t}return t.prototype.asymmetricMatch=function(t,n){if(!e.isMap(t))return!1;for(const[e,r]of this.sample){var i=!1;for(const[o,s]of t)if(n.equals(o,e)&&n.equals(s,r)){i=!0;break}if(!i)return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.mapContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().NotEmpty=function(e){function t(){}return t.prototype.asymmetricMatch=function(t){return e.isString_(t)||e.isArray_(t)||e.isTypedArray_(t)?0!==t.length:e.isMap(t)||e.isSet(t)?0!==t.size:!!e.isObject_(t)&&0!==Object.keys(t).length},t.prototype.jasmineToString=function(){return"<jasmine.notEmpty>"},t},getJasmineRequireObj().ObjectContaining=function(e){function t(e){this.sample=e}function n(e,t){return!(!e||"object"!=typeof e)&&(!!Object.prototype.hasOwnProperty.call(e,t)||n(Object.getPrototypeOf(e),t))}return t.prototype.asymmetricMatch=function(e,t){if("object"!=typeof this.sample)throw new Error("You must provide an object to objectContaining, not '"+this.sample+"'.");if("object"!=typeof e)return!1;for(var i in this.sample)if(!n(e,i)||!t.equals(this.sample[i],e[i]))return!1;return!0},t.prototype.valuesForDiff_=function(t,n){if(!e.isObject_(t))return{self:this.jasmineToString(n),other:t};var i={};return Object.keys(this.sample).forEach((function(e){i[e]=t[e]})),{self:this.sample,other:i}},t.prototype.jasmineToString=function(e){return"<jasmine.objectContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().SetContaining=function(e){function t(t){if(!e.isSet(t))throw new Error("You must provide a set to `setContaining`, not "+e.basicPrettyPrinter_(t));this.sample=t}return t.prototype.asymmetricMatch=function(t,n){if(!e.isSet(t))return!1;for(const e of this.sample){var i=!1;for(const r of t)if(n.equals(r,e)){i=!0;break}if(!i)return!1}return!0},t.prototype.jasmineToString=function(e){return"<jasmine.setContaining("+e(this.sample)+")>"},t},getJasmineRequireObj().StringContaining=function(e){function t(t){if(!e.isString_(t))throw new Error("Expected is not a String");this.expected=t}return t.prototype.asymmetricMatch=function(t){return!!e.isString_(t)&&-1!==t.indexOf(this.expected)},t.prototype.jasmineToString=function(){return'<jasmine.stringContaining("'+this.expected+'")>'},t},getJasmineRequireObj().StringMatching=function(e){function t(t){if(!e.isString_(t)&&!e.isA_("RegExp",t))throw new Error("Expected is not a String or a RegExp");this.regexp=new RegExp(t)}return t.prototype.asymmetricMatch=function(e){return this.regexp.test(e)},t.prototype.jasmineToString=function(){return"<jasmine.stringMatching("+this.regexp+")>"},t},getJasmineRequireObj().Truthy=function(e){function t(){}return t.prototype.asymmetricMatch=function(e){return!!e},t.prototype.jasmineToString=function(){return"<jasmine.truthy>"},t},getJasmineRequireObj().buildExpectationResult=function(e){return function(t){const n=new e.ExceptionFormatter,i={matcherName:t.matcherName,message:r(),stack:t.omitStackTrace?"":function(){if(t.passed)return"";let e=t.error;if(!e)if(t.errorForStack)e=t.errorForStack;else if(t.stack)e=t;else try{throw new Error(r())}catch(t){e=t}return n.stack(e,{omitMessage:!0})}(),passed:t.passed};return i.passed||(i.expected=t.expected,i.actual=t.actual,t.error&&!e.isString_(t.error)&&("code"in t.error&&(i.code=t.error.code),"ERR_ASSERTION"===t.error.code&&""===t.expected&&""===t.actual&&(i.expected=t.error.expected,i.actual=t.error.actual,i.matcherName="assert "+t.error.operator))),i;function r(){return t.passed?"Passed.":t.message?t.message:t.error?n.message(t.error):""}}},getJasmineRequireObj().CallTracker=function(e){return function(){var t=[],n={};this.track=function(i){n.cloneArgs&&(i.args=e.util.cloneArgs(i.args)),t.push(i)},this.any=function(){return!!t.length},this.count=function(){return t.length},this.argsFor=function(e){var n=t[e];return n?n.args:[]},this.thisFor=function(e){var n=t[e];return n?n.object:void 0},this.all=function(){return t},this.allArgs=function(){for(var e=[],n=0;n<t.length;n++)e.push(t[n].args);return e},this.first=function(){return t[0]},this.mostRecent=function(){return t[t.length-1]},this.reset=function(){t=[]},this.saveArgumentsByValue=function(){n.cloneArgs=!0}}},getJasmineRequireObj().clearStack=function(e){return function(t){var n=0,i=t.setTimeout,r=function(e){Function.prototype.apply.apply(i,[t,[e,0]])};if(e.isFunction_(t.setImmediate)){var o=t.setImmediate;return function(e){++n<10?o(e):(n=0,r(e))}}return e.util.isUndefined(t.MessageChannel)?r:function(e,t){var n=new e.MessageChannel,i={},r=i,o=!1;n.port1.onmessage=function(){var t=(i=i.next).task;if(delete i.task,o)e.setTimeout(t,0);else try{o=!0,t()}finally{o=!1}};var s=0;return function(e){++s<10?(r=r.next={task:e},n.port2.postMessage(0)):(s=0,t(e))}}(t,r)}},getJasmineRequireObj().Clock=function(){var e="undefined"!=typeof process&&process.versions&&"string"==typeof process.versions.node;function t(){}return t.prototype.ref=function(){return this},t.prototype.unref=function(){return this},function(n,i,r){var o,s,a=this,c={setTimeout:n.setTimeout,clearTimeout:n.clearTimeout,setInterval:n.setInterval,clearInterval:n.clearInterval},l={setTimeout:function(n,i){if(!e)return o.scheduleFunction(n,i,d(arguments,2));var r=new t;return o.scheduleFunction(n,i,d(arguments,2),!1,r),r},clearTimeout:function(e){return o.removeFunctionWithId(e)},setInterval:function(n,i){if(!e)return o.scheduleFunction(n,i,d(arguments,2),!0);var r=new t;return o.scheduleFunction(n,i,d(arguments,2),!0,r),r},clearInterval:function(e){return o.removeFunctionWithId(e)}},u=!1;return a.FakeTimeout=t,a.install=function(){if(n.setTimeout!==c.setTimeout||n.clearTimeout!==c.clearTimeout||n.setInterval!==c.setInterval||n.clearInterval!==c.clearInterval)throw new Error("Jasmine Clock was unable to install over custom global timer functions. Is the clock already installed?");return h(n,l),s=l,o=i(),u=!0,a},a.uninstall=function(){o=null,r.uninstall(),h(n,c),s=c,u=!1},a.withMock=function(e){this.install();try{e()}finally{this.uninstall()}},a.mockDate=function(e){r.install(e)},a.setTimeout=function(e,t,i){return Function.prototype.apply.apply(s.setTimeout,[n,arguments])},a.setInterval=function(e,t,i){return Function.prototype.apply.apply(s.setInterval,[n,arguments])},a.clearTimeout=function(e){return Function.prototype.call.apply(s.clearTimeout,[n,e])},a.clearInterval=function(e){return Function.prototype.call.apply(s.clearInterval,[n,e])},a.tick=function(e){if(!u)throw new Error("Mock clock is not installed, use jasmine.clock().install()");o.tick(e,(function(e){r.tick(e)}))},a;function h(e,t){for(var n in t)e[n]=t[n]}function d(e,t){return Array.prototype.slice.call(e,t)}}},getJasmineRequireObj().CompleteOnFirstErrorSkipPolicy=function(e){function t(e){this.queueableFns_=e,this.erroredFnIx_=null}function n(e,t){return!!e.parentSuite&&(e.parentSuite===t||n(e.parentSuite,t))}return t.prototype.skipTo=function(e){let t;for(t=e+1;t<this.queueableFns_.length&&this.shouldSkip_(t);t++);return t},t.prototype.fnErrored=function(e){this.erroredFnIx_=e},t.prototype.shouldSkip_=function(e){if(null===this.erroredFnIx_)return!1;const t=this.queueableFns_[e],i=t.suite,r=this.queueableFns_[this.erroredFnIx_].suite;return!("afterEach"===t.type||"afterAll"===t.type||"specCleanup"===t.type)||i&&n(i,r)},t},getJasmineRequireObj().DelayedFunctionScheduler=function(j$){function DelayedFunctionScheduler(){var self=this,scheduledLookup=[],scheduledFunctions={},currentTime=0,delayedFnCount=0,deletedKeys=[];return self.tick=function(e,t){runScheduledFunctions(currentTime+(e=e||0),t)},self.scheduleFunction=function(funcToCall,millis,params,recurring,timeoutKey,runAtMillis){var f;f="string"==typeof funcToCall?function(){return eval(funcToCall)}:funcToCall,millis=millis||0,timeoutKey=timeoutKey||++delayedFnCount,runAtMillis=runAtMillis||currentTime+millis;var funcToSchedule={runAtMillis:runAtMillis,funcToCall:f,recurring:recurring,params:params,timeoutKey:timeoutKey,millis:millis};return runAtMillis in scheduledFunctions?scheduledFunctions[runAtMillis].push(funcToSchedule):(scheduledFunctions[runAtMillis]=[funcToSchedule],scheduledLookup.push(runAtMillis),scheduledLookup.sort((function(e,t){return e-t}))),timeoutKey},self.removeFunctionWithId=function(e){for(var t in deletedKeys.push(e),scheduledFunctions){var n=scheduledFunctions[t],i=indexOfFirstToPass(n,(function(t){return t.timeoutKey===e}));if(i>-1){1===n.length?(delete scheduledFunctions[t],deleteFromLookup(t)):n.splice(i,1);break}}},self;function indexOfFirstToPass(e,t){for(var n=-1,i=0;i<e.length;++i)if(t(e[i])){n=i;break}return n}function deleteFromLookup(e){var t=Number(e),n=indexOfFirstToPass(scheduledLookup,(function(e){return e===t}));n>-1&&scheduledLookup.splice(n,1)}function reschedule(e){self.scheduleFunction(e.funcToCall,e.millis,e.params,!0,e.timeoutKey,e.runAtMillis+e.millis)}function forEachFunction(e,t){for(var n=0;n<e.length;++n)t(e[n])}function runScheduledFunctions(e,t){if(t=t||function(){},0===scheduledLookup.length||scheduledLookup[0]>e)e>=currentTime&&(t(e-currentTime),currentTime=e);else{do{deletedKeys=[];var n=scheduledLookup.shift();n>=currentTime&&(t(n-currentTime),currentTime=n);var i=scheduledFunctions[currentTime];delete scheduledFunctions[currentTime],forEachFunction(i,(function(e){e.recurring&&reschedule(e)})),forEachFunction(i,(function(e){j$.util.arrayContains(deletedKeys,e.timeoutKey)||e.funcToCall.apply(null,e.params||[])})),deletedKeys=[]}while(scheduledLookup.length>0&&currentTime!==e&&scheduledLookup[0]<=e);e>=currentTime&&(t(e-currentTime),currentTime=e)}}}return DelayedFunctionScheduler},getJasmineRequireObj().Deprecator=function(e){function t(e){this.topSuite_=e,this.verbose_=!1,this.toSuppress_=[]}var n="Note: This message will be shown only once. Set the verboseDeprecations config property to true to see every occurrence.";return t.prototype.verboseDeprecations=function(e){this.verbose_=e},t.prototype.addDeprecationWarning=function(t,n,i){if(i=i||{},!this.verbose_&&!e.isError_(n)){if(-1!==this.toSuppress_.indexOf(n))return;this.toSuppress_.push(n)}this.log_(t,n,i),this.report_(t,n,i)},t.prototype.log_=function(t,i,r){var o;e.isError_(i)?console.error(i):(o=t===this.topSuite_||r.ignoreRunnable?"":t.children?" (in suite: "+t.getFullName()+")":" (in spec: "+t.getFullName()+")",r.omitStackTrace||(o+="\n"+this.stackTrace_()),this.verbose_||(o+="\n"+n),console.error("DEPRECATION: "+i+o))},t.prototype.stackTrace_=function(){return(new e.ExceptionFormatter).stack(e.util.errorWithStack()).replace(/^Error\n/m,"")},t.prototype.report_=function(t,i,r){r.ignoreRunnable&&(t=this.topSuite_),e.isError_(i)?t.addDeprecationWarning(i):(this.verbose_||(i+="\n"+n),t.addDeprecationWarning({message:i,omitStackTrace:r.omitStackTrace||!1}))},t},getJasmineRequireObj().errors=function(){function e(){}return e.prototype=new Error,e.prototype.constructor=e,{ExpectationFailed:e}},getJasmineRequireObj().ExceptionFormatter=function(e){const t=["name","message","stack","fileName","sourceURL","line","lineNumber","column","description","jasmineMessage"];return function(n){const i=n&&n.jasmineFile||e.util.jasmineFile();this.message=function(e){let t="";return e.jasmineMessage?t+=e.jasmineMessage:e.name&&e.message?t+=e.name+": "+e.message:e.message?t+=e.message:t+=e.toString()+" thrown",(e.fileName||e.sourceURL)&&(t+=" in "+(e.fileName||e.sourceURL)),(e.line||e.lineNumber)&&(t+=" (line "+(e.line||e.lineNumber)+")"),t},this.stack=function(n,{omitMessage:r}={}){if(!n||!n.stack)return null;const o=new e.StackTrace(n),s=function(e){const t=[],n="webkit"===e.style?"<Jasmine>":"    at <Jasmine>";return e.frames.forEach((function(e){e.file!==i?t.push(e.raw):t[t.length-1]!==n&&t.push(n)})),t}(o);let a="";return o.message&&!r&&s.unshift(o.message),a+=function(n){if(!(n instanceof Object))return;const i={};let r=!0;for(const o in n)e.util.arrayContains(t,o)||(i[o]=n[o],r=!1);if(!r)return"error properties: "+e.basicPrettyPrinter_(i)+"\n";return""}(n),a+=s.join("\n"),a}}},getJasmineRequireObj().Expectation=function(e){function t(t){this.expector=new e.Expector(t);const n=t.customMatchers||{};for(const e in n)this[e]=i(e,n[e])}function n(t){this.expector=new e.Expector(t);const n=t.customAsyncMatchers||{};for(const e in n)this[e]=r(e,n[e])}function i(e,t){return function(){const n=this.expector.compare(e,t,arguments);this.expector.processResult(n)}}function r(t,n){return function(){const i=e.util.errorWithStack();return this.expector.compare(t,n,arguments).then((e=>{this.expector.processResult(e,i)}))}}function o(e,t,n){for(const i in t){const r=t[i];e[i]=n(i,r)}}function s(e,t){const n=Object.create(e);return n.expector=e.expector.addFilter(t),n}function a(t,n,i,r){return t.message?e.isFunction_(t.message)?t.message():t.message:((i=i.slice()).unshift(!0),i.unshift(n),r.buildFailureMessage.apply(r,i))}function c(e){return e.pass=!e.pass,e}t.prototype.withContext=function(e){return s(this,new d(e))},Object.defineProperty(t.prototype,"not",{get:function(){return s(this,l)}}),n.prototype.withContext=function(e){return s(this,new d(e))},Object.defineProperty(n.prototype,"not",{get:function(){return s(this,u)}}),Object.defineProperty(n.prototype,"already",{get:function(){return s(this,h)}});const l={selectComparisonFunc:function(e){return e.negativeCompare||function(){return c(e.compare.apply(null,arguments))}},buildFailureMessage:a},u={selectComparisonFunc:function(e){return e.negativeCompare||function(){return e.compare.apply(this,arguments).then(c)}},buildFailureMessage:a},h={selectComparisonFunc:function(t){return function(n){const i=arguments;return e.isPending_(n).then((function(e){return e?{pass:!1,message:"Expected a promise to be settled (via expectAsync(...).already) but it was pending."}:t.compare.apply(null,i)}))}}};function d(e){this.message=e}return d.prototype.modifyFailureMessage=function(e){return-1===e.indexOf("\n")?this.message+": "+e:this.message+":\n"+e.replace(/^/gm,"    ")},{factory:function(e){return new t(e||{})},addCoreMatchers:function(e){o(t.prototype,e,i)},asyncFactory:function(e){return new n(e||{})},addAsyncCoreMatchers:function(e){o(n.prototype,e,r)}}},getJasmineRequireObj().ExpectationFilterChain=function(){function e(e,t){this.filter_=e,this.prev_=t}return e.prototype.addFilter=function(t){return new e(t,this)},e.prototype.selectComparisonFunc=function(e){return this.callFirst_("selectComparisonFunc",arguments).result},e.prototype.buildFailureMessage=function(e,t,n,i){return this.callFirst_("buildFailureMessage",arguments).result},e.prototype.modifyFailureMessage=function(e){var t=this.callFirst_("modifyFailureMessage",arguments).result;return t||e},e.prototype.callFirst_=function(e,t){var n;return this.prev_&&(n=this.prev_.callFirst_(e,t)).found?n:this.filter_&&this.filter_[e]?{found:!0,result:this.filter_[e].apply(this.filter_,t)}:{found:!1}},e},getJasmineRequireObj().Expector=function(e){function t(t){this.matchersUtil=t.matchersUtil||{buildFailureMessage:function(){}},this.actual=t.actual,this.addExpectationResult=t.addExpectationResult||function(){},this.filters=new e.ExpectationFilterChain}return t.prototype.instantiateMatcher=function(e,t,n){this.matcherName=e,this.args=Array.prototype.slice.call(n,0),this.expected=this.args.slice(0),this.args.unshift(this.actual);var i=t(this.matchersUtil);return this.filters.selectComparisonFunc(i)||i.compare},t.prototype.buildMessage=function(t){var n=this;if(t.pass)return"";var i=this.filters.buildFailureMessage(t,this.matcherName,this.args,this.matchersUtil,r);return this.filters.modifyFailureMessage(i||r());function r(){if(t.message)return e.isFunction_(t.message)?t.message():t.message;var i=n.args.slice();return i.unshift(!1),i.unshift(n.matcherName),n.matchersUtil.buildFailureMessage.apply(n.matchersUtil,i)}},t.prototype.compare=function(e,t,n){return this.instantiateMatcher(e,t,n).apply(null,this.args)},t.prototype.addFilter=function(e){var t=Object.create(this);return t.filters=this.filters.addFilter(e),t},t.prototype.processResult=function(e,t){var n=this.buildMessage(e);1===this.expected.length&&(this.expected=this.expected[0]),this.addExpectationResult(e.pass,{matcherName:this.matcherName,passed:e.pass,message:n,error:t?void 0:e.error,errorForStack:t||void 0,actual:this.actual,expected:this.expected})},t},getJasmineRequireObj().formatErrorMsg=function(){return function(e,t){var n=t?"\nUsage: "+t:"";return function(t){return e+" : "+t+n}}},getJasmineRequireObj().GlobalErrors=function(e){return function(t){var n=[];t=t||e.getGlobal();var i=function(){var e=n[n.length-1];if(!e)throw arguments[0];e.apply(null,Array.prototype.slice.call(arguments,0))};this.originalHandlers={},this.jasmineHandlers={},this.installOne_=function(i,r){function o(t){var o;e.isError_(t)?t.jasmineMessage=r+": "+t:(o=t?r+": "+t:r+" with no error or message","unhandledRejection"===i&&(o+="\n(Tip: to get a useful stack trace, use Promise.reject(new Error(...)) instead of Promise.reject("+(t?"...":"")+").)"),t=new Error(o));var s=n[n.length-1];if(!s)throw t;s(t)}this.originalHandlers[i]=t.process.listeners(i),this.jasmineHandlers[i]=o,t.process.removeAllListeners(i),t.process.on(i,o),this.uninstall=function(){for(var e=Object.keys(this.originalHandlers),n=0;n<e.length;n++){var i=e[n];t.process.removeListener(i,this.jasmineHandlers[i]);for(var r=0;r<this.originalHandlers[i].length;r++)t.process.on(i,this.originalHandlers[i][r]);delete this.originalHandlers[i],delete this.jasmineHandlers[i]}}},this.install=function(){if(t.process&&t.process.listeners&&e.isFunction_(t.process.on))this.installOne_("uncaughtException","Uncaught exception"),this.installOne_("unhandledRejection","Unhandled promise rejection");else{var n=t.onerror;t.onerror=i;var r=function(n){e.isError_(n.reason)?(n.reason.jasmineMessage="Unhandled promise rejection: "+n.reason,t.onerror(n.reason)):t.onerror("Unhandled promise rejection: "+n.reason)};t.addEventListener&&t.addEventListener("unhandledrejection",r),this.uninstall=function(){t.onerror=n,t.removeEventListener&&t.removeEventListener("unhandledrejection",r)}}},this.pushListener=function(e){n.push(e)},this.popListener=function(e){if(!e)throw new Error("popListener expects a listener");n.pop()}}},getJasmineRequireObj().toBePending=function(e){return function(){return{compare:function(t){if(!e.isPromiseLike(t))throw new Error("Expected toBePending to be called on a promise.");var n={};return Promise.race([t,Promise.resolve(n)]).then((function(e){return{pass:n===e}}),(function(){return{pass:!1}}))}}}},getJasmineRequireObj().toBeRejected=function(e){return function(){return{compare:function(t){if(!e.isPromiseLike(t))throw new Error("Expected toBeRejected to be called on a promise.");return t.then((function(){return{pass:!1}}),(function(){return{pass:!0}}))}}}},getJasmineRequireObj().toBeRejectedWith=function(e){return function(t){return{compare:function(n,i){if(!e.isPromiseLike(n))throw new Error("Expected toBeRejectedWith to be called on a promise.");function r(e){return"Expected a promise "+(e?"not ":"")+"to be rejected with "+t.pp(i)}return n.then((function(){return{pass:!1,message:r(!1)+" but it was resolved."}}),(function(e){return t.equals(e,i)?{pass:!0,message:r(!0)+"."}:{pass:!1,message:r(!1)+" but it was rejected with "+t.pp(e)+"."}}))}}}},getJasmineRequireObj().toBeRejectedWithError=function(e){return function(i){return{compare:function(r,o,s){if(!e.isPromiseLike(r))throw new Error("Expected toBeRejectedWithError to be called on a promise.");var a=function(t,n,i){var r,o;s=t,"function"!=typeof s||s!==Error&&!e.isError_(s.prototype)?(r=Error,o=t):(r=t,o=n);var s;return{error:r,message:o,printValue:e.fnNameFor(r)+(void 0===o?"":": "+i.pp(o))}}(o,s,i);return r.then((function(){return{pass:!1,message:"Expected a promise to be rejected but it was resolved."}}),(function(r){return function(i,r,o){if(!e.isError_(i))return n(r,"rejected with "+o.pp(i));if(!(i instanceof r.error))return n(r,"rejected with type "+e.fnNameFor(i.constructor));var s=i.message;if(s===r.message||void 0===r.message)return t(r);if(r.message instanceof RegExp&&r.message.test(s))return t(r);return n(r,"rejected with "+o.pp(i))}(r,a,i)}))}}};function t(e){return{pass:!0,message:"Expected a promise not to be rejected with "+e.printValue+", but it was."}}function n(e,t){return{pass:!1,message:"Expected a promise to be rejected with "+e.printValue+" but it was "+t+"."}}},getJasmineRequireObj().toBeResolved=function(e){return function(t){return{compare:function(n){if(!e.isPromiseLike(n))throw new Error("Expected toBeResolved to be called on a promise.");return n.then((function(){return{pass:!0}}),(function(e){return{pass:!1,message:"Expected a promise to be resolved but it was rejected with "+t.pp(e)+"."}}))}}}},getJasmineRequireObj().toBeResolvedTo=function(e){return function(t){return{compare:function(n,i){if(!e.isPromiseLike(n))throw new Error("Expected toBeResolvedTo to be called on a promise.");function r(e){return"Expected a promise "+(e?"not ":"")+"to be resolved to "+t.pp(i)}return n.then((function(e){return t.equals(e,i)?{pass:!0,message:r(!0)+"."}:{pass:!1,message:r(!1)+" but it was resolved to "+t.pp(e)+"."}}),(function(e){return{pass:!1,message:r(!1)+" but it was rejected with "+t.pp(e)+"."}}))}}}},getJasmineRequireObj().DiffBuilder=function(e){function t(e,t,n){return"Expected "+n+(n.depth()?" = ":"")+e+" to equal "+t+"."}return class{constructor(t){this.prettyPrinter_=(t||{}).prettyPrinter||e.makePrettyPrinter(),this.mismatches_=new e.MismatchTree,this.path_=new e.ObjectPath,this.actualRoot_=void 0,this.expectedRoot_=void 0}setRoots(e,t){this.actualRoot_=e,this.expectedRoot_=t}recordMismatch(e){this.mismatches_.add(this.path_,e)}getMessage(){const n=[];return this.mismatches_.traverse(((i,r,o)=>{const{actual:s,expected:a}=this.dereferencePath_(i);if(o)return n.push(o(s,a,i,this.prettyPrinter_)),!0;const c=this.prettyPrinter_.customFormat_(s),l=this.prettyPrinter_.customFormat_(a);return e.util.isUndefined(c)&&e.util.isUndefined(l)?(r&&n.push(this.defaultFormatter_(s,a,i)),!0):(n.push(t(c,l,i)),!1)})),n.join("\n")}withPath(e,t){const n=this.path_;this.path_=this.path_.add(e),t(),this.path_=n}dereferencePath_(t){let n=this.actualRoot_,i=this.expectedRoot_;const r=()=>{if(e.isAsymmetricEqualityTester_(i)&&e.isFunction_(i.valuesForDiff_)){const e=i.valuesForDiff_(n,this.prettyPrinter_);i=e.self,n=e.other}};r();for(const e of t.components)n=n[e],i=i[e],r();return{actual:n,expected:i}}defaultFormatter_(e,n,i){return t(this.prettyPrinter_(e),this.prettyPrinter_(n),i)}}},getJasmineRequireObj().MatchersUtil=function(e){function t(e){e=e||{},this.customTesters_=e.customTesters||[],this.pp=e.pp||function(){}}function n(e){return"function"==typeof e}function i(n,i){return t.keys(n).filter((t=>!e.util.has(i,t))).map((e=>[e,n[e]]))}function r(e,t,n,r){var o=i(n,t),s=i(t,n),c=a(e,o),l=a(e,s),u=[];return r.depth()||(r="object"),c.length&&u.push("Expected "+r+" to have properties"+c),l.length&&u.push("Expected "+r+" not to have properties"+l),u.join("\n")}function o(t,n,i,r){return r.depth()||(r="object"),"Expected "+r+" to be a kind of "+e.fnNameFor(i.constructor)+", but was "+t(n)+"."}function s(e,t,n,i){return"Unexpected "+i+(i.depth()?" = ":"")+e(t)+" in array."}function a(e,t){let n="";for(const[i,r]of t)n+="\n    "+i.toString()+": "+e(r);return n}return t.prototype.contains=function(t,n){if(!t)return!1;if(e.isSet(t)&&t.has(n))return!0;if(e.isIterable_(t)&&!e.isString_(t)){for(const e of t)if(this.equals(e,n))return!0;return!1}if(t.indexOf)return t.indexOf(n)>=0;if(e.isNumber_(t.length))for(var i=0;i<t.length;i++)if(this.equals(t[i],n))return!0;return!1},t.prototype.buildFailureMessage=function(){var e=this,t=Array.prototype.slice.call(arguments,0),n=t[0],i=t[1],r=t[2],o=t.slice(3),s=n.replace(/[A-Z]/g,(function(e){return" "+e.toLowerCase()})),a="Expected "+e.pp(r)+(i?" not ":" ")+s;if(o.length>0)for(var c=0;c<o.length;c++)c>0&&(a+=","),a+=" "+e.pp(o[c]);return a+"."},t.prototype.asymmetricDiff_=function(t,n,i,r,o){if(e.isFunction_(n.valuesForDiff_)){var s=n.valuesForDiff_(t,this.pp);this.eq_(s.other,s.self,i,r,o)}else o.recordMismatch()},t.prototype.asymmetricMatch_=function(t,n,i,r,o){var s,a=e.isAsymmetricEqualityTester_(t),c=e.isAsymmetricEqualityTester_(n);if(a!==c)return a?((s=t.asymmetricMatch(n,this))||o.recordMismatch(),s):c?((s=n.asymmetricMatch(t,this))||this.asymmetricDiff_(t,n,i,r,o),s):void 0},t.prototype.equals=function(t,n,i){return(i=i||e.NullDiffBuilder()).setRoots(t,n),this.eq_(t,n,[],[],i)},t.prototype.eq_=function(i,a,c,l,u){var h,d=!0,f=this,p=this.asymmetricMatch_(i,a,c,l,u);if(!e.util.isUndefined(p))return p;for(h=0;h<this.customTesters_.length;h++){var g=this.customTesters_[h](i,a);if(!e.util.isUndefined(g))return g||u.recordMismatch(),g}if(i instanceof Error&&a instanceof Error)return(d=i.message==a.message)||u.recordMismatch(),d;if(i===a)return(d=0!==i||1/i==1/a)||u.recordMismatch(),d;if(null===i||null===a)return(d=i===a)||u.recordMismatch(),d;var m=Object.prototype.toString.call(i);if(m!=Object.prototype.toString.call(a))return u.recordMismatch(),!1;switch(m){case"[object String]":return(d=i==String(a))||u.recordMismatch(),d;case"[object Number]":return(d=i!=+i?a!=+a:0===i&&0===a?1/i==1/a:i==+a)||u.recordMismatch(),d;case"[object Date]":case"[object Boolean]":return(d=+i==+a)||u.recordMismatch(),d;case"[object ArrayBuffer]":return f.eq_(new Uint8Array(i),new Uint8Array(a),c,l,u);case"[object RegExp]":return i.source==a.source&&i.global==a.global&&i.multiline==a.multiline&&i.ignoreCase==a.ignoreCase}if("object"!=typeof i||"object"!=typeof a)return u.recordMismatch(),!1;var y=e.isDomNode(i),x=e.isDomNode(a);if(y&&x)return(d=i.isEqualNode(a))||u.recordMismatch(),d;if(y||x)return u.recordMismatch(),!1;var b=e.isPromise(i),v=e.isPromise(a);if(b&&v)return i===a;for(var w=c.length;w--;)if(c[w]==i)return l[w]==a;c.push(i),l.push(a);var _;if("[object Array]"==m){var S=i.length,C=a.length;for(u.withPath("length",(function(){S!==C&&(u.recordMismatch(),d=!1)})),h=0;h<S||h<C;h++)u.withPath(h,(function(){h>=C?(u.recordMismatch(s.bind(null,f.pp)),d=!1):d=f.eq_(h<S?i[h]:void 0,h<C?a[h]:void 0,c,l,u)&&d}));if(!d)return!1}else if(e.isMap(i)&&e.isMap(a)){if(i.size!=a.size)return u.recordMismatch(),!1;var k=[],M=[];i.forEach((function(e,t){k.push(t)})),a.forEach((function(e,t){M.push(t)}));var E,T,P,A,O,D,R=[k,M],L=[M,k];for(h=0;d&&h<R.length;h++){E=R[h],O=L[h];for(var N=0;d&&N<E.length;N++)T=E[N],D=O[N],P=i.get(T),A=e.isAsymmetricEqualityTester_(T)||e.isAsymmetricEqualityTester_(D)&&this.eq_(T,D,c,l,e.NullDiffBuilder())?a.get(D):a.get(T),d=this.eq_(P,A,c,l,e.NullDiffBuilder())}if(!d)return u.recordMismatch(),!1}else if(e.isSet(i)&&e.isSet(a)){if(i.size!=a.size)return u.recordMismatch(),!1;var F=[];i.forEach((function(e){F.push(e)}));var j=[];a.forEach((function(e){j.push(e)}));var I,q,B,z,G,H,V,W,U=[[F,j],[j,F]],$=[[c,l],[l,c]];for(h=0;d&&h<U.length;h++){I=U[h][0],z=U[h][1],B=$[h][0],H=$[h][1];for(var Y=0;d&&Y<I.length;Y++){q=I[Y],V=!1;for(var X=0;!V&&X<z.length;X++)G=z[X],W=B.length,(V=this.eq_(q,G,B,H,e.NullDiffBuilder()))||W===B.length||(B.splice(W),H.splice(W));d=d&&V}}if(!d)return u.recordMismatch(),!1}else{if(e.isURL(i)&&e.isURL(a))return i.toString()===a.toString();var J=i.constructor,K=a.constructor;if(J!==K&&n(J)&&n(K)&&i instanceof J&&a instanceof K&&!(J instanceof J&&K instanceof K))return u.recordMismatch(o.bind(null,this.pp)),!1}var Q,Z=t.keys(i,"[object Array]"==m);if(_=Z.length,t.keys(a,"[object Array]"==m).length!==_)return u.recordMismatch(r.bind(null,this.pp)),!1;for(h=0;h<_;h++)Q=Z[h],e.util.has(a,Q)?u.withPath(Q,(function(){f.eq_(i[Q],a[Q],c,l,u)||(d=!1)})):(u.recordMismatch(r.bind(null,this.pp)),d=!1);return!!d&&(c.pop(),l.pop(),d)},t.keys=function(t,n){var i=function(t){var n=[];for(var i in t)e.util.has(t,i)&&n.push(i);for(var r=Object.getOwnPropertySymbols(t),o=0;o<r.length;o++)t.propertyIsEnumerable(r[o])&&n.push(r[o]);return n}(t);if(!n)return i;if(0===i.length)return i;for(var r=[],o=0;o<i.length;o++)"symbol"!=typeof i[o]&&/^[0-9]+$/.test(i[o])||r.push(i[o]);return r},t},getJasmineRequireObj().MismatchTree=function(e){class t{constructor(t){this.path=t||new e.ObjectPath([]),this.formatter=void 0,this.children=[],this.isMismatch=!1}add(e,n){if(0===e.depth())this.formatter=n,this.isMismatch=!0;else{const i=e.components[0];e=e.shift();let r=this.child(i);r||(r=new t(this.path.add(i)),this.children.push(r)),r.add(e,n)}}traverse(e){const t=this.children.length>0;if((this.isMismatch||t)&&e(this.path,!t,this.formatter))for(const t of this.children)t.traverse(e)}child(e){return this.children.find((t=>{const n=t.path.components;return n[n.length-1]===e}))}}return t},getJasmineRequireObj().nothing=function(){return function(){return{compare:function(){return{pass:!0}}}}},getJasmineRequireObj().NullDiffBuilder=function(e){return function(){return{withPath:function(e,t){t()},setRoots:function(){},recordMismatch:function(){}}}},getJasmineRequireObj().ObjectPath=function(e){class t{constructor(e){this.components=e||[]}toString(){return this.components.length?"$"+this.components.map(n).join(""):""}add(e){return new t(this.components.concat([e]))}shift(){return new t(this.components.slice(1))}depth(){return this.components.length}}function n(e){return"number"==typeof e||"symbol"==typeof e?"["+e.toString()+"]":/^[A-Za-z\$_][A-Za-z0-9\$_]*$/.test(e)?"."+e:`['${e}']`}return t},getJasmineRequireObj().requireAsyncMatchers=function(e,t){for(var n=["toBePending","toBeResolved","toBeRejected","toBeResolvedTo","toBeRejectedWith","toBeRejectedWithError"],i={},r=0;r<n.length;r++){var o=n[r];i[o]=e[o](t)}return i},getJasmineRequireObj().toBe=function(e){return function(e){return{compare:function(t,n){var i={pass:t===n};return"object"==typeof n&&(i.message=e.buildFailureMessage("toBe",i.pass,t,n)+" Tip: To check for deep equality, use .toEqual() instead of .toBe()."),i}}}},getJasmineRequireObj().toBeCloseTo=function(){return function(){return{compare:function(e,t,n){if(0!==n&&(n=n||2),null===t||null===e)throw new Error("Cannot use toBeCloseTo with null. Arguments evaluated to: expect("+e+").toBeCloseTo("+t+").");if(t===1/0||t===-1/0)return{pass:e===t};var i=Math.pow(10,n+1),r=Math.abs(t-e),o=Math.pow(10,-n)/2;return{pass:Math.round(r*i)<=o*i}}}}},getJasmineRequireObj().toBeDefined=function(){return function(){return{compare:function(e){return{pass:void 0!==e}}}}},getJasmineRequireObj().toBeFalse=function(){return function(){return{compare:function(e){return{pass:!1===e}}}}},getJasmineRequireObj().toBeFalsy=function(){return function(){return{compare:function(e){return{pass:!e}}}}},getJasmineRequireObj().toBeGreaterThan=function(){return function(){return{compare:function(e,t){return{pass:e>t}}}}},getJasmineRequireObj().toBeGreaterThanOrEqual=function(){return function(){return{compare:function(e,t){return{pass:e>=t}}}}},getJasmineRequireObj().toBeInstanceOf=function(e){var t=e.formatErrorMsg("<toBeInstanceOf>","expect(value).toBeInstanceOf(<ConstructorFunction>)");return function(n){return{compare:function(i,r){var o,s=i&&i.constructor?e.fnNameFor(i.constructor):n.pp(i),a=r?e.fnNameFor(r):n.pp(r);try{o=new e.Any(r).asymmetricMatch(i)}catch(e){throw new Error(t("Expected value is not a constructor function"))}return o?{pass:!0,message:"Expected instance of "+s+" not to be an instance of "+a}:{pass:!1,message:"Expected instance of "+s+" to be an instance of "+a}}}}},getJasmineRequireObj().toBeLessThan=function(){return function(){return{compare:function(e,t){return{pass:e<t}}}}},getJasmineRequireObj().toBeLessThanOrEqual=function(){return function(){return{compare:function(e,t){return{pass:e<=t}}}}},getJasmineRequireObj().toBeNaN=function(e){return function(e){return{compare:function(t){var n={pass:t!=t};return n.pass?n.message="Expected actual not to be NaN.":n.message=function(){return"Expected "+e.pp(t)+" to be NaN."},n}}}},getJasmineRequireObj().toBeNegativeInfinity=function(e){return function(e){return{compare:function(t){var n={pass:t===Number.NEGATIVE_INFINITY};return n.pass?n.message="Expected actual not to be -Infinity.":n.message=function(){return"Expected "+e.pp(t)+" to be -Infinity."},n}}}},getJasmineRequireObj().toBeNull=function(){return function(){return{compare:function(e){return{pass:null===e}}}}},getJasmineRequireObj().toBePositiveInfinity=function(e){return function(e){return{compare:function(t){var n={pass:t===Number.POSITIVE_INFINITY};return n.pass?n.message="Expected actual not to be Infinity.":n.message=function(){return"Expected "+e.pp(t)+" to be Infinity."},n}}}},getJasmineRequireObj().toBeTrue=function(){return function(){return{compare:function(e){return{pass:!0===e}}}}},getJasmineRequireObj().toBeTruthy=function(){return function(){return{compare:function(e){return{pass:!!e}}}}},getJasmineRequireObj().toBeUndefined=function(){return function(){return{compare:function(e){return{pass:void 0===e}}}}},getJasmineRequireObj().toContain=function(){return function(e){return{compare:function(t,n){return{pass:e.contains(t,n)}}}}},getJasmineRequireObj().toEqual=function(e){return function(t){return{compare:function(n,i){var r={pass:!1},o=new e.DiffBuilder({prettyPrinter:t.pp});return r.pass=t.equals(n,i,o),r.message=o.getMessage(),r}}}},getJasmineRequireObj().toHaveBeenCalled=function(e){var t=e.formatErrorMsg("<toHaveBeenCalled>","expect(<spyObj>).toHaveBeenCalled()");return function(n){return{compare:function(i){var r={};if(!e.isSpy(i))throw new Error(t("Expected a spy, but got "+n.pp(i)+"."));if(arguments.length>1)throw new Error(t("Does not take arguments, use toHaveBeenCalledWith"));return r.pass=i.calls.any(),r.message=r.pass?"Expected spy "+i.and.identity+" not to have been called.":"Expected spy "+i.and.identity+" to have been called.",r}}}},getJasmineRequireObj().toHaveBeenCalledBefore=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledBefore>","expect(<spyObj>).toHaveBeenCalledBefore(<spyObj>)");return function(n){return{compare:function(i,r){if(!e.isSpy(i))throw new Error(t("Expected a spy, but got "+n.pp(i)+"."));if(!e.isSpy(r))throw new Error(t("Expected a spy, but got "+n.pp(r)+"."));var o={pass:!1};if(!i.calls.count())return o.message="Expected spy "+i.and.identity+" to have been called.",o;if(!r.calls.count())return o.message="Expected spy "+r.and.identity+" to have been called.",o;var s=i.calls.mostRecent().invocationOrder,a=r.calls.first().invocationOrder;if(o.pass=s<a,o.pass)o.message="Expected spy "+i.and.identity+" to not have been called before spy "+r.and.identity+", but it was";else{var c=i.calls.first().invocationOrder,l=r.calls.mostRecent().invocationOrder;o.message=c<a?"Expected latest call to spy "+i.and.identity+" to have been called before first call to spy "+r.and.identity+" (no interleaved calls)":l>s?"Expected first call to spy "+r.and.identity+" to have been called after latest call to spy "+i.and.identity+" (no interleaved calls)":"Expected spy "+i.and.identity+" to have been called before spy "+r.and.identity}return o}}}},getJasmineRequireObj().toHaveBeenCalledOnceWith=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledOnceWith>","expect(<spyObj>).toHaveBeenCalledOnceWith(...arguments)");return function(n){return{compare:function(){var i=Array.prototype.slice.call(arguments,0),r=i[0],o=i.slice(1);if(!e.isSpy(r))throw new Error(t("Expected a spy, but got "+n.pp(r)+"."));var s=r.calls.allArgs().map((function(e){return"  "+n.pp(e)}));if(1===r.calls.count()&&n.contains(r.calls.allArgs(),o))return{pass:!0,message:"Expected spy "+r.and.identity+" to have been called 0 times, multiple times, or once, but with arguments different from:\n  "+n.pp(o)+"\nBut the actual call was:\n"+s.join(",\n")+".\n\n"};function a(){return r.calls.allArgs().map((function(t,i){var r=new e.DiffBuilder;return n.equals(t,o,r),r.getMessage()}))}function c(){switch(r.calls.count()){case 0:return"But it was never called.\n\n";case 1:return"But the actual call was:\n"+s.join(",\n")+".\n"+a().join("\n")+"\n\n";default:return"But the actual calls were:\n"+s.join(",\n")+".\n\n"}}return{pass:!1,message:"Expected spy "+r.and.identity+" to have been called only once, and with given args:\n  "+n.pp(o)+"\n"+c()}}}}},getJasmineRequireObj().toHaveBeenCalledTimes=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledTimes>","expect(<spyObj>).toHaveBeenCalledTimes(<Number>)");return function(n){return{compare:function(i,r){if(!e.isSpy(i))throw new Error(t("Expected a spy, but got "+n.pp(i)+"."));var o=Array.prototype.slice.call(arguments,0),s={pass:!1};if(!e.isNumber_(r))throw new Error(t("The expected times failed is a required argument and must be a number."));var a=(i=o[0]).calls.count(),c=1===r?"once":r+" times";return s.pass=a===r,s.message=s.pass?"Expected spy "+i.and.identity+" not to have been called "+c+". It was called "+a+" times.":"Expected spy "+i.and.identity+" to have been called "+c+". It was called "+a+" times.",s}}}},getJasmineRequireObj().toHaveBeenCalledWith=function(e){var t=e.formatErrorMsg("<toHaveBeenCalledWith>","expect(<spyObj>).toHaveBeenCalledWith(...arguments)");return function(n){return{compare:function(){var i=Array.prototype.slice.call(arguments,0),r=i[0],o=i.slice(1),s={pass:!1};if(!e.isSpy(r))throw new Error(t("Expected a spy, but got "+n.pp(r)+"."));return r.calls.any()?(n.contains(r.calls.allArgs(),o)?(s.pass=!0,s.message=function(){return"Expected spy "+r.and.identity+" not to have been called with:\n  "+n.pp(o)+"\nbut it was."}):s.message=function(){var t=r.calls.allArgs().map((function(e){return"  "+n.pp(e)})),i=r.calls.allArgs().map((function(t,i){var r=new e.DiffBuilder;return n.equals(t,o,r),"Call "+i+":\n"+r.getMessage().replace(/^/gm,"  ")}));return"Expected spy "+r.and.identity+" to have been called with:\n  "+n.pp(o)+"\nbut actual calls were:\n"+t.join(",\n")+".\n\n"+i.join("\n")},s):(s.message=function(){return"Expected spy "+r.and.identity+" to have been called with:\n  "+n.pp(o)+"\nbut it was never called."},s)}}}},getJasmineRequireObj().toHaveClass=function(e){return function(t){return{compare:function(n,i){if(!((r=n)&&r.classList&&e.isFunction_(r.classList.contains)))throw new Error(t.pp(n)+" is not a DOM element");var r;return{pass:n.classList.contains(i)}}}}},getJasmineRequireObj().toHaveSize=function(e){var t=Number.MAX_SAFE_INTEGER||9007199254740991;return function(){return{compare:function(n,i){var r,o={pass:!1};if(e.isA_("WeakSet",n)||e.isWeakMap(n)||e.isDataView(n))throw new Error("Cannot get size of "+n+".");return e.isSet(n)||e.isMap(n)?o.pass=n.size===i:(r=n.length,o.pass="number"==typeof r&&r>-1&&r%1==0&&r<=t?n.length===i:Object.keys(n).length===i),o}}}},getJasmineRequireObj().toHaveSpyInteractions=function(e){var t=e.formatErrorMsg("<toHaveSpyInteractions>","expect(<spyObj>).toHaveSpyInteractions()");return function(n){return{compare:function(n){var i={};if(!e.isObject_(n))throw new Error(t("Expected a spy object, but got "+typeof n+"."));if(arguments.length>1)throw new Error(t("Does not take arguments"));i.pass=!1;let r=!1;const o=[];for(const t of Object.values(n))e.isSpy(t)&&(r=!0,t.calls.any()&&(i.pass=!0,o.push([t.and.identity,t.calls.count()])));if(!r)throw new Error(t("Expected a spy object with spies, but object has no spies."));let s;return i.pass?(s="Expected spy object spies not to have been called, but the following spies were called: ",s+=o.map((([e,t])=>`${e} called ${t} time(s)`)).join(", ")):s="Expected spy object spies to have been called, but no spies were called.",i.message=s,i}}}},getJasmineRequireObj().toMatch=function(e){var t=e.formatErrorMsg("<toMatch>","expect(<expectation>).toMatch(<string> || <regexp>)");return function(){return{compare:function(n,i){if(!e.isString_(i)&&!e.isA_("RegExp",i))throw new Error(t("Expected is not a String or a RegExp"));return{pass:new RegExp(i).test(n)}}}}},getJasmineRequireObj().toThrow=function(e){var t=e.formatErrorMsg("<toThrow>","expect(function() {<expectation>}).toThrow()");return function(e){return{compare:function(n,i){var r,o={pass:!1},s=!1;if("function"!=typeof n)throw new Error(t("Actual is not a Function"));try{n()}catch(e){s=!0,r=e}return s?1==arguments.length?(o.pass=!0,o.message=function(){return"Expected function not to throw, but it threw "+e.pp(r)+"."},o):(e.equals(r,i)?(o.pass=!0,o.message=function(){return"Expected function not to throw "+e.pp(i)+"."}):o.message=function(){return"Expected function to throw "+e.pp(i)+", but it threw "+e.pp(r)+"."},o):(o.message="Expected function to throw an exception.",o)}}}},getJasmineRequireObj().toThrowError=function(e){var t=e.formatErrorMsg("<toThrowError>","expect(function() {<expectation>}).toThrowError(<ErrorConstructor>, <message>)");function n(e){return{pass:!0,message:e}}function i(e){return{pass:!1,message:e}}return function(r){return{compare:function(n){var s,a=o.apply(null,arguments);if("function"!=typeof n)throw new Error(t("Actual is not a Function"));try{return n(),i("Expected function to throw an Error.")}catch(e){s=e}return e.isError_(s)?a.match(s):i((function(){return"Expected function to throw an Error, but it threw "+r.pp(s)+"."}))}};function o(){var e,n;if(arguments[2]){if(e=arguments[2],!c(n=arguments[1]))throw new Error(t("Expected error type is not an Error."));return a(e,n)}return arguments[1]?(e=arguments[1],c(arguments[1])?a(null,arguments[1]):a(arguments[1],null)):s()}function s(){return{match:function(t){return n("Expected function not to throw an Error, but it threw "+e.fnNameFor(t)+".")}}}function a(o,s){if(o&&!((a=o)instanceof RegExp||"string"==typeof a))throw s?new Error(t("Expected error message is not a string or RegExp.")):new Error(t("Expected is not an Error, string, or RegExp."));var a;var c=s?e.fnNameFor(s):"an exception";function l(){return null===o?"":o instanceof RegExp?" with a message matching "+r.pp(o):" with message "+r.pp(o)}function u(e){return(null===s||e instanceof s)&&(null===o||(t=e.message,"string"==typeof o?o==t:o.test(t)));var t}return{match:function(t){return u(t)?n((function(){return"Expected function not to throw "+c+l()+"."})):i((function(){return"Expected function to throw "+c+l()+", but it threw "+function(t){var n=s?e.fnNameFor(t.constructor):"an exception",i="";return o&&(i=" with message "+r.pp(t.message)),n+i}(t)+"."}))}}}function c(t){if("function"!=typeof t)return!1;var n=function(){};return n.prototype=t.prototype,e.isError_(new n)}}},getJasmineRequireObj().toThrowMatching=function(e){var t=e.formatErrorMsg("<toThrowMatching>","expect(function() {<expectation>}).toThrowMatching(<Predicate>)");function n(e){return{pass:!1,message:e}}return function(i){return{compare:function(r,o){var s;if("function"!=typeof r)throw new Error(t("Actual is not a Function"));if("function"!=typeof o)throw new Error(t("Predicate is not a Function"));try{return r(),n("Expected function to throw an exception.")}catch(e){s=e}return o(s)?{pass:!0,message:"Expected function not to throw an exception matching a predicate."}:n((function(){return"Expected function to throw an exception matching a predicate, but it threw "+function(t){return t&&t.constructor?e.fnNameFor(t.constructor)+" with message "+i.pp(t.message):i.pp(t)}(s)+"."}))}}}},getJasmineRequireObj().MockDate=function(e){return function(t){var n=this,i=0;if(!t||!t.Date)return n.install=function(){},n.tick=function(){},n.uninstall=function(){},n;var r=t.Date;return n.install=function(n){if(n instanceof r)i=n.getTime();else{if(!e.util.isUndefined(n))throw new Error("The argument to jasmine.clock().mockDate(), if specified, should be a Date instance.");i=(new r).getTime()}t.Date=o},n.tick=function(e){i+=e=e||0},n.uninstall=function(){i=0,t.Date=r},o.prototype=r.prototype,o.now=function(){return i},o.toSource=r.toSource,o.toString=r.toString,o.parse=r.parse,o.UTC=r.UTC,n;function o(){switch(arguments.length){case 0:return new r(i);case 1:return new r(arguments[0]);case 2:return new r(arguments[0],arguments[1]);case 3:return new r(arguments[0],arguments[1],arguments[2]);case 4:return new r(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return new r(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);case 6:return new r(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);default:return new r(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6])}}}},getJasmineRequireObj().NeverSkipPolicy=function(e){function t(e){}return t.prototype.skipTo=function(e){return e+1},t.prototype.fnErrored=function(e){},t},getJasmineRequireObj().makePrettyPrinter=function(e){class t{constructor(e,t){this.customObjectFormatters_=e,this.ppNestLevel_=0,this.seen=[],this.length=0,this.stringParts=[],this.pp_=t}format(t){this.ppNestLevel_++;try{const n=this.applyCustomFormatters_(t);if(n)this.emitScalar(n);else if(e.util.isUndefined(t))this.emitScalar("undefined");else if(null===t)this.emitScalar("null");else if(0===t&&1/t==-1/0)this.emitScalar("-0");else if(t===e.getGlobal())this.emitScalar("<global>");else if(t.jasmineToString)this.emitScalar(t.jasmineToString(this.pp_));else if(e.isString_(t))this.emitString(t);else if(e.isSpy(t))this.emitScalar("spy on "+t.and.identity);else if(e.isSpy(t.toString))this.emitScalar("spy on "+t.toString.and.identity);else if(t instanceof RegExp)this.emitScalar(t.toString());else if("function"==typeof t)this.emitScalar("Function");else if(e.isDomNode(t))t.tagName?this.emitDomElement(t):this.emitScalar("HTMLNode");else if(t instanceof Date)this.emitScalar("Date("+t+")");else if(e.isSet(t))this.emitSet(t);else if(e.isMap(t))this.emitMap(t);else if(e.isTypedArray_(t))this.emitTypedArray(t);else if(t.toString&&"object"==typeof t&&!e.isArray_(t)&&function(t){try{return e.isFunction_(t.toString)&&t.toString!==Object.prototype.toString&&t.toString()!==Object.prototype.toString.call(t)}catch(e){return!0}}(t))try{this.emitScalar(t.toString())}catch(e){this.emitScalar("has-invalid-toString-method")}else e.util.arrayContains(this.seen,t)?this.emitScalar("<circular reference: "+(e.isArray_(t)?"Array":"Object")+">"):e.isArray_(t)||e.isA_("Object",t)?(this.seen.push(t),e.isArray_(t)?this.emitArray(t):this.emitObject(t),this.seen.pop()):this.emitScalar(t.toString())}catch(e){if(this.ppNestLevel_>1||!(e instanceof n))throw e}finally{this.ppNestLevel_--}}applyCustomFormatters_(e){return i(e,this.customObjectFormatters_)}iterateObject(t,n){const i=e.MatchersUtil.keys(t,e.isArray_(t)),r=Math.min(i.length,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);for(let e=0;e<r;e++)n(i[e]);return i.length>r}emitScalar(e){this.append(e)}emitString(e){this.append("'"+e+"'")}emitArray(t){if(this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return void this.append("Array");const n=Math.min(t.length,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);this.append("[ ");for(let e=0;e<n;e++)e>0&&this.append(", "),this.format(t[e]);t.length>n&&this.append(", ...");let i=0===t.length;this.iterateObject(t,(e=>{i?i=!1:this.append(", "),this.formatProperty(t,e)}))&&this.append(", ..."),this.append(" ]")}emitSet(t){if(this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return void this.append("Set");this.append("Set( ");const n=Math.min(t.size,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);let i=0;t.forEach((function(e,t){i>=n||(i>0&&this.append(", "),this.format(e),i++)}),this),t.size>n&&this.append(", ..."),this.append(" )")}emitMap(t){if(this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return void this.append("Map");this.append("Map( ");const n=Math.min(t.size,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);let i=0;t.forEach((function(e,t){i>=n||(i>0&&this.append(", "),this.format([t,e]),i++)}),this),t.size>n&&this.append(", ..."),this.append(" )")}emitObject(t){const n=t.constructor,i="function"==typeof n&&t instanceof n?e.fnNameFor(t.constructor):"null";if(this.append(i),this.ppNestLevel_>e.MAX_PRETTY_PRINT_DEPTH)return;this.append("({ ");let r=!0;this.iterateObject(t,(e=>{r?r=!1:this.append(", "),this.formatProperty(t,e)}))&&this.append(", ..."),this.append(" })")}emitTypedArray(t){const n=e.fnNameFor(t.constructor),i=Array.prototype.slice.call(t,0,e.MAX_PRETTY_PRINT_ARRAY_LENGTH);let r=Array.prototype.join.call(i,", ");i.length!==t.length&&(r+=", ..."),this.append(n+" [ "+r+" ]")}emitDomElement(e){const t=e.tagName.toLowerCase();let n="<"+t;for(const t of e.attributes)n+=" "+t.name,""!==t.value&&(n+='="'+t.value+'"');n+=">",0===e.childElementCount&&""===e.textContent||(n+="...</"+t+">"),this.append(n)}formatProperty(e,t){"symbol"==typeof t?this.append(t.toString()):this.append(t),this.append(": "),this.format(e[t])}append(t){"string"!=typeof t&&(t=Object.prototype.toString.call(t));const i=function(e,t){if(e.length<=t)return{value:e,truncated:!1};return{value:e=e.substring(0,t-4)+" ...",truncated:!0}}(t,e.MAX_PRETTY_PRINT_CHARS-this.length);if(this.length+=i.value.length,this.stringParts.push(i.value),i.truncated)throw new n}}function n(){this.message="Exceeded "+e.MAX_PRETTY_PRINT_CHARS+" characters while pretty-printing a value"}function i(e,t){for(const n of t){const t=n(e);if(void 0!==t)return t}}return n.prototype=new Error,function(e){e=e||[];const n=function(i){const r=new t(e,n);return r.format(i),r.stringParts.join("")};return n.customFormat_=function(t){return i(t,e)},n}},getJasmineRequireObj().QueueRunner=function(e){var t=1;function n(){}function i(e,t){var n=!1;return function(i){return n?t&&t():(n=!0,e(i)),null}}function r(){console.error(new Error("An asynchronous function called its 'done' callback more than once, in a QueueRunner without a onMultipleDone handler."))}function o(){}function s(n){this.id_=t++,this.queueableFns=n.queueableFns||[],this.onComplete=n.onComplete||o,this.clearStack=n.clearStack||function(e){e()},this.onException=n.onException||o,this.onMultipleDone=n.onMultipleDone||r,this.userContext=n.userContext||new e.UserContext,this.timeout=n.timeout||{setTimeout:setTimeout,clearTimeout:clearTimeout},this.fail=n.fail||o,this.globalErrors=n.globalErrors||{pushListener:o,popListener:o};const i=n.SkipPolicy||e.NeverSkipPolicy;if(this.skipPolicy_=new i(this.queueableFns),this.errored_=!1,"function"!=typeof this.onComplete)throw new Error("invalid onComplete "+JSON.stringify(this.onComplete));this.deprecated=n.deprecated}return n.prototype=new Error,e.StopExecutionError=n,s.prototype.execute=function(){var e=this;this.handleFinalError=function(t,n,i,r,o){e.onException(o||t)},this.globalErrors.pushListener(this.handleFinalError),this.run(0)},s.prototype.clearTimeout=function(t){Function.prototype.apply.apply(this.timeout.clearTimeout,[e.getGlobal(),[t]])},s.prototype.setTimeout=function(t,n){return Function.prototype.apply.apply(this.timeout.setTimeout,[e.getGlobal(),[t,n]])},s.prototype.attempt=function(t){var r,o,s,a=this,c=!0,l=function(e){g(e)},u=i((function(){void 0!==r&&a.clearTimeout(r),a.globalErrors.popListener(l)})),h=i((function(e){function i(){a.run(a.nextFnIx_(t))}u(),void 0!==e&&(e instanceof n||e.jasmineMessage||a.fail(e),a.recordError_(t)),c?a.setTimeout(i):i()}),(function(){try{d||a.onMultipleDone()}catch(e){console.error(e)}})),d=!1,f=a.queueableFns[t];if(h.fail=function(){a.fail.apply(null,arguments),a.recordError_(t),h()},a.globalErrors.pushListener(l),void 0!==f.timeout){var p=f.timeout||e.DEFAULT_TIMEOUT_INTERVAL;r=a.setTimeout((function(){d=!0,g(new Error("Timeout - Async function did not complete within "+p+"ms "+(f.timeout?"(custom timeout)":"(set by jasmine.DEFAULT_TIMEOUT_INTERVAL)"))),h()}),p)}try{if(0!==f.fn.length)return o=f.fn.call(a.userContext,h),this.diagnoseConflictingAsync_(f.fn,o),c=!1,{completedSynchronously:!1};if((o=f.fn.call(a.userContext))&&e.isFunction_(o.then))return o.then((s=h,function(t){e.isError_(t)?s(t):s()}),(function(e){g(e),h()})),c=!1,{completedSynchronously:!1}}catch(e){g(e),a.recordError_(t)}return u(),{completedSynchronously:!0};function g(e){a.onException(e),a.recordError_(t)}},s.prototype.run=function(e){var t,i=this.queueableFns.length,r=this;for(t=e;t<i;t=this.nextFnIx_(t)){if(!this.attempt(t).completedSynchronously)return}this.clearStack((function(){r.globalErrors.popListener(r.handleFinalError),r.errored_?r.onComplete(new n):r.onComplete()}))},s.prototype.nextFnIx_=function(e){const t=this.skipPolicy_.skipTo(e);if(t===e)throw new Error("Can't skip to the same queueable fn that just finished");return t},s.prototype.recordError_=function(e){this.errored_=!0,this.skipPolicy_.fnErrored(e)},s.prototype.diagnoseConflictingAsync_=function(t,n){n&&e.isFunction_(n.then)&&(e.isAsyncFunction_(t)?this.onException("An asynchronous before/it/after function was defined with the async keyword but also took a done callback. Either remove the done callback (recommended) or remove the async keyword."):this.onException("An asynchronous before/it/after function took a done callback but also returned a promise. Either remove the done callback (recommended) or change the function to not return a promise."))},s},getJasmineRequireObj().ReportDispatcher=function(e){return function(t,n,i){for(var r=t||[],o=0;o<r.length;o++){var s=r[o];this[s]=function(e){return function(){l(e,arguments)}}(s)}var a=[],c=null;return this.addReporter=function(e){a.push(e)},this.provideFallbackReporter=function(e){c=e},this.clearReporters=function(){a=[]},this;function l(t,r){0===a.length&&null!==c&&a.push(c);var o=r[r.length-1];r=e.util.argsToArray(r).splice(0,r.length-1);for(var s=[],l=0;l<a.length;l++){u(s,a[l],t,r)}n({queueableFns:s,onComplete:o,isReporter:!0,onMultipleDone:function(){i(new Error("An asynchronous reporter callback called its 'done' callback more than once."))}})}function u(t,n,i,r){var o=n[i];if(o){var s=e.util.cloneArgs(r);o.length<=1?t.push({fn:function(){return o.apply(n,s)}}):t.push({fn:function(e){return o.apply(n,s.concat([e]))}})}}}},getJasmineRequireObj().interface=function(e,t){var n={describe:function(e,n){return t.describe(e,n)},xdescribe:function(e,n){return t.xdescribe(e,n)},fdescribe:function(e,n){return t.fdescribe(e,n)},it:function(){return t.it.apply(t,arguments)},xit:function(){return t.xit.apply(t,arguments)},fit:function(){return t.fit.apply(t,arguments)},beforeEach:function(){return t.beforeEach.apply(t,arguments)},afterEach:function(){return t.afterEach.apply(t,arguments)},beforeAll:function(){return t.beforeAll.apply(t,arguments)},afterAll:function(){return t.afterAll.apply(t,arguments)},setSpecProperty:function(e,n){return t.setSpecProperty(e,n)},setSuiteProperty:function(e,n){return t.setSuiteProperty(e,n)},expect:function(e){return t.expect(e)},expectAsync:function(e){return t.expectAsync(e)},pending:function(){return t.pending.apply(t,arguments)},fail:function(){return t.fail.apply(t,arguments)},spyOn:function(e,n){return t.spyOn(e,n)},spyOnProperty:function(e,n,i){return t.spyOnProperty(e,n,i)},spyOnAllFunctions:function(e,n){return t.spyOnAllFunctions(e,n)},jsApiReporter:new e.JsApiReporter({timer:new e.Timer}),jasmine:e};return e.addCustomEqualityTester=function(e){t.addCustomEqualityTester(e)},e.addMatchers=function(e){return t.addMatchers(e)},e.addAsyncMatchers=function(e){return t.addAsyncMatchers(e)},e.addCustomObjectFormatter=function(e){return t.addCustomObjectFormatter(e)},e.clock=function(){return t.clock},e.createSpy=function(e,n){return t.createSpy(e,n)},e.createSpyObj=function(e,n,i){return t.createSpyObj(e,n,i)},e.addSpyStrategy=function(e,n){return t.addSpyStrategy(e,n)},e.setDefaultSpyStrategy=function(e){return t.setDefaultSpyStrategy(e)},n},getJasmineRequireObj().SkipAfterBeforeAllErrorPolicy=function(e){function t(e){this.queueableFns_=e,this.skipping_=!1}return t.prototype.skipTo=function(e){return this.skipping_?this.nextAfterAllAfter_(e):e+1},t.prototype.nextAfterAllAfter_=function(e){for(e++;e<this.queueableFns_.length&&"afterAll"!==this.queueableFns_[e].type;e++);return e},t.prototype.fnErrored=function(e){"beforeAll"===this.queueableFns_[e].type&&(this.skipping_=!0,this.queueableFns_[e].suite.hadBeforeAllFailure=!0)},t},getJasmineRequireObj().Spy=function(e){var t,n=(t=0,function(){return t++});function i(t,n){var i=new e.SpyStrategy(t),o=new r((function(){return new e.SpyStrategy(t)}),n);this.and=i,this.exec=function(n,r,s){var a=o.get(r);if(!a){if(o.any()&&!i.isConfigured())throw new Error("Spy '"+t.name+"' received a call with arguments "+e.basicPrettyPrinter_(Array.prototype.slice.call(r))+" but all configured strategies specify other arguments.");a=i}return a.exec(n,r,s)},this.withArgs=function(){return{and:o.getOrCreate(arguments)}}}function r(e,t){this.strategies=[],this.strategyFactory=e,this.matchersUtil=t}return r.prototype.any=function(){return this.strategies.length>0},r.prototype.getOrCreate=function(e){var t=this.get(e);return t||(t=this.strategyFactory(),this.strategies.push({args:e,strategy:t})),t},r.prototype.get=function(e){var t;for(t=0;t<this.strategies.length;t++)if(this.matchersUtil.equals(e,this.strategies[t].args))return this.strategies[t].strategy},function(t,r,o){const{originalFn:s,customStrategies:a,defaultStrategyFn:c}=o||{};var l=function(e,t){switch(e){case 1:return function e(n){return t(this,arguments,this instanceof e)};case 2:return function e(n,i){return t(this,arguments,this instanceof e)};case 3:return function e(n,i,r){return t(this,arguments,this instanceof e)};case 4:return function e(n,i,r,o){return t(this,arguments,this instanceof e)};case 5:return function e(n,i,r,o,s){return t(this,arguments,this instanceof e)};case 6:return function e(n,i,r,o,s,a){return t(this,arguments,this instanceof e)};case 7:return function e(n,i,r,o,s,a,c){return t(this,arguments,this instanceof e)};case 8:return function e(n,i,r,o,s,a,c,l){return t(this,arguments,this instanceof e)};case 9:return function e(n,i,r,o,s,a,c,l,u){return t(this,arguments,this instanceof e)};default:return function e(){return t(this,arguments,this instanceof e)}}}("function"==typeof s?s.length:0,(function(e,t,n){return d(e,t,n)})),u=new i({name:t,fn:s,getSpy:function(){return l},customStrategies:a},r),h=new e.CallTracker,d=function(e,t,i){var r={object:e,invocationOrder:n(),args:Array.prototype.slice.apply(t)};h.track(r);var o=u.exec(e,t,i);return r.returnValue=o,o};for(var f in s){if("and"===f||"calls"===f)throw new Error("Jasmine spies would overwrite the 'and' and 'calls' properties on the object being spied upon");l[f]=s[f]}return l.and=u.and,l.withArgs=function(){return u.withArgs.apply(u,arguments)},l.calls=h,c&&c(l.and),l}},getJasmineRequireObj().SpyFactory=function(e){function t(t){var n=[];if(e.isArray_(t))for(var i=0;i<t.length;i++)n.push([t[i]]);else if(e.isObject_(t))for(var r in t)t.hasOwnProperty(r)&&n.push([r,t[r]]);return n}return function(n,i,r){var o=this;this.createSpy=function(t,o){return e.Spy(t,r(),{originalFn:o,customStrategies:n(),defaultStrategyFn:i()})},this.createSpyObj=function(n,i,r){(e.isObject_(n)||e.isArray_(n))&&(r=i,i=n,n="unknown");for(var s,a,c={},l=t(i),u=0;u<l.length;u++)s=c[l[u][0]]=o.createSpy(n+"."+l[u][0]),l[u].length>1&&s.and.returnValue(l[u][1]);var h=t(r);for(u=0;u<h.length;u++)a={enumerable:!0,get:o.createSpy(n+"."+h[u][0]+".get"),set:o.createSpy(n+"."+h[u][0]+".set")},h[u].length>1&&(a.get.and.returnValue(h[u][1]),a.set.and.returnValue(h[u][1])),Object.defineProperty(c,h[u][0],a);if(0===l.length&&0===h.length)throw"createSpyObj requires a non-empty array or object of method names to create spies for";return c}}},getJasmineRequireObj().SpyRegistry=function(e){var t=e.formatErrorMsg("<spyOn>","spyOn(<object>, <methodName>)"),n=e.formatErrorMsg("<spyOnProperty>","spyOnProperty(<object>, <propName>, [accessType])");function i(e,t){var n=Object.keys(e);return t?Object.getOwnPropertyNames(e).filter((function(e){return"constructor"!==e||n.indexOf("constructor")>-1})):n}function r(e,t){for(var n,i=[],r=0;r<t.length;r++)n=t[r],Object.prototype.hasOwnProperty.call(e,n)&&o(e,n)&&i.push(n);return i}function o(e,t){var n,i;try{n=e[t]}catch(e){return!1}return n instanceof Function&&(((i=Object.getOwnPropertyDescriptor(e,t)).writable||i.set)&&i.configurable)}return function(o){var s=(o=o||{}).global||e.getGlobal(),a=o.createSpy,c=o.currentSpies||function(){return[]};this.allowRespy=function(e){this.respy=e},this.spyOn=function(n,i){var r=t;if(e.util.isUndefined(n)||null===n)throw new Error(r("could not find an object to spy upon for "+i+"()"));if(e.util.isUndefined(i)||null===i)throw new Error(r("No method name supplied"));if(e.util.isUndefined(n[i]))throw new Error(r(i+"() method does not exist"));if(n[i]&&e.isSpy(n[i])){if(this.respy)return n[i];throw new Error(r(i+" has already been spied upon"))}var o=Object.getOwnPropertyDescriptor(n,i);if(o&&!o.writable&&!o.set)throw new Error(r(i+" is not declared writable or has no setter"));var l,u=n[i],h=a(i,u);return l=Object.prototype.hasOwnProperty.call(n,i)||n===s&&"onerror"===i?function(){n[i]=u}:function(){delete n[i]||(n[i]=u)},c().push({restoreObjectToOriginalState:l}),n[i]=h,h},this.spyOnProperty=function(t,i,r){var o=n;if(r=r||"get",e.util.isUndefined(t))throw new Error(o("spyOn could not find an object to spy upon for "+i));if(e.util.isUndefined(i))throw new Error(o("No property name supplied"));var s=e.util.getPropertyDescriptor(t,i);if(!s)throw new Error(o(i+" property does not exist"));if(!s.configurable)throw new Error(o(i+" is not declared configurable"));if(!s[r])throw new Error(o("Property "+i+" does not have access type "+r));if(e.isSpy(s[r])){if(this.respy)return s[r];throw new Error(o(i+"#"+r+" has already been spied upon"))}var l,u=e.util.clone(s),h=a(i,s[r]);return l=Object.prototype.hasOwnProperty.call(t,i)?function(){Object.defineProperty(t,i,u)}:function(){delete t[i]},c().push({restoreObjectToOriginalState:l}),s[r]=h,Object.defineProperty(t,i,s),h},this.spyOnAllFunctions=function(t,n){if(e.util.isUndefined(t))throw new Error("spyOnAllFunctions could not find an object to spy upon");for(var o,s=t,a=[],c=[];s&&(!n||s!==Object.prototype);)o=(o=i(s,n)).filter((function(e){return-1===c.indexOf(e)})),c=c.concat(o),a=a.concat(r(s,o)),s=Object.getPrototypeOf(s);for(var l=0;l<a.length;l++)this.spyOn(t,a[l]);return t},this.clearSpies=function(){for(var e=c(),t=e.length-1;t>=0;t--){e[t].restoreObjectToOriginalState()}}}},getJasmineRequireObj().SpyStrategy=function(e){function t(t){t=t||{};var i=this;this.identity=t.name||"unknown",this.originalFn=t.fn||function(){},this.getSpy=t.getSpy||function(){},this.plan=this._defaultPlan=function(){};var r,o=t.customStrategies||{};for(r in o)e.util.has(o,r)&&!this[r]&&(this[r]=n(o[r]));this.resolveTo=function(e){return i.plan=function(){return Promise.resolve(e)},i.getSpy()},this.rejectWith=function(e){return i.plan=function(){return Promise.reject(e)},i.getSpy()}}function n(t){return function(){var n=t.apply(null,arguments);if(!e.isFunction_(n))throw new Error("Spy strategy must return a function");return this.plan=n,this.getSpy()}}return t.prototype.exec=function(e,t,n){var i=[e].concat(t?Array.prototype.slice.call(t):[]),r=this.plan.bind.apply(this.plan,i);return n?new r:r()},t.prototype.callThrough=function(){return this.plan=this.originalFn,this.getSpy()},t.prototype.returnValue=function(e){return this.plan=function(){return e},this.getSpy()},t.prototype.returnValues=function(){var e=Array.prototype.slice.call(arguments);return this.plan=function(){return e.shift()},this.getSpy()},t.prototype.throwError=function(t){var n=e.isString_(t)?new Error(t):t;return this.plan=function(){throw n},this.getSpy()},t.prototype.callFake=function(t){if(!(e.isFunction_(t)||e.isAsyncFunction_(t)||e.isGeneratorFunction_(t)))throw new Error("Argument passed to callFake should be a function, got "+t);return this.plan=t,this.getSpy()},t.prototype.stub=function(e){return this.plan=function(){},this.getSpy()},t.prototype.isConfigured=function(){return this.plan!==this._defaultPlan},t},getJasmineRequireObj().StackTrace=function(e){var t=[{re:/^\s*at ([^\)]+) \(([^\)]+)\)$/,fnIx:1,fileLineColIx:2,style:"v8"},{re:/\s*at (.+)$/,fileLineColIx:1,style:"v8"},{re:/^(?:(([^@\s]+)@)|@)?([^\s]+)$/,fnIx:2,fileLineColIx:3,style:"webkit"}];return function(e){var n=e.stack.split("\n").filter((function(e){return""!==e})),i=function(e,t){var n=function(e,t){if(!t[0].match(/^\w*Error/))return 0;var n,i=e.split("\n");for(n=1;n<i.length;n++)if(i[n]!==t[n])return 0;return i.length}(e,t);if(n>0)return{message:t.slice(0,n).join("\n"),remainder:t.slice(n)}}(e.message,n);i&&(this.message=i.message,n=i.remainder);var r=function(e){var n=null,i=e.map((function(e){return function(e,t){var n,i;for(n=0;n<e.length;n++)if(i=t(e[n]))return i}(t,(function(t){var i,r=e.match(t.re);return r&&(i=r[t.fileLineColIx].match(/^(.*):(\d+):\d+$/))?(n=n||t.style,{raw:e,file:i[1],line:parseInt(i[2],10),func:r[t.fnIx]}):null}))||{raw:e}}));return{style:n,frames:i}}(n);this.frames=r.frames,this.style=r.style}},getJasmineRequireObj().Suite=function(e){function t(t){this.env=t.env,this.id=t.id,this.parentSuite=t.parentSuite,this.description=t.description,this.expectationFactory=t.expectationFactory,this.asyncExpectationFactory=t.asyncExpectationFactory,this.throwOnExpectationFailure=!!t.throwOnExpectationFailure,this.autoCleanClosures=void 0===t.autoCleanClosures||!!t.autoCleanClosures,this.onLateError=t.onLateError||function(){},this.beforeFns=[],this.afterFns=[],this.beforeAllFns=[],this.afterAllFns=[],this.timer=t.timer||new e.Timer,this.children=[],this.reset()}function n(e){for(var t=0;t<e.length;t++)e[t].fn=null}function i(e){this.suite_=e,this.id=e.id,this.parentSuite=e.parentSuite?e.parentSuite.metadata:null,this.description=e.description}function r(e){return!e[0]}return t.prototype.setSuiteProperty=function(e,t){this.result.properties=this.result.properties||{},this.result.properties[e]=t},t.prototype.expect=function(e){return this.expectationFactory(e,this)},t.prototype.expectAsync=function(e){return this.asyncExpectationFactory(e,this)},t.prototype.getFullName=function(){for(var e=[],t=this;t;t=t.parentSuite)t.parentSuite&&e.unshift(t.description);return e.join(" ")},t.prototype.pend=function(){this.markedPending=!0},t.prototype.exclude=function(){this.pend(),this.markedExcluding=!0},t.prototype.beforeEach=function(e){this.beforeFns.unshift({...e,suite:this})},t.prototype.beforeAll=function(e){this.beforeAllFns.push({...e,type:"beforeAll",suite:this})},t.prototype.afterEach=function(e){this.afterFns.unshift({...e,suite:this,type:"afterEach"})},t.prototype.afterAll=function(e){this.afterAllFns.unshift({...e,type:"afterAll"})},t.prototype.startTimer=function(){this.timer.start()},t.prototype.endTimer=function(){this.result.duration=this.timer.elapsed()},t.prototype.cleanupBeforeAfter=function(){this.autoCleanClosures&&(n(this.beforeAllFns),n(this.afterAllFns),n(this.beforeFns),n(this.afterFns))},t.prototype.reset=function(){this.result={id:this.id,description:this.description,fullName:this.getFullName(),failedExpectations:[],deprecationWarnings:[],duration:null,properties:null},this.markedPending=this.markedExcluding,this.children.forEach((function(e){e.reset()})),this.reportedDone=!1},t.prototype.addChild=function(e){this.children.push(e)},t.prototype.status=function(){return this.markedPending?"pending":this.result.failedExpectations.length>0?"failed":"passed"},t.prototype.canBeReentered=function(){return 0===this.beforeAllFns.length&&0===this.afterAllFns.length},t.prototype.getResult=function(){return this.result.status=this.status(),this.result},t.prototype.sharedUserContext=function(){return this.sharedContext||(this.sharedContext=this.parentSuite?this.parentSuite.clonedSharedUserContext():new e.UserContext),this.sharedContext},t.prototype.clonedSharedUserContext=function(){return e.UserContext.fromExisting(this.sharedUserContext())},t.prototype.handleException=function(){if(arguments[0]instanceof e.errors.ExpectationFailed)return;const t={matcherName:"",passed:!1,expected:"",actual:"",error:arguments[0]},n=e.buildExpectationResult(t);this.parentSuite||(n.globalErrorType="afterAll"),this.reportedDone?this.onLateError(n):this.result.failedExpectations.push(n)},t.prototype.onMultipleDone=function(){let e;e=this.parentSuite?"An asynchronous beforeAll or afterAll function called its 'done' callback more than once.\n(in suite: "+this.getFullName()+")":"A top-level beforeAll or afterAll function called its 'done' callback more than once.",this.onLateError(new Error(e))},t.prototype.addExpectationResult=function(){if(r(arguments)){const t=arguments[1],n=e.buildExpectationResult(t);if(this.reportedDone?this.onLateError(n):this.result.failedExpectations.push(n),this.throwOnExpectationFailure)throw new e.errors.ExpectationFailed}},t.prototype.addDeprecationWarning=function(t){"string"==typeof t&&(t={message:t}),this.result.deprecationWarnings.push(e.buildExpectationResult(t))},Object.defineProperty(t.prototype,"metadata",{get:function(){return this.metadata_||(this.metadata_=new i(this)),this.metadata_}}),i.prototype.getFullName=function(){return this.suite_.getFullName()},Object.defineProperty(i.prototype,"children",{get:function(){return this.suite_.children.map((e=>e.metadata))}}),t},getJasmineRequireObj().Timer=function(){var e=function(e){return function(){return(new e).getTime()}}(Date);return function(t){var n,i=(t=t||{}).now||e;this.start=function(){n=i()},this.elapsed=function(){return i()-n}}},getJasmineRequireObj().TreeProcessor=function(){return function(e){var t=e.tree,n=e.runnableIds,i=e.queueRunnerFactory,r=e.nodeStart||function(){},o=e.nodeComplete||function(){},s=!!e.failSpecWithNoExpectations,a=e.orderChildren||function(e){return e.children},c=e.excludeNode||function(e){return!1},l={valid:!0},u=!1,h=1/0,d=-1/0;function f(e,t){var i=function(e){for(var t=0;t<n.length;t++)if(n[t]===e)return t}(e.id);if(void 0!==i&&(t=!1),e.children){for(var r=!1,o=a(e),s=0;s<o.length;s++){var u=o[s];if(f(u,t),!l.valid)return;var m=l[u.id];r=r||m.willExecute}l[e.id]={excluded:t,willExecute:r},function(e,t,n,i){var r={index:0,owner:e,nodes:[],min:p(i),max:g(i)},o=[r],s=d,a=function(e){for(var t=[],n=[],i=0;i<e.length;i++)for(var r=e[i],o=l[r.id].segments,s=0;s<o.length;s++){var a=o[s];a.min===h?n.push(a):t.push(a)}return t.sort((function(e,t){return e.min-t.min})),t.concat(n)}(t);function c(e){return s!==d&&e!==h&&s<e-1}for(var u=0;u<a.length;u++){var f=a[u],m=f.max,y=f.min;c(y)&&(r={index:o.length,owner:e,nodes:[],min:h,max:d},o.push(r)),r.nodes.push(f),r.min=Math.min(r.min,y),r.max=Math.max(r.max,m),s=m}n.segments=o}(e,o,l[e.id],i),!e.canBeReentered()&&l[e.id].segments.length>1&&(l={valid:!1})}else{var y=t||c(e);l[e.id]={excluded:y,willExecute:!y&&!e.markedPending,segments:[{index:0,owner:e,nodes:[e],min:p(i),max:g(i)}]}}}function p(e){return void 0===e?h:e}function g(e){return void 0===e?d:e}function m(e,t){return e.children?{fn:function(n){i({onComplete:function(){var t=Array.prototype.slice.call(arguments,[0]);e.cleanupBeforeAfter(),o(e,e.getResult(),(function(){n.apply(void 0,t)}))},queueableFns:[{fn:function(t){r(e,t)}}].concat(y(e,t)),userContext:e.sharedUserContext(),onException:function(){e.handleException.apply(e,arguments)},onMultipleDone:e.onMultipleDone?e.onMultipleDone.bind(e):null})}}:{fn:function(t){e.execute(t,l[e.id].excluded,s)}}}function y(e,t){for(var n=[],i=l[e.id].segments[t].nodes,r=0;r<i.length;r++)n.push(m(i[r].owner,i[r].index));return l[e.id].willExecute?e.beforeAllFns.concat(n).concat(e.afterAllFns):n}this.processTree=function(){return f(t,!0),u=!0,l},this.execute=function(e){if(u||this.processTree(),!l.valid)throw"invalid order";var n=y(t,0);i({queueableFns:n,userContext:t.sharedUserContext(),onException:function(){t.handleException.apply(t,arguments)},onComplete:e,onMultipleDone:t.onMultipleDone?t.onMultipleDone.bind(t):null})}}},getJasmineRequireObj().UserContext=function(e){function t(){}return t.fromExisting=function(e){var n=new t;for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n},t},getJasmineRequireObj().version=function(){return"4.2.0"},define("toxilibs/extlibs/jasmine-4.2.0",(function(){})),define("user_code/test_suite",["event_bus","render/screen","toxilibs/color","render/font_awesome_codes","toxilibs/extlibs/jasmine-4.2.0"],(function(e,t,n,i){e.on("execution started",g);const{jasmineRequire:r}=window,o=r.core(r);function s(e){return{pass:!1,message:e}}function a(e=""){return{pass:!0,message:e}}function c({input:e,propertyName:t,value:n,inputName:i,matchersUtil:r}){if(void 0===n)return t in e?s(`Expected${i} to have no property "${t}"`):a();if(!(t in e))return s(`Expected${i} to have a property "${t}"`);let o=e[t];if(r.equals(o,n))return a();{let e;return e=i?i+"."+t:` property ${t}`,s(`Expected${e} to equal ${r.pp(n)} ,\n                but got ${r.pp(o)} instead`)}}const l={toHavePropertyEqual:function(e){return{compare:(t,n,i,r="")=>{r&&(r=" "+r);let o=typeof t;return"object"!==o?s(`Expected${r} to be an object, instead of ${o}`):c({input:t,propertyName:n,value:i,inputName:r,matchersUtil:e})}}},toHavePropertiesEqual:function(e){return{compare:(t,n,i="")=>{i&&(i=" "+i);let r=typeof t;return"object"!==r?s(`Expected${i} to be an object, instead of ${r}`):function({input:e,target:t,inputName:n,matchersUtil:i}){for(let r in t){let o=c({input:e,propertyName:r,value:t[r],inputName:n,matchersUtil:i});if(!o.pass)return o}return a()}({input:t,target:n,inputName:i,matchersUtil:e})}}},toHaveShape:function(e){return{compare:(t,n,i)=>{const{screenGroup:r}=t;if(!r)return s("Expected to have screen as an input");const o=" "+n;"Icon"===n&&(n="Text",i.isAnIcon=!0);const{elements:a}=r,c="draw"+n;let l,u=0;for(let t=0;t<a.length;t++){const[r,s]=a[t];if(c!==r)continue;u+=1;let h=f({inputName:o,shapeName:n,params:s,expectedParams:i,matchersUtil:e});if(h.pass)return h;l=h}return 0===u?s(`Screen has no ${n} in it`):1===u?l:s(`Screen has no matching ${n}`)}}}};const{paramsTypes:u}=t,h={text:(e,t)=>e===(t=t.replace(/<i class="fas">(.*)<\/i>/,"$1")),font:(...e)=>h.text(...e),length:(e,t,n)=>Math.abs(e-t)<n+1e-8,coords:(e,t,n)=>h.length(e.x,t.x,n)&&h.length(e.y,t.y,n),vector:(...e)=>h.coords(...e),angle:(e,t)=>{let n=((180+e-t)%(i=360)+i)%i-180;var i;return Math.abs(n)<10},color:(e,t)=>("string"==typeof e&&(e=new n(e)),e.isCloseTo(t))},d=["radius","width","height","size"];function f({inputName:e,params:t,expectedParams:n,matchersUtil:r}){let o=0;d.forEach((e=>{e in n&&(o=Math.max(0,n[e]))}));let c=o/10;for(let o in n){let a=t[o],l=n[o],d=u[o],f=o;if(n.isAnIcon){if("isAnIcon"===o)continue;"name"===o&&(f="text",d=u.text,a=t.text,l=i[l]),"size"===o&&(f="font",d=u.font,a=t.font,l=String(l)+"u FontAwesomeForScreen")}if(!d)throw new Error(`property ${o} is unsupported by screen`);if(void 0!==l){if(!(f in t))return s(`Expected${e} to have a property "${o}"`);if(!h[d](a,l,c))return n.isAnIcon&&"name"===o&&(l='<i class="fas">'+l+"</i>",a='<i class="fas">'+a+"</i>"),s(`Expected${e} ${o} to equal ${r.pp(l)} ,\n                    but got ${r.pp(a)} instead`)}else if(f in t)return s(`Expected${e} to have no property "${o}"`)}return a(`Expected${e} not to be present`)}const p=o.getEnv();function g(){p.topSuite().suite_.children.length=0}p.configure({autoCleanClosures:!0,stopOnSpecFailure:!1,stopSpecOnExpectationFailure:!0,random:!1});const m=r.interface(o,p),y=Object.assign({},m);return y.add=y.it,y.section=function(e,t){return y.describe(e,(()=>{y.beforeEach((()=>y.jasmine.addMatchers(l))),t()}))},delete y.jsApiReporter,y.resetAll=g,y.run=function(e=(()=>{})){let t=new o.JsApiReporter({timer:new o.Timer});p.clearReporters(),p.addReporter(t),p.execute(!1,(()=>{e(t)}))},y})),define("user_code/geometry_api",["toxilibs/vector","toxilibs/collision_detector"],(function(e,t){const{distanceToRectangle:n}=t,i=Math.PI/180;let{isInsideShape:r,distanceToShape:o,rectangleIntersectsWithRectangle:s}=t;return{cos:function(e){return Math.cos(e*i)},sin:function(e){return Math.sin(e*i)},tan:function(e){return Math.tan(e*i)},acos:function(e){return Math.acos(e)/i},asin:function(e){return Math.asin(e)/i},atan:function(e){return Math.atan(e)/i},atan2:function(e,t){return Math.atan2(e,t)/i},distance:function({x:e,y:t,z:n=0},{x:i,y:r,z:o=0}={x:0,y:0,z:0}){const s=i-e,a=r-t,c=o-n;return Math.sqrt(s*s+a*a+c*c)},closestFrom:function(e,t){let n,i=1/0;return t.forEach((t=>{if(t!==e){let r=function({x:e,y:t},{x:n,y:i}){const r=n-e,o=i-t;return r*r+o*o}(e,t);r<i&&(i=r,n=t)}})),n},normalize:function({x:t,y:n,z:i=!1}){if(!1===i){console.warn("normalize DEPRECATED - use vector and v.normalize() or v.length = 1 instead");let i=Math.sqrt(t*t+n*n)||1;return new e(t/i,n/i)}{let e=Math.sqrt(t*t+n*n+i*i)||1;return{x:t/e,y:n/e,z:i/e}}},directionFromTo:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)/i},angleBetweenVectors:function(e,t){let n=(Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x))/i;return n>180?n-360:n<-180?n+360:n},unitVectorAtDirection:function(t){return console.warn("unitVectorAtDirection DEPRECATED - use new Vector instead"),new e({direction:t})},unitVectorFromTo:function(t,n){return console.warn("unitVectorFromTo DEPRECATED - use new Vector instead"),new e({from:t,to:n,length:1})},distanceToRectangle:n,rayCircleIntersection:function(t,n){let i=new e({direction:t.direction}),{radius:r}=n,o=t.x-n.x,s=t.y-n.y,a=i.x,c=i.y,l=a*o+c*s,u=o*o+s*s-r*r,h=l*l-(a*a+c*c)*u;if(h<0)return!1;let d,f=u<0;if(d=f?u/(-Math.sqrt(h)-l):u/(Math.sqrt(h)-l),d<0)return!1;let p={x:t.x+d*a,y:t.y+d*c};return{point:p,normal:new e({from:n,to:p,length:1}),distance:d,fromInside:f}},rayPolygonIntersection:function(t,{points:n}){let i=n.length,r=1/0,o=!1;if(n.forEach(((s,a)=>{const c=n[(a+1)%i],l=function(t,n,i){let r=new e({direction:t.direction}),o=new e({from:n,to:i}),s=r.crossProduct(o);if(0===s)return!1;let a=new e({from:t,to:n}),c=a.crossProduct(r)/s;if(c>=0&&c<=1){let e=a.crossProduct(o)/s;return!(e<0)&&{point:{x:t.x+e*r.x,y:t.y+e*r.y},distance:e,normal:o.rotate90().normalize()}}return!1}(t,s,c);if(!l)return;const{distance:u}=l;u<r&&(r=u,o=l)})),o){const{normal:n}=o,i=new e({direction:t.direction});o.fromInside=n.dotProduct(i)>0}return o},rectangleIntersectsWithRectangle:s,isInsideShape:r,distanceToShape:o}})),define("user_code/stats_api",[],(function(){function e(e,t){return e-t}return{createBins:function(t,n={}){t=t.sort(e);let{steps:i=50,min:r=t[0],max:o=t[t.length-1]}=n,s=1.000000001*(o-r)/i,a=[];for(let e=0;e<i;e+=1)a.push({x:r+(.5+e)*s,y:0});return t.forEach((e=>{let t=Math.floor((e-r)/s);a[t].y+=1})),a}}})),define("user_code/agent_api",["toxilibs/vector","./geometry_api"],(function(e,t){const{distance:n,directionFromTo:i,closestFrom:r}=t;function o({x:t=0,y:n=0,direction:i=0,speed:r=0}={}){this.x=t,this.y=n,this.velocity=new e({direction:i,length:r}),this.vectorGoals=[]}function s(e,t){return"object"==typeof t?e.directionTo(t):t}return o.prototype.applyMotion=function(t){let{velocity:n}=this;this.vectorGoals.length>0&&(n.direction=function(t){let n=0,i=0;return t.vectorGoals.forEach((({x:e,y:t})=>{n+=e,i+=t})),new e(n,i)}(this).direction,this.vectorGoals=[],this.x+=t*n.x,this.y+=t*n.y)},o.prototype.distanceTo=function(e){return n(this,e)},o.prototype.directionTo=function(e){return i(this,e)},o.prototype.closest=function(e){return r(this,e)},o.prototype.rotate=function(e){this.velocity.rotate$(e)},o.prototype.addGoal=function(t,n=1){this.vectorGoals.push(new e({length:n,direction:s(this,t)}))},o.prototype.setDirection=function(e){this.velocity.direction=s(this,e)},o.prototype.avoid=function(e){this.velocity.direction=s(this,e)+180},{createAgent:function(e){return new o(e)}}})),function(e){"use strict";var t={},n=t,i="object"==typeof module&&module.exports,r="function"==typeof define&&define.amd;i?module.exports=t:r?define("toxilibs/extlibs/pizzicato-0.6.4",[],t):e.Pizzicato=e.Pz=t;var o=e.AudioContext||e.webkitAudioContext;if(o){t.context=new o;var s=t.context.createGain();s.connect(t.context.destination),t.Util={isString:function(e){return"[object String]"===toString.call(e)},isObject:function(e){return"[object Object]"===toString.call(e)},isFunction:function(e){return"[object Function]"===toString.call(e)},isNumber:function(e){return"[object Number]"===toString.call(e)&&e===+e},isArray:function(e){return"[object Array]"===toString.call(e)},isInRange:function(e,t,i){return!!(n.Util.isNumber(e)&&n.Util.isNumber(t)&&n.Util.isNumber(i))&&(e>=t&&e<=i)},isBool:function(e){return"boolean"==typeof e},isOscillator:function(e){return e&&"[object OscillatorNode]"===e.toString()},isAudioBufferSourceNode:function(e){return e&&"[object AudioBufferSourceNode]"===e.toString()},isSound:function(e){return e instanceof n.Sound},isEffect:function(e){for(var n in t.Effects)if(e instanceof t.Effects[n])return!0;return!1},normalize:function(e,t,i){if(n.Util.isNumber(e)&&n.Util.isNumber(t)&&n.Util.isNumber(i))return(i-t)*e/1+t},getDryLevel:function(e){return!n.Util.isNumber(e)||e>1||e<0?0:e<=.5?1:1-2*(e-.5)},getWetLevel:function(e){return!n.Util.isNumber(e)||e>1||e<0?0:e>=.5?1:1-2*(.5-e)}};var a=t.context.createGain(),c=Object.getPrototypeOf(Object.getPrototypeOf(a)),l=c.connect;c.connect=function(e){var t=n.Util.isEffect(e)?e.inputNode:e;return l.call(this,t),e},Object.defineProperty(t,"volume",{enumerable:!0,get:function(){return s.gain.value},set:function(e){n.Util.isInRange(e,0,1)&&s&&(s.gain.value=e)}}),Object.defineProperty(t,"masterGainNode",{enumerable:!1,get:function(){return s},set:function(e){console.error("Can't set the master gain node")}}),t.Events={on:function(e,t,n){e&&t&&(this._events=this._events||{},(this._events[e]||(this._events[e]=[])).push({callback:t,context:n||this,handler:this}))},trigger:function(e){var t,n,i,r;if(e&&(this._events=this._events||{},t=this._events[e]||(this._events[e]=[]))){for(n=Math.max(0,arguments.length-1),i=[],r=0;r<n;r++)i[r]=arguments[r+1];for(r=0;r<t.length;r++)t[r].callback.apply(t[r].context,i)}},off:function(e){e?this._events[e]=void 0:this._events={}}},t.Sound=function(e,i){var r=this,o=t.Util,s=function(e){if(e&&!o.isFunction(e)&&!o.isString(e)&&!o.isObject(e))return"Description type not supported. Initialize a sound using an object, a function or a string.";if(o.isObject(e)){if(!o.isString(e.source)||-1===["wave","file","input","script","sound"].indexOf(e.source))return"Specified source not supported. Sources can be wave, file, input or script";if(!("file"!==e.source||e.options&&e.options.path))return"A path is needed for sounds with a file source";if(!("script"!==e.source||e.options&&e.options.audioFunction))return"An audio function is needed for sounds with a script source"}}(e),a=o.isObject(e)&&o.isObject(e.options);if(s)throw console.error(s),new Error("Error initializing Pizzicato Sound: "+s);function c(e,i){e=e||{},this.getRawSourceNode=function(){var n=this.sourceNode?this.sourceNode.frequency.value:e.frequency,i=t.context.createOscillator();return i.type=e.type||"sine",i.frequency.value=n||440,i},this.sourceNode=this.getRawSourceNode(),this.sourceNode.gainSuccessor=n.context.createGain(),this.sourceNode.connect(this.sourceNode.gainSuccessor),o.isFunction(i)&&i()}function l(e,n){e=o.isArray(e)?e:[e];var i=new XMLHttpRequest;i.open("GET",e[0],!0),i.responseType="arraybuffer",i.onload=function(i){t.context.decodeAudioData(i.target.response,function(e){r.getRawSourceNode=function(){var n=t.context.createBufferSource();return n.loop=this.loop,n.buffer=e,n},o.isFunction(n)&&n()}.bind(r),function(t){if(console.error("Error decoding audio file "+e[0]),e.length>1)return e.shift(),void l(e,n);t=t||new Error("Error decoding audio file "+e[0]),o.isFunction(n)&&n(t)}.bind(r))},i.onreadystatechange=function(t){4===i.readyState&&200!==i.status&&console.error("Error while fetching "+e[0]+". "+i.statusText)},i.send()}function u(e,n){var i=o.isFunction(e)?e:e.audioFunction,r=o.isObject(e)&&e.bufferSize?e.bufferSize:null;if(!r)try{t.context.createScriptProcessor()}catch(e){r=2048}this.getRawSourceNode=function(){var e=t.context.createScriptProcessor(r,1,1);return e.onaudioprocess=i,e}}this.detached=a&&e.options.detached,this.masterVolume=t.context.createGain(),this.fadeNode=t.context.createGain(),this.fadeNode.gain.value=0,this.detached||this.masterVolume.connect(t.masterGainNode),this.lastTimePlayed=0,this.effects=[],this.effectConnectors=[],this.playing=this.paused=!1,this.loop=a&&e.options.loop,this.attack=a&&o.isNumber(e.options.attack)?e.options.attack:.04,this.volume=a&&o.isNumber(e.options.volume)?e.options.volume:1,a&&o.isNumber(e.options.release)?this.release=e.options.release:a&&o.isNumber(e.options.sustain)?(console.warn("'sustain' is deprecated. Use 'release' instead."),this.release=e.options.sustain):this.release=.04,e?o.isString(e)?l.bind(this)(e,i):o.isFunction(e)?u.bind(this)(e,i):"file"===e.source?l.bind(this)(e.options.path,i):"wave"===e.source?c.bind(this)(e.options,i):"input"===e.source?function(e,n){if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,!navigator.getUserMedia&&!navigator.mediaDevices.getUserMedia)return void console.error("Your browser does not support getUserMedia");var i=function(e){r.getRawSourceNode=function(){return t.context.createMediaStreamSource(e)},o.isFunction(n)&&n()}.bind(r),s=function(e){o.isFunction(n)&&n(e)};navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then(i).catch(s):navigator.getUserMedia({audio:!0},i,s)}.bind(this)(e,i):"script"===e.source?u.bind(this)(e.options,i):"sound"===e.source&&function(e,t){this.getRawSourceNode=e.sound.getRawSourceNode,e.sound.sourceNode&&n.Util.isOscillator(e.sound.sourceNode)&&(this.sourceNode=this.getRawSourceNode(),this.frequency=e.sound.frequency)}.bind(this)(e.options,i):c.bind(this)({},i)},t.Sound.prototype=Object.create(t.Events,{play:{enumerable:!0,value:function(e,i){this.playing||(n.Util.isNumber(i)||(i=this.offsetTime||0),n.Util.isNumber(e)||(e=0),this.playing=!0,this.paused=!1,this.sourceNode=this.getSourceNode(),this.applyAttack(),n.Util.isFunction(this.sourceNode.start)&&(this.lastTimePlayed=t.context.currentTime-i,this.sourceNode.start(n.context.currentTime+e,i)),this.trigger("play"))}},stop:{enumerable:!0,value:function(){(this.paused||this.playing)&&(this.paused=this.playing=!1,this.stopWithRelease(),this.offsetTime=0,this.trigger("stop"))}},pause:{enumerable:!0,value:function(){if(!this.paused&&this.playing){this.paused=!0,this.playing=!1,this.stopWithRelease();var e=n.context.currentTime-this.lastTimePlayed;this.sourceNode.buffer?this.offsetTime=e%(this.sourceNode.buffer.length/n.context.sampleRate):this.offsetTime=e,this.trigger("pause")}}},clone:{enumerable:!0,value:function(){for(var e=new t.Sound({source:"sound",options:{loop:this.loop,attack:this.attack,release:this.release,volume:this.volume,sound:this}}),n=0;n<this.effects.length;n++)e.addEffect(this.effects[n]);return e}},onEnded:{enumerable:!0,value:function(e){return function(){this.sourceNode&&this.sourceNode!==e||(this.playing&&this.stop(),this.paused||this.trigger("end"))}}},addEffect:{enumerable:!0,value:function(e){if(!n.Util.isEffect(e))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(e);var t=this.effectConnectors.length>0?this.effectConnectors[this.effectConnectors.length-1]:this.fadeNode;t.disconnect(),t.connect(e);var i=n.context.createGain();return this.effectConnectors.push(i),e.connect(i),i.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(e){var t=this.effects.indexOf(e);if(-1===t)return console.warn("Cannot remove effect that is not applied to this sound."),this;var n=this.playing;n&&this.pause();var i=0===t?this.fadeNode:this.effectConnectors[t-1];i.disconnect();var r,o=this.effectConnectors[t];return o.disconnect(),e.disconnect(o),this.effectConnectors.splice(t,1),this.effects.splice(t,1),r=t>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[t],i.connect(r),n&&this.play(),this}},connect:{enumerable:!0,value:function(e){return this.masterVolume.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.masterVolume.disconnect(e),this}},connectEffects:{enumerable:!0,value:function(){for(var e=[],t=0;t<this.effects.length;t++){var i=t===this.effects.length-1?this.masterVolume:this.effects[t+1].inputNode;e[t]=n.context.createGain(),this.effects[t].outputNode.disconnect(this.effectConnectors[t]),this.effects[t].outputNode.connect(i)}}},volume:{enumerable:!0,get:function(){if(this.masterVolume)return this.masterVolume.gain.value},set:function(e){n.Util.isInRange(e,0,1)&&this.masterVolume&&(this.masterVolume.gain.value=e)}},frequency:{enumerable:!0,get:function(){return this.sourceNode&&n.Util.isOscillator(this.sourceNode)?this.sourceNode.frequency.value:null},set:function(e){this.sourceNode&&n.Util.isOscillator(this.sourceNode)&&(this.sourceNode.frequency.value=e)}},sustain:{enumerable:!0,get:function(){return console.warn("'sustain' is deprecated. Use 'release' instead."),this.release},set:function(e){console.warn("'sustain' is deprecated. Use 'release' instead."),n.Util.isInRange(e,0,10)&&(this.release=e)}},getSourceNode:{enumerable:!0,value:function(){if(this.sourceNode){var e=this.sourceNode;e.gainSuccessor.gain.setValueAtTime(e.gainSuccessor.gain.value,n.context.currentTime),e.gainSuccessor.gain.linearRampToValueAtTime(1e-4,n.context.currentTime+.2),setTimeout((function(){e.disconnect(),e.gainSuccessor.disconnect()}),200)}var t=this.getRawSourceNode();return t.gainSuccessor=n.context.createGain(),t.connect(t.gainSuccessor),t.gainSuccessor.connect(this.fadeNode),this.fadeNode.connect(this.getInputNode()),n.Util.isAudioBufferSourceNode(t)&&(t.onended=this.onEnded(t).bind(this)),t}},getInputNode:{enumerable:!0,value:function(){return this.effects.length>0?this.effects[0].inputNode:this.masterVolume}},applyAttack:{enumerable:!1,value:function(){this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(n.context.currentTime),this.attack){var e=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,t=this.attack;e||(t=(1-this.fadeNode.gain.value)*this.attack),this.fadeNode.gain.setTargetAtTime(1,n.context.currentTime,2*t)}else this.fadeNode.gain.setTargetAtTime(1,n.context.currentTime,.001)}},stopWithRelease:{enumerable:!1,value:function(e){var t=this.sourceNode,i=function(){return n.Util.isFunction(t.stop)?t.stop(0):t.disconnect()};this.fadeNode.gain.value;if(this.fadeNode.gain.cancelScheduledValues(n.context.currentTime),!this.release)return this.fadeNode.gain.setTargetAtTime(0,n.context.currentTime,.001),void i();var r=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,o=this.release;r||(o=this.fadeNode.gain.value*this.release),this.fadeNode.gain.setTargetAtTime(1e-5,n.context.currentTime,o/5),window.setTimeout((function(){i()}),1e3*o)}}}),t.Group=function(e){e=e||[],this.mergeGainNode=n.context.createGain(),this.masterVolume=n.context.createGain(),this.sounds=[],this.effects=[],this.effectConnectors=[],this.mergeGainNode.connect(this.masterVolume),this.masterVolume.connect(n.masterGainNode);for(var t=0;t<e.length;t++)this.addSound(e[t])},t.Group.prototype=Object.create(n.Events,{connect:{enumerable:!0,value:function(e){return this.masterVolume.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.masterVolume.disconnect(e),this}},addSound:{enumerable:!0,value:function(e){n.Util.isSound(e)?this.sounds.indexOf(e)>-1?console.warn("The Pizzicato.Sound object was already added to this group"):e.detached?console.warn("Groups do not support detached sounds. You can manually create an audio graph to group detached sounds together."):(e.disconnect(n.masterGainNode),e.connect(this.mergeGainNode),this.sounds.push(e)):console.error("You can only add Pizzicato.Sound objects")}},removeSound:{enumerable:!0,value:function(e){var t=this.sounds.indexOf(e);-1!==t?(e.disconnect(this.mergeGainNode),e.connect(n.masterGainNode),this.sounds.splice(t,1)):console.warn("Cannot remove a sound that is not part of this group.")}},volume:{enumerable:!0,get:function(){if(this.masterVolume)return this.masterVolume.gain.value},set:function(e){n.Util.isInRange(e,0,1)&&(this.masterVolume.gain.value=e)}},play:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].play();this.trigger("play")}},stop:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].stop();this.trigger("stop")}},pause:{enumerable:!0,value:function(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].pause();this.trigger("pause")}},addEffect:{enumerable:!0,value:function(e){if(!n.Util.isEffect(e))return console.error("The object provided is not a Pizzicato effect."),this;this.effects.push(e);var t=this.effectConnectors.length>0?this.effectConnectors[this.effectConnectors.length-1]:this.mergeGainNode;t.disconnect(),t.connect(e);var i=n.context.createGain();return this.effectConnectors.push(i),e.connect(i),i.connect(this.masterVolume),this}},removeEffect:{enumerable:!0,value:function(e){var t=this.effects.indexOf(e);if(-1===t)return console.warn("Cannot remove effect that is not applied to this group."),this;var n=0===t?this.mergeGainNode:this.effectConnectors[t-1];n.disconnect();var i,r=this.effectConnectors[t];return r.disconnect(),e.disconnect(r),this.effectConnectors.splice(t,1),this.effects.splice(t,1),i=t>this.effects.length-1||0===this.effects.length?this.masterVolume:this.effects[t],n.connect(i),this}}}),t.Effects={};var u=Object.create(null,{connect:{enumerable:!0,value:function(e){return this.outputNode.connect(e),this}},disconnect:{enumerable:!0,value:function(e){return this.outputNode.disconnect(e),this}}});t.Effects.Delay=function(e){this.options={},e=e||this.options;var n={feedback:.5,time:.3,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.delayNode),this.inputNode.connect(this.delayNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Delay.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNode.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}}}),t.Effects.Compressor=function(e){this.options={},e=e||this.options;var n={threshold:-24,knee:30,attack:.003,release:.25,ratio:12};for(var i in this.inputNode=this.compressorNode=t.context.createDynamicsCompressor(),this.outputNode=t.context.createGain(),this.compressorNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Compressor.prototype=Object.create(u,{threshold:{enumerable:!0,get:function(){return this.compressorNode.threshold.value},set:function(e){t.Util.isInRange(e,-100,0)&&(this.compressorNode.threshold.value=e)}},knee:{enumerable:!0,get:function(){return this.compressorNode.knee.value},set:function(e){t.Util.isInRange(e,0,40)&&(this.compressorNode.knee.value=e)}},attack:{enumerable:!0,get:function(){return this.compressorNode.attack.value},set:function(e){t.Util.isInRange(e,0,1)&&(this.compressorNode.attack.value=e)}},release:{enumerable:!0,get:function(){return this.compressorNode.release.value},set:function(e){t.Util.isInRange(e,0,1)&&(this.compressorNode.release.value=e)}},ratio:{enumerable:!0,get:function(){return this.compressorNode.ratio.value},set:function(e){t.Util.isInRange(e,1,20)&&(this.compressorNode.ratio.value=e)}},getCurrentGainReduction:function(){return this.compressorNode.reduction}}),t.Effects.LowPassFilter=function(e){f.call(this,e,"lowpass")},t.Effects.HighPassFilter=function(e){f.call(this,e,"highpass")};var h=Object.create(u,{frequency:{enumerable:!0,get:function(){return this.filterNode.frequency.value},set:function(e){t.Util.isInRange(e,10,22050)&&(this.filterNode.frequency.value=e)}},peak:{enumerable:!0,get:function(){return this.filterNode.Q.value},set:function(e){t.Util.isInRange(e,1e-4,1e3)&&(this.filterNode.Q.value=e)}}});t.Effects.LowPassFilter.prototype=h,t.Effects.HighPassFilter.prototype=h,t.Effects.Distortion=function(e){this.options={},e=e||this.options;var n={gain:.5};for(var i in this.waveShaperNode=t.context.createWaveShaper(),this.inputNode=this.outputNode=this.waveShaperNode,n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Distortion.prototype=Object.create(u,{gain:{enumerable:!0,get:function(){return this.options.gain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.gain=e,this.adjustGain())}},adjustGain:{writable:!1,configurable:!1,enumerable:!1,value:function(){for(var e,t=n.Util.isNumber(this.options.gain)?parseInt(100*this.options.gain,10):50,i=44100,r=new Float32Array(i),o=Math.PI/180,s=0;s<i;++s)e=2*s/i-1,r[s]=(3+t)*e*20*o/(Math.PI+t*Math.abs(e));this.waveShaperNode.curve=r}}}),t.Effects.Flanger=function(e){this.options={},e=e||this.options;var n={time:.45,speed:.2,depth:.1,feedback:.1,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.inputFeedbackNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.oscillatorNode=t.context.createOscillator(),this.gainNode=t.context.createGain(),this.feedbackNode=t.context.createGain(),this.oscillatorNode.type="sine",this.inputNode.connect(this.inputFeedbackNode),this.inputNode.connect(this.dryGainNode),this.inputFeedbackNode.connect(this.delayNode),this.inputFeedbackNode.connect(this.wetGainNode),this.delayNode.connect(this.wetGainNode),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.inputFeedbackNode),this.oscillatorNode.connect(this.gainNode),this.gainNode.connect(this.delayNode.delayTime),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),this.oscillatorNode.start(0),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Flanger.prototype=Object.create(u,{time:{enumberable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.time=e,this.delayNode.delayTime.value=n.Util.normalize(e,.001,.02))}},speed:{enumberable:!0,get:function(){return this.options.speed},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.speed=e,this.oscillatorNode.frequency.value=n.Util.normalize(e,.5,5))}},depth:{enumberable:!0,get:function(){return this.options.depth},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.depth=e,this.gainNode.gain.value=n.Util.normalize(e,5e-4,.005))}},feedback:{enumberable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=e,this.feedbackNode.gain.value=n.Util.normalize(e,0,.8))}},mix:{enumberable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}}}),t.Effects.StereoPanner=function(e){this.options={},e=e||this.options;var n={pan:0};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),t.context.createStereoPanner?(this.pannerNode=t.context.createStereoPanner(),this.inputNode.connect(this.pannerNode),this.pannerNode.connect(this.outputNode)):t.context.createPanner?(console.warn("Your browser does not support the StereoPannerNode. Will use PannerNode instead."),this.pannerNode=t.context.createPanner(),this.pannerNode.type="equalpower",this.inputNode.connect(this.pannerNode),this.pannerNode.connect(this.outputNode)):(console.warn("Your browser does not support the Panner effect."),this.inputNode.connect(this.outputNode)),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.StereoPanner.prototype=Object.create(u,{pan:{enumerable:!0,get:function(){return this.options.pan},set:function(e){n.Util.isInRange(e,-1,1)&&(this.options.pan=e,this.pannerNode&&(this.pannerNode.toString().indexOf("StereoPannerNode")>-1?this.pannerNode.pan.value=e:this.pannerNode.setPosition(e,0,1-Math.abs(e))))}}}),t.Effects.Convolver=function(e,i){this.options={},e=e||this.options;var r=this,o=new XMLHttpRequest,s={mix:.5};for(var a in this.callback=i,this.inputNode=t.context.createGain(),this.convolverNode=t.context.createConvolver(),this.outputNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.inputNode.connect(this.convolverNode),this.convolverNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),s)this[a]=e[a],this[a]=void 0===this[a]||null===this[a]?s[a]:this[a];e.impulse?(o.open("GET",e.impulse,!0),o.responseType="arraybuffer",o.onload=function(e){var i=e.target.response;t.context.decodeAudioData(i,(function(e){r.convolverNode.buffer=e,r.callback&&n.Util.isFunction(r.callback)&&r.callback()}),(function(e){e=e||new Error("Error decoding impulse file"),r.callback&&n.Util.isFunction(r.callback)&&r.callback(e)}))},o.onreadystatechange=function(t){4===o.readyState&&200!==o.status&&console.error("Error while fetching "+e.impulse+". "+o.statusText)},o.send()):console.error("No impulse file specified.")},t.Effects.Convolver.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}}}),t.Effects.PingPongDelay=function(e){this.options={},e=e||this.options;var n={feedback:.5,time:.3,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.delayNodeLeft=t.context.createDelay(),this.delayNodeRight=t.context.createDelay(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.channelMerger=t.context.createChannelMerger(2),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.delayNodeLeft.connect(this.channelMerger,0,0),this.delayNodeRight.connect(this.channelMerger,0,1),this.delayNodeLeft.connect(this.delayNodeRight),this.feedbackGainNode.connect(this.delayNodeLeft),this.delayNodeRight.connect(this.feedbackGainNode),this.inputNode.connect(this.feedbackGainNode),this.channelMerger.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.PingPongDelay.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNodeLeft.delayTime.value=e,this.delayNodeRight.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}}}),t.Effects.Reverb=function(e){this.options={},e=e||this.options;var n={mix:.5,time:.01,decay:.01,reverse:!1};for(var i in this.inputNode=t.context.createGain(),this.reverbNode=t.context.createConvolver(),this.outputNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.inputNode.connect(this.reverbNode),this.reverbNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i];p.bind(this)()},t.Effects.Reverb.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,1e-4,10)&&(this.options.time=e,p.bind(this)())}},decay:{enumerable:!0,get:function(){return this.options.decay},set:function(e){n.Util.isInRange(e,1e-4,10)&&(this.options.decay=e,p.bind(this)())}},reverse:{enumerable:!0,get:function(){return this.options.reverse},set:function(e){n.Util.isBool(e)&&(this.options.reverse=e,p.bind(this)())}}}),t.Effects.Tremolo=function(e){this.options={},e=e||this.options;var n={speed:4,depth:1,mix:.8};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.tremoloGainNode=t.context.createGain(),this.tremoloGainNode.gain.value=0,this.lfoNode=t.context.createOscillator(),this.shaperNode=t.context.createWaveShaper(),this.shaperNode.curve=new Float32Array([0,1]),this.shaperNode.connect(this.tremoloGainNode.gain),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.lfoNode.connect(this.shaperNode),this.lfoNode.type="sine",this.lfoNode.start(0),this.inputNode.connect(this.tremoloGainNode),this.tremoloGainNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.Tremolo.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(e){n.Util.isInRange(e,0,20)&&(this.options.speed=e,this.lfoNode.frequency.value=e)}},depth:{enumerable:!0,get:function(){return this.options.depth},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.depth=e,this.shaperNode.curve=new Float32Array([1-e,1]))}}}),t.Effects.DubDelay=function(e){this.options={},e=e||this.options;var n={feedback:.6,time:.7,mix:.5,cutoff:700};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.feedbackGainNode=t.context.createGain(),this.delayNode=t.context.createDelay(),this.bqFilterNode=t.context.createBiquadFilter(),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.feedbackGainNode),this.feedbackGainNode.connect(this.bqFilterNode),this.bqFilterNode.connect(this.delayNode),this.delayNode.connect(this.feedbackGainNode),this.delayNode.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]},t.Effects.DubDelay.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},time:{enumerable:!0,get:function(){return this.options.time},set:function(e){n.Util.isInRange(e,0,180)&&(this.options.time=e,this.delayNode.delayTime.value=e)}},feedback:{enumerable:!0,get:function(){return this.options.feedback},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.feedback=parseFloat(e,10),this.feedbackGainNode.gain.value=this.feedback)}},cutoff:{enumerable:!0,get:function(){return this.options.cutoff},set:function(e){n.Util.isInRange(e,0,4e3)&&(this.options.cutoff=e,this.bqFilterNode.frequency.value=this.cutoff)}}}),t.Effects.RingModulator=function(e){this.options={},e=e||this.options;var n={speed:30,distortion:1,mix:.5};for(var i in this.inputNode=t.context.createGain(),this.outputNode=t.context.createGain(),this.dryGainNode=t.context.createGain(),this.wetGainNode=t.context.createGain(),this.vIn=t.context.createOscillator(),this.vIn.start(0),this.vInGain=t.context.createGain(),this.vInGain.gain.value=.5,this.vInInverter1=t.context.createGain(),this.vInInverter1.gain.value=-1,this.vInInverter2=t.context.createGain(),this.vInInverter2.gain.value=-1,this.vInDiode1=new d(t.context),this.vInDiode2=new d(t.context),this.vInInverter3=t.context.createGain(),this.vInInverter3.gain.value=-1,this.vcInverter1=t.context.createGain(),this.vcInverter1.gain.value=-1,this.vcDiode3=new d(t.context),this.vcDiode4=new d(t.context),this.outGain=t.context.createGain(),this.outGain.gain.value=3,this.compressor=t.context.createDynamicsCompressor(),this.compressor.threshold.value=-24,this.compressor.ratio.value=16,this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode),this.inputNode.connect(this.vcInverter1),this.inputNode.connect(this.vcDiode4.node),this.vcInverter1.connect(this.vcDiode3.node),this.vIn.connect(this.vInGain),this.vInGain.connect(this.vInInverter1),this.vInGain.connect(this.vcInverter1),this.vInGain.connect(this.vcDiode4.node),this.vInInverter1.connect(this.vInInverter2),this.vInInverter1.connect(this.vInDiode2.node),this.vInInverter2.connect(this.vInDiode1.node),this.vInDiode1.connect(this.vInInverter3),this.vInDiode2.connect(this.vInInverter3),this.vInInverter3.connect(this.compressor),this.vcDiode3.connect(this.compressor),this.vcDiode4.connect(this.compressor),this.compressor.connect(this.outGain),this.outGain.connect(this.wetGainNode),this.wetGainNode.connect(this.outputNode),n)this[i]=e[i],this[i]=void 0===this[i]||null===this[i]?n[i]:this[i]};var d=function(e){this.context=e,this.node=this.context.createWaveShaper(),this.vb=.2,this.vl=.4,this.h=1,this.setCurve()};return d.prototype.setDistortion=function(e){return this.h=e,this.setCurve()},d.prototype.setCurve=function(){var e,t,n,i,r,o,s;for(t=1024,e=o=0,s=(r=new Float32Array(t)).length;0<=s?o<s:o>s;e=0<=s?++o:--o)n=(e-512)/512,i=(n=Math.abs(n))<=this.vb?0:this.vb<n&&n<=this.vl?this.h*(Math.pow(n-this.vb,2)/(2*this.vl-2*this.vb)):this.h*n-this.h*this.vl+this.h*(Math.pow(this.vl-this.vb,2)/(2*this.vl-2*this.vb)),r[e]=i;return this.node.curve=r},d.prototype.connect=function(e){return this.node.connect(e)},t.Effects.RingModulator.prototype=Object.create(u,{mix:{enumerable:!0,get:function(){return this.options.mix},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.mix=e,this.dryGainNode.gain.value=t.Util.getDryLevel(this.mix),this.wetGainNode.gain.value=t.Util.getWetLevel(this.mix))}},speed:{enumerable:!0,get:function(){return this.options.speed},set:function(e){n.Util.isInRange(e,0,2e3)&&(this.options.speed=e,this.vIn.frequency.value=e)}},distortion:{enumerable:!0,get:function(){return this.options.distortion},set:function(e){if(n.Util.isInRange(e,.2,50)){this.options.distortion=parseFloat(e,10);for(var t=[this.vInDiode1,this.vInDiode2,this.vcDiode3,this.vcDiode4],i=0,r=t.length;i<r;i++)t[i].setDistortion(e)}}}}),t.Effects.Quadrafuzz=function(e){this.options={},e=e||this.options;var t={lowGain:.6,midLowGain:.8,midHighGain:.5,highGain:.6};this.inputNode=n.context.createGain(),this.outputNode=n.context.createGain(),this.dryGainNode=n.context.createGain(),this.wetGainNode=n.context.createGain(),this.lowpassLeft=n.context.createBiquadFilter(),this.lowpassLeft.type="lowpass",this.lowpassLeft.frequency.value=147,this.lowpassLeft.Q.value=.7071,this.bandpass1Left=n.context.createBiquadFilter(),this.bandpass1Left.type="bandpass",this.bandpass1Left.frequency.value=587,this.bandpass1Left.Q.value=.7071,this.bandpass2Left=n.context.createBiquadFilter(),this.bandpass2Left.type="bandpass",this.bandpass2Left.frequency.value=2490,this.bandpass2Left.Q.value=.7071,this.highpassLeft=n.context.createBiquadFilter(),this.highpassLeft.type="highpass",this.highpassLeft.frequency.value=4980,this.highpassLeft.Q.value=.7071,this.overdrives=[];for(var i=0;i<4;i++)this.overdrives[i]=n.context.createWaveShaper(),this.overdrives[i].curve=g();this.inputNode.connect(this.wetGainNode),this.inputNode.connect(this.dryGainNode),this.dryGainNode.connect(this.outputNode);var r=[this.lowpassLeft,this.bandpass1Left,this.bandpass2Left,this.highpassLeft];for(i=0;i<r.length;i++)this.wetGainNode.connect(r[i]),r[i].connect(this.overdrives[i]),this.overdrives[i].connect(this.outputNode);for(var o in t)this[o]=e[o],this[o]=void 0===this[o]||null===this[o]?t[o]:this[o]},t.Effects.Quadrafuzz.prototype=Object.create(u,{lowGain:{enumerable:!0,get:function(){return this.options.lowGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.lowGain=e,this.overdrives[0].curve=g(n.Util.normalize(this.lowGain,0,150)))}},midLowGain:{enumerable:!0,get:function(){return this.options.midLowGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.midLowGain=e,this.overdrives[1].curve=g(n.Util.normalize(this.midLowGain,0,150)))}},midHighGain:{enumerable:!0,get:function(){return this.options.midHighGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.midHighGain=e,this.overdrives[2].curve=g(n.Util.normalize(this.midHighGain,0,150)))}},highGain:{enumerable:!0,get:function(){return this.options.highGain},set:function(e){n.Util.isInRange(e,0,1)&&(this.options.highGain=e,this.overdrives[3].curve=g(n.Util.normalize(this.highGain,0,150)))}}}),t}function f(e,i){this.options={},e=e||this.options;var r={frequency:350,peak:1};for(var o in this.inputNode=this.filterNode=n.context.createBiquadFilter(),this.filterNode.type=i,this.outputNode=t.context.createGain(),this.filterNode.connect(this.outputNode),r)this[o]=e[o],this[o]=void 0===this[o]||null===this[o]?r[o]:this[o]}function p(){var e,i,r=n.context.sampleRate*this.time,o=t.context.createBuffer(2,r,n.context.sampleRate),s=o.getChannelData(0),a=o.getChannelData(1);for(i=0;i<r;i++)e=this.reverse?r-i:i,s[i]=(2*Math.random()-1)*Math.pow(1-e/r,this.decay),a[i]=(2*Math.random()-1)*Math.pow(1-e/r,this.decay);this.reverbNode.buffer&&(this.inputNode.disconnect(this.reverbNode),this.reverbNode.disconnect(this.wetGainNode),this.reverbNode=t.context.createConvolver(),this.inputNode.connect(this.reverbNode),this.reverbNode.connect(this.wetGainNode)),this.reverbNode.buffer=o}function g(e){for(var t=n.context.sampleRate,i=new Float32Array(t),r=Math.PI/180,o=0;o<t;o++){var s=2*o/t-1;i[o]=(3+e)*s*20*r/(Math.PI+e*Math.abs(s))}return i}console.error("No AudioContext found in this environment. Please ensure your window or global object contains a working AudioContext constructor function.")}("undefined"!=typeof window?window:global),define("user_code/sound",["event_bus","toxilibs/extlibs/pizzicato-0.6.4"],(function(e,t){const n=[],i=["sine","square","triangle","sawtooth"];return e.on("render execution about to start",(function(){n.forEach((e=>e.stop())),n.length=0})),{createSound:function(e={}){let{source:r="sine",duration:o=!1,volume:s=1,release:a=.04,attack:c=.04}=e;const l={volume:s,release:a,attack:c};if("function"==typeof r)l.audioFunction=r,e.bufferSize&&(l.bufferSize=e.bufferSize),r="script";else if(i.includes(r)){let{frequency:t=440}=e;l.type=r,l.frequency=t,r="wave"}else if("input"!==r){const{loop:t=!1}=e;l.loop=t,l.path=r,r="file"}let u=new t.Sound({source:r,options:l});return!1!==o&&u.on("play",(function(){setTimeout((()=>u.stop()),1e3*o)})),n.push(u),u}}})),define("user_code/pause",[],(function(){return function(e){return new Promise((t=>setTimeout(t,e)))}})),define("user_code/http",["jquery"],(function(e){function t({jqXHR:e,url:t,errorText:n}){const{status:i}=e;return n=0===i?"Server not responding at : "+t:404===i?"Page not found [404] : "+t:401===i?"Unauthorized [401] : "+t:500===i?"Internal Server Error [500] for : "+t:"Server Error ["+i+"] for : "+t,new Error(n)}function n(e){return new Promise(((t,n)=>{fetch(e).then((e=>(e.ok||n(e),e.blob()))).then(t).catch(n)}))}function i(e,{jqXHR:t}={}){return new Promise(((n,i)=>{const r=new Image;r.addEventListener("load",(()=>n(r))),r.addEventListener("error",(()=>{i(new Error("could not load image"))})),r.originalBlob=e,t&&(r.headers=function(e){const t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),n={};return t.forEach((e=>{const t=e.split(": "),i=t.shift(),r=t.join(": ");n[i]=r})),n}(t)),r.crossOrigin="Anonymous",r.src=window.URL.createObjectURL(e)}))}return{urlFor:function(e){const t=e.match(/(.*)-([a-zA-Z0-9]{8})\.(\w*)$/);if(!t)throw new Error("Asset name is not correct");const[,n,i,r]=t;return`https://explorers-assets.toxicode.fr/${i}__${n}.${r}?bust=34`},httpPost:function({url:n,params:i}){let r=new FormData;for(let e in i)r.append(e,i[e]);return new Promise(((i,o)=>{e.ajax({url:n,method:"POST",data:r,processData:!1,contentType:!1,cache:!1,success:i,error:(e,i,r)=>{o(t({jqXHR:e,errorText:r,url:n}))}})}))},httpPostForImage:function({url:n,params:r}){let o=new FormData;for(let e in r)o.append(e,r[e]);return new Promise(((r,s)=>{e.ajax({url:n,method:"POST",data:o,processData:!1,contentType:!1,cache:!1,xhr:function(){let e=new XMLHttpRequest;return e.responseType="blob",e},success:(e,t,n)=>{i(e,{jqXHR:n}).then(r).catch(s)},error:(e,i,r)=>{s(t({jqXHR:e,errorText:r,url:n}))}})}))},fetchBlob:n,fetchImageSource:async function(e){return i(await n(e))}}})),define("toxilibs/color_picker",["jquery","./screen","./screen_image","./color"],(function(e,t,n,i){let r;const o=1.65,s=2.15;function a(e){const{screen:t,colorSquareImage:n}=e;e.color=i.createFromOkHSV(e),t.clear(),t.drawImage(r),t.drawImage({image:n,center:{x:0,y:0},width:2,height:2}),t.drawRectangle({center:{x:2*e.saturation-1,y:2*e.value-1},width:.15,height:.15,fillColor:"#FFF",strokeColor:"#333"});let o=360*e.hue;t.drawPie({center:{x:0,y:0},radius:2.1999999999999997,innerRadius:1.5999999999999999,startAngle:o-1.2,endAngle:o+1.2,fillColor:"#FFF"}),t.drawRectangle({center:{x:3,y:0},width:1,height:3,fillColor:e.color})}function c(e,t,n){const i=h(t,n);e.hue=i,u(e),a(e)}function l(e,t,n){e.saturation=Math.max(0,Math.min(1,(1+t)/2)),e.value=Math.max(0,Math.min(1,(1+n)/2)),a(e)}function u(e){const{hue:t}=e;e.colorSquareImage.setColorForEachPixel(((e,n)=>i.createFromOkHSV({hue:t,saturation:e,value:n})))}function h(e,t){return(Math.atan2(t,e)/(2*Math.PI)+1)%1}return function({container:d,color:f,callback:p=(()=>{})}){r||function(){r=new n({center:{x:0,y:0},width:4.4,height:4.4,widthInPixels:600,heightInPixels:600,useOpacity:!0});const e={red255:0,green255:0,blue255:0,opacity:0};r.setColorForEachPixel(((t,n)=>{const r=Math.abs(1.9-Math.sqrt(t*t+n*n))-.25;if(r>0)return e;const o=h(t,n);let s=Math.min(1,20*-r);return i.createFromOklab({L:.7,h:o,C:.28,opacity:s})}))}(),this.colorSquareImage=new n({bottomLeft:{x:0,y:0},width:1,height:1,widthInPixels:40,heightInPixels:40}),this.container=d,d.css({position:"relative"});const g=document.createElement("canvas");g.style.position="absolute",g.style.top=0,g.style.left=0,g.style.width="100%",g.style.height="100%",g.width=d.innerWidth(),g.height=d.innerHeight(),d.append(g);let m=e("<button>ok</button>");m.css({position:"absolute",bottom:0,right:0}),m.on("click",(()=>{p(this.color)})),d.append(m),this.screen=new t(g),this.screen.setOptimalView([{x:-2.5,y:-3},{x:4,y:3}]),d.on("mousedown",(t=>function(t,n){const{screen:i}=t;let{x:r,y:a}=i.mouseEventToCoords(n);const u=Math.sqrt(r*r+a*a);e("body").one("mouseup",(()=>{delete t.moveMode})),o<u&&u<s?(t.moveMode="hue",c(t,r,a)):function(e,t){return-1<e&&e<1&&-1<t&&t<1}(r,a)&&(t.moveMode="square",l(t,r,a))}(this,t))),d.on("mousemove",(e=>function(e,t){const{screen:n,moveMode:i}=e;if(!i)return;let{x:r,y:o}=n.mouseEventToCoords(t);"hue"===i?c(e,r,o):"square"===i&&l(e,r,o)}(this,e))),function(e,t){if(t){t instanceof i||(t=new i(t));let{hue:n,value:r,saturation:o}=i.convertSRGBToOkHSV(t);e.hue=n,e.value=r,e.saturation=o}else e.hue=Math.random(),e.value=.5,e.saturation=.7;u(e)}(this,f),a(this)}})),define("toxilibs/copy_to_clipboard",[],(function(){return function(e){const t=document.activeElement,n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n);let i=document.getSelection();const r=i.rangeCount>0&&i.getRangeAt(0);n.select(),document.execCommand("copy"),document.body.removeChild(n),r&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(r)),t.focus()}})),define("logger",["event_bus"],(function(e){let t=console,n=console;return e.on("terminal logger api ready",(e=>{t=e})),e.on("system wants to log",(function(...e){n===console&&t!==console&&(n=t.terminal.system);e.forEach((e=>n.log(e)))})),{log:(...e)=>t.log(...e),rawLog:(...e)=>{t===console?console.log(...e):t.rawLog(...e)},error:(...e)=>t.error(...e),success:(...e)=>{t===console?console.log(...e):t.success(...e)},clear:()=>t.clear()}})),define("view/color_picker",["jquery","toxilibs/color_picker","toxilibs/copy_to_clipboard","logger"],(function(e,t,n,i){return function({color:r,copyToClipboard:o=!0}){const s=e('<div class="color_picker"></div>');return e("body").append(s),new Promise((e=>{new t({container:s,color:r,callback:t=>{s.remove();let r=t.toString();i.log("Color chosen : "+r),o&&n(r),e(r)}})}))}})),define("toxilibs/url_params",[],(function(){function e(e,n){return"#"!==e&&"all"!==e||(n=e,e=!1),e||(e=document.location.href),function(e,n){let r={},o=t(e);(function(e){return"params"===e||"all"===e})(n)&&i(r,o.regularParams);(function(e){return"#"===e||"all"===e})(n)&&i(r,o.hashParams);return r}(e=decodeURI(e.replace(/\+/g," ")),n=n||"params")}function t(e){let t=e.split("#"),n=t[0].split("?");return{mainUrl:n[0],regularParams:n[1],hashParams:t[1]}}function n(t){document.location.href!==t&&history.pushState(e(t),document.title,t)}function i(e,t){if(!t)return;t.split("&").forEach((function(t){let[n,i]=t.split("=");r(e,n,function(e,t){if(void 0===t)return null;t=d(t);let n=Number(t);String(n)===t&&(t=n);if("true"===t)return!0;if("false"===t)return!1;return t}(0,i))}))}function r(e,t,n){const i=t.match(/(\w+)\[(.*)\]/);if(i){const o=i[1],s=i[2];s?function(e,{keyStart:t,insideBrackets:n,value:i}){t in e||(e[t]={});n.indexOf("]")>0&&(n=n.replace("]","")+"]");r(e[t],n,i)}(e,{keyStart:o,insideBrackets:s,value:n}):function(e,t,n){t in e||(e[t]=[]);e[t].push(n)}(e,t,n)}else e[t]=n}function o(e,n,o={}){if(0===Object.keys(n).length)return e;let s=t(e=d(e)),c=encodeURI(s.mainUrl)+"?";if(s.regularParams){let e={};i(e,s.regularParams),n=function(e,t){let n={};for(let t in e)n[t]=e[t];for(let i in t){let o=t[i];i+"[]"in e&&null===o?delete n[i+"[]"]:r(n,i,o)}return n}(e,n)}let l=a(n,o);return l&&(c+=l),s.hashParams&&(c+="#"+s.hashParams),c}function s(e,n,r={}){var o;o=n,n=Array.isArray(o)?o:[o];let s=t(e=decodeURIComponent(e)),c={};i(c,s.regularParams);let l={},u=!1;for(let e in c)-1===n.indexOf(e)?l[e]=c[e]:u=!0;if(!u)return e;let h=s.mainUrl,d=a(l,r);return d&&(h+="?"+d),s.hashParams&&(h+="#"+s.hashParams),h}function a(e,t={}){let n=[];for(let i in e){let r=e[i];i.endsWith("[]")&&(i=i.substring(0,i.length-2)),c(n,{key:i,value:r},t)}return n.join("&")}function c(e,{key:t,value:n},i){let r;r=Array.isArray(n)?u:"object"==typeof n?h:l,r(e,{key:t,value:n},i)}function l(e,{key:t,value:n},{ignoreEmptyParams:i}){""===n&&i||e.push(f(t)+"="+f(n))}function u(e,{key:t,value:n},{useCommaForArrays:i}){if(i)e.push(f(t)+"="+n.map(f).join(","));else{let i=f(t+"[]");n.forEach((t=>{e.push(i+"="+f(t))}))}}function h(e,{key:t,value:n},i){for(let r in n){const o=n[r];r.endsWith("[]")&&(r=r.substring(0,r.length-2)),c(e,{key:t+"["+f(r)+"]",value:o},i)}}function d(e){return decodeURIComponent(e.replace(/\+/g," "))}function f(e){return encodeURIComponent(e).replace(/%20/g,"+")}return e.pushStateAdd=function(e,t){n(o(document.location.href,e,t))},e.pushStateRemove=function(e,t){n(s(document.location.href,e,t))},e.pushStateReplace=function(e,t){n(o(window.location.pathname,e,t))},e.extendUrlWithParams=o,e.removeParamsFromUrl=s,e.paramsToUrlString=a,e.addParamsFromString=i,e.isEmpty=function(){return 0===Object.keys(e()).length},e})),define("user_code/deprecate",["toxilibs/deprecation","logger"],(function(e,t){const{add:n}=e;function i({messagePrefix:e,deprecated:n,updated:i}){e=e?`[${e}] `:"",t.error(`Warning : ${e}'${n}' has been replaced with '${i}'\n            <br>Please update your code accordingly`)}return function(e,t,r){n(r,e,t,{handler:i,onlyWhenCalled:!0})}})),define("user_code/basic_api",["event_bus","editor/snippet_tools","jquery","toxilibs/random","toxilibs/event_capabilities_queued","toxilibs/color","toxilibs/vector","toxilibs/grid","toxilibs/interpolate","toxilibs/smooth_state","toxilibs/screen_group","toxilibs/screen_image","toxilibs/http_loader","toxilibs/webgl_image","toxilibs/noise_2D","toxilibs/stroke","toxilibs/bezier","toxilibs/bezier_path","toxilibs/sprite_collection","toxilibs/recorder","user_code/test_suite","user_code/geometry_api","user_code/stats_api","user_code/agent_api","user_code/sound","user_code/pause","user_code/http","view/color_picker","toxilibs/url_params","toxilibs/download","logger","user_code/deprecate"],(function(e,t,n,i,r,o,s,a,c,l,u,h,d,f,p,g,m,y,x,b,v,w,_,S,C,k,M,E,T,P,A,O){const{addMethodSnippet:D}=t,R={},{urlFor:L,httpPost:N,httpPostForImage:F,fetchImageSource:j,fetchBlob:I}=M;e.on("render execution about to start",(function(){i.reset()}));const q=T(),{pushStateAdd:B,pushStateRemove:z,pushStateReplace:G}=T,H={add:B,remove:z,replace:G};function V(e,t){return new l(e,t)}R.createScreenGroup="simpleFunction",R.fetchImageSource="urlFor('Horsehead_nebula-Jvvl0z1A.jpg')",R.createImage={source:"urlFor('Horsehead_nebula-Jvvl0z1A.jpg')",width:5,center:{x:0,y:0}},R.createWebGLImage={source:"",shader:"''",data:{}};const{createSound:W}=C,{downloadAsFile:U}=P;c._snippet="interpolate(${1:a}, ${2:b}, ${3:t})",V._autoComplete=!0,R.downloadAsFile={name:"'myFile.txt'",content:"'hello'"},E._snippet="colorPicker({color: ${1:'yellow'}})";let $={globals:{},random:i,addEventCapabilities:r,pause:k,geometry:w,stats:_,vector:function(e,t){return new s(e,t)},Color:o,createGrid:function(e){let t={};return a(t,e),t},addGridCapabilities:a,createScreenGroup:function(e){return new u(e)},fetchImageSource:j,fetchBlob:I,createImage:function(e){return new h(e)},createWebGLImage:function(e){return new f(e)},interpolate:c,smoothState:V,Noise2D:p,Stroke:g,Bezier:m,BezierPath:y,createSpriteCollection:function(...e){return new x(...e)},createRecorder:function(e){return new b(e)},expect:v.expect,spec:v,colorPicker:E,createSound:W,downloadAsFile:U,ajax:n.ajax,getJSON:n.getJSON,openUrl:function(e){window.open(e,"_blank").focus()},httpPost:N,httpPostForImage:F,urlParams:q,urlState:H,urlFor:L};O($,{screenGroup:"createScreenGroup",grid:"createGrid"}),Object.assign($,A),Object.assign($,S);for(let e in $){let t=R[e];t&&D($[e],e,t)}return $})),define("toxilibs/timer",[],(function(){function e({endCallback:e,secondsRemainingCallback:t,duration:n=3e4,bonusDelay:i=n/3}={}){this.endCallback=e,this.secondsRemainingCallback=t,this.duration=n,this.bonusDelay=i,this.paused=!0,this.wasNeverLaunched=!0}function t(e){clearTimeout(e.currentTimeout),clearTimeout(e.secondsRemainingTimeout)}function n(e){if(e.secondsRemainingCallback){let t=e.remainingTime();if(t<=0)return;e.secondsRemainingTimeout=setTimeout((function(){e.secondsRemainingCallback(Math.round(e.remainingTime()/1e3)),n(e)}),t%1e3)}}function i(i,r){i.wasNeverLaunched=!1,t(i),i.paused=!1,i.timerStop=e.now()+r,i.timerDelay=r,r<=0?i.endCallback&&i.endCallback():(n(i),i.endCallback&&(i.currentTimeout=setTimeout(i.endCallback,r)))}return e.now=function(){return(new Date).getTime()},e.prototype.launch=function(t){this.startedAt=e.now(),this.pauseDuration=0,this.duration=t||this.duration,i(this,this.duration)},e.prototype.addBonusDelay=function(){this.timerStop-e.now()<this.bonusDelay&&i(this,this.bonusDelay)},e.prototype.add=function(t){if(this.paused)this.remainingTimeAfterPause+=t;else if(this.ended())this.duration+=t;else{i(this,this.timerStop-e.now()+t)}},e.prototype.togglePause=function(){this.paused?this.unPause():this.pause()},e.prototype.pause=function(){this.paused||(t(this),this.paused=!0,this.pausedAt=e.now(),this.remainingTimeAfterPause=this.timerStop-e.now())},e.prototype.unPause=function(){this.wasNeverLaunched?this.launch():this.paused&&(i(this,this.remainingTimeAfterPause),this.pauseDuration+=e.now()-this.pausedAt)},e.prototype.reset=function(){this.pause(),this.pauseDuration=0,this.startedAt=e.now(),this.pausedAt=this.startedAt},e.prototype.restart=function(){this.reset(),this.launch(this.duration)},e.prototype.remainingTime=function(){return this.paused?this.remainingTimeAfterPause:this.timerStop-e.now()},e.prototype.totalTime=function(){if(this.wasNeverLaunched)return 0;return(this.paused?this.pausedAt:e.now())-this.startedAt-this.pauseDuration},e.prototype.ended=function(){return!this.paused&&e.now()>=this.timerStop},e})),define("toxilibs/on_every_frame",[],(function(){function e({forceDeltaTime:e,timeSpeed:t}){return void 0===e?function(e=1){let t=Date.now();const n=e/1e3;return function(){let e=Date.now(),i=(e-t)*n;return t=e,i}}(t):()=>e}return function(t=requestAnimationFrame){return function(n,i={}){i.skip?function(n,{skip:i,deltaTime:r,timeSpeed:o}={}){let s=e({forceDeltaTime:r,timeSpeed:o}),a=0;function c(){0===a&&n(s()),a<i?a++:a=0,t(c)}t(c)}(n,i):function(n,{deltaTime:i,timeSpeed:r}={}){let o=e({forceDeltaTime:i,timeSpeed:r});function s(){n(o()),t(s)}t(s)}(n,i)}}})),define("toxilibs/timers_manager",["./timer","./on_every_frame"],(function(e,t){let n={};function i({id:e="global",errorCallback:t,requestAnimationFrameHasToBeTriggered:i=!1}={}){let o=n[e];return o||(o={},t&&(o.errorCallback=t),r(o,{requestAnimationFrameHasToBeTriggered:i}),n[e]=o),o}function r(n,{requestAnimationFrameHasToBeTriggered:i}={}){let r={},s=0;n.setTimeout=function(t,i){let a=new e({endCallback:o(n,t),duration:i});return s++,r[s]=a,a.launch(),s},n.delay=n.setTimeout,n.setInterval=function(e,t){let i;return i=n.setTimeout((function(){r[i].restart(),e()}),t),i},i?function(e){let t=[];function n(){let e=t;t=[],e.forEach((e=>e()))}e.requestAnimationFrame=function(e){t.push(e)},n=o(e,n),e.triggerAnimationFrame=function(){e.requestAnimationFramePaused||n()},e.clearRequestAnimationFrames=function(){t=[]},e.resumeRequestAnimationFrames=function(){e.requestAnimationFramePaused=!1}}(n):function(e){let t=new Set,n=[];function i(t){return function(){e.requestAnimationFramePaused?n.push(t):t()}}e.requestAnimationFrame=function(n){function r(){t.delete(s),o(e,n)()}let s=requestAnimationFrame(i(r));t.add(s)},e.clearRequestAnimationFrames=function(){t.forEach((e=>cancelAnimationFrame(e))),t=new Set},e.resumeRequestAnimationFrames=function(){e.requestAnimationFramePaused=!1,n.forEach((e=>e())),n=[]}}(n),n.pauseRequestAnimationFrames=function(){this.requestAnimationFramePaused=!0},n.onEveryFrame=t(n.requestAnimationFrame),n.clearTimer=function(e){e in r?(r[e].pause(),delete r[e]):console.warn("Timers Manager - could not clear the given timer : timer not found")},n.clearTimeout=n.clearTimer,n.clearInterval=n.clearTimer,n.clearAll=function(){for(let e in r)n.clearTimer(e);n.clearRequestAnimationFrames()},n.pauseTimer=function(e){e in r?r[e].pause():console.warn("Timer "+e+" could not be paused : timer not found")},n.resumeTimer=function(e){e in r?r[e].unPause():console.warn("Timer "+e+" could not be resumed : timer not found")},n.pauseAll=function(){n.pauseRequestAnimationFrames();for(let e in r)n.pauseTimer(e)},n.resumeAll=function(){n.resumeRequestAnimationFrames();for(let e in r)n.resumeTimer(e)}}function o(e,t){return e.errorCallback?function(){try{t()}catch(t){t.toxiTrace=t.toxiTrace||[],t.toxiTrace.unshift("Toxilibs - timers_manager.js - encapsulateWithErrorCallback"),e.errorCallback(t)}}:t}return r(i),i})),define("libs/collection",[],(function(){let e=["create","find","update","destroy"];function t({name:t,indexedKey:i,uniqueness:r,Constructor:o=Object}){var s;this.name=t,this.indexedKey=i,this.uniqueness=r,this.Constructor=o,this.items={},this.validations={},s=this.validations,e.forEach((function(e){s[e]=[]})),this.uniqueness&&this.addValidation("create",n)}function n(e,t){let n=t[e.indexedKey];if(n in e.items)throw new Error(e.name+" "+n+" already exists")}function i(e,t){if(void 0===e.validations[t])throw new Error("Collection "+e.name+" - Unknown validation type : "+t)}return t.prototype.create=function(e){this.runValidations("create",e);let t=new this.Constructor(e),n=t[this.indexedKey];return this.items[n]=t,t},t.prototype.find=function(e){return this.runValidations("find",e),this.items[e]},t.prototype.destroy=function(e){this.runValidations("destroy",e),this.find(e)&&delete this.items[e]},t.prototype.addValidation=function(e,t){i(this,e),this.validations[e].push(t)},t.prototype.runValidations=function(e,t){i(this,e),this.validations[e].forEach((function(e){e(this,t)}),this)},t})),define("libs/swap_view_capabilities",[],(function(){return function(e){e.currentView=null,e.openView=function(t){let n=e.find(t);return e.currentView===n||(e.currentView&&e.currentView.hide(),e.currentView=n,n.show()),n},e.closeView=function(t){let n=e.find(t);return n===e.currentView&&delete e.currentView,n.hide(),n}}})),
/*!
 * jQuery Mousewheel 3.1.13
 * Copyright OpenJS Foundation and other contributors
 */
function(e){"function"==typeof define&&define.amd?define("toxilibs/extlibs/jquery.mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}((function(e){var t,n,i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in window.document||window.document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(e.event.fixHooks)for(var s=i.length;s;)e.event.fixHooks[i[--s]]=e.event.mouseHooks;var a=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=r.length;t;)this.addEventListener(r[--t],c,!1);else this.onmousewheel=c;e.data(this,"mousewheel-line-height",a.getLineHeight(this)),e.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=r.length;t;)this.removeEventListener(r[--t],c,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),i=n["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function c(i){var r=i||window.event,s=o.call(arguments,1),c=0,h=0,d=0,f=0;if((i=e.event.fix(r)).type="mousewheel","detail"in r&&(d=-1*r.detail),"wheelDelta"in r&&(d=r.wheelDelta),"wheelDeltaY"in r&&(d=r.wheelDeltaY),"wheelDeltaX"in r&&(h=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(h=-1*d,d=0),c=0===d?h:d,"deltaY"in r&&(c=d=-1*r.deltaY),"deltaX"in r&&(h=r.deltaX,0===d&&(c=-1*h)),0!==d||0!==h){if(1===r.deltaMode){var p=e.data(this,"mousewheel-line-height");c*=p,d*=p,h*=p}else if(2===r.deltaMode){var g=e.data(this,"mousewheel-page-height");c*=g,d*=g,h*=g}if(f=Math.max(Math.abs(d),Math.abs(h)),(!n||f<n)&&(n=f,u(r,f)&&(n/=40)),u(r,f)&&(c/=40,h/=40,d/=40),c=Math[c>=1?"floor":"ceil"](c/n),h=Math[h>=1?"floor":"ceil"](h/n),d=Math[d>=1?"floor":"ceil"](d/n),a.settings.normalizeOffset&&this.getBoundingClientRect){var m=this.getBoundingClientRect();i.offsetX=i.clientX-m.left,i.offsetY=i.clientY-m.top}return i.deltaX=h,i.deltaY=d,i.deltaFactor=n,i.deltaMode=0,s.unshift(i,c,h,d),t&&window.clearTimeout(t),t=window.setTimeout(l,200),(e.event.dispatch||e.event.handle).apply(this,s)}}function l(){n=null}function u(e,t){return a.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}e.fn.extend({mousewheel:function(e){return e?this.on("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.off("mousewheel",e)}})})),define("toxilibs/screen_mouse_control",["jquery","./extlibs/jquery.mousewheel"],(function(e){function t(t,{scaleVelocity:s=1,minScale:a=.001,maxScale:c=1e3,disableDrag:l,preHook:u,onMove:h=(()=>{}),onDragStart:d=(()=>{}),onDragEnd:f=(()=>{})}={}){"mouseEventToCoords"in t?(this.screen=t,this.$container=e(this.screen.container||this.screen.canvas)):this.$container=t,this.preHook=u,this.onMove=h,this.onDragStart=d,this.onDragEnd=f,this.minScale=a,this.maxScale=c,this.mouseWheelScaleVelocity=.15*s,function(t){let o,{$container:s,preHook:a}=t;const c=e("body");s.on("mousedown",(function(i){l=0,n(t)||a&&!a(i)||(i.preventDefault(),e(":focus").blur(),o=t.screen.mouseEventToCoords(i),c.on("mousemove.cameraZoom",u),c.one("mouseup",h))}));let l=0;function u(e){n(t)||a&&!a(e)||(e.preventDefault(),o&&(l+=1,r(t.screen,e,o),i(t),4===l&&t.onDragStart()))}function h(){a&&!a(event)||(o=!1,c.off("mousemove.cameraZoom"),l>4&&t.onDragEnd(),l=0)}}(this),function(e){let{$container:t}=e;t.on("mousewheel",(function(t){let{screen:n,mouseWheelScaleVelocity:s,zoomExternallyDisabled:a,preHook:c}=e;if(!n||a)return;if(c&&!c(t))return;t.preventDefault();const l=n.mouseEventToCoords(t),u=function({event:e,mouseWheelScaleVelocity:t}){let{deltaY:n}=e,i=1+t*Math.pow(Math.abs(n),.02);n<0&&(i=1/i);return i}({event:t,mouseWheelScaleVelocity:s});o(e,u),r(n,t,l),i(e)}))}(this),function(e){const{screen:t}=e;if(!t)return;t.internalEventBus.on("selection initiated",(()=>{e.dragInternallyDisabled=!0})),t.internalEventBus.on("selection created",(()=>{e.dragInternallyDisabled=!1})),t.internalEventBus.on("selection aborted",(()=>{e.dragInternallyDisabled=!1}))}(this),this.screen&&o(this,1),this.dragExternallyDisabled=l}function n({dragInternallyDisabled:e,dragExternallyDisabled:t,screen:n}){return e||t||!n}function i(e){e.onMove(),e.screen.internalEventBus.emit("camera moved")}function r(e,t,n){let{x:i,y:r}=e.mouseEventToCoords(t);e.translateCenter({x:n.x-i,y:n.y-r})}function o(e,t){let{screen:n,minScale:i,maxScale:r}=e,o=(s=n.scale*t,a=i,c=r,Math.max(Math.min(s,c),a));var s,a,c;n.setScale(o)}return t.prototype.enableDrag=function(){this.dragExternallyDisabled=!1},t.prototype.disableDrag=function(){this.dragExternallyDisabled=!0},t.prototype.enableZoom=function(){this.zoomExternallyDisabled=!1},t.prototype.disableZoom=function(){this.zoomExternallyDisabled=!0},t})),define("render/camera_control",["event_bus","toxilibs/screen_mouse_control"],(function(e,t){return function({$uiContainer:n,renderViews:i}){let r,o=new t(n,{preHook:e=>e.target.classList.contains("ui_parent"),minScale:.01,maxScale:1e3,onMove:function(){const{currentView:t}=i;t&&t.synchronizeCamera();e.emit("camera moved",t),clearTimeout(r),Date.now()-s>200?a():r=setTimeout(a,100)},onDragStart:()=>n.addClass("drag_mode"),onDragEnd:()=>n.removeClass("drag_mode")}),s=0;function a(){const{currentView:t}=i;t&&(s=Date.now(),e.emit("camera moved throttled",t.screenStateParams()))}return o.followScreenState=function({path:e,xMin:t,xMax:n,yMin:r,yMax:o}){let s=i.find(e);s&&s.setOptimalView([{x:t,y:r},{x:n,y:o}],{delay:300})},o}})),define("toxilibs/alias",[],(function(){function e({target:e,originalName:n,proxy:i=e,alias:r=n,writable:o,fastMode:s}){if(i===e&&r===n)return;const a={enumerable:!0};let c=t(i,e,e[n]);a.get=s?c?()=>c:()=>e[n]:()=>t(i,e,e[n])||e[n],!1!==o&&(a.set=function(t){e[n]=t}),Object.defineProperty(i,r,a)}function t(e,t,n){return"function"==typeof n&&e!==t&&n.bind(t)}return function(t){let{key:n,keys:i,proxy:r,target:o,writable:s,fastMode:a}=t;"string"==typeof n?r?e({proxy:r,target:o,writable:s,fastMode:a,originalName:n}):console.warn('Alias : "key" param is a simple string -> "proxy" param should be specified !'):i instanceof Array?r?function({proxy:t,target:n,writable:i,fastMode:r},o){o.forEach((o=>{e({proxy:t,target:n,writable:i,fastMode:r,originalName:o})}))}(t,i):console.warn('Alias : "keys" param is a simple array -> "proxy" param should be specified !'):function({proxy:t,target:n,writable:i,fastMode:r},o){for(let s in o)("string"==typeof o[s]?[o[s]]:o[s]).forEach((o=>{e({proxy:t,target:n,writable:i,alias:o,fastMode:r,originalName:s})}))}(t,i||n)}})),define("toxilibs/screen_camera",["./interpolate","./smooth_state"],(function(e,t){const{closestEndValueWithModulo:n}=e;function i(e,n=e.getCamera()){this.screen=e;const{center:i,scale:o,orientation:s}=n;this.smoothState=new t({center:i,scale:o,orientation:s},{hook:r})}function r(e,t){t.orientation=n({start:e.orientation,end:t.orientation,modulo:360})}i.prototype.change=function(e,t=0){"delay"in e&&(t=e.delay);let{whenEnded:n}=e;e=function(e,t){let{center:n,scale:i,orientation:r}=t.getCamera();if("function"==typeof e)return function(){let{center:t=n,orientation:o=r,scale:s=i}=e(),{x:a,y:c}=t;return{center:{x:a,y:c},orientation:o,scale:s}};{let{center:t=n,orientation:o=r,scale:s=i}=e,{x:a,y:c}=t;return{center:{x:a,y:c},orientation:o,scale:s}}}(e,this.screen),this.smoothState.change(e,t,{whenEnded:n}),0===t&&this.triggerScreenUpdate()},i.prototype.freeze=function(e=0){this.smoothState.freeze(e),0===e&&this.triggerScreenUpdate()},i.prototype.triggerScreenUpdate=function(){this.screen.setCamera(this.currentValue())},i.prototype.currentValue=function(){return this.smoothState.currentValue()},i.prototype.isMoving=function(){return this.smoothState.isChanging()};const o=1e-6;return i.putTargetInsideBox=function(e,{target:t,xLeft:n,xRight:i,yTop:r,yBottom:s}){i===n&&(i+=o),s===r&&(s+=o);let{width:a,height:c}=e,l=e.pixToCoords({x:a*n,y:c*s}),u=e.pixToCoords({x:a*i,y:c*s}),h=e.pixToCoords({x:a*n,y:c*r}),d=u.x-l.x,f=u.y-l.y,p=h.x-l.x,g=h.y-l.y,m=t.x-l.x,y=t.y-l.y,x=(d*m+f*y)/(d*d+f*f),b=(p*m+g*y)/(p*p+g*g),{center:v,scale:w,orientation:_}=e.getCamera(),S=0,C=0;return x>1?S=x-1:x<0&&(S=x),b>1?C=b-1:b<0&&(C=b),v={x:v.x+S*d+C*p,y:v.y+S*f+C*g},{center:v,scale:w,orientation:_}},i})),define("user_code/handle_execution_error",["event_bus"],(function(e){let t;return e.on("executionError handler ready",(e=>{t=e})),function(e){return function(n){if(n.toxiTrace=n.toxiTrace||[],n.toxiTrace.unshift(e),!t)throw n;t(n)}}})),define("render/hybrid_screen",["toxilibs/event_capabilities_queued","toxilibs/alias","./screen","toxilibs/screen_group","toxilibs/screen_camera","toxilibs/topleft_and_pivot","user_code/handle_execution_error"],(function(e,t,n,i,r,o,s){const{getCenterPoint:a}=o,c=s("Explorers - hybrid_screen.js - screen event error"),l=s("Explorers - hybrid_screen.js - screen error"),u=["isInside","isOutside","getPixelColor","coordsToPix","pixToCoords","mouseEventToCoords","mouseEventToSmartTrimmedCoords","smartTrimCoords","on","when","emit","boundingBox","pixBoundingBox","boundingBoxForPixelZone","boundingBoxForWholeView","toImageData","toBlob"],h=["toJSON","importJSON"],d={};function f({name:o="screen",canvas:s,directScreenMode:a,onCameraMoved:f=(()=>{})}){var p,g;this.name=o,this.screen=new n(s,{errorHandler:l}),this.directScreen=this.screen,this.screen.setScale(40),this.onCameraMoved=f,e(this.screen,{onError:c}),this.directScreenMode=a,a?(g=this.screen,n.drawingMethods.forEach((e=>{let t=e.replace("draw","add");t!==e&&(g[t]=g[e])})),t({target:(p=this).screen,proxy:p,keys:d,fastMode:!0,writable:!1})):(this.screenGroup=new i({failFast:!0}),this.screenGroupLastChange=0,function(e){t({target:e.screenGroup,proxy:e,keys:h,fastMode:!0,writable:!1})}(this)),function(e){t({target:e.screen,proxy:e,keys:u,fastMode:!0,writable:!1})}(this),this.screenCamera=new r(this.screen)}n.drawingMethods.forEach((e=>{let t=e.replace("draw","add");d[e]=t,h.push(t)})),f.prototype.reset=function(){this.screen.removeAllListeners(),this.clear(),this.screen.drawAdapter.resetStyle()},f.prototype.clear=function(e){this.directScreenMode?this.screen.clear(e):(this.lastClearParams=e,this.screenGroup.reset(),this.screenGroupLastChange=0)},f.prototype.render=function(e=!1){if(this.directScreenMode)return;let{lastChange:t}=this.screenGroup;if(e||t!==this.screenGroupLastChange||this.screenCamera.isMoving()){const e=performance.now();this.emit("render started"),this.screen.clear(this.lastClearParams),this.screenCamera.triggerScreenUpdate(),this.screenGroupLastChange=t,this.screen.drawGroup({group:this.screenGroup}),this.renderTime=Math.round(10*(performance.now()-e))/10}},f.prototype.forceRender=function(){this.render(!0)},f.prototype.adaptSizeTo=function(e){const{canvas:t}=this.screen,n=e[0].clientWidth,i=e[0].clientHeight;t.width=n,t.height=i,t.style.width=n+"px",t.style.height=i+"px",this.screen.updateCanvasSize()},f.prototype.isEmpty=function(){return 0===this.screenGroup.length},f.prototype.getCamera=function(){const{center:e,scale:t,orientation:n}=this.screenCamera.currentValue(),{width:i,height:r}=this.screen;return{center:e,scale:t,width:i/t,height:r/t,orientation:0===n?0:-n}},f.prototype.setCamera=function(...e){this.screenCamera.change(...e),this.onCameraMoved()},f.prototype.freezeCamera=function(e){this.screenCamera.freeze(e),this.onCameraMoved()},f.prototype.setOptimalView=function(e,t={}){const n=this.screen.setOptimalView(e,t);return n.delay=t.delay,this.setCamera(n),n},f.prototype.zoom=function(e){let{scale:t}=this.getCamera();t*=e,this.setCamera({scale:t})},f.prototype.rotate=function(e){let{orientation:t}=this.getCamera();t+=e,this.setCamera({orientation:t})},f.prototype.translateCenter=function({x:e=0,y:t=0}){let{center:n}=this.getCamera();this.setCamera({center:{x:n.x+e,y:n.y+t}})},f.prototype.saveAsImage=function(e){setTimeout((()=>{const{fillColor:t,color:n=t}=this.lastClearParams||{};let i={fileName:this.name};if(n&&(i.backgroundColor=n),!(e=Object.assign(i,e))||"fileName"in e&&1===Object.keys(e).length)this.screen.downloadAsPNG(e);else{const t=function(e,t){let{width:n,height:i,orientation:r}=e.getCamera();const{canvas:o}=e;let{width:s=n,height:c=i,orientation:l=r,widthInPixels:u=o.width*s/n,heightInPixels:h}=t,d=s/c;if("widthInPixels"in t&&"heightInPixels"in t){let e=u/h;e>d?s=c*e:c=s/e}if(u>p||h>p)throw new Error("Image too big");return{center:a(t,s,c)||e.center,width:s,height:c,orientation:l,widthInPixels:u,heightInPixels:h}}(this.screen,e);t.fileName=e.fileName,t.backgroundColor=e.backgroundColor,this.screenGroup.downloadAsPNG(t)}}),50)};const p=1e4;return f})),define("toxilibs/object_utils",[],(function(){function e(...e){return Object.assign?Object.assign(...e):function(e,...t){t.forEach((t=>{for(let n in t)e[n]=t[n]}))}(...e),e[0]}function t(e,t){let n={};return t.forEach((function(t){t in e&&(n[t]=e[t])})),n}function n(...t){let n={};return e(n,...t),n}function i(e,t){let n,i={};for(n in e)i[n]=e[n];for(n in t)i[n]=r(i,t[n],n);return i}function r(e,t,n){if(n in e)if(Array.isArray(e[n])){if(Array.isArray(t))return function(e,t){let n=e.slice();for(let e=0;e<t.length;e++)-1===n.indexOf(t[e])&&n.push(t[e]);return n}(e[n],t)}else if("object"==typeof e[n]&&"object"==typeof t&&!Array.isArray(t))return i(e[n],t);return t}return{extend:e,merge:e,compose:n,clone:n,filterKeys:t,filteredExtend:function(n,i,...r){return r.forEach((r=>{let o=t(r,i);e(n,o)})),n},deepMerge:i,isObject:function(e){return e===Object(e)},invoke:function(e,t,...n){for(let i=0;i<e.length;i++){e[i][t](...n)}},orderArray:function(){console.error('"orderArray" removed. Ask Pierre L')},setMethodsWithPrivateArgument:function(e){const{object:t,methods:n,privateMap:i}=e;for(let e in n)t[e]=r(n[e]);function r(e){return function(...t){const n=i.get(this);return e.call(this,n,...t)}}},xmlToJson:function e(t){let n={};if(1===t.nodeType){if(t.attributes.length>0){n["@attributes"]={};for(let e=0;e<t.attributes.length;e++){let i=t.attributes.item(e);n["@attributes"][i.nodeName]=i.nodeValue}}}else 3===t.nodeType&&(n=t.nodeValue);if(t.hasChildNodes())for(let i=0;i<t.childNodes.length;i++){let r=t.childNodes.item(i),{nodeName:o}=r;if(void 0===n[o])n[o]=e(r);else{if(void 0===n[o].push){let e=n[o];n[o]=[],n[o].push(e)}n[o].push(e(r))}}return n}}})),define("user_code/api_manager",["event_bus","toxilibs/object_utils"],(function(e,t){const{clone:n}=t;let i,r={};e.on("system wants to add properties to scope",(function(e){for(let t in e)r[t]=e[t]})),e.on("worldApi tools added",(function(e){i=e}));const o=[];function s({namespace:t,include:s,onDestroy:c=(()=>{})}){let l=s?n(...s):{};return a({api:l,namespace:t,properties:r}),i&&i.addScopeDependentMethods(l),function({api:t,namespace:n}){let i=e.on("system wants to add properties to scope",(e=>{a({api:t,namespace:n,properties:e})}));o.push(i)}({api:l,namespace:t}),{api:l,destroy:function(){i&&i.destroyProxy(t),c()}}}function a({api:e,namespace:t,properties:n}){for(let i in n)i in e&&console.log(i+" already in scope in "+t),e[i]=c(n[i],t)}function c(e,t){return e.createProxy?e.createProxy("world_"+t):e}return s.reset=function(){r={},o.forEach((t=>e.removeListener("system wants to add properties to scope",t)))},s})),define("user_code/executable_api",["./deprecate"],(function(e){return function(t){const n=new Set,i={doOnce:function(e){const{name:i,executedAt:r}=t,o=`${i} ${r} ${e}`;n.has(o)||(e(),n.add(o))},currentTime:function(){let{executedAt:e=!1}=t;return e?(Date.now()-e)/1e3:null},currentRunner:function(){return t.name}};return e(i,{time:"currentTime"}),i}})),define("toxilibs/element",["jquery","./object_utils"],(function(e,t){const{filteredExtend:n,setMethodsWithPrivateArgument:i}=t,r=new WeakMap;class o{constructor(t){const{template:n,setup:i,$container:o,errorHandler:s,class:a,earlyHook:c}=t,l=e(n||"<div>");a&&l.addClass(a),this.$element=l,c&&c(this,t),r.set(this,l),this.errorHandler=s,o&&o.append(l),function(e,t){function n(t){if(t.toxiTrace=t.toxiTrace||[],t.toxiTrace.unshift("Toxilibs - element.js - handleError"),!e.errorHandler)throw t;e.errorHandler(t)}function i(e){if(e)try{e()}catch(e){n(e)}}t.data("toxiElement",e),t.on("click",(function(){i(e.click)})),t.on("mouseover",(function(){i(e.mouseOver)})),t.on("mouseleave",(function(){i(e.mouseLeave)}))}(this,l),i&&i(this,l,t),this.update(t)}static methods(e){i({object:this.prototype,privateMap:r,methods:e})}static permit(e=[]){this.attributes=new Set(this.attributes),e.forEach((e=>this.attributes.add(e)))}}return o.permit(["click","mouseOver","mouseLeave","class"]),o.methods({remove(e){e.remove()},clear(e){e.empty()},add(e,t){t instanceof o||(t=new o({content:t}));const n=r.get(t);return e.append(n),t},setContent(e,t){r.has(t)&&(t=r.get(t)),e.html(t)},update(e,t){"content"in t&&this.setContent(t.content),t.class&&e.addClass(t.class),t.style&&e.css(t.style),n(this,this.constructor.attributes,t)},show(e){e.show()},hide(e){e.hide()},toggle(e){e.is(":visible")?e.hide():e.show()},isVisible:e=>e.is(":visible")}),o})),define("toxilibs/element_input",["jquery","./object_utils","./element"],(function(e,t,n){const{clone:i}=t;class r extends n{constructor(e){super(i(e,{setup:o}))}}function o(t,n,i){const{type:o="text",label:s,choices:l}=i;t.type=o,r.fetchPersistedInputValue(i);const u=(c+=1,"input_"+c),h=e("<div>");let d,f;d="select"===o?function({choices:t,id:n}){let i="";if(Array.isArray(t))t.forEach((e=>{i+=`<option value="${e}">${e}</option>`}));else for(let e in t)i+=`<option value="${t[e]}">${e}</option>`;return e(`<select id="${n}">${i}</select>`)}({choices:l,id:u}):e("textarea"===o?`<textarea id="${u}">`:`<input type="${o}" id="${u}">`),t.$input=d,f=e(s?`<label for="${u}">${s}</label>`:`<label for="${u}" style="display: none;">`),t.onChanged&&(t.whenChanged=t.onChanged),d.on("input propertychange",(function(){let e=a(d);r.setPersistedInputValue(i,e),t.whenChanged&&t.whenChanged(e)})),h.append(d),n.append(f),n.append(h)}function s(e){return e.is('[type="checkbox"]')}function a(e){return s(e)?e.is(":checked"):e.val()}r.permit(["onChanged","whenChanged","choices"]),r.methods({value(e,t){var n,i;return void 0!==t&&(n=this.$input,i=t,s(n)?n.attr("checked",i):n.val(i)),a(this.$input)},update(e,t){"value"in t&&this.value(t.value),"label"in t&&function(e,t){e.find("label").text(t).show()}(e,t.label),n.prototype.update.call(this,t)}}),r.fetchPersistedInputValue=function(e){const{label:t,persisting:n,storagePrefix:i}=e;if(!n||!i)return;if(!t)throw new Error("Can not persist values if no label is provided");let r=localStorage[`${i}_${t}`];void 0!==r&&(e.value=r)},r.setPersistedInputValue=function(e,t){const{label:n,persisting:i,storagePrefix:r}=e;i&&r&&n&&(localStorage[`${r}_${n}`]=t)};let c=0;return r})),define("toxilibs/slider",["jquery"],(function(e){function t({id:t,defaultValue:i=0,value:r,min:s=0,max:a,step:u=!1,ticks:h,slots:d,noHandle:f,readOnly:p=!1,label:g,displayValue:m=!0,formatDisplayedValue:y,noProgressBar:x,alwaysShowHandle:b,progressBarColor:v,progressBarInitAt:w=0,onChanged:_,whenChanged:S=_,onChangedByUser:C,whenChangedByUser:k=C,skipChangeCallbacksOnStart:M}){this.id=t,this.defaultValue=i,this.min=s,this.max=a,this.step=u,this.progressBarColor=v,this.progressBarInitAt=w,this.label=g,this.formatDisplayedValue=y,M||(this.whenChanged=S,this.whenChangedByUser=k),function(t,{noProgressBar:n,alwaysShowHandle:i,noHandle:r,ticks:s,slots:a,displayValue:l}){const{id:u}=t,h=e("<div>",{class:"toxislider",id:u}),d=e("<div>",{class:"toxislider_inner"}),f=e("<div>",{class:"toxislider_bar"}),p=e("<input>",{type:"hidden"});t.$container=h,t.$inner=d,t.$input=p,t.$bar=f,f.append(p),d.append(f),h.append(d),(n||i)&&h.addClass("toxislider_permanent_handle");n||function(t){t.$progressBar=e("<div>",{class:"toxislider_progress_bar"}),t.$bar.append(t.$progressBar)}(t);r||function(t){t.$handle=e("<div>",{class:"toxislider_handle"}),t.$bar.append(t.$handle)}(t);s&&function(t,n){const i=e("<div>",{class:"toxislider_ticks"});t.$inner.append(i),n.forEach((e=>o(t,e,{$container:i})))}(t,s);a&&function(t,n){let i;const r=e("<div>",{class:"toxislider_slots"});t.$inner.append(r),n.forEach((function(n){let{startValue:s,endValue:a,position:l,noStartTick:u,noEndTick:h}=n;if(!(u||i&&i===l)){let e=o(t,{label:!1,value:s,position:l},{$container:r});r.append(e)}if(!h){let e=o(t,{label:!1,value:a,position:l},{$container:r});r.append(e)}let d=function(t,{label:n,startValue:i,endValue:r}){let o=e('<div class="toxislider_slot_label">'+n+"</div>"),s=(i+r)/2;return o.css("left",c(t,s)+"%"),o}(t,n);r.append(d),i=l}))}(t,a);t.label&&function(t){t.$container.addClass("toxislider_with_label"),t.$label=e('<div class="toxislider_label">'+t.label+"</div>"),t.$inner.append(t.$label)}(t);l&&function(t,n){!0===n&&(n=t.label?"facing_label":"right");t.$value=e("<div>",{class:"toxislider_value toxislider_value_"+n}),t.$inner.append(t.$value)}(t,l)}(this,{noProgressBar:x,alwaysShowHandle:b,noHandle:f,ticks:h,slots:d,displayValue:m}),p?this.$container.addClass("toxislider_read_only"):function(t){let{$inner:i}=t;i.on("click",(e=>{let r=i.offset().left,o=l(t,e.clientX-r);n(t,o,{userChange:!0})})),i.on("mousedown",(()=>function(t){let{$inner:i}=t,r=i.offset().left;function o(e){let i=l(t,e.clientX-r);n(t,i,{userChange:!0})}e("body").on("mousemove",o),e("body").one("mouseup",(()=>e("body").off("mousemove",o)))}(t)))}(this),void 0===r?this.reset():this.setValue(r),M&&(this.whenChanged=S,this.whenChangedByUser=k)}function n(e,t,{skipEvents:n,userChange:o,forceAsync:s}={}){t=a(e,t),e.value!==t&&(e.value=t,e.noDefinedValue=!1,e.$input.val(t),function(e){if(!e.$value)return;let t=e.value;e.formatDisplayedValue&&(t=e.formatDisplayedValue(t));e.$value.text(t)}(e),function(e){if(!e.$handle)return;e.$handle.css({left:c(e,e.value)+"%"})}(e),function(e){if(!e.$progressBar)return;(function(e){const{$progressBar:t,progressBarInitAt:n,value:i}=e,r=c(e,i),o=c(e,a(e,n));t.css({left:Math.min(r,o)+"%",width:Math.abs(r-o)+"%"})})(e),function(e){let{$progressBar:t,progressBarColor:n,value:i}=e;"function"==typeof n&&(n=n(i));n&&t.css("background",n.toString())}(e)}(e),r(e),n||(s?setTimeout((()=>i(e,{userChange:o})),0):i(e,{userChange:o})))}function i(e,{userChange:t}){let{value:n}=e;e.whenChanged&&e.whenChanged(n),e.whenChangedByUser&&t&&e.whenChangedByUser(n)}function r({noDefinedValue:e,$container:t}){e?t.addClass("no_defined_value"):t.removeClass("no_defined_value")}function o(t,{label:n,value:i},{$container:r}){let o=e('<div class="toxislider_tick"></div>');!1!==n&&o.append("<div>"+(n||i)+"</div>"),o.css("left",c(t,i)+"%"),r.append(o)}t.prototype.setValue=function(e,t){n(this,e,{skipEvents:t})},t.prototype.reset=function(){n(this,this.defaultValue,{forceAsync:!0}),this.noDefinedValue=!0,r(this)};const s=1e7;function a(e,t){let{min:n,max:i,step:r}=e;return r&&(t=n+r*Math.round((t-n)/r),t=Math.round(t*s)/s),Math.min(Math.max(t,n),i)}function c({min:e,max:t},n){return 100*(n-e)/(t-e)}function l(e,t){let{min:n,max:i,$inner:r}=e,{width:o}=r[0].getBoundingClientRect();return n+t/o*(i-n)}return t})),define("toxilibs/element_slider",["./object_utils","./element","./element_input","./slider"],(function(e,t,n,i){const{filteredExtend:r}=e,{fetchPersistedInputValue:o,setPersistedInputValue:s}=n;class a extends t{constructor(e){"step"in(e=Object.assign({setup:c,min:0,max:1},e))||(e.step=function({min:e,max:t}){let n=Math.abs(t-e);if(n>2&&Math.round(n)===n)return 1;if(n>.5)return.01;if(n>.05)return.001;return 1e-4}(e)),o(e),function(e){const{errorHandler:t,onChanged:n,whenChanged:i=n,onChangedByUser:r,whenChangedByUser:o=r}=e;if(!t)throw new Error("no errorHandler !");e.whenChanged=function(n){if(s(e,n),i)try{i(n)}catch(e){e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Toxilibs - element_slider.js - whenChanged"),t(e)}},o&&(e.whenChangedByUser=function(e){try{o(e)}catch(e){e.toxiTrace=e.toxiTrace||[],e.toxiTrace.unshift("Toxilibs - element_slider.js - whenChangedByUser"),t(e)}})}(e),super(e)}}function c(e,t,n){const o=function(e){const t=(u+=1,"slider_"+u),n=r({name:"slider_"+t},l,e);return n.skipChangeCallbacksOnStart=!0,new i(n)}(n);e.setContent(o.$container),e.slider=o,o.whenChanged(o.value)}a.methods({value(e,t){return t&&this.slider.setValue(t),this.slider.value},reset(){this.slider.reset()},update(e,n){n.value&&this.value(n.value),t.prototype.update.call(this,n)}});const l=["min","max","label","displayValue","value","defaultValue","onChanged","whenChanged","onChangedByUser","whenChangedByUser","progressBarColor","step","ticks","alwaysShowHandle"];let u=0;return a})),define("view/textarea_autosize",[],(function(){function e(e){""===e.val().trim()?e.css("height",""):(e.css("height","0.1px"),e.css("height",e[0].scrollHeight))}return function(t){t.on("input propertychange",(()=>e(t))),setTimeout((()=>e(t)),1)}})),define("render/ui_tools",["jquery","toxilibs/topleft_and_pivot"],(function(e,t){return function(n){const i=n.$ui;function r(t={},{internalWhenClosed:i=(()=>{})}={}){const{$currentPopup:r,disableDefaultPopupBlur:o}=n.storageForThisLaunch;let{blur:s=!o,closable:a=!1,clickOutsideToClose:c=a,clickToClose:u=!1,whenClosed:h=(()=>{}),whenCanceled:d=(()=>{}),whenClicked:f}=t;r&&l(r),s&&n.blur(s);const p=e('<div class="ui_popup not_blurred">'),g=e('<div class="inside"></div>');if(p.append(g),p.$inside=g,n.storageForThisLaunch.$currentPopup=p,p.createdAt=Date.now(),p.clickOutsideToClose=c,p.whenClosed=h,p.whenCanceled=d,p.result=null,p.internalWhenClosed=i,a){let t=e('<div class="close">×</div>');t.on("click",(()=>l(p))),p.append(t)}return u&&p.addClass("click_to_close"),(u||f)&&p.on("click",(()=>{f&&f(),u&&l(p)})),function(t,{title:n,content:i}){n&&t.$inside.append("<h3>"+n+"</h3>");if(i){let n=e('<div class="content"></div>');Array.isArray(i)||(i=[i]),i.forEach((e=>{n.append("<p>"+e+"</p>")})),t.$inside.append(n)}}(p,t),p}function o(e,r){i.append(e),t.containsPositionParam(r)&&function(e,r){const{hybridScreen:o}=n,{scale:s}=o.getCamera(),a=e.outerWidth(),c=e.outerHeight(),l=t.getTopLeftPoint(r,a/s,c/s);e.addClass("precise_position");let{x:u,y:h}=o.coordsToPix(l);u=Math.min(Math.max(u,0),i.width()-a),h=Math.min(Math.max(h,0),i.height()-c),e.css({top:Math.round(h)+"px",left:Math.round(u)+"px"})}(e,r)}function s(e,t){const n=r(e=Object.assign({closable:!0},e),t);return o(n,e),n}function a(t,{label:n,choiceOrCallback:i}){const r=e('<div class="ui_button">'+n+"</div>");let o,s;"function"==typeof i?(o=n,s=i):o=i;const{whenReplied:a}=t;r.on("click",(()=>{t.result=o,l(t,!0),a(o),s&&s(o)})),t.$choicesContainer.append(r)}function c(e,{type:t="text",value:n,label:i=e}){if("select"===t)throw new Error('Type "select" is not supported yet');{let r="";return void 0!==n&&(r=`value="${n}"`),`${i}<input name="${e}" type="${t}" ${r} />`}}function l(e,t){e.remove(),n.storageForThisLaunch.$currentPopup===e&&delete n.storageForThisLaunch.$currentPopup,e.whenClosed(),t||e.whenCanceled(),e.internalWhenClosed(t),n.unblur()}return i.on("click",(function(t){const{$currentPopup:i}=n.storageForThisLaunch;if(!i||!i.clickOutsideToClose||Date.now()-i.createdAt<200)return;let r=e(t.target);r.hasClass("ui_popup")||0!==r.parents(".ui_popup").length||l(i)})),{showPopup:function(e={}){return new Promise((t=>s(e,{internalWhenClosed:t})))},showSlides:async function({speaker:e={},title:t=e.name,image:n=e.image,contents:i,closable:r=!1}={}){for(let e=0;e<i.length;e++){let o;if(await new Promise((a=>{let c=s({title:t,closable:r,content:i[e],clickToClose:!0,whenClicked:()=>{o=!0}},{internalWhenClosed:a});n&&(c.addClass("with_title_image"),c.prepend('<img class="title_image" src="'+n+'">')),c.addClass("ui_slide")})),!o)return!1}return!0},showChoices:function(t={}){return new Promise((n=>{const i=r(t,{internalWhenClosed:()=>n(i.result)});!function(t,{choices:n={},choicesDisposition:i="auto",whenChosen:r=(()=>{}),whenReplied:o=r}){t.whenReplied=o;const s=e('<div class="choices">');t.$choicesContainer=s;let c=0;if(Array.isArray(n))n.forEach((e=>{a(t,{label:e,choiceOrCallback:e}),c+=e.length}));else for(let e in n)a(t,{label:e,choiceOrCallback:n[e]}),c+=e.length;c>20&&"auto"===i&&(i="vertical");"vertical"===i?t.addClass("vertical_choices"):t.addClass("horizontal_choices");t.$inside.append(t.$choicesContainer)}(i,t),o(i,t)}))},showForm:function(t={}){return new Promise((n=>{const i=r(t,{internalWhenClosed:()=>n(i.result)});!function(t,{fields:n,whenReplied:i=(()=>{})}){let r=e("<form>");if(n)for(let e in n)r.append(c(e,n[e]));else r.append('<input name="default" type="text" />');r.append('<input class="submit" type="submit" value="Ok" />'),r.on("submit",(e=>{e.preventDefault();let o={};r.serializeArray().forEach((({name:e,value:t})=>{""!==t.trim()&&(n&&n[e]&&"number"===n[e].type&&(t=parseFloat(t)),o[e]=t)})),n||(o=o.default),t.result=o,i(o),l(t,!0)})),t.$inside.append(r)}(i,t),o(i,t),i.find("input:first").focus()}))},hidePopup:function(){const{$currentPopup:e}=n.storageForThisLaunch;e&&l(e)},setBackground:function({color:e,image:t}={}){e&&n.$background.css({backgroundColor:e}),t&&n.$background.css({backgroundImage:"url("+t+")",backgroundSize:"cover",backgroundPosition:"center"})}}}})),define("toxilibs/string_utils",[],(function(){let e={camelToSeparator:function(e,t){return(e=e.replace(/([A-Z]+)([A-Z][a-z])/g,"$1"+t+"$2")).replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").toLowerCase()},camelToSnake:function(t){return e.camelToSeparator(t,"_")},camelToSpace:function(t){return e.camelToSeparator(t," ")},camelToDash:function(t){return e.camelToSeparator(t,"-")},camelToPascale:function(t){return e.upperFirstLetter(t)},pascaleToSnake:function(t){return t=e.pascaleToCamel(t),e.camelToSeparator(t,"_")},pascaleToSpace:function(t){return t=e.pascaleToCamel(t),e.camelToSeparator(t," ")},pascaleToDash:function(t){return t=e.pascaleToCamel(t),e.camelToSeparator(t,"-")},pascaleToCamel:function(t){return e.lowerFirstLetter(t)},spaceToSnake:function(t){return e.separatorToAnotherSeparator(t.toLowerCase(),"\\s+","_")},spaceToDash:function(t){return e.separatorToAnotherSeparator(t.toLowerCase(),"\\s+","-")},spaceToCamel:function(t){return e.separatorToCamel(t.toLowerCase(),"\\s")},spaceToPascale:function(t){return e.upperFirstLetter(e.spaceToCamel(t))},dashToSnake:function(t){return e.separatorToAnotherSeparator(t,"-","_")},dashToSpace:function(t){return e.separatorToAnotherSeparator(t,"-"," ")},dashToCamel:function(t){return e.separatorToCamel(t,"-")},dashToPascale:function(t){return e.upperFirstLetter(e.separatorToCamel(t,"-"))},snakeToDash:function(t){return e.separatorToAnotherSeparator(t,"_","-")},snakeToSpace:function(t){return e.separatorToAnotherSeparator(t,"_"," ")},snakeToCamel:function(t){return e.separatorToCamel(t,"_")},snakeToPascale:function(t){return e.upperFirstLetter(e.separatorToCamel(t,"_"))},separatorToCamel:function(e,t){let n=new RegExp(t+"+([^"+t+"])","g");return e.replace(n,(function(e,t){return t.toUpperCase()})).replace(/\s/g,"")},separatorToAnotherSeparator:function(e,t,n){let i=new RegExp(t,"g");return e.replace(i,n)},upperFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},lowerFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},dasherize:function(e){return e.trim().replace(/([a-z\d])([A-Z]+)/g,"$1-$2").replace(/[_\s]+/g,"-").toLowerCase()},camelize:function(t){let n=t.trim().replace(/[-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}));return e.lowerFirstLetter(n)},pascalize:function(t){return e.upperFirstLetter(e.camelize(t))},snakerize:function(e){return e.trim().replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},regexp:{latin:/^([A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff\s]*)$/,classicVariableName:/^([a-zA-Z_$][0-9a-zA-Z_$]*)$/},escapeForRegExp:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},replaceAll:function(e,t,n){return e.replace(new RegExp(t,"g"),n)},interpolate:function(t,n){n=n||{};for(let i in n)t=e.replaceAll(t,"{{"+i+"}}",n[i]);return t},distance:function(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;let n,i,r=[];for(n=0;n<=t.length;n++)r[n]=[n];for(i=0;i<=e.length;i++)r[0][i]=i;for(n=1;n<=t.length;n++)for(i=1;i<=e.length;i++)t.charAt(n-1)===e.charAt(i-1)?r[n][i]=r[n-1][i-1]:r[n][i]=Math.min(r[n-1][i-1]+1,Math.min(r[n][i-1]+1,r[n-1][i]+1));return r[t.length][e.length]}};return e})),define("render/toolbars",["jquery","toxilibs/element","toxilibs/string_utils"],(function(e,t,n){const i=["left","right","top","bottom"],r=i.map((e=>e+"Toolbar")),o={class:"ui_toolbar"};function s(e){return"ui_toolbar_"+n.spaceToSnake(e)}return function(n){const a=n.$ui;function c(t){return i.includes(t)?l(t)||function(t){const n=e(`<div class="ui_toolbar_container ui_toolbar_container_${t}">`);let i="horizontal_toolbar";if("top"===t)a.prepend(n);else if("left"===t||"right"===t){i="vertical_toolbar";const e=l("top");e?n.insertAfter(e):a.prepend(n)}else a.append(n);return n.addClass(i),n}(t):null}function l(e){let t=a.find(`.ui_toolbar_container_${e}`);return 0===t.length?null:t}function u(e){let t=a.find("."+s(e));return 0===t.length?null:t.data("toxiElement")}function h(e={}){e=Object.assign({},o,e);const{name:n,position:i}=e;if(!n)throw new Error("a toolbar must have a name");e.class=(e.class||"")+" "+s(n);let r=c(i)||a;e.click=e.whenClicked;let l=new t(e);return"topToolbar"===n||"leftToolbar"===n?r.prepend(l.$element):r.append(l.$element),l}return{positionElement:function(e,{position:t}){if("string"==typeof t)if("toolbar"===t&&(t="topToolbar"),r.includes(t)){(u(n=t)||h({name:n,position:n.replace("Toolbar","")})).add(e)}else{let n=u(t);if(!n)throw new Error(`position ${t} unknown`);n.add(e)}var n},addToolbar:function(e={}){return h(e)},getToolbar:u}}})),define("render/dom_api",["jquery","toxilibs/object_utils","editor/snippet_tools","toxilibs/element","toxilibs/element_input","toxilibs/element_slider","view/textarea_autosize","./ui_tools","./toolbars","user_code/handle_execution_error","logger","user_code/deprecate"],(function(e,t,n,i,r,o,s,a,c,l,u,h){const{addMethodSnippet:d}=n,{deepMerge:f}=t,p=l("Explorers - dom_api.js - element event error"),g={showChoices:{title:"'Which one ?'",choices:"{\n\t\t'Dog': 'woof',\n\t\t'Cat': 'meow'\n\t}",whenReplied:"log"},showForm:{title:"'Who are you ?'",fields:{name:"{type: 'text'}",age:"{type: 'number'}"},whenReplied:"log"},showPopup:{title:"'What is an astronaut’s favorite part on a computer?'",content:"'The space bar.'"},addButton:{content:"'my button'",whenClicked:"() => log('button clicked')"},addSlider:{label:"'rating'",min:0,max:100,value:40,whenChanged:"log"},addBox:{content:"'my box'",style:{top:"'50px'",left:"'30%'",color:"'yellow'"}},addTextInput:{label:"'Name'",whenChanged:"log"},addSelect:{label:"'Painter'",choices:"{\n\t\t'Van Gogh': 'gogh',\n\t\t'da Vinci': 'vinci',\n\t\t'Imagine': 'imagine'\n\t}",whenChanged:"log"}};return function(e){const t=e.$ui,{positionElement:n,addToolbar:l,getToolbar:m}=c(e),y={$container:t,style:{position:"absolute"},errorHandler:p},x={$container:t,errorHandler:p,storagePrefix:`explorers_input_${e.fullId}`,earlyHook:function(t,n){const{label:i}=n;i&&(e.storageForThisLaunch["input_"+i]=t)}};let b=(v=i,e=>new v(f(y,e)));var v;const w={content:"my button",class:"ui_button",whenClicked:()=>u.log("Button clicked")},_={type:"textarea",class:"ui_text_input"},S={type:"select",class:"ui_select"},C={class:"ui_slider"},k={class:"ui_spinner",content:'<i class="fas"></i>'},M={setTheme:function(t){e.setTheme(t)},addBox:b,addButton:function(e={}){(e=Object.assign({},x,w,e)).click=e.whenClicked;const t=new i(e);return n(t,e),t},addToolbar:l,getToolbar:m,addTextInput:function(e={}){e=Object.assign({},x,_,e);const t=new r(e);return n(t,e),"textarea"===e.type&&s(t.$element.find("textarea")),t},addSlider:function(e={}){e=Object.assign({},x,C,e);const t=new o(e);return n(t,e),t},addSelect:function(e={}){e=Object.assign({},x,S,e);const t=new r(e);return n(t,e),t},addSpinner:function(e={}){(e=Object.assign({},x,k,e)).click=e.whenClicked;const t=new i(e);return n(t,e),t},valueFor:function(t){const n=e.storageForThisLaunch["input_"+t];return n&&n.value()}};if(Object.assign(M,a(e)),"generic render"===e.name)for(let e in M){let t=g[e];t&&d(M[e],e,t)}return h(M,{showMenu:"showChoices",hideMenu:"hidePopup",addInput:"addTextInput"}),M}})),
/*!
 * Chart.js v3.5.0
 * https://www.chartjs.org
 * (c) 2021 Chart.js Contributors
 * Released under the MIT License
 */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("toxilibs/extlibs/chart-3.5.0",t):(e="undefined"!=typeof globalThis?globalThis:e||self).Chart=t()}(this,(function(){"use strict";const e="undefined"==typeof window?function(e){return e()}:window.requestAnimationFrame;function t(t,n,i){const r=i||(e=>Array.prototype.slice.call(e));let o=!1,s=[];return function(...i){s=r(i),o||(o=!0,e.call(window,(()=>{o=!1,t.apply(n,s)})))}}function n(e,t){let n;return function(){return t?(clearTimeout(n),n=setTimeout(e,t)):e(),t}}const i=e=>"start"===e?"left":"end"===e?"right":"center",r=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2,o=(e,t,n,i)=>e===(i?"left":"right")?n:"center"===e?(t+n)/2:t;var s=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const r=t.listeners[i],o=t.duration;r.forEach((i=>i({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)})))}_refresh(){const t=this;t._request||(t._running=!0,t._request=e.call(window,(()=>{t._update(),t._request=null,t._running&&t._refresh()})))}_update(e=Date.now()){const t=this;let n=0;t._charts.forEach(((i,r)=>{if(!i.running||!i.items.length)return;const o=i.items;let s,a=o.length-1,c=!1;for(;a>=0;--a)s=o[a],s._active?(s._total>i.duration&&(i.duration=s._total),s.tick(e),c=!0):(o[a]=o[o.length-1],o.pop());c&&(r.draw(),t._notify(r,i,e,"progress")),o.length||(i.running=!1,t._notify(r,i,e,"complete"),i.initial=!1),n+=o.length})),t._lastDate=e,0===n&&(t._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}};
/*!
 * @kurkle/color v0.1.9
 * https://github.com/kurkle/color#readme
 * (c) 2020 Jukka Kurkela
 * Released under the MIT License
 */const a={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},c="0123456789ABCDEF",l=e=>c[15&e],u=e=>c[(240&e)>>4]+c[15&e],h=e=>(240&e)>>4==(15&e);function d(e){var t=function(e){return h(e.r)&&h(e.g)&&h(e.b)&&h(e.a)}(e)?l:u;return e?"#"+t(e.r)+t(e.g)+t(e.b)+(e.a<255?t(e.a):""):e}function f(e){return e+.5|0}const p=(e,t,n)=>Math.max(Math.min(e,n),t);function g(e){return p(f(2.55*e),0,255)}function m(e){return p(f(255*e),0,255)}function y(e){return p(f(e/2.55)/100,0,1)}function x(e){return p(f(100*e),0,100)}const b=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const v=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function w(e,t,n){const i=t*Math.min(n,1-n),r=(t,r=(t+e/30)%12)=>n-i*Math.max(Math.min(r-3,9-r,1),-1);return[r(0),r(8),r(4)]}function _(e,t,n){const i=(i,r=(i+e/60)%6)=>n-n*t*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function S(e,t,n){const i=w(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function C(e){const t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),o=Math.min(t,n,i),s=(r+o)/2;let a,c,l;return r!==o&&(l=r-o,c=s>.5?l/(2-r-o):l/(r+o),a=r===t?(n-i)/l+(n<i?6:0):r===n?(i-t)/l+2:(t-n)/l+4,a=60*a+.5),[0|a,c||0,s]}function k(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(m)}function M(e,t,n){return k(w,e,t,n)}function E(e){return(e%360+360)%360}function T(e){const t=v.exec(e);let n,i=255;if(!t)return;t[5]!==n&&(i=t[6]?g(+t[5]):m(+t[5]));const r=E(+t[2]),o=+t[3]/100,s=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return k(S,e,t,n)}(r,o,s):"hsv"===t[1]?function(e,t,n){return k(_,e,t,n)}(r,o,s):M(r,o,s),{r:n[0],g:n[1],b:n[2],a:i}}const P={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},A={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let O;function D(e){O||(O=function(){const e={},t=Object.keys(A),n=Object.keys(P);let i,r,o,s,a;for(i=0;i<t.length;i++){for(s=a=t[i],r=0;r<n.length;r++)o=n[r],a=a.replace(o,P[o]);o=parseInt(A[s],16),e[a]=[o>>16&255,o>>8&255,255&o]}return e}(),O.transparent=[0,0,0,0]);const t=O[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}function R(e,t,n){if(e){let i=C(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,0===t?360:1)),i=M(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function L(e,t){return e?Object.assign(t||{},e):e}function N(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=m(e[3]))):(t=L(e,{r:0,g:0,b:0,a:1})).a=m(t.a),t}function F(e){return"r"===e.charAt(0)?function(e){const t=b.exec(e);let n,i,r,o=255;if(t){if(t[7]!==n){const e=+t[7];o=255&(t[8]?g(e):255*e)}return n=+t[1],i=+t[3],r=+t[5],n=255&(t[2]?g(n):n),i=255&(t[4]?g(i):i),r=255&(t[6]?g(r):r),{r:n,g:i,b:r,a:o}}}(e):T(e)}class j{constructor(e){if(e instanceof j)return e;const t=typeof e;let n;var i,r,o;"object"===t?n=N(e):"string"===t&&(o=(i=e).length,"#"===i[0]&&(4===o||5===o?r={r:255&17*a[i[1]],g:255&17*a[i[2]],b:255&17*a[i[3]],a:5===o?17*a[i[4]]:255}:7!==o&&9!==o||(r={r:a[i[1]]<<4|a[i[2]],g:a[i[3]]<<4|a[i[4]],b:a[i[5]]<<4|a[i[6]],a:9===o?a[i[7]]<<4|a[i[8]]:255})),n=r||D(e)||F(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=L(this._rgb);return e&&(e.a=y(e.a)),e}set rgb(e){this._rgb=N(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${y(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):this._rgb;var e}hexString(){return this._valid?d(this._rgb):this._rgb}hslString(){return this._valid?function(e){if(!e)return;const t=C(e),n=t[0],i=x(t[1]),r=x(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${r}%, ${y(e.a)})`:`hsl(${n}, ${i}%, ${r}%)`}(this._rgb):this._rgb}mix(e,t){const n=this;if(e){const i=n.rgb,r=e.rgb;let o;const s=t===o?.5:t,a=2*s-1,c=i.a-r.a,l=((a*c==-1?a:(a+c)/(1+a*c))+1)/2;o=1-l,i.r=255&l*i.r+o*r.r+.5,i.g=255&l*i.g+o*r.g+.5,i.b=255&l*i.b+o*r.b+.5,i.a=s*i.a+(1-s)*r.a,n.rgb=i}return n}clone(){return new j(this.rgb)}alpha(e){return this._rgb.a=m(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=f(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return R(this._rgb,2,e),this}darken(e){return R(this._rgb,2,-e),this}saturate(e){return R(this._rgb,1,e),this}desaturate(e){return R(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=C(e);n[0]=E(n[0]+t),n=M(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function I(e){return new j(e)}const q=e=>e instanceof CanvasGradient||e instanceof CanvasPattern;function B(e){return q(e)?e:I(e)}function z(e){return q(e)?e:I(e).saturate(.5).darken(.1).hexString()}function G(){}const H=function(){let e=0;return function(){return e++}}();function V(e){return null==e}function W(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.substr(0,7)&&"Array]"===t.substr(-6)}function U(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}const $=e=>("number"==typeof e||e instanceof Number)&&isFinite(+e);function Y(e,t){return $(e)?e:t}function X(e,t){return void 0===e?t:e}const J=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100:e/t,K=(e,t)=>"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Q(e,t,n){if(e&&"function"==typeof e.call)return e.apply(n,t)}function Z(e,t,n,i){let r,o,s;if(W(e))if(o=e.length,i)for(r=o-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<o;r++)t.call(n,e[r],r);else if(U(e))for(s=Object.keys(e),o=s.length,r=0;r<o;r++)t.call(n,e[s[r]],s[r])}function ee(e,t){let n,i,r,o;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(r=e[n],o=t[n],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function te(e){if(W(e))return e.map(te);if(U(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let r=0;for(;r<i;++r)t[n[r]]=te(e[n[r]]);return t}return e}function ne(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function ie(e,t,n,i){if(!ne(e))return;const r=t[e],o=n[e];U(r)&&U(o)?re(r,o,i):t[e]=te(o)}function re(e,t,n){const i=W(t)?t:[t],r=i.length;if(!U(e))return e;const o=(n=n||{}).merger||ie;for(let s=0;s<r;++s){if(!U(t=i[s]))continue;const r=Object.keys(t);for(let i=0,s=r.length;i<s;++i)o(r[i],e,t,n)}return e}function oe(e,t){return re(e,t,{merger:se})}function se(e,t,n){if(!ne(e))return;const i=t[e],r=n[e];U(i)&&U(r)?oe(i,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=te(r))}function ae(e,t){const n=e.indexOf(".",t);return-1===n?e.length:n}function ce(e,t){if(""===t)return e;let n=0,i=ae(t,n);for(;e&&i>n;)e=e[t.substr(n,i-n)],n=i+1,i=ae(t,n);return e}function le(e){return e.charAt(0).toUpperCase()+e.slice(1)}const ue=e=>void 0!==e,he=e=>"function"==typeof e,de=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0},fe=Object.create(null),pe=Object.create(null);function ge(e,t){if(!t)return e;const n=t.split(".");for(let t=0,i=n.length;t<i;++t){const i=n[t];e=e[i]||(e[i]=Object.create(null))}return e}function me(e,t,n){return"string"==typeof t?re(ge(e,t),n):re(ge(e,""),t)}var ye=new class{constructor(e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>z(t.backgroundColor),this.hoverBorderColor=(e,t)=>z(t.borderColor),this.hoverColor=(e,t)=>z(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.describe(e)}set(e,t){return me(this,e,t)}get(e){return ge(this,e)}describe(e,t){return me(pe,e,t)}override(e,t){return me(fe,e,t)}route(e,t,n,i){const r=ge(this,e),o=ge(this,n),s="_"+t;Object.defineProperties(r,{[s]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[s],t=o[i];return U(e)?Object.assign({},t,e):X(e,t)},set(e){this[s]=e}}})}}({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});const xe=Math.PI,be=2*xe,ve=be+xe,we=Number.POSITIVE_INFINITY,_e=xe/180,Se=xe/2,Ce=xe/4,ke=2*xe/3,Me=Math.log10,Ee=Math.sign;function Te(e){const t=Math.round(e);e=Oe(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Me(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Pe(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i==0&&(t.push(i),t.push(e/i));return n===(0|n)&&t.push(n),t.sort(((e,t)=>e-t)).pop(),t}function Ae(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Oe(e,t,n){return Math.abs(e-t)<n}function De(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function Re(e,t,n){let i,r,o;for(i=0,r=e.length;i<r;i++)o=e[i][n],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function Le(e){return e*(xe/180)}function Ne(e){return e*(180/xe)}function Fe(e){if(!$(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function je(e,t){const n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);let o=Math.atan2(i,n);return o<-.5*xe&&(o+=be),{angle:o,distance:r}}function Ie(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function qe(e,t){return(e-t+ve)%be-xe}function Be(e){return(e%be+be)%be}function ze(e,t,n,i){const r=Be(e),o=Be(t),s=Be(n),a=Be(o-r),c=Be(s-r),l=Be(r-o),u=Be(r-s);return r===o||r===s||i&&o===s||a>c&&l<u}function Ge(e,t,n){return Math.max(t,Math.min(n,e))}function He(e){return Ge(e,-32768,32767)}function Ve(e){return!e||V(e.size)||V(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function We(e,t,n,i,r){let o=t[r];return o||(o=t[r]=e.measureText(r).width,n.push(r)),o>i&&(i=o),i}function Ue(e,t,n,i){let r=(i=i||{}).data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},o=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let s=0;const a=n.length;let c,l,u,h,d;for(c=0;c<a;c++)if(h=n[c],null!=h&&!0!==W(h))s=We(e,r,o,s,h);else if(W(h))for(l=0,u=h.length;l<u;l++)d=h[l],null==d||W(d)||(s=We(e,r,o,s,d));e.restore();const f=o.length/2;if(f>n.length){for(c=0;c<f;c++)delete r[o[c]];o.splice(0,f)}return s}function $e(e,t,n){const i=e.currentDevicePixelRatio,r=0!==n?Math.max(n/2,.5):0;return Math.round((t-r)*i)/i+r}function Ye(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Xe(e,t,n,i){let r,o,s,a,c;const l=t.pointStyle,u=t.rotation,h=t.radius;let d=(u||0)*_e;if(l&&"object"==typeof l&&(r=l.toString(),"[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r))return e.save(),e.translate(n,i),e.rotate(d),e.drawImage(l,-l.width/2,-l.height/2,l.width,l.height),void e.restore();if(!(isNaN(h)||h<=0)){switch(e.beginPath(),l){default:e.arc(n,i,h,0,be),e.closePath();break;case"triangle":e.moveTo(n+Math.sin(d)*h,i-Math.cos(d)*h),d+=ke,e.lineTo(n+Math.sin(d)*h,i-Math.cos(d)*h),d+=ke,e.lineTo(n+Math.sin(d)*h,i-Math.cos(d)*h),e.closePath();break;case"rectRounded":c=.516*h,a=h-c,o=Math.cos(d+Ce)*a,s=Math.sin(d+Ce)*a,e.arc(n-o,i-s,c,d-xe,d-Se),e.arc(n+s,i-o,c,d-Se,d),e.arc(n+o,i+s,c,d,d+Se),e.arc(n-s,i+o,c,d+Se,d+xe),e.closePath();break;case"rect":if(!u){a=Math.SQRT1_2*h,e.rect(n-a,i-a,2*a,2*a);break}d+=Ce;case"rectRot":o=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-o,i-s),e.lineTo(n+s,i-o),e.lineTo(n+o,i+s),e.lineTo(n-s,i+o),e.closePath();break;case"crossRot":d+=Ce;case"cross":o=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-o,i-s),e.lineTo(n+o,i+s),e.moveTo(n+s,i-o),e.lineTo(n-s,i+o);break;case"star":o=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-o,i-s),e.lineTo(n+o,i+s),e.moveTo(n+s,i-o),e.lineTo(n-s,i+o),d+=Ce,o=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-o,i-s),e.lineTo(n+o,i+s),e.moveTo(n+s,i-o),e.lineTo(n-s,i+o);break;case"line":o=Math.cos(d)*h,s=Math.sin(d)*h,e.moveTo(n-o,i-s),e.lineTo(n+o,i+s);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(d)*h,i+Math.sin(d)*h)}e.fill(),t.borderWidth>0&&e.stroke()}}function Je(e,t,n){return n=n||.5,e&&t&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Ke(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Qe(e){e.restore()}function Ze(e,t,n,i,r){if(!t)return e.lineTo(n.x,n.y);if("middle"===r){const i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else"after"===r!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function et(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function tt(e,t,n,i,r,o={}){const s=W(t)?t:[t],a=o.strokeWidth>0&&""!==o.strokeColor;let c,l;for(e.save(),e.font=r.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]);V(t.rotation)||e.rotate(t.rotation);t.color&&(e.fillStyle=t.color);t.textAlign&&(e.textAlign=t.textAlign);t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,o),c=0;c<s.length;++c)l=s[c],a&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),V(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(l,n,i,o.maxWidth)),e.fillText(l,n,i,o.maxWidth),nt(e,n,i,l,o),i+=r.lineHeight;e.restore()}function nt(e,t,n,i,r){if(r.strikethrough||r.underline){const o=e.measureText(i),s=t-o.actualBoundingBoxLeft,a=t+o.actualBoundingBoxRight,c=n-o.actualBoundingBoxAscent,l=n+o.actualBoundingBoxDescent,u=r.strikethrough?(c+l)/2:l;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(s,u),e.lineTo(a,u),e.stroke()}}function it(e,t){const{x:n,y:i,w:r,h:o,radius:s}=t;e.arc(n+s.topLeft,i+s.topLeft,s.topLeft,-Se,xe,!0),e.lineTo(n,i+o-s.bottomLeft),e.arc(n+s.bottomLeft,i+o-s.bottomLeft,s.bottomLeft,xe,Se,!0),e.lineTo(n+r-s.bottomRight,i+o),e.arc(n+r-s.bottomRight,i+o-s.bottomRight,s.bottomRight,Se,0,!0),e.lineTo(n+r,i+s.topRight),e.arc(n+r-s.topRight,i+s.topRight,s.topRight,0,-Se,!0),e.lineTo(n+s.topLeft,i)}function rt(e,t,n){n=n||(n=>e[n]<t);let i,r=e.length-1,o=0;for(;r-o>1;)i=o+r>>1,n(i)?o=i:r=i;return{lo:o,hi:r}}const ot=(e,t,n)=>rt(e,n,(i=>e[i][t]<n)),st=(e,t,n)=>rt(e,n,(i=>e[i][t]>=n));function at(e,t,n){let i=0,r=e.length;for(;i<r&&e[i]<t;)i++;for(;r>i&&e[r-1]>n;)r--;return i>0||r<e.length?e.slice(i,r):e}const ct=["push","pop","shift","splice","unshift"];function lt(e,t){e._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),ct.forEach((t=>{const n="_onData"+le(t),i=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value(...t){const r=i.apply(this,t);return e._chartjs.listeners.forEach((e=>{"function"==typeof e[n]&&e[n](...t)})),r}})})))}function ut(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(t);-1!==r&&i.splice(r,1),i.length>0||(ct.forEach((t=>{delete e[t]})),delete e._chartjs)}function ht(e){const t=new Set;let n,i;for(n=0,i=e.length;n<i;++n)t.add(e[n]);return t.size===i?e:Array.from(t)}function dt(){return"undefined"!=typeof window&&"undefined"!=typeof document}function ft(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function pt(e,t,n){let i;return"string"==typeof e?(i=parseInt(e,10),-1!==e.indexOf("%")&&(i=i/100*t.parentNode[n])):i=e,i}const gt=e=>window.getComputedStyle(e,null);function mt(e,t){return gt(e).getPropertyValue(t)}const yt=["top","right","bottom","left"];function xt(e,t,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const o=yt[r];i[o]=parseFloat(e[t+"-"+o+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function bt(e,t){const{canvas:n,currentDevicePixelRatio:i}=t,r=gt(n),o="border-box"===r.boxSizing,s=xt(r,"padding"),a=xt(r,"border","width"),{x:c,y:l,box:u}=function(e,t){const n=e.native||e,i=n.touches,r=i&&i.length?i[0]:n,{offsetX:o,offsetY:s}=r;let a,c,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(o,s,n.target))a=o,c=s;else{const e=t.getBoundingClientRect();a=r.clientX-e.left,c=r.clientY-e.top,l=!0}return{x:a,y:c,box:l}}(e,n),h=s.left+(u&&a.left),d=s.top+(u&&a.top);let{width:f,height:p}=t;return o&&(f-=s.width+a.width,p-=s.height+a.height),{x:Math.round((c-h)/f*n.width/i),y:Math.round((l-d)/p*n.height/i)}}const vt=e=>Math.round(10*e)/10;function wt(e,t,n,i){const r=gt(e),o=xt(r,"margin"),s=pt(r.maxWidth,e,"clientWidth")||we,a=pt(r.maxHeight,e,"clientHeight")||we,c=function(e,t,n){let i,r;if(void 0===t||void 0===n){const o=ft(e);if(o){const e=o.getBoundingClientRect(),s=gt(o),a=xt(s,"border","width"),c=xt(s,"padding");t=e.width-c.width-a.width,n=e.height-c.height-a.height,i=pt(s.maxWidth,o,"clientWidth"),r=pt(s.maxHeight,o,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:i||we,maxHeight:r||we}}(e,t,n);let{width:l,height:u}=c;if("content-box"===r.boxSizing){const e=xt(r,"border","width"),t=xt(r,"padding");l-=t.width+e.width,u-=t.height+e.height}return l=Math.max(0,l-o.width),u=Math.max(0,i?Math.floor(l/i):u-o.height),l=vt(Math.min(l,s,c.maxWidth)),u=vt(Math.min(u,a,c.maxHeight)),l&&!u&&(u=vt(l/2)),{width:l,height:u}}function _t(e,t,n){const i=t||1,r=Math.floor(e.height*i),o=Math.floor(e.width*i);e.height=r/i,e.width=o/i;const s=e.canvas;return s.style&&(n||!s.style.height&&!s.style.width)&&(s.style.height=`${e.height}px`,s.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==i||s.height!==r||s.width!==o)&&(e.currentDevicePixelRatio=i,s.height=r,s.width=o,e.ctx.setTransform(i,0,0,i,0,0),!0)}const St=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}();function Ct(e,t){const n=mt(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function kt(e,t){return"native"in e?{x:e.x,y:e.y}:bt(e,t)}function Mt(e,t,n,i){const{controller:r,data:o,_sorted:s}=e,a=r._cachedMeta.iScale;if(a&&t===a.axis&&s&&o.length){const e=a._reversePixels?st:ot;if(!i)return e(o,t,n);if(r._sharedOptions){const i=o[0],r="function"==typeof i.getRange&&i.getRange(t);if(r){const i=e(o,t,n-r),s=e(o,t,n+r);return{lo:i.lo,hi:s.hi}}}}return{lo:0,hi:o.length-1}}function Et(e,t,n,i,r){const o=e.getSortedVisibleDatasetMetas(),s=n[t];for(let e=0,n=o.length;e<n;++e){const{index:n,data:a}=o[e],{lo:c,hi:l}=Mt(o[e],t,s,r);for(let e=c;e<=l;++e){const t=a[e];t.skip||i(t,n,e)}}}function Tt(e,t,n,i){const r=[];if(!Je(t,e.chartArea,e._minPadding))return r;return Et(e,n,t,(function(e,n,o){e.inRange(t.x,t.y,i)&&r.push({element:e,datasetIndex:n,index:o})}),!0),r}function Pt(e,t,n,i,r){const o=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,i){const r=t?Math.abs(e.x-i.x):0,o=n?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}(n);let s=Number.POSITIVE_INFINITY,a=[];if(!Je(t,e.chartArea,e._minPadding))return a;return Et(e,n,t,(function(n,c,l){if(i&&!n.inRange(t.x,t.y,r))return;const u=n.getCenterPoint(r);if(!Je(u,e.chartArea,e._minPadding)&&!n.inRange(t.x,t.y,r))return;const h=o(t,u);h<s?(a=[{element:n,datasetIndex:c,index:l}],s=h):h===s&&a.push({element:n,datasetIndex:c,index:l})})),a}function At(e,t,n,i){const r=kt(t,e),o=[],s=n.axis,a="x"===s?"inXRange":"inYRange";let c=!1;return function(e,t){const n=e.getSortedVisibleDatasetMetas();let i,r,o;for(let e=0,s=n.length;e<s;++e){({index:i,data:r}=n[e]);for(let e=0,n=r.length;e<n;++e)o=r[e],o.skip||t(o,i,e)}}(e,((e,t,n)=>{e[a](r[s],i)&&o.push({element:e,datasetIndex:t,index:n}),e.inRange(r.x,r.y,i)&&(c=!0)})),n.intersect&&!c?[]:o}var Ot={modes:{index(e,t,n,i){const r=kt(t,e),o=n.axis||"x",s=n.intersect?Tt(e,r,o,i):Pt(e,r,o,!1,i),a=[];return s.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=s[0].index,n=e.data[t];n&&!n.skip&&a.push({element:n,datasetIndex:e.index,index:t})})),a):[]},dataset(e,t,n,i){const r=kt(t,e),o=n.axis||"xy";let s=n.intersect?Tt(e,r,o,i):Pt(e,r,o,!1,i);if(s.length>0){const t=s[0].datasetIndex,n=e.getDatasetMeta(t).data;s=[];for(let e=0;e<n.length;++e)s.push({element:n[e],datasetIndex:t,index:e})}return s},point:(e,t,n,i)=>Tt(e,kt(t,e),n.axis||"xy",i),nearest:(e,t,n,i)=>Pt(e,kt(t,e),n.axis||"xy",n.intersect,i),x:(e,t,n,i)=>(n.axis="x",At(e,t,n,i)),y:(e,t,n,i)=>(n.axis="y",At(e,t,n,i))}};const Dt=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),Rt=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function Lt(e,t){const n=(""+e).match(Dt);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}function Nt(e,t){const n={},i=U(t),r=i?Object.keys(t):t,o=U(e)?i?n=>X(e[n],e[t[n]]):t=>e[t]:()=>e;for(const e of r)n[e]=+o(e)||0;return n}function Ft(e){return Nt(e,{top:"y",right:"x",bottom:"y",left:"x"})}function jt(e){return Nt(e,["topLeft","topRight","bottomLeft","bottomRight"])}function It(e){const t=Ft(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function qt(e,t){e=e||{},t=t||ye.font;let n=X(e.size,t.size);"string"==typeof n&&(n=parseInt(n,10));let i=X(e.style,t.style);i&&!(""+i).match(Rt)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const r={family:X(e.family,t.family),lineHeight:Lt(X(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:X(e.weight,t.weight),string:""};return r.string=Ve(r),r}function Bt(e,t,n,i){let r,o,s,a=!0;for(r=0,o=e.length;r<o;++r)if(s=e[r],void 0!==s&&(void 0!==t&&"function"==typeof s&&(s=s(t),a=!1),void 0!==n&&W(s)&&(s=s[n%s.length],a=!1),void 0!==s))return i&&!a&&(i.cacheable=!1),s}function zt(e,t){const{min:n,max:i}=e;return{min:n-Math.abs(K(t,n)),max:i+K(t,i)}}const Gt=["left","top","right","bottom"];function Ht(e,t){return e.filter((e=>e.pos===t))}function Vt(e,t){return e.filter((e=>-1===Gt.indexOf(e.pos)&&e.box.axis===t))}function Wt(e,t){return e.sort(((e,n)=>{const i=t?n:e,r=t?e:n;return i.weight===r.weight?i.index-r.index:i.weight-r.weight}))}function Ut(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:i,stackWeight:r}=n;if(!e||!Gt.includes(i))continue;const o=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}(e),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let o,s,a;for(o=0,s=e.length;o<s;++o){a=e[o];const{fullSize:s}=a.box,c=n[a.stack],l=c&&a.stackWeight/c.weight;a.horizontal?(a.width=l?l*i:s&&t.availableWidth,a.height=r):(a.width=i,a.height=l?l*r:s&&t.availableHeight)}return n}function $t(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function Yt(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Xt(e,t,n,i){const{pos:r,box:o}=n,s=e.maxPadding;if(!U(r)){n.size&&(e[r]-=n.size);const t=i[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?o.height:o.width),n.size=t.size/t.count,e[r]+=n.size}o.getPadding&&Yt(s,o.getPadding());const a=Math.max(0,t.outerWidth-$t(s,e,"left","right")),c=Math.max(0,t.outerHeight-$t(s,e,"top","bottom")),l=a!==e.w,u=c!==e.h;return e.w=a,e.h=c,n.horizontal?{same:l,other:u}:{same:u,other:l}}function Jt(e,t){const n=t.maxPadding;function i(e){const i={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{i[e]=Math.max(t[e],n[e])})),i}return i(e?["left","right"]:["top","bottom"])}function Kt(e,t,n,i){const r=[];let o,s,a,c,l,u;for(o=0,s=e.length,l=0;o<s;++o){a=e[o],c=a.box,c.update(a.width||t.w,a.height||t.h,Jt(a.horizontal,t));const{same:s,other:h}=Xt(t,n,a,i);l|=s&&r.length,u=u||h,c.fullSize||r.push(a)}return l&&Kt(r,t,n,i)||u}function Qt(e,t,n,i,r){e.top=n,e.left=t,e.right=t+i,e.bottom=n+r,e.width=i,e.height=r}function Zt(e,t,n,i){const r=n.padding;let{x:o,y:s}=t;for(const a of e){const e=a.box,c=i[a.stack]||{count:1,placed:0,weight:1},l=a.stackWeight/c.weight||1;if(a.horizontal){const i=t.w*l,o=c.size||e.height;ue(c.start)&&(s=c.start),e.fullSize?Qt(e,r.left,s,n.outerWidth-r.right-r.left,o):Qt(e,t.left+c.placed,s,i,o),c.start=s,c.placed+=i,s=e.bottom}else{const i=t.h*l,s=c.size||e.width;ue(c.start)&&(o=c.start),e.fullSize?Qt(e,o,r.top,s,n.outerHeight-r.bottom-r.top):Qt(e,o,t.top+c.placed,s,i),c.start=o,c.placed+=i,o=e.right}}t.x=o,t.y=s}ye.set("layout",{padding:{top:0,right:0,bottom:0,left:0}});var en={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const r=It(e.options.layout.padding),o=Math.max(t-r.width,0),s=Math.max(n-r.height,0),a=function(e){const t=function(e){const t=[];let n,i,r,o,s,a;for(n=0,i=(e||[]).length;n<i;++n)r=e[n],({position:o,options:{stack:s,stackWeight:a=1}}=r),t.push({index:n,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:s&&o+s,stackWeight:a});return t}(e),n=Wt(t.filter((e=>e.box.fullSize)),!0),i=Wt(Ht(t,"left"),!0),r=Wt(Ht(t,"right")),o=Wt(Ht(t,"top"),!0),s=Wt(Ht(t,"bottom")),a=Vt(t,"x"),c=Vt(t,"y");return{fullSize:n,leftAndTop:i.concat(o),rightAndBottom:r.concat(c).concat(s).concat(a),chartArea:Ht(t,"chartArea"),vertical:i.concat(r).concat(c),horizontal:o.concat(s).concat(a)}}(e.boxes),c=a.vertical,l=a.horizontal;Z(e.boxes,(e=>{"function"==typeof e.beforeLayout&&e.beforeLayout()}));const u=c.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:o,availableHeight:s,vBoxMaxWidth:o/2/u,hBoxMaxHeight:s/2}),d=Object.assign({},r);Yt(d,It(i));const f=Object.assign({maxPadding:d,w:o,h:s,x:r.left,y:r.top},r),p=Ut(c.concat(l),h);Kt(a.fullSize,f,h,p),Kt(c,f,h,p),Kt(l,f,h,p)&&Kt(c,f,h,p),function(e){const t=e.maxPadding;function n(n){const i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(f),Zt(a.leftAndTop,f,h,p),f.x+=f.w,f.y+=f.h,Zt(a.rightAndBottom,f,h,p),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Z(a.chartArea,(t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(f.w,f.h)}))}};function tn(e,t=[""],n=e,i,r=(()=>e[0])){ue(i)||(i=fn("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:n,_fallback:i,_getTarget:r,override:r=>tn([r,...e],t,n,i)};return new Proxy(o,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,i)=>an(n,i,(()=>function(e,t,n,i){let r;for(const o of t)if(r=fn(on(o,e),n),ue(r))return sn(e,r)?hn(n,i,e,r):r}(i,t,e,n))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>pn(e).includes(t),ownKeys:e=>pn(e),set:(e,t,n)=>((e._storage||(e._storage=r()))[t]=n,delete e[t],delete e._keys,!0)})}function nn(e,t,n,i){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:rn(e,i),setContext:t=>nn(e,t,n,i),override:r=>nn(e.override(r),t,n,i)};return new Proxy(r,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>an(e,t,(()=>function(e,t,n){const{_proxy:i,_context:r,_subProxy:o,_descriptors:s}=e;let a=i[t];he(a)&&s.isScriptable(t)&&(a=function(e,t,n,i){const{_proxy:r,_context:o,_subProxy:s,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e),t=t(o,s||i),a.delete(e),U(t)&&(t=hn(r._scopes,r,e,t));return t}(t,a,e,n));W(a)&&a.length&&(a=function(e,t,n,i){const{_proxy:r,_context:o,_subProxy:s,_descriptors:a}=n;if(ue(o.index)&&i(e))t=t[o.index%t.length];else if(U(t[0])){const n=t,i=r._scopes.filter((e=>e!==n));t=[];for(const c of n){const n=hn(i,r,e,c);t.push(nn(n,o,s&&s[e],a))}}return t}(t,a,e,s.isIndexable));sn(t,a)&&(a=nn(a,r,o&&o[t],s));return a}(e,t,n))),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,i)=>(e[n]=i,delete t[n],!0)})}function rn(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:i,isScriptable:he(n)?n:()=>n,isIndexable:he(i)?i:()=>i}}const on=(e,t)=>e?e+le(t):t,sn=(e,t)=>U(t)&&"adapters"!==e;function an(e,t,n){let i=e[t];return ue(i)||(i=n(),ue(i)&&(e[t]=i)),i}function cn(e,t,n){return he(e)?e(t,n):e}const ln=(e,t)=>!0===e?t:"string"==typeof e?ce(t,e):void 0;function un(e,t,n,i){for(const r of t){const t=ln(n,r);if(t){e.add(t);const r=cn(t._fallback,n,t);if(ue(r)&&r!==n&&r!==i)return r}else if(!1===t&&ue(i)&&n!==i)return null}return!1}function hn(e,t,n,i){const r=t._rootScopes,o=cn(t._fallback,n,i),s=[...e,...r],a=new Set;a.add(i);let c=dn(a,s,n,o||n);return null!==c&&((!ue(o)||o===n||(c=dn(a,s,o,c),null!==c))&&tn(Array.from(a),[""],r,o,(()=>function(e,t,n){const i=e._getTarget();t in i||(i[t]={});const r=i[t];if(W(r)&&U(n))return n;return r}(t,n,i))))}function dn(e,t,n,i){for(;n;)n=un(e,t,n,i);return n}function fn(e,t){for(const n of t){if(!n)continue;const t=n[e];if(ue(t))return t}}function pn(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}const gn=Number.EPSILON||1e-14,mn=(e,t)=>t<e.length&&!e[t].skip&&e[t],yn=e=>"x"===e?"y":"x";function xn(e,t,n,i){const r=e.skip?t:e,o=t,s=n.skip?t:n,a=Ie(o,r),c=Ie(s,o);let l=a/(a+c),u=c/(a+c);l=isNaN(l)?0:l,u=isNaN(u)?0:u;const h=i*l,d=i*u;return{previous:{x:o.x-h*(s.x-r.x),y:o.y-h*(s.y-r.y)},next:{x:o.x+d*(s.x-r.x),y:o.y+d*(s.y-r.y)}}}function bn(e,t="x"){const n=yn(t),i=e.length,r=Array(i).fill(0),o=Array(i);let s,a,c,l=mn(e,0);for(s=0;s<i;++s)if(a=c,c=l,l=mn(e,s+1),c){if(l){const e=l[t]-c[t];r[s]=0!==e?(l[n]-c[n])/e:0}o[s]=a?l?Ee(r[s-1])!==Ee(r[s])?0:(r[s-1]+r[s])/2:r[s-1]:r[s]}!function(e,t,n){const i=e.length;let r,o,s,a,c,l=mn(e,0);for(let u=0;u<i-1;++u)c=l,l=mn(e,u+1),c&&l&&(Oe(t[u],0,gn)?n[u]=n[u+1]=0:(r=n[u]/t[u],o=n[u+1]/t[u],a=Math.pow(r,2)+Math.pow(o,2),a<=9||(s=3/Math.sqrt(a),n[u]=r*s*t[u],n[u+1]=o*s*t[u])))}(e,r,o),function(e,t,n="x"){const i=yn(n),r=e.length;let o,s,a,c=mn(e,0);for(let l=0;l<r;++l){if(s=a,a=c,c=mn(e,l+1),!a)continue;const r=a[n],u=a[i];s&&(o=(r-s[n])/3,a[`cp1${n}`]=r-o,a[`cp1${i}`]=u-o*t[l]),c&&(o=(c[n]-r)/3,a[`cp2${n}`]=r+o,a[`cp2${i}`]=u+o*t[l])}}(e,o,t)}function vn(e,t,n){return Math.max(Math.min(e,n),t)}function wn(e,t,n,i,r){let o,s,a,c;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)bn(e,r);else{let n=i?e[e.length-1]:e[0];for(o=0,s=e.length;o<s;++o)a=e[o],c=xn(n,a,e[Math.min(o+1,s-(i?0:1))%s],t.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,n=a}t.capBezierPoints&&function(e,t){let n,i,r,o,s,a=Je(e[0],t);for(n=0,i=e.length;n<i;++n)s=o,o=a,a=n<i-1&&Je(e[n+1],t),o&&(r=e[n],s&&(r.cp1x=vn(r.cp1x,t.left,t.right),r.cp1y=vn(r.cp1y,t.top,t.bottom)),a&&(r.cp2x=vn(r.cp2x,t.left,t.right),r.cp2y=vn(r.cp2y,t.top,t.bottom)))}(e,n)}const _n=e=>0===e||1===e,Sn=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*be/n),Cn=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*be/n)+1,kn={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Se),easeOutSine:e=>Math.sin(e*Se),easeInOutSine:e=>-.5*(Math.cos(xe*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>_n(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>_n(e)?e:Sn(e,.075,.3),easeOutElastic:e=>_n(e)?e:Cn(e,.075,.3),easeInOutElastic(e){const t=.1125;return _n(e)?e:e<.5?.5*Sn(2*e,t,.45):.5+.5*Cn(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-kn.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*kn.easeInBounce(2*e):.5*kn.easeOutBounce(2*e-1)+.5};function Mn(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function En(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:"middle"===i?n<.5?e.y:t.y:"after"===i?n<1?e.y:t.y:n>0?t.y:e.y}}function Tn(e,t,n,i){const r={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},s=Mn(e,r,n),a=Mn(r,o,n),c=Mn(o,t,n),l=Mn(s,a,n),u=Mn(a,c,n);return Mn(l,u,n)}const Pn=new Map;function An(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let i=Pn.get(n);return i||(i=new Intl.NumberFormat(e,t),Pn.set(n,i)),i}(t,n).format(e)}function On(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Dn(e,t){let n,i;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function Rn(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Ln(e){return"angle"===e?{between:ze,compare:qe,normalize:Be}:{between:(e,t,n)=>e>=Math.min(t,n)&&e<=Math.max(n,t),compare:(e,t)=>e-t,normalize:e=>e}}function Nn({start:e,end:t,count:n,loop:i,style:r}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n==0,style:r}}function Fn(e,t,n){if(!n)return[e];const{property:i,start:r,end:o}=n,s=t.length,{compare:a,between:c,normalize:l}=Ln(i),{start:u,end:h,loop:d,style:f}=function(e,t,n){const{property:i,start:r,end:o}=n,{between:s,normalize:a}=Ln(i),c=t.length;let l,u,{start:h,end:d,loop:f}=e;if(f){for(h+=c,d+=c,l=0,u=c;l<u&&s(a(t[h%c][i]),r,o);++l)h--,d--;h%=c,d%=c}return d<h&&(d+=c),{start:h,end:d,loop:f,style:e.style}}(e,t,n),p=[];let g,m,y,x=!1,b=null;const v=()=>x||c(r,y,g)&&0!==a(r,y),w=()=>!x||0===a(o,g)||c(o,y,g);for(let e=u,n=u;e<=h;++e)m=t[e%s],m.skip||(g=l(m[i]),g!==y&&(x=c(g,r,o),null===b&&v()&&(b=0===a(g,r)?e:n),null!==b&&w()&&(p.push(Nn({start:b,end:e,loop:d,count:s,style:f})),b=null),n=e,y=g));return null!==b&&p.push(Nn({start:b,end:h,loop:d,count:s,style:f})),p}function jn(e,t){const n=[],i=e.segments;for(let r=0;r<i.length;r++){const o=Fn(i[r],e.points,t);o.length&&n.push(...o)}return n}function In(e,t){const n=e.points,i=e.options.spanGaps,r=n.length;if(!r)return[];const o=!!e._loop,{start:s,end:a}=function(e,t,n,i){let r=0,o=t-1;if(n&&!i)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(o+=r);o>r&&e[o%t].skip;)o--;return o%=t,{start:r,end:o}}(n,r,o,i);if(!0===i)return qn(e,[{start:s,end:a,loop:o}],n,t);return qn(e,function(e,t,n,i){const r=e.length,o=[];let s,a=t,c=e[t];for(s=t+1;s<=n;++s){const n=e[s%r];n.skip||n.stop?c.skip||(i=!1,o.push({start:t%r,end:(s-1)%r,loop:i}),t=a=n.stop?s:null):(a=s,c.skip&&(t=s)),c=n}return null!==a&&o.push({start:t%r,end:a%r,loop:i}),o}(n,s,a<s?a+r:a,!!e._fullLoop&&0===s&&a===r-1),n,t)}function qn(e,t,n,i){return i&&i.setContext&&n?function(e,t,n,i){const r=Bn(e.options),o=n.length,s=[];let a=t[0].start,c=a;for(const l of t){let t,u=r,h=n[a%o];for(c=a+1;c<=l.end;c++){const r=n[c%o];t=Bn(i.setContext({type:"segment",p0:h,p1:r,p0DataIndex:(c-1)%o,p1DataIndex:c%o,datasetIndex:e._datasetIndex})),zn(t,u)&&(s.push({start:a,end:c-1,loop:l.loop,style:u}),u=t,a=c-1),h=r,u=t}a<c-1&&(s.push({start:a,end:c-1,loop:l.loop,style:t}),a=c-1)}return s}(e,t,n,i):t}function Bn(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function zn(e,t){return t&&JSON.stringify(e)!==JSON.stringify(t)}var Gn=Object.freeze({__proto__:null,easingEffects:kn,color:B,getHoverColor:z,noop:G,uid:H,isNullOrUndef:V,isArray:W,isObject:U,isFinite:$,finiteOrDefault:Y,valueOrDefault:X,toPercentage:J,toDimension:K,callback:Q,each:Z,_elementsEqual:ee,clone:te,_merger:ie,merge:re,mergeIf:oe,_mergerIf:se,_deprecated:function(e,t,n,i){void 0!==t&&console.warn(e+': "'+n+'" is deprecated. Please use "'+i+'" instead')},resolveObjectKey:ce,_capitalize:le,defined:ue,isFunction:he,setsEqual:de,toFontString:Ve,_measureText:We,_longestText:Ue,_alignPixel:$e,clearCanvas:Ye,drawPoint:Xe,_isPointInArea:Je,clipArea:Ke,unclipArea:Qe,_steppedLineTo:Ze,_bezierCurveTo:et,renderText:tt,addRoundedRectPath:it,_lookup:rt,_lookupByKey:ot,_rlookupByKey:st,_filterBetween:at,listenArrayEvents:lt,unlistenArrayEvents:ut,_arrayUnique:ht,_createResolver:tn,_attachContext:nn,_descriptors:rn,splineCurve:xn,splineCurveMonotone:bn,_updateBezierControlPoints:wn,_isDomSupported:dt,_getParentNode:ft,getStyle:mt,getRelativePosition:bt,getMaximumSize:wt,retinaScale:_t,supportsEventListenerOptions:St,readUsedSize:Ct,fontString:function(e,t,n){return t+" "+e+"px "+n},requestAnimFrame:e,throttled:t,debounce:n,_toLeftRightCenter:i,_alignStartEnd:r,_textX:o,_pointInLine:Mn,_steppedInterpolation:En,_bezierInterpolation:Tn,formatNumber:An,toLineHeight:Lt,_readValueToProps:Nt,toTRBL:Ft,toTRBLCorners:jt,toPadding:It,toFont:qt,resolve:Bt,_addGrace:zt,PI:xe,TAU:be,PITAU:ve,INFINITY:we,RAD_PER_DEG:_e,HALF_PI:Se,QUARTER_PI:Ce,TWO_THIRDS_PI:ke,log10:Me,sign:Ee,niceNum:Te,_factorize:Pe,isNumber:Ae,almostEquals:Oe,almostWhole:De,_setMinAndMaxByKey:Re,toRadians:Le,toDegrees:Ne,_decimalPlaces:Fe,getAngleFromPoint:je,distanceBetweenPoints:Ie,_angleDiff:qe,_normalizeAngle:Be,_angleBetween:ze,_limitValue:Ge,_int16Range:He,getRtlAdapter:On,overrideTextDirection:Dn,restoreTextDirection:Rn,_boundSegment:Fn,_boundSegments:jn,_computeSegments:In});class Hn{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}}class Vn extends Hn{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}}const Wn={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Un=e=>null===e||""===e;const $n=!!St&&{passive:!0};function Yn(e,t,n){e.canvas.removeEventListener(t,n,$n)}function Xn(e,t,n){const i=e.canvas,r=i&&ft(i)||i,o=new MutationObserver((e=>{const t=ft(r);e.forEach((e=>{for(let i=0;i<e.addedNodes.length;i++){const o=e.addedNodes[i];o!==r&&o!==t||n(e.target)}}))}));return o.observe(document,{childList:!0,subtree:!0}),o}function Jn(e,t,n){const i=e.canvas,r=i&&ft(i);if(!r)return;const o=new MutationObserver((e=>{e.forEach((e=>{for(let t=0;t<e.removedNodes.length;t++)if(e.removedNodes[t]===i){n();break}}))}));return o.observe(r,{childList:!0}),o}const Kn=new Map;let Qn=0;function Zn(){const e=window.devicePixelRatio;e!==Qn&&(Qn=e,Kn.forEach(((t,n)=>{n.currentDevicePixelRatio!==e&&t()})))}function ei(e,n,i){const r=e.canvas,o=r&&ft(r);if(!o)return;const s=t(((e,t)=>{const n=o.clientWidth;i(e,t),n<o.clientWidth&&i()}),window),a=new ResizeObserver((e=>{const t=e[0],n=t.contentRect.width,i=t.contentRect.height;0===n&&0===i||s(n,i)}));return a.observe(o),function(e,t){Kn.size||window.addEventListener("resize",Zn),Kn.set(e,t)}(e,s),a}function ti(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){Kn.delete(e),Kn.size||window.removeEventListener("resize",Zn)}(e)}function ni(e,n,i){const r=e.canvas,o=t((t=>{null!==e.ctx&&i(function(e,t){const n=Wn[e.type]||e.type,{x:i,y:r}=bt(e,t);return{type:n,chart:t,native:e,x:void 0!==i?i:null,y:void 0!==r?r:null}}(t,e))}),e,(e=>{const t=e[0];return[t,t.offsetX,t.offsetY]}));return function(e,t,n){e.addEventListener(t,n,$n)}(r,n,o),o}class ii extends Hn{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e.$chartjs={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Un(r)){const t=Ct(e,"width");void 0!==t&&(e.width=t)}if(Un(i))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Ct(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t.$chartjs)return!1;const n=t.$chartjs.initial;["height","width"].forEach((e=>{const i=n[e];V(i)?t.removeAttribute(e):t.setAttribute(e,i)}));const i=n.style||{};return Object.keys(i).forEach((e=>{t.style[e]=i[e]})),t.width=t.width,delete t.$chartjs,!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),r={attach:Xn,detach:Jn,resize:ei}[t]||ni;i[t]=r(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:ti,detach:ti,resize:ti}[t]||Yn)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return wt(e,t,n,i)}isAttached(e){const t=ft(e);return!(!t||!t.isConnected)}}function ri(e){return!dt()||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Vn:ii}var oi=Object.freeze({__proto__:null,_detectPlatform:ri,BasePlatform:Hn,BasicPlatform:Vn,DomPlatform:ii});const si="transparent",ai={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const i=B(e||si),r=i.valid&&B(t||si);return r&&r.valid?r.mix(i,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class ci{constructor(e,t,n,i){const r=t[n];i=Bt([e.to,i,r,e.from]);const o=Bt([e.from,r,i]);this._active=!0,this._fn=e.fn||ai[e.type||typeof o],this._easing=kn[e.easing]||kn.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){const i=this;if(i._active){i._notify(!1);const r=i._target[i._prop],o=n-i._start,s=i._duration-o;i._start=n,i._duration=Math.floor(Math.max(s,e.duration)),i._total+=o,i._loop=!!e.loop,i._to=Bt([e.to,t,r,e.from]),i._from=Bt([e.from,r,t])}}cancel(){const e=this;e._active&&(e.tick(Date.now()),e._active=!1,e._notify(!1))}tick(e){const t=this,n=e-t._start,i=t._duration,r=t._prop,o=t._from,s=t._loop,a=t._to;let c;if(t._active=o!==a&&(s||n<i),!t._active)return t._target[r]=a,void t._notify(!0);n<0?t._target[r]=o:(c=n/i%2,c=s&&c>1?2-c:c,c=t._easing(Math.min(1,Math.max(0,c))),t._target[r]=t._fn(o,a,c))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,n)=>{e.push({res:t,rej:n})}))}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let e=0;e<n.length;e++)n[e][t]()}}ye.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const li=Object.keys(ye.animation);ye.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),ye.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),ye.describe("animations",{_fallback:"animation"}),ye.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}});class ui{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!U(e))return;const t=this._properties;Object.getOwnPropertyNames(e).forEach((n=>{const i=e[n];if(!U(i))return;const r={};for(const e of li)r[e]=i[e];(W(i.properties)&&i.properties||[n]).forEach((e=>{e!==n&&t.has(e)||t.set(e,r)}))}))}_animateOptions(e,t){const n=t.options,i=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!i)return[];const r=this._createAnimations(i,n);return n.$shared&&function(e,t){const n=[],i=Object.keys(t);for(let t=0;t<i.length;t++){const r=e[i[t]];r&&r.active()&&n.push(r.wait())}return Promise.all(n)}(e.options.$animations,n).then((()=>{e.options=n}),(()=>{})),r}_createAnimations(e,t){const n=this._properties,i=[],r=e.$animations||(e.$animations={}),o=Object.keys(t),s=Date.now();let a;for(a=o.length-1;a>=0;--a){const c=o[a];if("$"===c.charAt(0))continue;if("options"===c){i.push(...this._animateOptions(e,t));continue}const l=t[c];let u=r[c];const h=n.get(c);if(u){if(h&&u.active()){u.update(h,l,s);continue}u.cancel()}h&&h.duration?(r[c]=u=new ci(h,e,c,l),i.push(u)):e[c]=l}return i}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(s.add(this._chart,n),!0):void 0}}function hi(e,t){const n=e&&e.options||{},i=n.reverse,r=void 0===n.min?t:0,o=void 0===n.max?t:0;return{start:i?o:r,end:i?r:o}}function di(e,t){const n=[],i=e._getSortedDatasetMetas(t);let r,o;for(r=0,o=i.length;r<o;++r)n.push(i[r].index);return n}function fi(e,t,n,i){const r=e.keys,o="single"===i.mode;let s,a,c,l;if(null!==t){for(s=0,a=r.length;s<a;++s){if(c=+r[s],c===n){if(i.all)continue;break}l=e.values[c],$(l)&&(o||0===t||Ee(t)===Ee(l))&&(t+=l)}return t}}function pi(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function gi(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function mi(e,t,n){for(const i of t.getMatchingVisibleMetas("bar").reverse()){const t=e[i.index];if(n&&t>0||!n&&t<0)return i.index}return null}function yi(e,t){const{chart:n,_cachedMeta:i}=e,r=n._stacks||(n._stacks={}),{iScale:o,vScale:s,index:a}=i,c=o.axis,l=s.axis,u=function(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}(o,s,i),h=t.length;let d;for(let e=0;e<h;++e){const n=t[e],{[c]:i,[l]:o}=n;d=(n._stacks||(n._stacks={}))[l]=gi(r,u,i),d[a]=o,d._top=mi(d,s,!0),d._bottom=mi(d,s,!1)}}function xi(e,t){const n=e.scales;return Object.keys(n).filter((e=>n[e].axis===t)).shift()}function bi(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[i]||void 0===t[i][n])return;delete t[i][n]}}}const vi=e=>"reset"===e||"none"===e,wi=(e,t)=>t?e:Object.assign({},e);class _i{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const e=this,t=e._cachedMeta;e.configure(),e.linkScales(),t._stacked=pi(t.vScale,t),e.addElements()}updateIndex(e){this.index!==e&&bi(this._cachedMeta),this.index=e}linkScales(){const e=this,t=e.chart,n=e._cachedMeta,i=e.getDataset(),r=(e,t,n,i)=>"x"===e?t:"r"===e?i:n,o=n.xAxisID=X(i.xAxisID,xi(t,"x")),s=n.yAxisID=X(i.yAxisID,xi(t,"y")),a=n.rAxisID=X(i.rAxisID,xi(t,"r")),c=n.indexAxis,l=n.iAxisID=r(c,o,s,a),u=n.vAxisID=r(c,s,o,a);n.xScale=e.getScaleForId(o),n.yScale=e.getScaleForId(s),n.rScale=e.getScaleForId(a),n.iScale=e.getScaleForId(l),n.vScale=e.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&ut(this._data,this),e._stacked&&bi(e)}_dataCheck(){const e=this,t=e.getDataset(),n=t.data||(t.data=[]),i=e._data;if(U(n))e._data=function(e){const t=Object.keys(e),n=new Array(t.length);let i,r,o;for(i=0,r=t.length;i<r;++i)o=t[i],n[i]={x:o,y:e[o]};return n}(n);else if(i!==n){if(i){ut(i,e);const t=e._cachedMeta;bi(t),t._parsed=[]}n&&Object.isExtensible(n)&&lt(n,e),e._syncList=[],e._data=n}}addElements(){const e=this,t=e._cachedMeta;e._dataCheck(),e.datasetElementType&&(t.dataset=new e.datasetElementType)}buildOrUpdateElements(e){const t=this,n=t._cachedMeta,i=t.getDataset();let r=!1;t._dataCheck();const o=n._stacked;n._stacked=pi(n.vScale,n),n.stack!==i.stack&&(r=!0,bi(n),n.stack=i.stack),t._resyncElements(e),(r||o!==n._stacked)&&yi(t,n._parsed)}configure(){const e=this,t=e.chart.config,n=t.datasetScopeKeys(e._type),i=t.getOptionScopes(e.getDataset(),n,!0);e.options=t.createResolver(i,e.getContext()),e._parsing=e.options.parsing}parse(e,t){const n=this,{_cachedMeta:i,_data:r}=n,{iScale:o,_stacked:s}=i,a=o.axis;let c,l,u,h=0===e&&t===r.length||i._sorted,d=e>0&&i._parsed[e-1];if(!1===n._parsing)i._parsed=r,i._sorted=!0,u=r;else{u=W(r[e])?n.parseArrayData(i,r,e,t):U(r[e])?n.parseObjectData(i,r,e,t):n.parsePrimitiveData(i,r,e,t);const o=()=>null===l[a]||d&&l[a]<d[a];for(c=0;c<t;++c)i._parsed[c+e]=l=u[c],h&&(o()&&(h=!1),d=l);i._sorted=h}s&&yi(n,u)}parsePrimitiveData(e,t,n,i){const{iScale:r,vScale:o}=e,s=r.axis,a=o.axis,c=r.getLabels(),l=r===o,u=new Array(i);let h,d,f;for(h=0,d=i;h<d;++h)f=h+n,u[h]={[s]:l||r.parse(c[f],f),[a]:o.parse(t[f],f)};return u}parseArrayData(e,t,n,i){const{xScale:r,yScale:o}=e,s=new Array(i);let a,c,l,u;for(a=0,c=i;a<c;++a)l=a+n,u=t[l],s[a]={x:r.parse(u[0],l),y:o.parse(u[1],l)};return s}parseObjectData(e,t,n,i){const{xScale:r,yScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,c=new Array(i);let l,u,h,d;for(l=0,u=i;l<u;++l)h=l+n,d=t[h],c[l]={x:r.parse(ce(d,s),h),y:o.parse(ce(d,a),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,r=this._cachedMeta,o=t[e.axis];return fi({keys:di(i,!0),values:t._stacks[e.axis]},o,r.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const r=n[t.axis];let o=null===r?NaN:r;const s=i&&n._stacks[t.axis];i&&s&&(i.values=s,e.min=Math.min(e.min,o),e.max=Math.max(e.max,o),o=fi(i,r,this._cachedMeta.index,{all:!0})),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const n=this,i=n._cachedMeta,r=i._parsed,o=i._sorted&&e===i.iScale,s=r.length,a=n._getOtherScale(e),c=t&&i._stacked&&{keys:di(n.chart,!0),values:null},l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=function(e){const{min:t,max:n,minDefined:i,maxDefined:r}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}(a);let d,f,p,g;function m(){return p=r[d],f=p[e.axis],g=p[a.axis],!$(f)||u>g||h<g}for(d=0;d<s&&(m()||(n.updateRangeFromParsed(l,e,p,c),!o));++d);if(o)for(d=s-1;d>=0;--d)if(!m()){n.updateRangeFromParsed(l,e,p,c);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,r,o;for(i=0,r=t.length;i<r;++i)o=t[i][e.axis],$(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,r=this.getParsed(e);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(e){const t=this,n=t._cachedMeta;t.configure(),t._cachedDataOpts={},t.update(e||"default"),n._clip=function(e){let t,n,i,r;return U(e)?(t=e.top,n=e.right,i=e.bottom,r=e.left):t=n=i=r=e,{top:t,right:n,bottom:i,left:r,disabled:!1===e}}(X(t.options.clip,function(e,t,n){if(!1===n)return!1;const i=hi(e,n),r=hi(t,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}(n.xScale,n.yScale,t.getMaxOverflow())))}update(e){}draw(){const e=this,t=e._ctx,n=e.chart,i=e._cachedMeta,r=i.data||[],o=n.chartArea,s=[],a=e._drawStart||0,c=e._drawCount||r.length-a;let l;for(i.dataset&&i.dataset.draw(t,o,a,c),l=a;l<a+c;++l){const e=r[l];e.hidden||(e.active?s.push(e):e.draw(t,o))}for(l=0;l<s.length;++l)s[l].draw(t,o)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this,r=i.getDataset();let o;if(e>=0&&e<i._cachedMeta.data.length){const t=i._cachedMeta.data[e];o=t.$context||(t.$context=function(e,t,n){return Object.assign(Object.create(e),{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(i.getContext(),e,t)),o.parsed=i.getParsed(e),o.raw=r.data[e],o.index=o.dataIndex=e}else o=i.$context||(i.$context=function(e,t){return Object.assign(Object.create(e),{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(i.chart.getContext(),i.index)),o.dataset=r,o.index=o.datasetIndex=i.index;return o.active=!!t,o.mode=n,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const i=this,r="active"===t,o=i._cachedDataOpts,s=e+"-"+t,a=o[s],c=i.enableOptionSharing&&ue(n);if(a)return wi(a,c);const l=i.chart.config,u=l.datasetElementScopeKeys(i._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],d=l.getOptionScopes(i.getDataset(),u),f=Object.keys(ye.elements[e]),p=l.resolveNamedOptions(d,f,(()=>i.getContext(n,r)),h);return p.$shared&&(p.$shared=c,o[s]=Object.freeze(wi(p,c))),p}_resolveAnimations(e,t,n){const i=this,r=i.chart,o=i._cachedDataOpts,s=`animation-${t}`,a=o[s];if(a)return a;let c;if(!1!==r.options.animation){const r=i.chart.config,o=r.datasetAnimationScopeKeys(i._type,t),s=r.getOptionScopes(i.getDataset(),o);c=r.createResolver(s,i.getContext(e,n,t))}const l=new ui(r,c&&c.animations);return c&&c._cacheable&&(o[s]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||vi(e)||this.chart._animationsDisabled}updateElement(e,t,n,i){vi(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!vi(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const r=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this,n=t._data,i=t._cachedMeta.data;for(const[e,n,i]of t._syncList)t[e](n,i);t._syncList=[];const r=i.length,o=n.length,s=Math.min(o,r);s&&t.parse(0,s),o>r?t._insertElements(r,o-r,e):o<r&&t._removeElements(o,r-o)}_insertElements(e,t,n=!0){const i=this,r=i._cachedMeta,o=r.data,s=e+t;let a;const c=e=>{for(e.length+=t,a=e.length-1;a>=s;a--)e[a]=e[a-t]};for(c(o),a=e;a<s;++a)o[a]=new i.dataElementType;i._parsing&&c(r._parsed),i.parse(e,t),n&&i.updateElements(o,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&bi(n,i)}n.data.splice(e,t)}_onDataPush(){const e=arguments.length;this._syncList.push(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._syncList.push(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._syncList.push(["_removeElements",0,1])}_onDataSplice(e,t){this._syncList.push(["_removeElements",e,t]),this._syncList.push(["_insertElements",e,arguments.length-2])}_onDataUnshift(){this._syncList.push(["_insertElements",0,arguments.length])}}_i.defaults={},_i.prototype.datasetElementType=null,_i.prototype.dataElementType=null;class Si{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return Ae(this.x)&&Ae(this.y)}getProps(e,t){const n=this,i=this.$animations;if(!t||!i)return n;const r={};return e.forEach((e=>{r[e]=i[e]&&i[e].active()?i[e]._to:n[e]})),r}}Si.defaults={},Si.defaultRoutes=void 0;const Ci={values:e=>W(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const i=this.chart.options.locale;let r,o=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(r="scientific"),o=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const s=Me(Math.abs(o)),a=Math.max(Math.min(-1*Math.floor(s),20),0),c={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),An(e,i,c)},logarithmic(e,t,n){if(0===e)return"0";const i=e/Math.pow(10,Math.floor(Me(e)));return 1===i||2===i||5===i?Ci.numeric.call(this,e,t,n):""}};var ki={formatters:Ci};function Mi(e,t){const n=e.options.ticks,i=n.maxTicksLimit||function(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(i,r))}(e),r=n.major.enabled?function(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}(t):[],o=r.length,s=r[0],a=r[o-1],c=[];if(o>i)return function(e,t,n,i){let r,o=0,s=n[0];for(i=Math.ceil(i),r=0;r<e.length;r++)r===s&&(t.push(e[r]),o++,s=n[o*i])}(t,c,r,o/i),c;const l=function(e,t,n){const i=function(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}(e),r=t.length/n;if(!i)return Math.max(r,1);const o=Pe(i);for(let e=0,t=o.length-1;e<t;e++){const t=o[e];if(t>r)return t}return Math.max(r,1)}(r,t,i);if(o>0){let e,n;const i=o>1?Math.round((a-s)/(o-1)):null;for(Ei(t,c,l,V(i)?0:s-i,s),e=0,n=o-1;e<n;e++)Ei(t,c,l,r[e],r[e+1]);return Ei(t,c,l,a,V(i)?t.length:a+i),c}return Ei(t,c,l),c}function Ei(e,t,n,i,r){const o=X(i,0),s=Math.min(X(r,e.length),e.length);let a,c,l,u=0;for(n=Math.ceil(n),r&&(a=r-i,n=a/Math.floor(a/n)),l=o;l<0;)u++,l=Math.round(o+u*n);for(c=Math.max(o,0);c<s;c++)c===l&&(t.push(e[c]),u++,l=Math.round(o+u*n))}ye.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ki.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),ye.route("scale.ticks","color","","color"),ye.route("scale.grid","color","","borderColor"),ye.route("scale.grid","borderColor","","borderColor"),ye.route("scale.title","color","","color"),ye.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e}),ye.describe("scales",{_fallback:"scale"}),ye.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e});const Ti=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n;function Pi(e,t){const n=[],i=e.length/t,r=e.length;let o=0;for(;o<r;o+=i)n.push(e[Math.floor(o)]);return n}function Ai(e,t,n){const i=e.ticks.length,r=Math.min(t,i-1),o=e._startPixel,s=e._endPixel,a=1e-6;let c,l=e.getPixelForTick(r);if(!(n&&(c=1===i?Math.max(l-o,s-l):0===t?(e.getPixelForTick(1)-l)/2:(l-e.getPixelForTick(r-1))/2,l+=r<t?c:-c,l<o-a||l>s+a)))return l}function Oi(e){return e.drawTicks?e.tickLength:0}function Di(e,t){if(!e.display)return 0;const n=qt(e.font,t),i=It(e.padding);return(W(e.text)?e.text.length:1)*n.lineHeight+i.height}function Ri(e,t,n){let r=i(e);return(n&&"right"!==t||!n&&"right"===t)&&(r=(e=>"left"===e?"right":"right"===e?"left":e)(r)),r}class Li extends Si{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){const t=this;t.options=e.setContext(t.getContext()),t.axis=e.axis,t._userMin=t.parse(e.min),t._userMax=t.parse(e.max),t._suggestedMin=t.parse(e.suggestedMin),t._suggestedMax=t.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=Y(e,Number.POSITIVE_INFINITY),t=Y(t,Number.NEGATIVE_INFINITY),n=Y(n,Number.POSITIVE_INFINITY),i=Y(i,Number.NEGATIVE_INFINITY),{min:Y(e,n),max:Y(t,i),minDefined:$(e),maxDefined:$(t)}}getMinMax(e){const t=this;let n,{min:i,max:r,minDefined:o,maxDefined:s}=t.getUserBounds();if(o&&s)return{min:i,max:r};const a=t.getMatchingVisibleMetas();for(let c=0,l=a.length;c<l;++c)n=a[c].controller.getMinMax(t,e),o||(i=Math.min(i,n.min)),s||(r=Math.max(r,n.max));return{min:Y(i,Y(r,i)),max:Y(r,Y(i,r))}}getPadding(){const e=this;return{left:e.paddingLeft||0,top:e.paddingTop||0,right:e.paddingRight||0,bottom:e.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Q(this.options.beforeUpdate,[this])}update(e,t,n){const i=this,r=i.options.ticks,o=r.sampleSize;i.beforeUpdate(),i.maxWidth=e,i.maxHeight=t,i._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),i.ticks=null,i._labelSizes=null,i._gridLineItems=null,i._labelItems=null,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i._maxLength=i.isHorizontal()?i.width+n.left+n.right:i.height+n.top+n.bottom,i._dataLimitsCached||(i.beforeDataLimits(),i.determineDataLimits(),i.afterDataLimits(),i._range=zt(i,i.options.grace),i._dataLimitsCached=!0),i.beforeBuildTicks(),i.ticks=i.buildTicks()||[],i.afterBuildTicks();const s=o<i.ticks.length;i._convertTicksToLabels(s?Pi(i.ticks,o):i.ticks),i.configure(),i.beforeCalculateLabelRotation(),i.calculateLabelRotation(),i.afterCalculateLabelRotation(),r.display&&(r.autoSkip||"auto"===r.source)&&(i.ticks=Mi(i,i.ticks),i._labelSizes=null),s&&i._convertTicksToLabels(i.ticks),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate()}configure(){const e=this;let t,n,i=e.options.reverse;e.isHorizontal()?(t=e.left,n=e.right):(t=e.top,n=e.bottom,i=!i),e._startPixel=t,e._endPixel=n,e._reversePixels=i,e._length=n-t,e._alignToPixels=e.options.alignToPixels}afterUpdate(){Q(this.options.afterUpdate,[this])}beforeSetDimensions(){Q(this.options.beforeSetDimensions,[this])}setDimensions(){const e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0}afterSetDimensions(){Q(this.options.afterSetDimensions,[this])}_callHooks(e){const t=this;t.chart.notifyPlugins(e,t.getContext()),Q(t.options[e],[t])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Q(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this,n=t.options.ticks;let i,r,o;for(i=0,r=e.length;i<r;i++)o=e[i],o.label=Q(n.callback,[o.value,i,e],t)}afterTickToLabelConversion(){Q(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Q(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this,t=e.options,n=t.ticks,i=e.ticks.length,r=n.minRotation||0,o=n.maxRotation;let s,a,c,l=r;if(!e._isVisible()||!n.display||r>=o||i<=1||!e.isHorizontal())return void(e.labelRotation=r);const u=e._getLabelSizes(),h=u.widest.width,d=u.highest.height,f=Ge(e.chart.width-h,0,e.maxWidth);s=t.offset?e.maxWidth/i:f/(i-1),h+6>s&&(s=f/(i-(t.offset?.5:1)),a=e.maxHeight-Oi(t.grid)-n.padding-Di(t.title,e.chart.options.font),c=Math.sqrt(h*h+d*d),l=Ne(Math.min(Math.asin(Ge((u.highest.height+6)/s,-1,1)),Math.asin(Ge(a/c,-1,1))-Math.asin(Ge(d/c,-1,1)))),l=Math.max(r,Math.min(o,l))),e.labelRotation=l}afterCalculateLabelRotation(){Q(this.options.afterCalculateLabelRotation,[this])}beforeFit(){Q(this.options.beforeFit,[this])}fit(){const e=this,t={width:0,height:0},{chart:n,options:{ticks:i,title:r,grid:o}}=e,s=e._isVisible(),a=e.isHorizontal();if(s){const s=Di(r,n.options.font);if(a?(t.width=e.maxWidth,t.height=Oi(o)+s):(t.height=e.maxHeight,t.width=Oi(o)+s),i.display&&e.ticks.length){const{first:n,last:r,widest:o,highest:s}=e._getLabelSizes(),c=2*i.padding,l=Le(e.labelRotation),u=Math.cos(l),h=Math.sin(l);if(a){const n=i.mirror?0:h*o.width+u*s.height;t.height=Math.min(e.maxHeight,t.height+n+c)}else{const n=i.mirror?0:u*o.width+h*s.height;t.width=Math.min(e.maxWidth,t.width+n+c)}e._calculatePadding(n,r,h,u)}}e._handleMargins(),a?(e.width=e._length=n.width-e._margins.left-e._margins.right,e.height=t.height):(e.width=t.width,e.height=e._length=n.height-e._margins.top-e._margins.bottom)}_calculatePadding(e,t,n,i){const r=this,{ticks:{align:o,padding:s},position:a}=r.options,c=0!==r.labelRotation,l="top"!==a&&"x"===r.axis;if(r.isHorizontal()){const a=r.getPixelForTick(0)-r.left,u=r.right-r.getPixelForTick(r.ticks.length-1);let h=0,d=0;c?l?(h=i*e.width,d=n*t.height):(h=n*e.height,d=i*t.width):"start"===o?d=t.width:"end"===o?h=e.width:(h=e.width/2,d=t.width/2),r.paddingLeft=Math.max((h-a+s)*r.width/(r.width-a),0),r.paddingRight=Math.max((d-u+s)*r.width/(r.width-u),0)}else{let n=t.height/2,i=e.height/2;"start"===o?(n=0,i=e.height):"end"===o&&(n=t.height,i=0),r.paddingTop=n+s,r.paddingBottom=i+s}}_handleMargins(){const e=this;e._margins&&(e._margins.left=Math.max(e.paddingLeft,e._margins.left),e._margins.top=Math.max(e.paddingTop,e._margins.top),e._margins.right=Math.max(e.paddingRight,e._margins.right),e._margins.bottom=Math.max(e.paddingBottom,e._margins.bottom))}afterFit(){Q(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){const t=this;let n,i;for(t.beforeTickToLabelConversion(),t.generateTickLabels(e),n=0,i=e.length;n<i;n++)V(e[n].label)&&(e.splice(n,1),i--,n--);t.afterTickToLabelConversion()}_getLabelSizes(){const e=this;let t=e._labelSizes;if(!t){const n=e.options.ticks.sampleSize;let i=e.ticks;n<i.length&&(i=Pi(i,n)),e._labelSizes=t=e._computeLabelSizes(i,i.length)}return t}_computeLabelSizes(e,t){const{ctx:n,_longestTextCache:i}=this,r=[],o=[];let s,a,c,l,u,h,d,f,p,g,m,y=0,x=0;for(s=0;s<t;++s){if(l=e[s].label,u=this._resolveTickFontOptions(s),n.font=h=u.string,d=i[h]=i[h]||{data:{},gc:[]},f=u.lineHeight,p=g=0,V(l)||W(l)){if(W(l))for(a=0,c=l.length;a<c;++a)m=l[a],V(m)||W(m)||(p=We(n,d.data,d.gc,p,m),g+=f)}else p=We(n,d.data,d.gc,p,l),g=f;r.push(p),o.push(g),y=Math.max(p,y),x=Math.max(g,x)}!function(e,t){Z(e,(e=>{const n=e.gc,i=n.length/2;let r;if(i>t){for(r=0;r<i;++r)delete e.data[n[r]];n.splice(0,i)}}))}(i,t);const b=r.indexOf(y),v=o.indexOf(x),w=e=>({width:r[e]||0,height:o[e]||0});return{first:w(0),last:w(t-1),widest:w(b),highest:w(v),widths:r,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){const t=this;t._reversePixels&&(e=1-e);const n=t._startPixel+e*t._length;return He(t._alignToPixels?$e(t.chart,n,0):n)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this,n=t.ticks||[];if(e>=0&&e<n.length){const i=n[e];return i.$context||(i.$context=function(e,t,n){return Object.assign(Object.create(e),{tick:n,index:t,type:"tick"})}(t.getContext(),e,i))}return t.$context||(t.$context=(i=t.chart.getContext(),r=t,Object.assign(Object.create(i),{scale:r,type:"scale"})));var i,r}_tickSize(){const e=this,t=e.options.ticks,n=Le(e.labelRotation),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),o=e._getLabelSizes(),s=t.autoSkipPadding||0,a=o?o.widest.width+s:0,c=o?o.highest.height+s:0;return e.isHorizontal()?c*i>a*r?a/i:c/r:c*r<a*i?c/i:a/r}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this,n=t.axis,i=t.chart,r=t.options,{grid:o,position:s}=r,a=o.offset,c=t.isHorizontal(),l=t.ticks.length+(a?1:0),u=Oi(o),h=[],d=o.setContext(t.getContext()),f=d.drawBorder?d.borderWidth:0,p=f/2,g=function(e){return $e(i,e,f)};let m,y,x,b,v,w,_,S,C,k,M,E;if("top"===s)m=g(t.bottom),w=t.bottom-u,S=m-p,k=g(e.top)+p,E=e.bottom;else if("bottom"===s)m=g(t.top),k=e.top,E=g(e.bottom)-p,w=m+p,S=t.top+u;else if("left"===s)m=g(t.right),v=t.right-u,_=m-p,C=g(e.left)+p,M=e.right;else if("right"===s)m=g(t.left),C=e.left,M=g(e.right)-p,v=m+p,_=t.left+u;else if("x"===n){if("center"===s)m=g((e.top+e.bottom)/2+.5);else if(U(s)){const e=Object.keys(s)[0],n=s[e];m=g(t.chart.scales[e].getPixelForValue(n))}k=e.top,E=e.bottom,w=m+p,S=w+u}else if("y"===n){if("center"===s)m=g((e.left+e.right)/2);else if(U(s)){const e=Object.keys(s)[0],n=s[e];m=g(t.chart.scales[e].getPixelForValue(n))}v=m-p,_=v-u,C=e.left,M=e.right}const T=X(r.ticks.maxTicksLimit,l),P=Math.max(1,Math.ceil(l/T));for(y=0;y<l;y+=P){const e=o.setContext(t.getContext(y)),n=e.lineWidth,r=e.color,s=o.borderDash||[],l=e.borderDashOffset,u=e.tickWidth,d=e.tickColor,f=e.tickBorderDash||[],p=e.tickBorderDashOffset;x=Ai(t,y,a),void 0!==x&&(b=$e(i,x,n),c?v=_=C=M=b:w=S=k=E=b,h.push({tx1:v,ty1:w,tx2:_,ty2:S,x1:C,y1:k,x2:M,y2:E,width:n,color:r,borderDash:s,borderDashOffset:l,tickWidth:u,tickColor:d,tickBorderDash:f,tickBorderDashOffset:p}))}return t._ticksLength=l,t._borderValue=m,h}_computeLabelItems(e){const t=this,n=t.axis,i=t.options,{position:r,ticks:o}=i,s=t.isHorizontal(),a=t.ticks,{align:c,crossAlign:l,padding:u,mirror:h}=o,d=Oi(i.grid),f=d+u,p=h?-u:f,g=-Le(t.labelRotation),m=[];let y,x,b,v,w,_,S,C,k,M,E,T,P="middle";if("top"===r)_=t.bottom-p,S=t._getXAxisLabelAlignment();else if("bottom"===r)_=t.top+p,S=t._getXAxisLabelAlignment();else if("left"===r){const e=t._getYAxisLabelAlignment(d);S=e.textAlign,w=e.x}else if("right"===r){const e=t._getYAxisLabelAlignment(d);S=e.textAlign,w=e.x}else if("x"===n){if("center"===r)_=(e.top+e.bottom)/2+f;else if(U(r)){const e=Object.keys(r)[0],n=r[e];_=t.chart.scales[e].getPixelForValue(n)+f}S=t._getXAxisLabelAlignment()}else if("y"===n){if("center"===r)w=(e.left+e.right)/2-f;else if(U(r)){const e=Object.keys(r)[0],n=r[e];w=t.chart.scales[e].getPixelForValue(n)}S=t._getYAxisLabelAlignment(d).textAlign}"y"===n&&("start"===c?P="top":"end"===c&&(P="bottom"));const A=t._getLabelSizes();for(y=0,x=a.length;y<x;++y){b=a[y],v=b.label;const e=o.setContext(t.getContext(y));C=t.getPixelForTick(y)+o.labelOffset,k=t._resolveTickFontOptions(y),M=k.lineHeight,E=W(v)?v.length:1;const n=E/2,i=e.color,c=e.textStrokeColor,u=e.textStrokeWidth;let d;if(s?(w=C,T="top"===r?"near"===l||0!==g?-E*M+M/2:"center"===l?-A.highest.height/2-n*M+M:-A.highest.height+M/2:"near"===l||0!==g?M/2:"center"===l?A.highest.height/2-n*M:A.highest.height-E*M,h&&(T*=-1)):(_=C,T=(1-E)*M/2),e.showLabelBackdrop){const t=It(e.backdropPadding),n=A.heights[y],i=A.widths[y];let r=_+T-t.top,o=w-t.left;switch(P){case"middle":r-=n/2;break;case"bottom":r-=n}switch(S){case"center":o-=i/2;break;case"right":o-=i}d={left:o,top:r,width:i+t.width,height:n+t.height,color:e.backdropColor}}m.push({rotation:g,label:v,font:k,color:i,strokeColor:c,strokeWidth:u,textOffset:T,textAlign:S,textBaseline:P,translation:[w,_],backdrop:d})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Le(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align&&(n="right"),n}_getYAxisLabelAlignment(e){const t=this,{position:n,ticks:{crossAlign:i,mirror:r,padding:o}}=t.options,s=e+o,a=t._getLabelSizes().widest.width;let c,l;return"left"===n?r?(c="left",l=t.right+o):(l=t.right-s,"near"===i?c="right":"center"===i?(c="center",l-=a/2):(c="left",l=t.left)):"right"===n?r?(c="right",l=t.left+o):(l=t.left+s,"near"===i?c="left":"center"===i?(c="center",l+=a/2):(c="right",l=t.right)):c="right",{textAlign:c,x:l}}_computeLabelArea(){const e=this;if(e.options.ticks.mirror)return;const t=e.chart,n=e.options.position;return"left"===n||"right"===n?{top:0,left:e.left,bottom:t.height,right:e.right}:"top"===n||"bottom"===n?{top:e.top,left:0,bottom:e.bottom,right:t.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:r,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,r,o),e.restore())}getLineWidthForValue(e){const t=this,n=t.options.grid;if(!t._isVisible()||!n.display)return 0;const i=t.ticks.findIndex((t=>t.value===e));if(i>=0){return n.setContext(t.getContext(i)).lineWidth}return 0}drawGrid(e){const t=this,n=t.options.grid,i=t.ctx,r=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e));let o,s;const a=(e,t,n)=>{n.width&&n.color&&(i.save(),i.lineWidth=n.width,i.strokeStyle=n.color,i.setLineDash(n.borderDash||[]),i.lineDashOffset=n.borderDashOffset,i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(t.x,t.y),i.stroke(),i.restore())};if(n.display)for(o=0,s=r.length;o<s;++o){const e=r[o];n.drawOnChartArea&&a({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),n.drawTicks&&a({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const e=this,{chart:t,ctx:n,options:{grid:i}}=e,r=i.setContext(e.getContext()),o=i.drawBorder?r.borderWidth:0;if(!o)return;const s=i.setContext(e.getContext(0)).lineWidth,a=e._borderValue;let c,l,u,h;e.isHorizontal()?(c=$e(t,e.left,o)-o/2,l=$e(t,e.right,s)+s/2,u=h=a):(u=$e(t,e.top,o)-o/2,h=$e(t,e.bottom,s)+s/2,c=l=a),n.save(),n.lineWidth=r.borderWidth,n.strokeStyle=r.borderColor,n.beginPath(),n.moveTo(c,u),n.lineTo(l,h),n.stroke(),n.restore()}drawLabels(e){const t=this;if(!t.options.ticks.display)return;const n=t.ctx,i=t._computeLabelArea();i&&Ke(n,i);const r=t._labelItems||(t._labelItems=t._computeLabelItems(e));let o,s;for(o=0,s=r.length;o<s;++o){const e=r[o],t=e.font,i=e.label;e.backdrop&&(n.fillStyle=e.backdrop.color,n.fillRect(e.backdrop.left,e.backdrop.top,e.backdrop.width,e.backdrop.height)),tt(n,i,0,e.textOffset,t,e)}i&&Qe(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const o=qt(n.font),s=It(n.padding),a=n.align;let c=o.lineHeight/2;"bottom"===t||"center"===t||U(t)?(c+=s.bottom,W(n.text)&&(c+=o.lineHeight*(n.text.length-1))):c+=s.top;const{titleX:l,titleY:u,maxWidth:h,rotation:d}=function(e,t,n,i){const{top:o,left:s,bottom:a,right:c,chart:l}=e,{chartArea:u,scales:h}=l;let d,f,p,g=0;const m=a-o,y=c-s;if(e.isHorizontal()){if(f=r(i,s,c),U(n)){const e=Object.keys(n)[0],i=n[e];p=h[e].getPixelForValue(i)+m-t}else p="center"===n?(u.bottom+u.top)/2+m-t:Ti(e,n,t);d=c-s}else{if(U(n)){const e=Object.keys(n)[0],i=n[e];f=h[e].getPixelForValue(i)-y+t}else f="center"===n?(u.left+u.right)/2-y+t:Ti(e,n,t);p=r(i,a,o),g="left"===n?-Se:Se}return{titleX:f,titleY:p,maxWidth:d,rotation:g}}(this,c,t,a);tt(e,n.text,0,0,o,{color:n.color,maxWidth:h,rotation:d,textAlign:Ri(a,t,i),textBaseline:"middle",translation:[l,u]})}draw(e){const t=this;t._isVisible()&&(t.drawBackground(),t.drawGrid(e),t.drawBorder(),t.drawTitle(),t.drawLabels(e))}_layers(){const e=this,t=e.options,n=t.ticks&&t.ticks.z||0,i=X(t.grid&&t.grid.z,-1);return e._isVisible()&&e.draw===Li.prototype.draw?[{z:i,draw(t){e.drawBackground(),e.drawGrid(t),e.drawTitle()}},{z:i+1,draw(){e.drawBorder()}},{z:n,draw(t){e.drawLabels(t)}}]:[{z:n,draw(t){e.draw(t)}}]}getMatchingVisibleMetas(e){const t=this,n=t.chart.getSortedVisibleDatasetMetas(),i=t.axis+"AxisID",r=[];let o,s;for(o=0,s=n.length;o<s;++o){const s=n[o];s[i]!==t.id||e&&s.type!==e||r.push(s)}return r}_resolveTickFontOptions(e){return qt(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this,t=e._resolveTickFontOptions(0).lineHeight;return(e.isHorizontal()?e.width:e.height)/t}}class Ni{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=this,n=Object.getPrototypeOf(e);let i;(function(e){return"id"in e&&"defaults"in e})(n)&&(i=t.register(n));const r=t.items,o=e.id,s=t.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in r||(r[o]=e,function(e,t,n){const i=re(Object.create(null),[n?ye.get(n):{},ye.get(t),e.defaults]);ye.set(t,i),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((n=>{const i=n.split("."),r=i.pop(),o=[e].concat(i).join("."),s=t[n].split("."),a=s.pop(),c=s.join(".");ye.route(o,r,c,a)}))}(t,e.defaultRoutes);e.descriptors&&ye.describe(t,e.descriptors)}(e,s,i),t.override&&ye.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in ye[i]&&(delete ye[i][n],this.override&&delete fe[n])}}var Fi=new class{constructor(){this.controllers=new Ni(_i,"datasets",!0),this.elements=new Ni(Si,"elements"),this.plugins=new Ni(Object,"plugins"),this.scales=new Ni(Li,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){const i=this;[...t].forEach((t=>{const r=n||i._getRegistryForType(t);n||r.isForType(t)||r===i.plugins&&t.id?i._exec(e,r,t):Z(t,(t=>{const r=n||i._getRegistryForType(t);i._exec(e,r,t)}))}))}_exec(e,t,n){const i=le(e);Q(n["before"+i],[],n),t[e](n),Q(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(void 0===i)throw new Error('"'+e+'" is not a registered '+n+".");return i}};class ji{constructor(){this._init=[]}notify(e,t,n,i){const r=this;"beforeInit"===t&&(r._init=r._createDescriptors(e,!0),r._notify(r._init,e,"install"));const o=i?r._descriptors(e).filter(i):r._descriptors(e),s=r._notify(o,e,t,n);return"destroy"===t&&(r._notify(o,e,"stop"),r._notify(r._init,e,"uninstall")),s}_notify(e,t,n,i){i=i||{};for(const r of e){const e=r.plugin;if(!1===Q(e[n],[t,i,r.options],e)&&i.cancelable)return!1}return!0}invalidate(){V(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=X(n.options&&n.options.plugins,{}),r=function(e){const t=[],n=Object.keys(Fi.plugins.items);for(let e=0;e<n.length;e++)t.push(Fi.getPlugin(n[e]));const i=e.plugins||[];for(let e=0;e<i.length;e++){const n=i[e];-1===t.indexOf(n)&&t.push(n)}return t}(n);return!1!==i||t?function(e,t,n,i){const r=[],o=e.getContext();for(let s=0;s<t.length;s++){const a=t[s],c=Ii(n[a.id],i);null!==c&&r.push({plugin:a,options:qi(e.config,a,c,o)})}return r}(e,r,i,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function Ii(e,t){return t||!1!==e?!0===e?{}:e:null}function qi(e,t,n,i){const r=e.pluginScopeKeys(t),o=e.getOptionScopes(n,r);return e.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Bi(e,t){const n=ye.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function zi(e,t){return"x"===e||"y"===e?e:t.axis||("top"===(n=t.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||e.charAt(0).toLowerCase();var n}function Gi(e){const t=e.options||(e.options={});t.plugins=X(t.plugins,{}),t.scales=function(e,t){const n=fe[e.type]||{scales:{}},i=t.scales||{},r=Bi(e.type,t),o=Object.create(null),s=Object.create(null);return Object.keys(i).forEach((e=>{const t=i[e],a=zi(e,t),c=function(e,t){return e===t?"_index_":"_value_"}(a,r),l=n.scales||{};o[a]=o[a]||e,s[e]=oe(Object.create(null),[{axis:a},t,l[a],l[c]])})),e.data.datasets.forEach((n=>{const r=n.type||e.type,a=n.indexAxis||Bi(r,t),c=(fe[r]||{}).scales||{};Object.keys(c).forEach((e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,a),r=n[t+"AxisID"]||o[t]||t;s[r]=s[r]||Object.create(null),oe(s[r],[{axis:t},i[r],c[e]])}))})),Object.keys(s).forEach((e=>{const t=s[e];oe(t,[ye.scales[t.type],ye.scale])})),s}(e,t)}function Hi(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Vi=new Map,Wi=new Set;function Ui(e,t){let n=Vi.get(e);return n||(n=t(),Vi.set(e,n),Wi.add(n)),n}const $i=(e,t,n)=>{const i=ce(t,n);void 0!==i&&e.add(i)};class Yi{constructor(e){this._config=function(e){return(e=e||{}).data=Hi(e.data),Gi(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Hi(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Gi(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Ui(e,(()=>[[`datasets.${e}`,""]]))}datasetAnimationScopeKeys(e,t){return Ui(`${e}.transition.${t}`,(()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]]))}datasetElementScopeKeys(e,t){return Ui(`${e}-${t}`,(()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]]))}pluginScopeKeys(e){const t=e.id;return Ui(`${this.type}-plugin-${t}`,(()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return i&&!t||(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:r}=this,o=this._cachedScopes(e,n),s=o.get(t);if(s)return s;const a=new Set;t.forEach((t=>{e&&(a.add(e),t.forEach((t=>$i(a,e,t)))),t.forEach((e=>$i(a,i,e))),t.forEach((e=>$i(a,fe[r]||{},e))),t.forEach((e=>$i(a,ye,e))),t.forEach((e=>$i(a,pe,e)))}));const c=Array.from(a);return 0===c.length&&c.push(Object.create(null)),Wi.has(t)&&o.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,fe[t]||{},ye.datasets[t]||{},{type:t},ye,pe]}resolveNamedOptions(e,t,n,i=[""]){const r={$shared:!0},{resolver:o,subPrefixes:s}=Xi(this._resolverCache,e,i);let a=o;if(function(e,t){const{isScriptable:n,isIndexable:i}=rn(e);for(const r of t)if(n(r)&&he(e[r])||i(r)&&W(e[r]))return!0;return!1}(o,t)){r.$shared=!1;a=nn(o,n=he(n)?n():n,this.createResolver(e,n,s))}for(const e of t)r[e]=a[e];return r}createResolver(e,t,n=[""],i){const{resolver:r}=Xi(this._resolverCache,e,n);return U(t)?nn(r,t,void 0,i):r}}function Xi(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const r=n.join();let o=i.get(r);if(!o){o={resolver:tn(t,n),subPrefixes:n.filter((e=>!e.toLowerCase().includes("hover")))},i.set(r,o)}return o}const Ji=["top","bottom","left","right","chartArea"];function Ki(e,t){return"top"===e||"bottom"===e||-1===Ji.indexOf(e)&&"x"===t}function Qi(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function Zi(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Q(n&&n.onComplete,[e],t)}function er(e){const t=e.chart,n=t.options.animation;Q(n&&n.onProgress,[e],t)}function tr(e){return dt()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const nr={},ir=e=>{const t=tr(e);return Object.values(nr).filter((e=>e.canvas===t)).pop()};class rr{constructor(e,t){const i=this,r=this.config=new Yi(t),o=tr(e),a=ir(o);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas can be reused.");const c=r.createResolver(r.chartOptionScopes(),i.getContext());this.platform=new(r.platform||ri(o));const l=i.platform.acquireContext(o,c.aspectRatio),u=l&&l.canvas,h=u&&u.height,d=u&&u.width;this.id=H(),this.ctx=l,this.canvas=u,this.width=d,this.height=h,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this.scale=void 0,this._plugins=new ji,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=n((()=>this.update("resize")),c.resizeDelay||0),nr[i.id]=i,l&&u?(s.listen(i,"complete",Zi),s.listen(i,"progress",er),i._initialize(),i.attached&&i.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:r}=this;return V(e)?t&&r?r:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}_initialize(){const e=this;return e.notifyPlugins("beforeInit"),e.options.responsive?e.resize():_t(e,e.options.devicePixelRatio),e.bindEvents(),e.notifyPlugins("afterInit"),e}clear(){return Ye(this.canvas,this.ctx),this}stop(){return s.stop(this),this}resize(e,t){s.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this,i=n.options,r=n.canvas,o=i.maintainAspectRatio&&n.aspectRatio,s=n.platform.getMaximumSize(r,e,t,o),a=i.devicePixelRatio||n.platform.getDevicePixelRatio();n.width=s.width,n.height=s.height,n._aspectRatio=n.aspectRatio,_t(n,a,!0)&&(n.notifyPlugins("resize",{size:s}),Q(i.onResize,[n,s],n),n.attached&&n._doResize()&&n.render())}ensureScalesHaveIDs(){Z(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this,t=e.options,n=t.scales,i=e.scales,r=Object.keys(i).reduce(((e,t)=>(e[t]=!1,e)),{});let o=[];n&&(o=o.concat(Object.keys(n).map((e=>{const t=n[e],i=zi(e,t),r="r"===i,o="x"===i;return{options:t,dposition:r?"chartArea":o?"bottom":"left",dtype:r?"radialLinear":o?"category":"linear"}})))),Z(o,(n=>{const o=n.options,s=o.id,a=zi(s,o),c=X(o.type,n.dtype);void 0!==o.position&&Ki(o.position,a)===Ki(n.dposition)||(o.position=n.dposition),r[s]=!0;let l=null;if(s in i&&i[s].type===c)l=i[s];else{l=new(Fi.getScale(c))({id:s,type:c,ctx:e.ctx,chart:e}),i[l.id]=l}l.init(o,t)})),Z(r,((e,t)=>{e||delete i[t]})),Z(i,(t=>{en.configure(e,t,t.options),en.addBox(e,t)}))}_updateMetasets(){const e=this,t=e._metasets,n=e.data.datasets.length,i=t.length;if(t.sort(((e,t)=>e.index-t.index)),i>n){for(let t=n;t<i;++t)e._destroyDatasetMeta(t);t.splice(n,i-n)}e._sortedMetasets=t.slice(0).sort(Qi("order","index"))}_removeUnreferencedMetasets(){const e=this,{_metasets:t,data:{datasets:n}}=e;t.length>n.length&&delete e._stacks,t.forEach(((t,i)=>{0===n.filter((e=>e===t._dataset)).length&&e._destroyDatasetMeta(i)}))}buildOrUpdateControllers(){const e=this,t=[],n=e.data.datasets;let i,r;for(e._removeUnreferencedMetasets(),i=0,r=n.length;i<r;i++){const r=n[i];let o=e.getDatasetMeta(i);const s=r.type||e.config.type;if(o.type&&o.type!==s&&(e._destroyDatasetMeta(i),o=e.getDatasetMeta(i)),o.type=s,o.indexAxis=r.indexAxis||Bi(s,e.options),o.order=r.order||0,o.index=i,o.label=""+r.label,o.visible=e.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const n=Fi.getController(s),{datasetElementType:r,dataElementType:a}=ye.datasets[s];Object.assign(n.prototype,{dataElementType:Fi.getElement(a),datasetElementType:r&&Fi.getElement(r)}),o.controller=new n(e,i),t.push(o.controller)}}return e._updateMetasets(),t}_resetElements(){const e=this;Z(e.data.datasets,((t,n)=>{e.getDatasetMeta(n).controller.reset()}),e)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this,n=t.config;n.update(),t._options=n.createResolver(n.chartOptionScopes(),t.getContext()),Z(t.scales,(e=>{en.removeBox(t,e)}));const i=t._animationsDisabled=!t.options.animation;t.ensureScalesHaveIDs(),t.buildOrUpdateScales();const r=new Set(Object.keys(t._listeners)),o=new Set(t.options.events);if(de(r,o)&&!!this._responsiveListeners===t.options.responsive||(t.unbindEvents(),t.bindEvents()),t._plugins.invalidate(),!1===t.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const s=t.buildOrUpdateControllers();t.notifyPlugins("beforeElementsUpdate");let a=0;for(let e=0,n=t.data.datasets.length;e<n;e++){const{controller:n}=t.getDatasetMeta(e),r=!i&&-1===s.indexOf(n);n.buildOrUpdateElements(r),a=Math.max(+n.getMaxOverflow(),a)}t._minPadding=a,t._updateLayout(a),i||Z(s,(e=>{e.reset()})),t._updateDatasets(e),t.notifyPlugins("afterUpdate",{mode:e}),t._layers.sort(Qi("z","_idx")),t._lastEvent&&t._eventHandler(t._lastEvent,!0),t.render()}_updateLayout(e){const t=this;if(!1===t.notifyPlugins("beforeLayout",{cancelable:!0}))return;en.update(t,t.width,t.height,e);const n=t.chartArea,i=n.width<=0||n.height<=0;t._layers=[],Z(t.boxes,(e=>{i&&"chartArea"===e.position||(e.configure&&e.configure(),t._layers.push(...e._layers()))}),t),t._layers.forEach(((e,t)=>{e._idx=t})),t.notifyPlugins("afterLayout")}_updateDatasets(e){const t=this,n="function"==typeof e;if(!1!==t.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let i=0,r=t.data.datasets.length;i<r;++i)t._updateDataset(i,n?e({datasetIndex:i}):e);t.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this,i=n.getDatasetMeta(e),r={meta:i,index:e,mode:t,cancelable:!0};!1!==n.notifyPlugins("beforeDatasetUpdate",r)&&(i.controller._update(t),r.cancelable=!1,n.notifyPlugins("afterDatasetUpdate",r))}render(){const e=this;!1!==e.notifyPlugins("beforeRender",{cancelable:!0})&&(s.has(e)?e.attached&&!s.running(e)&&s.start(e):(e.draw(),Zi({chart:e})))}draw(){const e=this;let t;if(e._resizeBeforeDraw){const{width:t,height:n}=e._resizeBeforeDraw;e._resize(t,n),e._resizeBeforeDraw=null}if(e.clear(),e.width<=0||e.height<=0)return;if(!1===e.notifyPlugins("beforeDraw",{cancelable:!0}))return;const n=e._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(e.chartArea);for(e._drawDatasets();t<n.length;++t)n[t].draw(e.chartArea);e.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,r;for(i=0,r=t.length;i<r;++i){const r=t[i];e&&!r.visible||n.push(r)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){const e=this;if(!1===e.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=e.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)e._drawDataset(t[n]);e.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this,n=t.ctx,i=e._clip,r=!i.disabled,o=t.chartArea,s={meta:e,index:e.index,cancelable:!0};!1!==t.notifyPlugins("beforeDatasetDraw",s)&&(r&&Ke(n,{left:!1===i.left?0:o.left-i.left,right:!1===i.right?t.width:o.right+i.right,top:!1===i.top?0:o.top-i.top,bottom:!1===i.bottom?t.height:o.bottom+i.bottom}),e.controller.draw(),r&&Qe(n),s.cancelable=!1,t.notifyPlugins("afterDatasetDraw",s))}getElementsAtEventForMode(e,t,n,i){const r=Ot.modes[t];return"function"==typeof r?r(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter((e=>e&&e._dataset===t)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context={chart:this,type:"chart"})}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"==typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=this,r=n?"show":"hide",o=i.getDatasetMeta(e),s=o.controller._resolveAnimations(void 0,r);ue(t)?(o.data[t].hidden=!n,i.update()):(i.setDatasetVisibility(e,n),s.update(o,{visible:n}),i.update((t=>t.datasetIndex===e?r:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this,n=t._metasets&&t._metasets[e];n&&n.controller&&(n.controller._destroy(),delete t._metasets[e])}destroy(){const e=this,{canvas:t,ctx:n}=e;let i,r;for(e.stop(),s.remove(e),i=0,r=e.data.datasets.length;i<r;++i)e._destroyDatasetMeta(i);e.config.clearCache(),t&&(e.unbindEvents(),Ye(t,n),e.platform.releaseContext(n),e.canvas=null,e.ctx=null),e.notifyPlugins("destroy"),delete nr[e.id]}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this,t=e._listeners,n=e.platform,i=function(t,n,i){t.offsetX=n,t.offsetY=i,e._eventHandler(t)};Z(e.options.events,(r=>((i,r)=>{n.addEventListener(e,i,r),t[i]=r})(r,i)))}bindResponsiveEvents(){const e=this;e._responsiveListeners||(e._responsiveListeners={});const t=e._responsiveListeners,n=e.platform,i=(i,r)=>{n.addEventListener(e,i,r),t[i]=r},r=(i,r)=>{t[i]&&(n.removeEventListener(e,i,r),delete t[i])},o=(t,n)=>{e.canvas&&e.resize(t,n)};let s;const a=()=>{r("attach",a),e.attached=!0,e.resize(),i("resize",o),i("detach",s)};s=()=>{e.attached=!1,r("resize",o),i("attach",a)},n.isAttached(e.canvas)?a():s()}unbindEvents(){const e=this;Z(e._listeners,((t,n)=>{e.platform.removeEventListener(e,n,t)})),e._listeners={},Z(e._responsiveListeners,((t,n)=>{e.platform.removeEventListener(e,n,t)})),e._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let r,o,s,a;for("dataset"===t&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),s=0,a=e.length;s<a;++s){o=e[s];const t=o&&this.getDatasetMeta(o.datasetIndex).controller;t&&t[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this,n=t._active||[],i=e.map((({datasetIndex:e,index:n})=>{const i=t.getDatasetMeta(e);if(!i)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:i.data[n],index:n}}));!ee(i,n)&&(t._active=i,t._updateHoverStyles(i,n))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}_updateHoverStyles(e,t,n){const i=this,r=i.options.hover,o=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),s=o(t,e),a=n?e:o(e,t);s.length&&i.updateHoverStyle(s,r.mode,!1),a.length&&r.mode&&i.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,t){const n=this,i={event:e,replay:t,cancelable:!0},r=t=>(t.options.events||this.options.events).includes(e.type);if(!1===n.notifyPlugins("beforeEvent",i,r))return;const o=n._handleEvent(e,t);return i.cancelable=!1,n.notifyPlugins("afterEvent",i,r),(o||i.changed)&&n.render(),n}_handleEvent(e,t){const n=this,{_active:i=[],options:r}=n,o=r.hover,s=t;let a=[],c=!1,l=null;return"mouseout"!==e.type&&(a=n.getElementsAtEventForMode(e,o.mode,o,s),l="click"===e.type?n._lastEvent:e),n._lastEvent=null,Je(e,n.chartArea,n._minPadding)&&(Q(r.onHover,[e,a,n],n),"mouseup"!==e.type&&"click"!==e.type&&"contextmenu"!==e.type||Q(r.onClick,[e,a,n],n)),c=!ee(a,i),(c||t)&&(n._active=a,n._updateHoverStyles(a,i,t)),n._lastEvent=l,c}}const or=()=>Z(rr.instances,(e=>e._plugins.invalidate())),sr=!0;function ar(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}Object.defineProperties(rr,{defaults:{enumerable:sr,value:ye},instances:{enumerable:sr,value:nr},overrides:{enumerable:sr,value:fe},registry:{enumerable:sr,value:Fi},version:{enumerable:sr,value:"3.5.0"},getChart:{enumerable:sr,value:ir},register:{enumerable:sr,value:(...e)=>{Fi.add(...e),or()}},unregister:{enumerable:sr,value:(...e)=>{Fi.remove(...e),or()}}});class cr{constructor(e){this.options=e||{}}formats(){return ar()}parse(e,t){return ar()}format(e,t){return ar()}add(e,t,n){return ar()}diff(e,t,n){return ar()}startOf(e,t,n){return ar()}endOf(e,t){return ar()}}cr.override=function(e){Object.assign(cr.prototype,e)};var lr={_date:cr};function ur(e){const t=function(e){if(!e._cache.$bar){const t=e.getMatchingVisibleMetas("bar");let n=[];for(let i=0,r=t.length;i<r;i++)n=n.concat(t[i].controller.getAllParsedValues(e));e._cache.$bar=ht(n.sort(((e,t)=>e-t)))}return e._cache.$bar}(e);let n,i,r,o,s=e._length;const a=()=>{32767!==r&&-32768!==r&&(ue(o)&&(s=Math.min(s,Math.abs(r-o)||s)),o=r)};for(n=0,i=t.length;n<i;++n)r=e.getPixelForValue(t[n]),a();for(o=void 0,n=0,i=e.ticks.length;n<i;++n)r=e.getPixelForTick(n),a();return s}function hr(e,t,n,i){return W(e)?function(e,t,n,i){const r=n.parse(e[0],i),o=n.parse(e[1],i),s=Math.min(r,o),a=Math.max(r,o);let c=s,l=a;Math.abs(s)>Math.abs(a)&&(c=a,l=s),t[n.axis]=l,t._custom={barStart:c,barEnd:l,start:r,end:o,min:s,max:a}}(e,t,n,i):t[n.axis]=n.parse(e,i),t}function dr(e,t,n,i){const r=e.iScale,o=e.vScale,s=r.getLabels(),a=r===o,c=[];let l,u,h,d;for(l=n,u=n+i;l<u;++l)d=t[l],h={},h[r.axis]=a||r.parse(s[l],l),c.push(hr(d,h,o,l));return c}function fr(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function pr(e,t,n,i){let r=t.borderSkipped;const o={};if(!r)return void(e.borderSkipped=o);const{start:s,end:a,reverse:c,top:l,bottom:u}=function(e){let t,n,i,r,o;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(r="end",o="start"):(r="start",o="end"),{start:n,end:i,reverse:t,top:r,bottom:o}}(e);"middle"===r&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?r=l:(n._bottom||0)===i?r=u:(o[gr(u,s,a,c)]=!0,r=l)),o[gr(r,s,a,c)]=!0,e.borderSkipped=o}function gr(e,t,n,i){var r,o,s;return i?(s=n,e=mr(e=(r=e)===(o=t)?s:r===s?o:r,n,t)):e=mr(e,t,n),e}function mr(e,t,n){return"start"===e?t:"end"===e?n:e}class yr extends _i{parsePrimitiveData(e,t,n,i){return dr(e,t,n,i)}parseArrayData(e,t,n,i){return dr(e,t,n,i)}parseObjectData(e,t,n,i){const{iScale:r,vScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,c="x"===r.axis?s:a,l="x"===o.axis?s:a,u=[];let h,d,f,p;for(h=n,d=n+i;h<d;++h)p=t[h],f={},f[r.axis]=r.parse(ce(p,c),h),u.push(hr(ce(p,l),f,o,h));return u}updateRangeFromParsed(e,t,n,i){super.updateRangeFromParsed(e,t,n,i);const r=n._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:i}=t,r=this.getParsed(e),o=r._custom,s=fr(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:s}}initialize(){const e=this;e.enableOptionSharing=!0,super.initialize();e._cachedMeta.stack=e.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,i){const r=this,o="reset"===i,{index:s,_cachedMeta:{vScale:a}}=r,c=a.getBasePixel(),l=a.isHorizontal(),u=r._getRuler(),h=r.resolveDataElementOptions(t,i),d=r.getSharedOptions(h),f=r.includeOptions(i,d);r.updateSharedOptions(d,i,h);for(let h=t;h<t+n;h++){const t=r.getParsed(h),n=o||V(t[a.axis])?{base:c,head:c}:r._calculateBarValuePixels(h),p=r._calculateBarIndexPixels(h,u),g=(t._stacks||{})[a.axis],m={horizontal:l,base:n.base,enableBorderRadius:!g||fr(t._custom)||s===g._top||s===g._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};f&&(m.options=d||r.resolveDataElementOptions(h,e[h].active?"active":i)),pr(m,m.options||e[h].options,g,s),r.updateElement(e[h],h,m,i)}}_getStacks(e,t){const n=this._cachedMeta.iScale,i=n.getMatchingVisibleMetas(this._type),r=n.options.stacked,o=i.length,s=[];let a,c;for(a=0;a<o;++a)if(c=i[a],c.controller.options.grouped){if(void 0!==t){const e=c.controller.getParsed(t)[c.controller._cachedMeta.vScale.axis];if(V(e)||isNaN(e))continue}if((!1===r||-1===s.indexOf(c.stack)||void 0===r&&void 0===c.stack)&&s.push(c.stack),c.index===e)break}return s.length||s.push(void 0),s}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,n){const i=this._getStacks(e,n),r=void 0!==t?i.indexOf(t):-1;return-1===r?i.length-1:r}_getRuler(){const e=this,t=e.options,n=e._cachedMeta,i=n.iScale,r=[];let o,s;for(o=0,s=n.data.length;o<s;++o)r.push(i.getPixelForValue(e.getParsed(o)[i.axis],o));const a=t.barThickness;return{min:a||ur(i),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:e._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(e){const t=this,{_cachedMeta:{vScale:n,_stacked:i},options:{base:r,minBarLength:o}}=t,s=r||0,a=t.getParsed(e),c=a._custom,l=fr(c);let u,h,d=a[n.axis],f=0,p=i?t.applyStack(n,a,i):d;p!==d&&(f=p-d,p=d),l&&(d=c.barStart,p=c.barEnd-c.barStart,0!==d&&Ee(d)!==Ee(c.barEnd)&&(f=0),f+=d);const g=V(r)||l?f:r;let m=n.getPixelForValue(g);if(u=t.chart.getDataVisibility(e)?n.getPixelForValue(f+p):m,h=u-m,Math.abs(h)<o&&(h=function(e,t,n){return 0!==e?Ee(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(h,n,s)*o,d===s&&(m-=h/2),u=m+h),m===n.getPixelForValue(s)){const e=Ee(h)*n.getLineWidthForValue(s)/2;m+=e,h-=e}return{size:h,base:m,head:u,center:u+h/2}}_calculateBarIndexPixels(e,t){const n=this,i=t.scale,r=n.options,o=r.skipNull,s=X(r.maxBarThickness,1/0);let a,c;if(t.grouped){const i=o?n._getStackCount(e):t.stackCount,l="flex"===r.barThickness?function(e,t,n,i){const r=t.pixels,o=r[e];let s=e>0?r[e-1]:null,a=e<r.length-1?r[e+1]:null;const c=n.categoryPercentage;null===s&&(s=o-(null===a?t.end-t.start:a-o)),null===a&&(a=o+o-s);const l=o-(o-Math.min(s,a))/2*c;return{chunk:Math.abs(a-s)/2*c/i,ratio:n.barPercentage,start:l}}(e,t,r,i):function(e,t,n,i){const r=n.barThickness;let o,s;return V(r)?(o=t.min*n.categoryPercentage,s=n.barPercentage):(o=r*i,s=1),{chunk:o/i,ratio:s,start:t.pixels[e]-o/2}}(e,t,r,i),u=n._getStackIndex(n.index,n._cachedMeta.stack,o?e:void 0);a=l.start+l.chunk*u+l.chunk/2,c=Math.min(s,l.chunk*l.ratio)}else a=i.getPixelForValue(n.getParsed(e)[i.axis],e),c=Math.min(s,t.min*t.ratio);return{base:a-c/2,head:a+c/2,center:a,size:c}}draw(){const e=this,t=e._cachedMeta,n=t.vScale,i=t.data,r=i.length;let o=0;for(;o<r;++o)null!==e.getParsed(o)[n.axis]&&i[o].draw(e._ctx)}}yr.id="bar",yr.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},yr.overrides={interaction:{mode:"index"},scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class xr extends _i{initialize(){this.enableOptionSharing=!0,super.initialize()}parseObjectData(e,t,n,i){const{xScale:r,yScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,c=[];let l,u,h;for(l=n,u=n+i;l<u;++l)h=t[l],c.push({x:r.parse(ce(h,s),l),y:o.parse(ce(h,a),l),_custom:h&&h.r&&+h.r});return c}getMaxOverflow(){const{data:e,_parsed:t}=this._cachedMeta;let n=0;for(let i=e.length-1;i>=0;--i)n=Math.max(n,e[i].size()/2,t[i]._custom);return n>0&&n}getLabelAndValue(e){const t=this._cachedMeta,{xScale:n,yScale:i}=t,r=this.getParsed(e),o=n.getLabelForValue(r.x),s=i.getLabelForValue(r.y),a=r._custom;return{label:t.label,value:"("+o+", "+s+(a?", "+a:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,i){const r=this,o="reset"===i,{iScale:s,vScale:a}=r._cachedMeta,c=r.resolveDataElementOptions(t,i),l=r.getSharedOptions(c),u=r.includeOptions(i,l),h=s.axis,d=a.axis;for(let c=t;c<t+n;c++){const t=e[c],n=!o&&r.getParsed(c),l={},f=l[h]=o?s.getPixelForDecimal(.5):s.getPixelForValue(n[h]),p=l[d]=o?a.getBasePixel():a.getPixelForValue(n[d]);l.skip=isNaN(f)||isNaN(p),u&&(l.options=r.resolveDataElementOptions(c,t.active?"active":i),o&&(l.options.radius=0)),r.updateElement(t,c,l,i)}r.updateSharedOptions(l,i,c)}resolveDataElementOptions(e,t){const n=this.getParsed(e);let i=super.resolveDataElementOptions(e,t);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return"active"!==t&&(i.radius=0),i.radius+=X(n&&n._custom,r),i}}xr.id="bubble",xr.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},xr.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}};class br extends _i{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;let r,o;for(r=e,o=e+t;r<o;++r)i._parsed[r]=+n[r]}_getRotation(){return Le(this.options.rotation-90)}_getCircumference(){return Le(this.options.circumference)}_getRotationExtents(){let e=be,t=-be;const n=this;for(let i=0;i<n.chart.data.datasets.length;++i)if(n.chart.isDatasetVisible(i)){const r=n.chart.getDatasetMeta(i).controller,o=r._getRotation(),s=r._getCircumference();e=Math.min(e,o),t=Math.max(t,o+s)}return{rotation:e,circumference:t-e}}update(e){const t=this,n=t.chart,{chartArea:i}=n,r=t._cachedMeta,o=r.data,s=t.getMaxBorderWidth()+t.getMaxOffset(o)+t.options.spacing,a=Math.max((Math.min(i.width,i.height)-s)/2,0),c=Math.min(J(t.options.cutout,a),1),l=t._getRingWeight(t.index),{circumference:u,rotation:h}=t._getRotationExtents(),{ratioX:d,ratioY:f,offsetX:p,offsetY:g}=function(e,t,n){let i=1,r=1,o=0,s=0;if(t<be){const a=e,c=a+t,l=Math.cos(a),u=Math.sin(a),h=Math.cos(c),d=Math.sin(c),f=(e,t,i)=>ze(e,a,c,!0)?1:Math.max(t,t*n,i,i*n),p=(e,t,i)=>ze(e,a,c,!0)?-1:Math.min(t,t*n,i,i*n),g=f(0,l,h),m=f(Se,u,d),y=p(xe,l,h),x=p(xe+Se,u,d);i=(g-y)/2,r=(m-x)/2,o=-(g+y)/2,s=-(m+x)/2}return{ratioX:i,ratioY:r,offsetX:o,offsetY:s}}(h,u,c),m=(i.width-s)/d,y=(i.height-s)/f,x=Math.max(Math.min(m,y)/2,0),b=K(t.options.radius,x),v=(b-Math.max(b*c,0))/t._getVisibleDatasetWeightTotal();t.offsetX=p*b,t.offsetY=g*b,r.total=t.calculateTotal(),t.outerRadius=b-v*t._getRingWeightOffset(t.index),t.innerRadius=Math.max(t.outerRadius-v*l,0),t.updateElements(o,0,o.length,e)}_circumference(e,t){const n=this,i=n.options,r=n._cachedMeta,o=n._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:n.calculateCircumference(r._parsed[e]*o/be)}updateElements(e,t,n,i){const r=this,o="reset"===i,s=r.chart,a=s.chartArea,c=s.options.animation,l=(a.left+a.right)/2,u=(a.top+a.bottom)/2,h=o&&c.animateScale,d=h?0:r.innerRadius,f=h?0:r.outerRadius,p=r.resolveDataElementOptions(t,i),g=r.getSharedOptions(p),m=r.includeOptions(i,g);let y,x=r._getRotation();for(y=0;y<t;++y)x+=r._circumference(y,o);for(y=t;y<t+n;++y){const t=r._circumference(y,o),n=e[y],s={x:l+r.offsetX,y:u+r.offsetY,startAngle:x,endAngle:x+t,circumference:t,outerRadius:f,innerRadius:d};m&&(s.options=g||r.resolveDataElementOptions(y,n.active?"active":i)),x+=t,r.updateElement(n,y,s,i)}r.updateSharedOptions(g,i,p)}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,i=0;for(n=0;n<t.length;n++){const r=e._parsed[n];null===r||isNaN(r)||!this.chart.getDataVisibility(n)||t[n].hidden||(i+=Math.abs(r))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?be*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=An(t._parsed[e],n.options.locale);return{label:i[e]||"",value:r}}getMaxBorderWidth(e){const t=this;let n=0;const i=t.chart;let r,o,s,a,c;if(!e)for(r=0,o=i.data.datasets.length;r<o;++r)if(i.isDatasetVisible(r)){s=i.getDatasetMeta(r),e=s.data,a=s.controller,a!==t&&a.configure();break}if(!e)return 0;for(r=0,o=e.length;r<o;++r)c=a.resolveDataElementOptions(r),"inner"!==c.borderAlign&&(n=Math.max(n,c.borderWidth||0,c.hoverBorderWidth||0));return n}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(X(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}br.id="doughnut",br.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},br.descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e},br.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map(((t,i)=>{const r=e.getDatasetMeta(0).controller.getStyle(i);return{text:t,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(i),index:i}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label(e){let t=e.label;const n=": "+e.formattedValue;return W(t)?(t=t.slice(),t[0]+=n):t+=n,t}}}}};class vr extends _i{initialize(){this.enableOptionSharing=!0,super.initialize()}update(e){const t=this,n=t._cachedMeta,{dataset:i,data:r=[],_dataset:o}=n,s=t.chart._animationsDisabled;let{start:a,count:c}=function(e,t,n){const i=t.length;let r=0,o=i;if(e._sorted){const{iScale:s,_parsed:a}=e,c=s.axis,{min:l,max:u,minDefined:h,maxDefined:d}=s.getUserBounds();h&&(r=Ge(Math.min(ot(a,s.axis,l).lo,n?i:ot(t,c,s.getPixelForValue(l)).lo),0,i-1)),o=d?Ge(Math.max(ot(a,s.axis,u).hi+1,n?0:ot(t,c,s.getPixelForValue(u)).hi+1),r,i)-r:i-r}return{start:r,count:o}}(n,r,s);t._drawStart=a,t._drawCount=c,function(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=r,!0;const o=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),o}(n)&&(a=0,c=r.length),i._datasetIndex=t.index,i._decimated=!!o._decimated,i.points=r;const l=t.resolveDatasetElementOptions(e);t.options.showLine||(l.borderWidth=0),l.segment=t.options.segment,t.updateElement(i,void 0,{animated:!s,options:l},e),t.updateElements(r,a,c,e)}updateElements(e,t,n,i){const r=this,o="reset"===i,{iScale:s,vScale:a,_stacked:c}=r._cachedMeta,l=r.resolveDataElementOptions(t,i),u=r.getSharedOptions(l),h=r.includeOptions(i,u),d=s.axis,f=a.axis,p=r.options.spanGaps,g=Ae(p)?p:Number.POSITIVE_INFINITY,m=r.chart._animationsDisabled||o||"none"===i;let y=t>0&&r.getParsed(t-1);for(let l=t;l<t+n;++l){const t=e[l],n=r.getParsed(l),p=m?t:{},x=V(n[f]),b=p[d]=s.getPixelForValue(n[d],l),v=p[f]=o||x?a.getBasePixel():a.getPixelForValue(c?r.applyStack(a,n,c):n[f],l);p.skip=isNaN(b)||isNaN(v)||x,p.stop=l>0&&n[d]-y[d]>g,p.parsed=n,h&&(p.options=u||r.resolveDataElementOptions(l,t.active?"active":i)),m||r.updateElement(t,l,p,i),y=n}r.updateSharedOptions(u,i,l)}getMaxOverflow(){const e=this,t=e._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return i;const o=r[0].size(e.resolveDataElementOptions(0)),s=r[r.length-1].size(e.resolveDataElementOptions(r.length-1));return Math.max(i,o,s)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}vr.id="line",vr.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},vr.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class wr extends _i{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=An(t._parsed[e].r,n.options.locale);return{label:i[e]||"",value:r}}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}_updateRadius(){const e=this,t=e.chart,n=t.chartArea,i=t.options,r=Math.min(n.right-n.left,n.bottom-n.top),o=Math.max(r/2,0),s=(o-Math.max(i.cutoutPercentage?o/100*i.cutoutPercentage:1,0))/t.getVisibleDatasetCount();e.outerRadius=o-s*e.index,e.innerRadius=e.outerRadius-s}updateElements(e,t,n,i){const r=this,o="reset"===i,s=r.chart,a=r.getDataset(),c=s.options.animation,l=r._cachedMeta.rScale,u=l.xCenter,h=l.yCenter,d=l.getIndexAngle(0)-.5*xe;let f,p=d;const g=360/r.countVisibleElements();for(f=0;f<t;++f)p+=r._computeAngle(f,i,g);for(f=t;f<t+n;f++){const t=e[f];let n=p,m=p+r._computeAngle(f,i,g),y=s.getDataVisibility(f)?l.getDistanceFromCenterForValue(a.data[f]):0;p=m,o&&(c.animateScale&&(y=0),c.animateRotate&&(n=m=d));const x={x:u,y:h,innerRadius:0,outerRadius:y,startAngle:n,endAngle:m,options:r.resolveDataElementOptions(f,t.active?"active":i)};r.updateElement(t,f,x,i)}}countVisibleElements(){const e=this.getDataset(),t=this._cachedMeta;let n=0;return t.data.forEach(((t,i)=>{!isNaN(e.data[i])&&this.chart.getDataVisibility(i)&&n++})),n}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?Le(this.resolveDataElementOptions(e,t).angle||n):0}}wr.id="polarArea",wr.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},wr.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map(((t,i)=>{const r=e.getDatasetMeta(0).controller.getStyle(i);return{text:t,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(i),index:i}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label:e=>e.chart.data.labels[e.dataIndex]+": "+e.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class _r extends br{}_r.id="pie",_r.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class Sr extends _i{getLabelAndValue(e){const t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}update(e){const t=this,n=t._cachedMeta,i=n.dataset,r=n.data||[],o=n.iScale.getLabels();if(i.points=r,"resize"!==e){const n=t.resolveDatasetElementOptions(e);t.options.showLine||(n.borderWidth=0);const s={_loop:!0,_fullLoop:o.length===r.length,options:n};t.updateElement(i,void 0,s,e)}t.updateElements(r,0,r.length,e)}updateElements(e,t,n,i){const r=this,o=r.getDataset(),s=r._cachedMeta.rScale,a="reset"===i;for(let c=t;c<t+n;c++){const t=e[c],n=r.resolveDataElementOptions(c,t.active?"active":i),l=s.getPointPositionForValue(c,o.data[c]),u=a?s.xCenter:l.x,h=a?s.yCenter:l.y,d={x:u,y:h,angle:l.angle,skip:isNaN(u)||isNaN(h),options:n};r.updateElement(t,c,d,i)}}}Sr.id="radar",Sr.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},Sr.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Cr extends vr{}Cr.id="scatter",Cr.defaults={showLine:!1,fill:!1},Cr.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:e=>"("+e.label+", "+e.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var kr=Object.freeze({__proto__:null,BarController:yr,BubbleController:xr,DoughnutController:br,LineController:vr,PolarAreaController:wr,PieController:_r,RadarController:Sr,ScatterController:Cr});function Mr(e,t,n){const{startAngle:i,pixelMargin:r,x:o,y:s,outerRadius:a,innerRadius:c}=t;let l=r/a;e.beginPath(),e.arc(o,s,a,i-l,n+l),c>r?(l=r/c,e.arc(o,s,c,n+l,i-l,!0)):e.arc(o,s,r,n+Se,i-Se),e.closePath(),e.clip()}function Er(e,t,n,i){const r=Nt(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const o=(n-t)/2,s=Math.min(o,i*t/2),a=e=>{const t=(n-Math.min(o,e))*i/2;return Ge(e,0,Math.min(o,t))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:Ge(r.innerStart,0,s),innerEnd:Ge(r.innerEnd,0,s)}}function Tr(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function Pr(e,t,n,i,r){const{x:o,y:s,startAngle:a,pixelMargin:c,innerRadius:l}=t,u=Math.max(t.outerRadius+i+n-c,0),h=l>0?l+i+n+c:0;let d=0;const f=r-a;if(i){const e=((l>0?l-i:0)+(u>0?u-i:0))/2;d=(f-(0!==e?f*e/(e+i):f))/2}const p=(f-Math.max(.001,f*u-n/xe)/u)/2,g=a+p+d,m=r-p-d,{outerStart:y,outerEnd:x,innerStart:b,innerEnd:v}=Er(t,h,u,m-g),w=u-y,_=u-x,S=g+y/w,C=m-x/_,k=h+b,M=h+v,E=g+b/k,T=m-v/M;if(e.beginPath(),e.arc(o,s,u,S,C),x>0){const t=Tr(_,C,o,s);e.arc(t.x,t.y,x,C,m+Se)}const P=Tr(M,m,o,s);if(e.lineTo(P.x,P.y),v>0){const t=Tr(M,T,o,s);e.arc(t.x,t.y,v,m+Se,T+Math.PI)}if(e.arc(o,s,h,m-v/h,g+b/h,!0),b>0){const t=Tr(k,E,o,s);e.arc(t.x,t.y,b,E+Math.PI,g-Se)}const A=Tr(w,g,o,s);if(e.lineTo(A.x,A.y),y>0){const t=Tr(w,S,o,s);e.arc(t.x,t.y,y,g-Se,S)}e.closePath()}function Ar(e,t,n,i,r){const{options:o}=t,s="inner"===o.borderAlign;o.borderWidth&&(s?(e.lineWidth=2*o.borderWidth,e.lineJoin="round"):(e.lineWidth=o.borderWidth,e.lineJoin="bevel"),t.fullCircles&&function(e,t,n){const{x:i,y:r,startAngle:o,pixelMargin:s,fullCircles:a}=t,c=Math.max(t.outerRadius-s,0),l=t.innerRadius+s;let u;for(n&&Mr(e,t,o+be),e.beginPath(),e.arc(i,r,l,o+be,o,!0),u=0;u<a;++u)e.stroke();for(e.beginPath(),e.arc(i,r,c,o,o+be),u=0;u<a;++u)e.stroke()}(e,t,s),s&&Mr(e,t,r),Pr(e,t,n,i,r),e.stroke())}class Or extends Si{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.getProps(["x","y"],n),{angle:r,distance:o}=je(i,{x:e,y:t}),{startAngle:s,endAngle:a,innerRadius:c,outerRadius:l,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=this.options.spacing/2;return(u>=be||ze(r,s,a))&&(o>=c+h&&o<=l+h)}getCenterPoint(e){const{x:t,y:n,startAngle:i,endAngle:r,innerRadius:o,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:a,spacing:c}=this.options,l=(i+r)/2,u=(o+s+c+a)/2;return{x:t+Math.cos(l)*u,y:n+Math.sin(l)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const t=this,{options:n,circumference:i}=t,r=(n.offset||0)/2,o=(n.spacing||0)/2;if(t.pixelMargin="inner"===n.borderAlign?.33:0,t.fullCircles=i>be?Math.floor(i/be):0,0===i||t.innerRadius<0||t.outerRadius<0)return;e.save();let s=0;if(r){s=r/2;const n=(t.startAngle+t.endAngle)/2;e.translate(Math.cos(n)*s,Math.sin(n)*s),t.circumference>=xe&&(s=r)}e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor;const a=function(e,t,n,i){const{fullCircles:r,startAngle:o,circumference:s}=t;let a=t.endAngle;if(r){Pr(e,t,n,i,o+be);for(let t=0;t<r;++t)e.fill();isNaN(s)||(a=o+s%be,s%be==0&&(a+=be))}return Pr(e,t,n,i,a),e.fill(),a}(e,t,s,o);Ar(e,t,s,o,a),e.restore()}}function Dr(e,t,n=t){e.lineCap=X(n.borderCapStyle,t.borderCapStyle),e.setLineDash(X(n.borderDash,t.borderDash)),e.lineDashOffset=X(n.borderDashOffset,t.borderDashOffset),e.lineJoin=X(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=X(n.borderWidth,t.borderWidth),e.strokeStyle=X(n.borderColor,t.borderColor)}function Rr(e,t,n){e.lineTo(n.x,n.y)}function Lr(e,t,n={}){const i=e.length,{start:r=0,end:o=i-1}=n,{start:s,end:a}=t,c=Math.max(r,s),l=Math.min(o,a),u=r<s&&o<s||r>a&&o>a;return{count:i,start:c,loop:t.loop,ilen:l<c&&!u?i+l-c:l-c}}function Nr(e,t,n,i){const{points:r,options:o}=t,{count:s,start:a,loop:c,ilen:l}=Lr(r,n,i),u=function(e){return e.stepped?Ze:e.tension||"monotone"===e.cubicInterpolationMode?et:Rr}(o);let h,d,f,{move:p=!0,reverse:g}=i||{};for(h=0;h<=l;++h)d=r[(a+(g?l-h:h))%s],d.skip||(p?(e.moveTo(d.x,d.y),p=!1):u(e,f,d,g,o.stepped),f=d);return c&&(d=r[(a+(g?l:0))%s],u(e,f,d,g,o.stepped)),!!c}function Fr(e,t,n,i){const r=t.points,{count:o,start:s,ilen:a}=Lr(r,n,i),{move:c=!0,reverse:l}=i||{};let u,h,d,f,p,g,m=0,y=0;const x=e=>(s+(l?a-e:e))%o,b=()=>{f!==p&&(e.lineTo(m,p),e.lineTo(m,f),e.lineTo(m,g))};for(c&&(h=r[x(0)],e.moveTo(h.x,h.y)),u=0;u<=a;++u){if(h=r[x(u)],h.skip)continue;const t=h.x,n=h.y,i=0|t;i===d?(n<f?f=n:n>p&&(p=n),m=(y*m+t)/++y):(b(),e.lineTo(t,n),d=i,y=0,f=p=n),g=n}b()}function jr(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!(e._decimated||e._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||n)?Fr:Nr}Or.id="arc",Or.defaults={borderAlign:"center",borderColor:"#fff",borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},Or.defaultRoutes={backgroundColor:"backgroundColor"};const Ir="function"==typeof Path2D;function qr(e,t,n,i){Ir&&1===t.segments.length?function(e,t,n,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,i)&&r.closePath()),Dr(e,t.options),e.stroke(r)}(e,t,n,i):function(e,t,n,i){const{segments:r,options:o}=t,s=jr(t);for(const a of r)Dr(e,o,a.style),e.beginPath(),s(e,t,a,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}(e,t,n,i)}class Br extends Si{constructor(e){super(),this.animated=!0,this.options=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this,i=n.options;if((i.tension||"monotone"===i.cubicInterpolationMode)&&!i.stepped&&!n._pointsUpdated){const r=i.spanGaps?n._loop:n._fullLoop;wn(n._points,i,e,r,t),n._pointsUpdated=!0}}set points(e){const t=this;t._points=e,delete t._segments,delete t._path,t._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=In(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this,i=n.options,r=e[t],o=n.points,s=jn(n,{property:t,start:r,end:r});if(!s.length)return;const a=[],c=function(e){return e.stepped?En:e.tension||"monotone"===e.cubicInterpolationMode?Tn:Mn}(i);let l,u;for(l=0,u=s.length;l<u;++l){const{start:n,end:u}=s[l],h=o[n],d=o[u];if(h===d){a.push(h);continue}const f=c(h,d,Math.abs((r-h[t])/(d[t]-h[t])),i.stepped);f[t]=e[t],a.push(f)}return 1===a.length?a[0]:a}pathSegment(e,t,n){return jr(this)(e,this,t,n)}path(e,t,n){const i=this,r=i.segments,o=jr(i);let s=i._loop;t=t||0,n=n||i.points.length-t;for(const a of r)s&=o(e,i,a,{start:t,end:t+n-1});return!!s}draw(e,t,n,i){const r=this,o=r.options||{};(r.points||[]).length&&o.borderWidth&&(e.save(),qr(e,r,n,i),e.restore(),r.animated&&(r._pointsUpdated=!1,r._path=void 0))}}function zr(e,t,n,i){const r=e.options,{[n]:o}=e.getProps([n],i);return Math.abs(t-o)<r.radius+r.hitRadius}Br.id="line",Br.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},Br.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},Br.descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};class Gr extends Si{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.options,{x:r,y:o}=this.getProps(["x","y"],n);return Math.pow(e-r,2)+Math.pow(t-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,t){return zr(this,e,"x",t)}inYRange(e,t){return zr(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this,i=n.options;n.skip||i.radius<.1||!Je(n,t,n.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Xe(e,i,n.x,n.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Hr(e,t){const{x:n,y:i,base:r,width:o,height:s}=e.getProps(["x","y","base","width","height"],t);let a,c,l,u,h;return e.horizontal?(h=s/2,a=Math.min(n,r),c=Math.max(n,r),l=i-h,u=i+h):(h=o/2,a=n-h,c=n+h,l=Math.min(i,r),u=Math.max(i,r)),{left:a,top:l,right:c,bottom:u}}function Vr(e,t,n,i){return e?0:Ge(t,n,i)}function Wr(e){const t=Hr(e),n=t.right-t.left,i=t.bottom-t.top,r=function(e,t,n){const i=e.options.borderWidth,r=e.borderSkipped,o=Ft(i);return{t:Vr(r.top,o.top,0,n),r:Vr(r.right,o.right,0,t),b:Vr(r.bottom,o.bottom,0,n),l:Vr(r.left,o.left,0,t)}}(e,n/2,i/2),o=function(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,o=jt(r),s=Math.min(t,n),a=e.borderSkipped,c=i||U(r);return{topLeft:Vr(!c||a.top||a.left,o.topLeft,0,s),topRight:Vr(!c||a.top||a.right,o.topRight,0,s),bottomLeft:Vr(!c||a.bottom||a.left,o.bottomLeft,0,s),bottomRight:Vr(!c||a.bottom||a.right,o.bottomRight,0,s)}}(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:o},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function Ur(e,t,n,i){const r=null===t,o=null===n,s=e&&!(r&&o)&&Hr(e,i);return s&&(r||t>=s.left&&t<=s.right)&&(o||n>=s.top&&n<=s.bottom)}function $r(e,t){e.rect(t.x,t.y,t.w,t.h)}function Yr(e,t,n={}){const i=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,o=(e.x+e.w!==n.x+n.w?t:0)-i,s=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+i,y:e.y+r,w:e.w+o,h:e.h+s,radius:e.radius}}Gr.id="point",Gr.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},Gr.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};class Xr extends Si{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,e&&Object.assign(this,e)}draw(e){const t=this.options,{inner:n,outer:i}=Wr(this),r=(o=i.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?it:$r;var o;const s=.33;e.save(),i.w===n.w&&i.h===n.h||(e.beginPath(),r(e,Yr(i,s,n)),e.clip(),r(e,Yr(n,-.33,i)),e.fillStyle=t.borderColor,e.fill("evenodd")),e.beginPath(),r(e,Yr(n,s,i)),e.fillStyle=t.backgroundColor,e.fill(),e.restore()}inRange(e,t,n){return Ur(this,e,t,n)}inXRange(e,t){return Ur(this,e,null,t)}inYRange(e,t){return Ur(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+i)/2:t,y:r?n:(n+i)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}Xr.id="bar",Xr.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,enableBorderRadius:!0,pointStyle:void 0},Xr.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var Jr=Object.freeze({__proto__:null,ArcElement:Or,LineElement:Br,PointElement:Gr,BarElement:Xr});function Kr(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{value:t})}}function Qr(e){e.data.datasets.forEach((e=>{Kr(e)}))}var Zr={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled)return void Qr(e);const i=e.width;e.data.datasets.forEach(((t,r)=>{const{_data:o,indexAxis:s}=t,a=e.getDatasetMeta(r),c=o||t.data;if("y"===Bt([s,e.options.indexAxis]))return;if("line"!==a.type)return;const l=e.scales[a.xAxisID];if("linear"!==l.type&&"time"!==l.type)return;if(e.options.parsing)return;let{start:u,count:h}=function(e,t){const n=t.length;let i,r=0;const{iScale:o}=e,{min:s,max:a,minDefined:c,maxDefined:l}=o.getUserBounds();return c&&(r=Ge(ot(t,o.axis,s).lo,0,n-1)),i=l?Ge(ot(t,o.axis,a).hi+1,r,n)-r:n-r,{start:r,count:i}}(a,c);if(h<=(n.threshold||4*i))return void Kr(t);let d;switch(V(o)&&(t._data=c,delete t.data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(e){this._data=e}})),n.algorithm){case"lttb":d=function(e,t,n,i,r){const o=r.samples||i;if(o>=n)return e.slice(t,t+n);const s=[],a=(n-2)/(o-2);let c=0;const l=t+n-1;let u,h,d,f,p,g=t;for(s[c++]=e[g],u=0;u<o-2;u++){let i,r=0,o=0;const l=Math.floor((u+1)*a)+1+t,m=Math.min(Math.floor((u+2)*a)+1,n)+t,y=m-l;for(i=l;i<m;i++)r+=e[i].x,o+=e[i].y;r/=y,o/=y;const x=Math.floor(u*a)+1+t,b=Math.min(Math.floor((u+1)*a)+1,n)+t,{x:v,y:w}=e[g];for(d=f=-1,i=x;i<b;i++)f=.5*Math.abs((v-r)*(e[i].y-w)-(v-e[i].x)*(o-w)),f>d&&(d=f,h=e[i],p=i);s[c++]=h,g=p}return s[c++]=e[l],s}(c,u,h,i,n);break;case"min-max":d=function(e,t,n,i){let r,o,s,a,c,l,u,h,d,f,p=0,g=0;const m=[],y=t+n-1,x=e[t].x,b=e[y].x-x;for(r=t;r<t+n;++r){o=e[r],s=(o.x-x)/b*i,a=o.y;const t=0|s;if(t===c)a<d?(d=a,l=r):a>f&&(f=a,u=r),p=(g*p+o.x)/++g;else{const n=r-1;if(!V(l)&&!V(u)){const t=Math.min(l,u),i=Math.max(l,u);t!==h&&t!==n&&m.push({...e[t],x:p}),i!==h&&i!==n&&m.push({...e[i],x:p})}r>0&&n!==h&&m.push(e[n]),m.push(o),c=t,g=0,d=f=a,l=u=h=r}}return m}(c,u,h,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}t._decimated=d}))},destroy(e){Qr(e)}};function eo(e,t,n){const i=function(e){const t=e.options,n=t.fill;let i=X(n&&n.target,n);return void 0===i&&(i=!!t.backgroundColor),!1!==i&&null!==i&&(!0===i?"origin":i)}(e);if(U(i))return!isNaN(i.value)&&i;let r=parseFloat(i);return $(r)&&Math.floor(r)===r?("-"!==i[0]&&"+"!==i[0]||(r=t+r),!(r===t||r<0||r>=n)&&r):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}class to{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,n){const{x:i,y:r,radius:o}=this;return t=t||{start:0,end:be},e.arc(i,r,o,t.end,t.start,!0),!n.bounds}interpolate(e){const{x:t,y:n,radius:i}=this,r=e.angle;return{x:t+Math.cos(r)*i,y:n+Math.sin(r)*i,angle:r}}}function no(e){return(e.scale||{}).getPointPositionForValue?function(e){const{scale:t,fill:n}=e,i=t.options,r=t.getLabels().length,o=[],s=i.reverse?t.max:t.min,a=i.reverse?t.min:t.max;let c,l,u;if(u="start"===n?s:"end"===n?a:U(n)?n.value:t.getBaseValue(),i.grid.circular)return l=t.getPointPositionForValue(0,s),new to({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(u)});for(c=0;c<r;++c)o.push(t.getPointPositionForValue(c,u));return o}(e):function(e){const{scale:t={},fill:n}=e;let i,r=null;return"start"===n?r=t.bottom:"end"===n?r=t.top:U(n)?r=t.getPixelForValue(n.value):t.getBasePixel&&(r=t.getBasePixel()),$(r)?(i=t.isHorizontal(),{x:i?r:null,y:i?null:r}):null}(e)}function io(e,t,n){for(;t>e;t--){const e=n[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function ro(e){const{chart:t,scale:n,index:i,line:r}=e,o=[],s=r.segments,a=r.points,c=function(e,t){const n=[],i=e.getSortedVisibleDatasetMetas();for(let e=0;e<i.length;e++){const r=i[e];if(r.index===t)break;oo(r)&&n.unshift(r.dataset)}return n}(t,i);c.push(co({x:null,y:n.bottom},r));for(let e=0;e<s.length;e++){const t=s[e];for(let e=t.start;e<=t.end;e++)so(o,a[e],c)}return new Br({points:o,options:{}})}const oo=e=>"line"===e.type&&!e.hidden;function so(e,t,n){const i=[];for(let r=0;r<n.length;r++){const o=n[r],{first:s,last:a,point:c}=ao(o,t,"x");if(!(!c||s&&a))if(s)i.unshift(c);else if(e.push(c),!a)break}e.push(...i)}function ao(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const r=i[n],o=e.segments,s=e.points;let a=!1,c=!1;for(let e=0;e<o.length;e++){const t=o[e],i=s[t.start][n],l=s[t.end][n];if(r>=i&&r<=l){a=r===i,c=r===l;break}}return{first:a,last:c,point:i}}function co(e,t){let n=[],i=!1;return W(e)?(i=!0,n=e):n=function(e,t){const{x:n=null,y:i=null}=e||{},r=t.points,o=[];return t.segments.forEach((({start:e,end:t})=>{t=io(e,t,r);const s=r[e],a=r[t];null!==i?(o.push({x:s.x,y:i}),o.push({x:a.x,y:i})):null!==n&&(o.push({x:n,y:s.y}),o.push({x:n,y:a.y}))})),o}(e,t),n.length?new Br({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function lo(e,t,n){let i=e[t].fill;const r=[t];let o;if(!n)return i;for(;!1!==i&&-1===r.indexOf(i);){if(!$(i))return i;if(o=e[i],!o)return!1;if(o.visible)return i;r.push(i),i=o.fill}return!1}function uo(e,t,n){e.beginPath(),t.path(e),e.lineTo(t.last().x,n),e.lineTo(t.first().x,n),e.closePath(),e.clip()}function ho(e,t,n,i){if(i)return;let r=t[e],o=n[e];return"angle"===e&&(r=Be(r),o=Be(o)),{property:e,start:r,end:o}}function fo(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function po(e,t,n){const{top:i,bottom:r}=t.chart.chartArea,{property:o,start:s,end:a}=n||{};"x"===o&&(e.beginPath(),e.rect(s,i,a-s,r-i),e.clip())}function go(e,t,n,i){const r=t.interpolate(n,i);r&&e.lineTo(r.x,r.y)}function mo(e,t){const{line:n,target:i,property:r,color:o,scale:s}=t,a=function(e,t,n){const i=e.segments,r=e.points,o=t.points,s=[];for(const e of i){let{start:i,end:a}=e;a=io(i,a,r);const c=ho(n,r[i],r[a],e.loop);if(!t.segments){s.push({source:e,target:c,start:r[i],end:r[a]});continue}const l=jn(t,c);for(const t of l){const i=ho(n,o[t.start],o[t.end],t.loop),a=Fn(e,r,i);for(const e of a)s.push({source:e,target:t,start:{[n]:fo(c,i,"start",Math.max)},end:{[n]:fo(c,i,"end",Math.min)}})}}return s}(n,i,r);for(const{source:t,target:c,start:l,end:u}of a){const{style:{backgroundColor:a=o}={}}=t,h=!0!==i;e.save(),e.fillStyle=a,po(e,s,h&&ho(r,l,u)),e.beginPath();const d=!!n.pathSegment(e,t);let f;if(h){d?e.closePath():go(e,i,u,r);const t=!!i.pathSegment(e,c,{move:d,reverse:!0});f=d&&t,f||go(e,i,l,r)}e.closePath(),e.fill(f?"evenodd":"nonzero"),e.restore()}}function yo(e,t,n){const i=function(e){const{chart:t,fill:n,line:i}=e;if($(n))return function(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}(t,n);if("stack"===n)return ro(e);if("shape"===n)return!0;const r=no(e);return r instanceof to?r:co(r,i)}(t),{line:r,scale:o,axis:s}=t,a=r.options,c=a.fill,l=a.backgroundColor,{above:u=l,below:h=l}=c||{};i&&r.points.length&&(Ke(e,n),function(e,t){const{line:n,target:i,above:r,below:o,area:s,scale:a}=t,c=n._loop?"angle":t.axis;e.save(),"x"===c&&o!==r&&(uo(e,i,s.top),mo(e,{line:n,target:i,color:r,scale:a,property:c}),e.restore(),e.save(),uo(e,i,s.bottom)),mo(e,{line:n,target:i,color:o,scale:a,property:c}),e.restore()}(e,{line:r,target:i,above:u,below:h,area:n,scale:o,axis:s}),Qe(e))}var xo={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,r=[];let o,s,a,c;for(s=0;s<i;++s)o=e.getDatasetMeta(s),a=o.dataset,c=null,a&&a.options&&a instanceof Br&&(c={visible:e.isDatasetVisible(s),index:s,fill:eo(a,s,i),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=c,r.push(c);for(s=0;s<i;++s)c=r[s],c&&!1!==c.fill&&(c.fill=lo(r,s,n.propagate))},beforeDraw(e,t,n){const i="beforeDraw"===n.drawTime,r=e.getSortedVisibleDatasetMetas(),o=e.chartArea;for(let t=r.length-1;t>=0;--t){const n=r[t].$filler;n&&(n.line.updateControlPoints(o,n.axis),i&&yo(e.ctx,n,o))}},beforeDatasetsDraw(e,t,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=e.getSortedVisibleDatasetMetas();for(let t=i.length-1;t>=0;--t){const n=i[t].$filler;n&&yo(e.ctx,n,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;i&&!1!==i.fill&&"beforeDatasetDraw"===n.drawTime&&yo(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const bo=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}};class vo extends Si{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){const i=this;i.maxWidth=e,i.maxHeight=t,i._margins=n,i.setDimensions(),i.buildLabels(),i.fit()}setDimensions(){const e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=e._margins.left,e.right=e.width):(e.height=e.maxHeight,e.top=e._margins.top,e.bottom=e.height)}buildLabels(){const e=this,t=e.options.labels||{};let n=Q(t.generateLabels,[e.chart],e)||[];t.filter&&(n=n.filter((n=>t.filter(n,e.chart.data)))),t.sort&&(n=n.sort(((n,i)=>t.sort(n,i,e.chart.data)))),e.options.reverse&&n.reverse(),e.legendItems=n}fit(){const e=this,{options:t,ctx:n}=e;if(!t.display)return void(e.width=e.height=0);const i=t.labels,r=qt(i.font),o=r.size,s=e._computeTitleHeight(),{boxWidth:a,itemHeight:c}=bo(i,o);let l,u;n.font=r.string,e.isHorizontal()?(l=e.maxWidth,u=e._fitRows(s,o,a,c)+10):(u=e.maxHeight,l=e._fitCols(s,o,a,c)+10),e.width=Math.min(l,t.maxWidth||e.maxWidth),e.height=Math.min(u,t.maxHeight||e.maxHeight)}_fitRows(e,t,n,i){const r=this,{ctx:o,maxWidth:s,options:{labels:{padding:a}}}=r,c=r.legendHitBoxes=[],l=r.lineWidths=[0],u=i+a;let h=e;o.textAlign="left",o.textBaseline="middle";let d=-1,f=-u;return r.legendItems.forEach(((e,r)=>{const p=n+t/2+o.measureText(e.text).width;(0===r||l[l.length-1]+p+2*a>s)&&(h+=u,l[l.length-(r>0?0:1)]=0,f+=u,d++),c[r]={left:0,top:f,row:d,width:p,height:i},l[l.length-1]+=p+a})),h}_fitCols(e,t,n,i){const r=this,{ctx:o,maxHeight:s,options:{labels:{padding:a}}}=r,c=r.legendHitBoxes=[],l=r.columnSizes=[],u=s-e;let h=a,d=0,f=0,p=0,g=0;return r.legendItems.forEach(((e,r)=>{const s=n+t/2+o.measureText(e.text).width;r>0&&f+i+2*a>u&&(h+=d+a,l.push({width:d,height:f}),p+=d+a,g++,d=f=0),c[r]={left:p,top:f,col:g,width:s,height:i},d=Math.max(d,s),f+=i+a})),h+=d,l.push({width:d,height:f}),h}adjustHitBoxes(){const e=this;if(!e.options.display)return;const t=e._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:o},rtl:s}}=e,a=On(s,e.left,e.width);if(this.isHorizontal()){let s=0,c=r(i,e.left+o,e.right-e.lineWidths[s]);for(const l of n)s!==l.row&&(s=l.row,c=r(i,e.left+o,e.right-e.lineWidths[s])),l.top+=e.top+t+o,l.left=a.leftForLtr(a.x(c),l.width),c+=l.width+o}else{let s=0,c=r(i,e.top+t+o,e.bottom-e.columnSizes[s].height);for(const l of n)l.col!==s&&(s=l.col,c=r(i,e.top+t+o,e.bottom-e.columnSizes[s].height)),l.top=c,l.left+=e.left+o,l.left=a.leftForLtr(a.x(l.left),l.width),c+=l.height+o}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){const e=this;if(e.options.display){const t=e.ctx;Ke(t,e),e._draw(),Qe(t)}}_draw(){const e=this,{options:t,columnSizes:n,lineWidths:i,ctx:s}=e,{align:a,labels:c}=t,l=ye.color,u=On(t.rtl,e.left,e.width),h=qt(c.font),{color:d,padding:f}=c,p=h.size,g=p/2;let m;e.drawTitle(),s.textAlign=u.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=h.string;const{boxWidth:y,boxHeight:x,itemHeight:b}=bo(c,p),v=e.isHorizontal(),w=this._computeTitleHeight();m=v?{x:r(a,e.left+f,e.right-i[0]),y:e.top+f+w,line:0}:{x:e.left+f,y:r(a,e.top+w+f,e.bottom-n[0].height),line:0},Dn(e.ctx,t.textDirection);const _=b+f;e.legendItems.forEach(((S,C)=>{s.strokeStyle=S.fontColor||d,s.fillStyle=S.fontColor||d;const k=s.measureText(S.text).width,M=u.textAlign(S.textAlign||(S.textAlign=c.textAlign)),E=y+g+k;let T=m.x,P=m.y;u.setWidth(e.width),v?C>0&&T+E+f>e.right&&(P=m.y+=_,m.line++,T=m.x=r(a,e.left+f,e.right-i[m.line])):C>0&&P+_>e.bottom&&(T=m.x=T+n[m.line].width+f,m.line++,P=m.y=r(a,e.top+w+f,e.bottom-n[m.line].height));!function(e,t,n){if(isNaN(y)||y<=0||isNaN(x)||x<0)return;s.save();const i=X(n.lineWidth,1);if(s.fillStyle=X(n.fillStyle,l),s.lineCap=X(n.lineCap,"butt"),s.lineDashOffset=X(n.lineDashOffset,0),s.lineJoin=X(n.lineJoin,"miter"),s.lineWidth=i,s.strokeStyle=X(n.strokeStyle,l),s.setLineDash(X(n.lineDash,[])),c.usePointStyle){const r={radius:y*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:i},o=u.xPlus(e,y/2);Xe(s,r,o,t+g)}else{const r=t+Math.max((p-x)/2,0),o=u.leftForLtr(e,y),a=jt(n.borderRadius);s.beginPath(),Object.values(a).some((e=>0!==e))?it(s,{x:o,y:r,w:y,h:x,radius:a}):s.rect(o,r,y,x),s.fill(),0!==i&&s.stroke()}s.restore()}(u.x(T),P,S),T=o(M,T+y+g,v?T+E:e.right,t.rtl),function(e,t,n){tt(s,n.text,e,t+b/2,h,{strikethrough:n.hidden,textAlign:u.textAlign(n.textAlign)})}(u.x(T),P,S),v?m.x+=E+f:m.y+=_})),Rn(e.ctx,t.textDirection)}drawTitle(){const e=this,t=e.options,n=t.title,o=qt(n.font),s=It(n.padding);if(!n.display)return;const a=On(t.rtl,e.left,e.width),c=e.ctx,l=n.position,u=o.size/2,h=s.top+u;let d,f=e.left,p=e.width;if(this.isHorizontal())p=Math.max(...e.lineWidths),d=e.top+h,f=r(t.align,f,e.right-p);else{const n=e.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);d=h+r(t.align,e.top,e.bottom-n-t.labels.padding-e._computeTitleHeight())}const g=r(l,f,f+p);c.textAlign=a.textAlign(i(l)),c.textBaseline="middle",c.strokeStyle=n.color,c.fillStyle=n.color,c.font=o.string,tt(c,n.text,g,d,o)}_computeTitleHeight(){const e=this.options.title,t=qt(e.font),n=It(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){const n=this;let i,r,o;if(e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom)for(o=n.legendHitBoxes,i=0;i<o.length;++i)if(r=o[i],e>=r.left&&e<=r.left+r.width&&t>=r.top&&t<=r.top+r.height)return n.legendItems[i];return null}handleEvent(e){const t=this,n=t.options;if(!function(e,t){if("mousemove"===e&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,n))return;const i=t._getLegendItemAt(e.x,e.y);if("mousemove"===e.type){const s=t._hoveredItem,a=(o=i,null!==(r=s)&&null!==o&&r.datasetIndex===o.datasetIndex&&r.index===o.index);s&&!a&&Q(n.onLeave,[e,s,t],t),t._hoveredItem=i,i&&!a&&Q(n.onHover,[e,i,t],t)}else i&&Q(n.onClick,[e,i,t],t);var r,o}}var wo={id:"legend",_element:vo,start(e,t,n){const i=e.legend=new vo({ctx:e.ctx,options:n,chart:e});en.configure(e,i,n),en.addBox(e,i)},stop(e){en.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;en.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:o}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const s=e.controller.getStyle(n?0:void 0),a=It(s.borderWidth);return{text:t[e.index].label,fillStyle:s.backgroundColor,fontColor:o,hidden:!e.visible,lineCap:s.borderCapStyle,lineDash:s.borderDash,lineDashOffset:s.borderDashOffset,lineJoin:s.borderJoinStyle,lineWidth:(a.width+a.height)/4,strokeStyle:s.borderColor,pointStyle:i||s.pointStyle,rotation:s.rotation,textAlign:r||s.textAlign,borderRadius:0,datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class _o extends Si{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this,i=n.options;if(n.left=0,n.top=0,!i.display)return void(n.width=n.height=n.right=n.bottom=0);n.width=n.right=e,n.height=n.bottom=t;const r=W(i.text)?i.text.length:1;n._padding=It(i.padding);const o=r*qt(i.font).lineHeight+n._padding.height;n.isHorizontal()?n.height=o:n.width=o}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:i,right:o,options:s}=this,a=s.align;let c,l,u,h=0;return this.isHorizontal()?(l=r(a,n,o),u=t+e,c=o-n):("left"===s.position?(l=n+e,u=r(a,i,t),h=-.5*xe):(l=o-e,u=r(a,t,i),h=.5*xe),c=i-t),{titleX:l,titleY:u,maxWidth:c,rotation:h}}draw(){const e=this,t=e.ctx,n=e.options;if(!n.display)return;const r=qt(n.font),o=r.lineHeight/2+e._padding.top,{titleX:s,titleY:a,maxWidth:c,rotation:l}=e._drawArgs(o);tt(t,n.text,0,0,r,{color:n.color,maxWidth:c,rotation:l,textAlign:i(n.align),textBaseline:"middle",translation:[s,a]})}}var So={id:"title",_element:_o,start(e,t,n){!function(e,t){const n=new _o({ctx:e.ctx,options:t,chart:e});en.configure(e,n,t),en.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;en.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;en.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Co=new WeakMap;var ko={id:"subtitle",start(e,t,n){const i=new _o({ctx:e.ctx,options:n,chart:e});en.configure(e,i,n),en.addBox(e,i),Co.set(e,i)},stop(e){en.removeBox(e,Co.get(e)),Co.delete(e)},beforeUpdate(e,t,n){const i=Co.get(e);en.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Mo={average(e){if(!e.length)return!1;let t,n,i=0,r=0,o=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();i+=e.x,r+=e.y,++o}}return{x:i/o,y:r/o}},nearest(e,t){if(!e.length)return!1;let n,i,r,o=t.x,s=t.y,a=Number.POSITIVE_INFINITY;for(n=0,i=e.length;n<i;++n){const i=e[n].element;if(i&&i.hasValue()){const e=Ie(t,i.getCenterPoint());e<a&&(a=e,r=i)}}if(r){const e=r.tooltipPosition();o=e.x,s=e.y}return{x:o,y:s}}};function Eo(e,t){return t&&(W(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function To(e){return("string"==typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Po(e,t){const{element:n,datasetIndex:i,index:r}=t,o=e.getDatasetMeta(i).controller,{label:s,value:a}=o.getLabelAndValue(r);return{chart:e,label:s,parsed:o.getParsed(r),raw:e.data.datasets[i].data[r],formattedValue:a,dataset:o.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function Ao(e,t){const n=e._chart.ctx,{body:i,footer:r,title:o}=e,{boxWidth:s,boxHeight:a}=t,c=qt(t.bodyFont),l=qt(t.titleFont),u=qt(t.footerFont),h=o.length,d=r.length,f=i.length,p=It(t.padding);let g=p.height,m=0,y=i.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(y+=e.beforeBody.length+e.afterBody.length,h&&(g+=h*l.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),y){g+=f*(t.displayColors?Math.max(a,c.lineHeight):c.lineHeight)+(y-f)*c.lineHeight+(y-1)*t.bodySpacing}d&&(g+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let x=0;const b=function(e){m=Math.max(m,n.measureText(e).width+x)};return n.save(),n.font=l.string,Z(e.title,b),n.font=c.string,Z(e.beforeBody.concat(e.afterBody),b),x=t.displayColors?s+2:0,Z(i,(e=>{Z(e.before,b),Z(e.lines,b),Z(e.after,b)})),x=0,n.font=u.string,Z(e.footer,b),n.restore(),m+=p.width,{width:m,height:g}}function Oo(e,t,n,i){const{x:r,width:o}=n,{width:s,chartArea:{left:a,right:c}}=e;let l="center";return"center"===i?l=r<=(a+c)/2?"left":"right":r<=o/2?l="left":r>=s-o/2&&(l="right"),function(e,t,n,i){const{x:r,width:o}=i,s=n.caretSize+n.caretPadding;return"left"===e&&r+o+s>t.width||"right"===e&&r-o-s<0||void 0}(l,e,t,n)&&(l="center"),l}function Do(e,t,n){const i=t.yAlign||function(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}(e,n);return{xAlign:t.xAlign||Oo(e,t,n,i),yAlign:i}}function Ro(e,t,n,i){const{caretSize:r,caretPadding:o,cornerRadius:s}=e,{xAlign:a,yAlign:c}=n,l=r+o,u=s+o;let h=function(e,t){let{x:n,width:i}=e;return"right"===t?n-=i:"center"===t&&(n-=i/2),n}(t,a);const d=function(e,t,n){let{y:i,height:r}=e;return"top"===t?i+=n:i-="bottom"===t?r+n:r/2,i}(t,c,l);return"center"===c?"left"===a?h+=l:"right"===a&&(h-=l):"left"===a?h-=u:"right"===a&&(h+=u),{x:Ge(h,0,i.width-t.width),y:Ge(d,0,i.height-t.height)}}function Lo(e,t,n){const i=It(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-i.right:e.x+i.left}function No(e){return Eo([],To(e))}function Fo(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}class jo extends Si{constructor(e){super(),this.opacity=0,this._active=[],this._chart=e._chart,this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this,t=e._cachedAnimations;if(t)return t;const n=e._chart,i=e.options.setContext(e.getContext()),r=i.enabled&&n.options.animation&&i.animations,o=new ui(e._chart,r);return r._cacheable&&(e._cachedAnimations=Object.freeze(o)),o}getContext(){const e=this;return e.$context||(e.$context=(t=e._chart.getContext(),n=e,i=e._tooltipItems,Object.assign(Object.create(t),{tooltip:n,tooltipItems:i,type:"tooltip"})));var t,n,i}getTitle(e,t){const n=this,{callbacks:i}=t,r=i.beforeTitle.apply(n,[e]),o=i.title.apply(n,[e]),s=i.afterTitle.apply(n,[e]);let a=[];return a=Eo(a,To(r)),a=Eo(a,To(o)),a=Eo(a,To(s)),a}getBeforeBody(e,t){return No(t.callbacks.beforeBody.apply(this,[e]))}getBody(e,t){const n=this,{callbacks:i}=t,r=[];return Z(e,(e=>{const t={before:[],lines:[],after:[]},o=Fo(i,e);Eo(t.before,To(o.beforeLabel.call(n,e))),Eo(t.lines,o.label.call(n,e)),Eo(t.after,To(o.afterLabel.call(n,e))),r.push(t)})),r}getAfterBody(e,t){return No(t.callbacks.afterBody.apply(this,[e]))}getFooter(e,t){const n=this,{callbacks:i}=t,r=i.beforeFooter.apply(n,[e]),o=i.footer.apply(n,[e]),s=i.afterFooter.apply(n,[e]);let a=[];return a=Eo(a,To(r)),a=Eo(a,To(o)),a=Eo(a,To(s)),a}_createItems(e){const t=this,n=t._active,i=t._chart.data,r=[],o=[],s=[];let a,c,l=[];for(a=0,c=n.length;a<c;++a)l.push(Po(t._chart,n[a]));return e.filter&&(l=l.filter(((t,n,r)=>e.filter(t,n,r,i)))),e.itemSort&&(l=l.sort(((t,n)=>e.itemSort(t,n,i)))),Z(l,(n=>{const i=Fo(e.callbacks,n);r.push(i.labelColor.call(t,n)),o.push(i.labelPointStyle.call(t,n)),s.push(i.labelTextColor.call(t,n))})),t.labelColors=r,t.labelPointStyles=o,t.labelTextColors=s,t.dataPoints=l,l}update(e,t){const n=this,i=n.options.setContext(n.getContext()),r=n._active;let o,s=[];if(r.length){const e=Mo[i.position].call(n,r,n._eventPosition);s=n._createItems(i),n.title=n.getTitle(s,i),n.beforeBody=n.getBeforeBody(s,i),n.body=n.getBody(s,i),n.afterBody=n.getAfterBody(s,i),n.footer=n.getFooter(s,i);const t=n._size=Ao(n,i),a=Object.assign({},e,t),c=Do(n._chart,i,a),l=Ro(i,a,c,n._chart);n.xAlign=c.xAlign,n.yAlign=c.yAlign,o={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==n.opacity&&(o={opacity:0});n._tooltipItems=s,n.$context=void 0,o&&n._resolveAnimations().update(n,o),e&&i.external&&i.external.call(n,{chart:n._chart,tooltip:n,replay:t})}drawCaret(e,t,n,i){const r=this.getCaretPosition(e,n,i);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:r}=this,{cornerRadius:o,caretSize:s}=n,{x:a,y:c}=e,{width:l,height:u}=t;let h,d,f,p,g,m;return"center"===r?(g=c+u/2,"left"===i?(h=a,d=h-s,p=g+s,m=g-s):(h=a+l,d=h+s,p=g-s,m=g+s),f=h):(d="left"===i?a+o+s:"right"===i?a+l-o-s:this.caretX,"top"===r?(p=c,g=p-s,h=d-s,f=d+s):(p=c+u,g=p+s,h=d+s,f=d-s),m=p),{x1:h,x2:d,x3:f,y1:p,y2:g,y3:m}}drawTitle(e,t,n){const i=this,r=i.title,o=r.length;let s,a,c;if(o){const l=On(n.rtl,i.x,i.width);for(e.x=Lo(i,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",s=qt(n.titleFont),a=n.titleSpacing,t.fillStyle=n.titleColor,t.font=s.string,c=0;c<o;++c)t.fillText(r[c],l.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+a,c+1===o&&(e.y+=n.titleMarginBottom-a)}}_drawColorBox(e,t,n,i,r){const o=this,s=o.labelColors[n],a=o.labelPointStyles[n],{boxHeight:c,boxWidth:l}=r,u=qt(r.bodyFont),h=Lo(o,"left",r),d=i.x(h),f=c<u.lineHeight?(u.lineHeight-c)/2:0,p=t.y+f;if(r.usePointStyle){const t={radius:Math.min(l,c)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},n=i.leftForLtr(d,l)+l/2,o=p+c/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,Xe(e,t,n,o),e.strokeStyle=s.borderColor,e.fillStyle=s.backgroundColor,Xe(e,t,n,o)}else{e.lineWidth=s.borderWidth||1,e.strokeStyle=s.borderColor,e.setLineDash(s.borderDash||[]),e.lineDashOffset=s.borderDashOffset||0;const t=i.leftForLtr(d,l),n=i.leftForLtr(i.xPlus(d,1),l-2),o=jt(s.borderRadius);Object.values(o).some((e=>0!==e))?(e.beginPath(),e.fillStyle=r.multiKeyBackground,it(e,{x:t,y:p,w:l,h:c,radius:o}),e.fill(),e.stroke(),e.fillStyle=s.backgroundColor,e.beginPath(),it(e,{x:n,y:p+1,w:l-2,h:c-2,radius:o}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(t,p,l,c),e.strokeRect(t,p,l,c),e.fillStyle=s.backgroundColor,e.fillRect(n,p+1,l-2,c-2))}e.fillStyle=o.labelTextColors[n]}drawBody(e,t,n){const i=this,{body:r}=i,{bodySpacing:o,bodyAlign:s,displayColors:a,boxHeight:c,boxWidth:l}=n,u=qt(n.bodyFont);let h=u.lineHeight,d=0;const f=On(n.rtl,i.x,i.width),p=function(n){t.fillText(n,f.x(e.x+d),e.y+h/2),e.y+=h+o},g=f.textAlign(s);let m,y,x,b,v,w,_;for(t.textAlign=s,t.textBaseline="middle",t.font=u.string,e.x=Lo(i,g,n),t.fillStyle=n.bodyColor,Z(i.beforeBody,p),d=a&&"right"!==g?"center"===s?l/2+1:l+2:0,b=0,w=r.length;b<w;++b){for(m=r[b],y=i.labelTextColors[b],t.fillStyle=y,Z(m.before,p),x=m.lines,a&&x.length&&(i._drawColorBox(t,e,b,f,n),h=Math.max(u.lineHeight,c)),v=0,_=x.length;v<_;++v)p(x[v]),h=u.lineHeight;Z(m.after,p)}d=0,h=u.lineHeight,Z(i.afterBody,p),e.y-=o}drawFooter(e,t,n){const i=this,r=i.footer,o=r.length;let s,a;if(o){const c=On(n.rtl,i.x,i.width);for(e.x=Lo(i,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=c.textAlign(n.footerAlign),t.textBaseline="middle",s=qt(n.footerFont),t.fillStyle=n.footerColor,t.font=s.string,a=0;a<o;++a)t.fillText(r[a],c.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:r,yAlign:o}=this,{x:s,y:a}=e,{width:c,height:l}=n,u=i.cornerRadius;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(s+u,a),"top"===o&&this.drawCaret(e,t,n,i),t.lineTo(s+c-u,a),t.quadraticCurveTo(s+c,a,s+c,a+u),"center"===o&&"right"===r&&this.drawCaret(e,t,n,i),t.lineTo(s+c,a+l-u),t.quadraticCurveTo(s+c,a+l,s+c-u,a+l),"bottom"===o&&this.drawCaret(e,t,n,i),t.lineTo(s+u,a+l),t.quadraticCurveTo(s,a+l,s,a+l-u),"center"===o&&"left"===r&&this.drawCaret(e,t,n,i),t.lineTo(s,a+u),t.quadraticCurveTo(s,a,s+u,a),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this,n=t._chart,i=t.$animations,r=i&&i.x,o=i&&i.y;if(r||o){const i=Mo[e.position].call(t,t._active,t._eventPosition);if(!i)return;const s=t._size=Ao(t,e),a=Object.assign({},i,t._size),c=Do(n,e,a),l=Ro(e,a,c,n);r._to===l.x&&o._to===l.y||(t.xAlign=c.xAlign,t.yAlign=c.yAlign,t.width=s.width,t.height=s.height,t.caretX=i.x,t.caretY=i.y,t._resolveAnimations().update(t,l))}}draw(e){const t=this,n=t.options.setContext(t.getContext());let i=t.opacity;if(!i)return;t._updateAnimationTarget(n);const r={width:t.width,height:t.height},o={x:t.x,y:t.y};i=Math.abs(i)<.001?0:i;const s=It(n.padding),a=t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=i,t.drawBackground(o,e,r,n),Dn(e,n.textDirection),o.y+=s.top,t.drawTitle(o,e,n),t.drawBody(o,e,n),t.drawFooter(o,e,n),Rn(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this,i=n._active,r=e.map((({datasetIndex:e,index:t})=>{const i=n._chart.getDatasetMeta(e);if(!i)throw new Error("Cannot find a dataset at index "+e);return{datasetIndex:e,element:i.data[t],index:t}})),o=!ee(i,r),s=n._positionChanged(r,t);(o||s)&&(n._active=r,n._eventPosition=t,n.update(!0))}handleEvent(e,t){const n=this,i=n.options,r=n._active||[];let o=!1,s=[];"mouseout"!==e.type&&(s=n._chart.getElementsAtEventForMode(e,i.mode,i,t),i.reverse&&s.reverse());const a=n._positionChanged(s,e);return o=t||!ee(s,r)||a,o&&(n._active=s,(i.enabled||i.external)&&(n._eventPosition={x:e.x,y:e.y},n.update(!0,t))),o}_positionChanged(e,t){const{caretX:n,caretY:i,options:r}=this,o=Mo[r.position].call(this,e,t);return!1!==o&&(n!==o.x||i!==o.y)}}jo.positioners=Mo;var Io={id:"tooltip",_element:jo,positioners:Mo,afterInit(e,t,n){n&&(e.tooltip=new jo({_chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip,n={tooltip:t};!1!==e.notifyPlugins("beforeTooltipDraw",n)&&(t&&t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n))},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:G,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:G,beforeBody:G,beforeLabel:G,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return V(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:G,afterBody:G,beforeFooter:G,footer:G,afterFooter:G}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},qo=Object.freeze({__proto__:null,Decimation:Zr,Filler:xo,Legend:wo,SubTitle:ko,Title:So,Tooltip:Io});function Bo(e,t,n){const i=e.indexOf(t);if(-1===i)return((e,t,n)=>"string"==typeof t?e.push(t)-1:isNaN(t)?null:n)(e,t,n);return i!==e.lastIndexOf(t)?n:i}class zo extends Li{constructor(e){super(e),this._startValue=void 0,this._valueRange=0}parse(e,t){if(V(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:Ge(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:Bo(n,e,X(t,e)),n.length-1)}determineDataLimits(){const e=this,{minDefined:t,maxDefined:n}=e.getUserBounds();let{min:i,max:r}=e.getMinMax(!0);"ticks"===e.options.bounds&&(t||(i=0),n||(r=e.getLabels().length-1)),e.min=i,e.max=r}buildTicks(){const e=this,t=e.min,n=e.max,i=e.options.offset,r=[];let o=e.getLabels();o=0===t&&n===o.length-1?o:o.slice(t,n+1),e._valueRange=Math.max(o.length-(i?0:1),1),e._startValue=e.min-(i?.5:0);for(let e=t;e<=n;e++)r.push({value:e});return r}getLabelForValue(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}configure(){const e=this;super.configure(),e.isHorizontal()||(e._reversePixels=!e._reversePixels)}getPixelForValue(e){const t=this;return"number"!=typeof e&&(e=t.parse(e)),null===e?NaN:t.getPixelForDecimal((e-t._startValue)/t._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){const t=this;return Math.round(t._startValue+t.getDecimalForPixel(e)*t._valueRange)}getBasePixel(){return this.bottom}}function Go(e,t,{horizontal:n,minRotation:i}){const r=Le(i),o=(n?Math.sin(r):Math.cos(r))||.001,s=.75*t*(""+e).length;return Math.min(t/o,s)}zo.id="category",zo.defaults={ticks:{callback:zo.prototype.getLabelForValue}};class Ho extends Li{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return V(e)||("number"==typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const e=this,{beginAtZero:t}=e.options,{minDefined:n,maxDefined:i}=e.getUserBounds();let{min:r,max:o}=e;const s=e=>r=n?r:e,a=e=>o=i?o:e;if(t){const e=Ee(r),t=Ee(o);e<0&&t<0?a(0):e>0&&t>0&&s(0)}if(r===o){let e=1;(o>=Number.MAX_SAFE_INTEGER||r<=Number.MIN_SAFE_INTEGER)&&(e=Math.abs(.05*o)),a(o+e),t||s(r-e)}e.min=r,e.max=o}getTickLimit(){const e=this,t=e.options.ticks;let n,{maxTicksLimit:i,stepSize:r}=t;return r?n=Math.ceil(e.max/r)-Math.floor(e.min/r)+1:(n=e.computeTickLimit(),i=i||11),i&&(n=Math.min(i,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this,t=e.options,n=t.ticks;let i=e.getTickLimit();i=Math.max(2,i);const r=function(e,t){const n=[],{bounds:i,step:r,min:o,max:s,precision:a,count:c,maxTicks:l,maxDigits:u,includeBounds:h}=e,d=r||1,f=l-1,{min:p,max:g}=t,m=!V(o),y=!V(s),x=!V(c),b=(g-p)/(u+1);let v,w,_,S,C=Te((g-p)/f/d)*d;if(C<1e-14&&!m&&!y)return[{value:p},{value:g}];S=Math.ceil(g/C)-Math.floor(p/C),S>f&&(C=Te(S*C/f/d)*d),V(a)||(v=Math.pow(10,a),C=Math.ceil(C*v)/v),"ticks"===i?(w=Math.floor(p/C)*C,_=Math.ceil(g/C)*C):(w=p,_=g),m&&y&&r&&De((s-o)/r,C/1e3)?(S=Math.round(Math.min((s-o)/C,l)),C=(s-o)/S,w=o,_=s):x?(w=m?o:w,_=y?s:_,S=c-1,C=(_-w)/S):(S=(_-w)/C,S=Oe(S,Math.round(S),C/1e3)?Math.round(S):Math.ceil(S));const k=Math.max(Fe(C),Fe(w));v=Math.pow(10,V(a)?k:a),w=Math.round(w*v)/v,_=Math.round(_*v)/v;let M=0;for(m&&(h&&w!==o?(n.push({value:o}),w<o&&M++,Oe(Math.round((w+M*C)*v)/v,o,Go(o,b,e))&&M++):w<o&&M++);M<S;++M)n.push({value:Math.round((w+M*C)*v)/v});return y&&h&&_!==s?Oe(n[n.length-1].value,s,Go(s,b,e))?n[n.length-1].value=s:n.push({value:s}):y&&_!==s||n.push({value:_}),n}({maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:e._maxDigits(),horizontal:e.isHorizontal(),minRotation:n.minRotation||0,includeBounds:!1!==n.includeBounds},e._range||e);return"ticks"===t.bounds&&Re(r,e,"value"),t.reverse?(r.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),r}configure(){const e=this,t=e.ticks;let n=e.min,i=e.max;if(super.configure(),e.options.offset&&t.length){const e=(i-n)/Math.max(t.length-1,1)/2;n-=e,i+=e}e._startValue=n,e._endValue=i,e._valueRange=i-n}getLabelForValue(e){return An(e,this.chart.options.locale)}}class Vo extends Ho{determineDataLimits(){const e=this,{min:t,max:n}=e.getMinMax(!0);e.min=$(t)?t:0,e.max=$(n)?n:1,e.handleTickRangeOptions()}computeTickLimit(){const e=this,t=e.isHorizontal(),n=t?e.width:e.height,i=Le(e.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,o=e._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/r))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}function Wo(e){return 1===e/Math.pow(10,Math.floor(Me(e)))}Vo.id="linear",Vo.defaults={ticks:{callback:ki.formatters.numeric}};class Uo extends Li{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const n=Ho.prototype.parse.apply(this,[e,t]);if(0!==n)return $(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const e=this,{min:t,max:n}=e.getMinMax(!0);e.min=$(t)?Math.max(0,t):null,e.max=$(n)?Math.max(0,n):null,e.options.beginAtZero&&(e._zero=!0),e.handleTickRangeOptions()}handleTickRangeOptions(){const e=this,{minDefined:t,maxDefined:n}=e.getUserBounds();let i=e.min,r=e.max;const o=e=>i=t?i:e,s=e=>r=n?r:e,a=(e,t)=>Math.pow(10,Math.floor(Me(e))+t);i===r&&(i<=0?(o(1),s(10)):(o(a(i,-1)),s(a(r,1)))),i<=0&&o(a(r,-1)),r<=0&&s(a(i,1)),e._zero&&e.min!==e._suggestedMin&&i===a(e.min,0)&&o(a(i,-1)),e.min=i,e.max=r}buildTicks(){const e=this,t=e.options,n=function(e,t){const n=Math.floor(Me(t.max)),i=Math.ceil(t.max/Math.pow(10,n)),r=[];let o=Y(e.min,Math.pow(10,Math.floor(Me(t.min)))),s=Math.floor(Me(o)),a=Math.floor(o/Math.pow(10,s)),c=s<0?Math.pow(10,Math.abs(s)):1;do{r.push({value:o,major:Wo(o)}),++a,10===a&&(a=1,++s,c=s>=0?1:c),o=Math.round(a*Math.pow(10,s)*c)/c}while(s<n||s===n&&a<i);const l=Y(e.max,o);return r.push({value:l,major:Wo(o)}),r}({min:e._userMin,max:e._userMax},e);return"ticks"===t.bounds&&Re(n,e,"value"),t.reverse?(n.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),n}getLabelForValue(e){return void 0===e?"0":An(e,this.chart.options.locale)}configure(){const e=this,t=e.min;super.configure(),e._startValue=Me(t),e._valueRange=Me(e.max)-Me(t)}getPixelForValue(e){const t=this;return void 0!==e&&0!==e||(e=t.min),null===e||isNaN(e)?NaN:t.getPixelForDecimal(e===t.min?0:(Me(e)-t._startValue)/t._valueRange)}getValueForPixel(e){const t=this,n=t.getDecimalForPixel(e);return Math.pow(10,t._startValue+n*t._valueRange)}}function $o(e){const t=e.ticks;if(t.display&&e.display){const e=It(t.backdropPadding);return X(t.font&&t.font.size,ye.font.size)+e.height}return 0}function Yo(e,t,n,i,r){return e===i||e===r?{start:t-n/2,end:t+n/2}:e<i||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function Xo(e){const t={l:0,r:e.width,t:0,b:e.height-e.paddingTop},n={},i=[],r=[],o=e.getLabels().length;for(let l=0;l<o;l++){const o=e.options.pointLabels.setContext(e.getPointLabelContext(l));r[l]=o.padding;const u=e.getPointPosition(l,e.drawingArea+r[l]),h=qt(o.font),d=(s=e.ctx,a=h,c=W(c=e._pointLabels[l])?c:[c],{w:Ue(s,a.string,c),h:c.length*a.lineHeight});i[l]=d;const f=e.getIndexAngle(l),p=Ne(f),g=Yo(p,u.x,d.w,0,180),m=Yo(p,u.y,d.h,90,270);g.start<t.l&&(t.l=g.start,n.l=f),g.end>t.r&&(t.r=g.end,n.r=f),m.start<t.t&&(t.t=m.start,n.t=f),m.end>t.b&&(t.b=m.end,n.b=f)}var s,a,c;e._setReductions(e.drawingArea,t,n),e._pointLabelItems=function(e,t,n){const i=[],r=e.getLabels().length,o=e.options,s=$o(o),a=e.getDistanceFromCenterForValue(o.ticks.reverse?e.min:e.max);for(let o=0;o<r;o++){const r=0===o?s/2:0,c=e.getPointPosition(o,a+r+n[o]),l=Ne(e.getIndexAngle(o)),u=t[o],h=Qo(c.y,u.h,l),d=Jo(l),f=Ko(c.x,u.w,d);i.push({x:c.x,y:h,textAlign:d,left:f,top:h,right:f+u.w,bottom:h+u.h})}return i}(e,i,r)}function Jo(e){return 0===e||180===e?"center":e<180?"left":"right"}function Ko(e,t,n){return"right"===n?e-=t:"center"===n&&(e-=t/2),e}function Qo(e,t,n){return 90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t),e}function Zo(e,t,n,i){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,be);else{let n=e.getPointPosition(0,t);r.moveTo(n.x,n.y);for(let o=1;o<i;o++)n=e.getPointPosition(o,t),r.lineTo(n.x,n.y)}}function es(e){return Ae(e)?e:0}Uo.id="logarithmic",Uo.defaults={ticks:{callback:ki.formatters.logarithmic,major:{enabled:!0}}};class ts extends Ho{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this;e.width=e.maxWidth,e.height=e.maxHeight,e.paddingTop=$o(e.options)/2,e.xCenter=Math.floor(e.width/2),e.yCenter=Math.floor((e.height-e.paddingTop)/2),e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2}determineDataLimits(){const e=this,{min:t,max:n}=e.getMinMax(!1);e.min=$(t)&&!isNaN(t)?t:0,e.max=$(n)&&!isNaN(n)?n:0,e.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/$o(this.options))}generateTickLabels(e){const t=this;Ho.prototype.generateTickLabels.call(t,e),t._pointLabels=t.getLabels().map(((e,n)=>{const i=Q(t.options.pointLabels.callback,[e,n],t);return i||0===i?i:""}))}fit(){const e=this,t=e.options;t.display&&t.pointLabels.display?Xo(e):e.setCenterPoint(0,0,0,0)}_setReductions(e,t,n){const i=this;let r=t.l/Math.sin(n.l),o=Math.max(t.r-i.width,0)/Math.sin(n.r),s=-t.t/Math.cos(n.t),a=-Math.max(t.b-(i.height-i.paddingTop),0)/Math.cos(n.b);r=es(r),o=es(o),s=es(s),a=es(a),i.drawingArea=Math.max(e/2,Math.min(Math.floor(e-(r+o)/2),Math.floor(e-(s+a)/2))),i.setCenterPoint(r,o,s,a)}setCenterPoint(e,t,n,i){const r=this,o=r.width-t-r.drawingArea,s=e+r.drawingArea,a=n+r.drawingArea,c=r.height-r.paddingTop-i-r.drawingArea;r.xCenter=Math.floor((s+o)/2+r.left),r.yCenter=Math.floor((a+c)/2+r.top+r.paddingTop)}getIndexAngle(e){return Be(e*(be/this.getLabels().length)+Le(this.options.startAngle||0))}getDistanceFromCenterForValue(e){const t=this;if(V(e))return NaN;const n=t.drawingArea/(t.max-t.min);return t.options.reverse?(t.max-e)*n:(e-t.min)*n}getValueForDistanceFromCenter(e){if(V(e))return NaN;const t=this,n=e/(t.drawingArea/(t.max-t.min));return t.options.reverse?t.max-n:t.min+n}getPointLabelContext(e){const t=this,n=t._pointLabels||[];if(e>=0&&e<n.length){const i=n[e];return function(e,t,n){return Object.assign(Object.create(e),{label:n,index:t,type:"pointLabel"})}(t.getContext(),e,i)}}getPointPosition(e,t){const n=this,i=n.getIndexAngle(e)-Se;return{x:Math.cos(i)*t+n.xCenter,y:Math.sin(i)*t+n.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:n,right:i,bottom:r}=this._pointLabelItems[e];return{left:t,top:n,right:i,bottom:r}}drawBackground(){const e=this,{backgroundColor:t,grid:{circular:n}}=e.options;if(t){const i=e.ctx;i.save(),i.beginPath(),Zo(e,e.getDistanceFromCenterForValue(e._endValue),n,e.getLabels().length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const e=this,t=e.ctx,n=e.options,{angleLines:i,grid:r}=n,o=e.getLabels().length;let s,a,c;if(n.pointLabels.display&&function(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let r=t-1;r>=0;r--){const t=i.setContext(e.getPointLabelContext(r)),o=qt(t.font),{x:s,y:a,textAlign:c,left:l,top:u,right:h,bottom:d}=e._pointLabelItems[r],{backdropColor:f}=t;if(!V(f)){const e=It(t.backdropPadding);n.fillStyle=f,n.fillRect(l-e.left,u-e.top,h-l+e.width,d-u+e.height)}tt(n,e._pointLabels[r],s,a+o.lineHeight/2,o,{color:t.color,textAlign:c,textBaseline:"middle"})}}(e,o),r.display&&e.ticks.forEach(((t,n)=>{if(0!==n){a=e.getDistanceFromCenterForValue(t.value);const i=r.setContext(e.getContext(n-1));!function(e,t,n,i){const r=e.ctx,o=t.circular,{color:s,lineWidth:a}=t;!o&&!i||!s||!a||n<0||(r.save(),r.strokeStyle=s,r.lineWidth=a,r.setLineDash(t.borderDash),r.lineDashOffset=t.borderDashOffset,r.beginPath(),Zo(e,n,o,i),r.closePath(),r.stroke(),r.restore())}(e,i,a,o)}})),i.display){for(t.save(),s=e.getLabels().length-1;s>=0;s--){const r=i.setContext(e.getPointLabelContext(s)),{color:o,lineWidth:l}=r;l&&o&&(t.lineWidth=l,t.strokeStyle=o,t.setLineDash(r.borderDash),t.lineDashOffset=r.borderDashOffset,a=e.getDistanceFromCenterForValue(n.ticks.reverse?e.min:e.max),c=e.getPointPosition(s,a),t.beginPath(),t.moveTo(e.xCenter,e.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const e=this,t=e.ctx,n=e.options,i=n.ticks;if(!i.display)return;const r=e.getIndexAngle(0);let o,s;t.save(),t.translate(e.xCenter,e.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",e.ticks.forEach(((r,a)=>{if(0===a&&!n.reverse)return;const c=i.setContext(e.getContext(a)),l=qt(c.font);if(o=e.getDistanceFromCenterForValue(e.ticks[a].value),c.showLabelBackdrop){t.font=l.string,s=t.measureText(r.label).width,t.fillStyle=c.backdropColor;const e=It(c.backdropPadding);t.fillRect(-s/2-e.left,-o-l.size/2-e.top,s+e.width,l.size+e.height)}tt(t,r.label,0,-o,l,{color:c.color})})),t.restore()}drawTitle(){}}ts.id="radialLinear",ts.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ki.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5}},ts.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},ts.descriptors={angleLines:{_fallback:"grid"}};const ns={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},is=Object.keys(ns);function rs(e,t){return e-t}function os(e,t){if(V(t))return null;const n=e._adapter,{parser:i,round:r,isoWeekday:o}=e._parseOpts;let s=t;return"function"==typeof i&&(s=i(s)),$(s)||(s="string"==typeof i?n.parse(s,i):n.parse(s)),null===s?null:(r&&(s="week"!==r||!Ae(o)&&!0!==o?n.startOf(s,r):n.startOf(s,"isoWeek",o)),+s)}function ss(e,t,n,i){const r=is.length;for(let o=is.indexOf(e);o<r-1;++o){const e=ns[is[o]],r=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(r*e.size))<=i)return is[o]}return is[r-1]}function as(e,t,n){if(n){if(n.length){const{lo:i,hi:r}=rt(n,t);e[n[i]>=t?n[i]:n[r]]=!0}}else e[t]=!0}function cs(e,t,n){const i=[],r={},o=t.length;let s,a;for(s=0;s<o;++s)a=t[s],r[a]=s,i.push({value:a,major:!1});return 0!==o&&n?function(e,t,n,i){const r=e._adapter,o=+r.startOf(t[0].value,i),s=t[t.length-1].value;let a,c;for(a=o;a<=s;a=+r.add(a,1,i))c=n[a],c>=0&&(t[c].major=!0);return t}(e,i,r,n):i}class ls extends Li{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t){const n=e.time||(e.time={}),i=this._adapter=new lr._date(e.adapters.date);oe(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:os(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this,t=e.options,n=e._adapter,i=t.time.unit||"day";let{min:r,max:o,minDefined:s,maxDefined:a}=e.getUserBounds();function c(e){s||isNaN(e.min)||(r=Math.min(r,e.min)),a||isNaN(e.max)||(o=Math.max(o,e.max))}s&&a||(c(e._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||c(e.getMinMax(!1))),r=$(r)&&!isNaN(r)?r:+n.startOf(Date.now(),i),o=$(o)&&!isNaN(o)?o:+n.endOf(Date.now(),i)+1,e.min=Math.min(r,o-1),e.max=Math.max(r+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this,t=e.options,n=t.time,i=t.ticks,r="labels"===i.source?e.getLabelTimestamps():e._generate();"ticks"===t.bounds&&r.length&&(e.min=e._userMin||r[0],e.max=e._userMax||r[r.length-1]);const o=e.min,s=at(r,o,e.max);return e._unit=n.unit||(i.autoSkip?ss(n.minUnit,e.min,e.max,e._getLabelCapacity(o)):function(e,t,n,i,r){for(let o=is.length-1;o>=is.indexOf(n);o--){const n=is[o];if(ns[n].common&&e._adapter.diff(r,i,n)>=t-1)return n}return is[n?is.indexOf(n):0]}(e,s.length,n.minUnit,e.min,e.max)),e._majorUnit=i.major.enabled&&"year"!==e._unit?function(e){for(let t=is.indexOf(e)+1,n=is.length;t<n;++t)if(ns[is[t]].common)return is[t]}(e._unit):void 0,e.initOffsets(r),t.reverse&&s.reverse(),cs(e,s,e._majorUnit)}initOffsets(e){const t=this;let n,i,r=0,o=0;t.options.offset&&e.length&&(n=t.getDecimalForValue(e[0]),r=1===e.length?1-n:(t.getDecimalForValue(e[1])-n)/2,i=t.getDecimalForValue(e[e.length-1]),o=1===e.length?i:(i-t.getDecimalForValue(e[e.length-2]))/2);const s=e.length<3?.5:.25;r=Ge(r,0,s),o=Ge(o,0,s),t._offsets={start:r,end:o,factor:1/(r+1+o)}}_generate(){const e=this,t=e._adapter,n=e.min,i=e.max,r=e.options,o=r.time,s=o.unit||ss(o.minUnit,n,i,e._getLabelCapacity(n)),a=X(o.stepSize,1),c="week"===s&&o.isoWeekday,l=Ae(c)||!0===c,u={};let h,d,f=n;if(l&&(f=+t.startOf(f,"isoWeek",c)),f=+t.startOf(f,l?"day":s),t.diff(i,n,s)>1e5*a)throw new Error(n+" and "+i+" are too far apart with stepSize of "+a+" "+s);const p="data"===r.ticks.source&&e.getDataTimestamps();for(h=f,d=0;h<i;h=+t.add(h,a,s),d++)as(u,h,p);return h!==i&&"ticks"!==r.bounds&&1!==d||as(u,h,p),Object.keys(u).sort(((e,t)=>e-t)).map((e=>+e))}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}_tickFormatFunction(e,t,n,i){const r=this,o=r.options,s=o.time.displayFormats,a=r._unit,c=r._majorUnit,l=a&&s[a],u=c&&s[c],h=n[t],d=c&&u&&h&&h.major,f=r._adapter.format(e,i||(d?u:l)),p=o.ticks.callback;return p?Q(p,[f,t,n],r):f}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){const t=this;return null===e?NaN:(e-t.min)/(t.max-t.min)}getPixelForValue(e){const t=this,n=t._offsets,i=t.getDecimalForValue(e);return t.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(e){const t=this,n=t._offsets,i=t.getDecimalForPixel(e)/n.factor-n.end;return t.min+i*(t.max-t.min)}_getLabelSize(e){const t=this,n=t.options.ticks,i=t.ctx.measureText(e).width,r=Le(t.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(r),s=Math.sin(r),a=t._resolveTickFontOptions(0).size;return{w:i*o+a*s,h:i*s+a*o}}_getLabelCapacity(e){const t=this,n=t.options.time,i=n.displayFormats,r=i[n.unit]||i.millisecond,o=t._tickFormatFunction(e,0,cs(t,[e],t._majorUnit),r),s=t._getLabelSize(o),a=Math.floor(t.isHorizontal()?t.width/s.w:t.height/s.h)-1;return a>0?a:1}getDataTimestamps(){const e=this;let t,n,i=e._cache.data||[];if(i.length)return i;const r=e.getMatchingVisibleMetas();if(e._normalized&&r.length)return e._cache.data=r[0].controller.getAllParsedValues(e);for(t=0,n=r.length;t<n;++t)i=i.concat(r[t].controller.getAllParsedValues(e));return e._cache.data=e.normalize(i)}getLabelTimestamps(){const e=this,t=e._cache.labels||[];let n,i;if(t.length)return t;const r=e.getLabels();for(n=0,i=r.length;n<i;++n)t.push(os(e,r[n]));return e._cache.labels=e._normalized?t:e.normalize(t)}normalize(e){return ht(e.sort(rs))}}function us(e,t,n){let i,r,o,s,a=0,c=e.length-1;n?(t>=e[a].pos&&t<=e[c].pos&&({lo:a,hi:c}=ot(e,"pos",t)),({pos:i,time:o}=e[a]),({pos:r,time:s}=e[c])):(t>=e[a].time&&t<=e[c].time&&({lo:a,hi:c}=ot(e,"time",t)),({time:i,pos:o}=e[a]),({time:r,pos:s}=e[c]));const l=r-i;return l?o+(s-o)*(t-i)/l:o}ls.id="time",ls.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};class hs extends ls{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this,t=e._getTimestampsForTable(),n=e._table=e.buildLookupTable(t);e._minPos=us(n,e.min),e._tableRange=us(n,e.max)-e._minPos,super.initOffsets(t)}buildLookupTable(e){const{min:t,max:n}=this,i=[],r=[];let o,s,a,c,l;for(o=0,s=e.length;o<s;++o)c=e[o],c>=t&&c<=n&&i.push(c);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(o=0,s=i.length;o<s;++o)l=i[o+1],a=i[o-1],c=i[o],Math.round((l+a)/2)!==c&&r.push({time:c,pos:o/(s-1)});return r}_getTimestampsForTable(){const e=this;let t=e._cache.all||[];if(t.length)return t;const n=e.getDataTimestamps(),i=e.getLabelTimestamps();return t=n.length&&i.length?e.normalize(n.concat(i)):n.length?n:i,t=e._cache.all=t,t}getDecimalForValue(e){return(us(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this,n=t._offsets,i=t.getDecimalForPixel(e)/n.factor-n.end;return us(t._table,i*t._tableRange+t._minPos,!0)}}hs.id="timeseries",hs.defaults=ls.defaults;var ds=Object.freeze({__proto__:null,CategoryScale:zo,LinearScale:Vo,LogarithmicScale:Uo,RadialLinearScale:ts,TimeScale:ls,TimeSeriesScale:hs});return rr.register(kr,ds,Jr,qo),rr.helpers={...Gn},rr._adapters=lr,rr.Animation=ci,rr.Animations=ui,rr.animator=s,rr.controllers=Fi.controllers.items,rr.DatasetController=_i,rr.Element=Si,rr.elements=Jr,rr.Interaction=Ot,rr.layouts=en,rr.platforms=oi,rr.Scale=Li,rr.Ticks=ki,Object.assign(rr,kr,ds,Jr,qo,oi),rr.Chart=rr,"undefined"!=typeof window&&(window.Chart=rr),rr})),define("render/graph",["toxilibs/extlibs/chart-3.5.0"],(function(e){function t(t){!function(e,{title:t="Graph",data:n=[],function:i,maxValue:r,type:o,limit:s,height:a=200,width:c=350}){e.title=t,e.data=n,e.maxX=r,e.type=o,e.limit=s,e.height=a,e.width=c,i&&(e.data=i)}(this,t);let n=t.canvas[0].getContext("2d"),o=function({limit:e,xLabel:t,yLabel:n,beginAtZero:r=!0,displayLegend:o=!0}){let s="rgba(98, 104, 110, 0.7)",a="#bbc7d2";return{animation:!1,scales:{x:{ticks:{maxRotation:e?0:50,color:a,callback:i},grid:{color:s,zeroLineColor:s},title:{display:"string"==typeof t,text:t,color:a}},y:{beginAtZero:r,ticks:{color:a},grid:{color:s,zeroLineColor:s},title:{display:"string"==typeof n,text:n,color:a}}},plugins:{legend:{display:o,labels:{color:a}}}}}(t);"function"==typeof this.data&&function(e,t,n){e.data=function(e,{xMin:t=0,xMax:n=10,steps:i=100}){let r=[],o=(n-t)/i;for(let i=t;i<n;i+=o)r.push({x:i,y:e(i)});return r}(e.data,n),e.type=e.type||"line","line"===e.type&&(t.pointRadius=0);t.scales.x.grid.zeroLineColor="#FA0",t.scales.y.grid.zeroLineColor="#FA0";let i=t.scales.x.grid.color;function r(e){return 0===e.tick.value?"#FA0":i}t.scales.x.grid.color=r,t.scales.y.grid.color=r}(this,o,t);let s="line"===this.type,a="number"==typeof this.data[0];if(this.dataOptions={},"bar"===this.type){if(!a)throw new Error("Bar charts must have data formatted like : [23, 2, 4.5, 90, ...]");this.chartType="bar"}else a?(this.chartType="line",this.dataOptions.showLine=s):(this.chartType="scatter",this.dataOptions.showLine=s);o.maintainAspectRatio=!1,this.chart=new e(n,{type:this.chartType,data:r(this,this.dataOptions),options:o}),this.resize()}function n(e,t){let n=e[t];return"number"==typeof n?t:n.x}function i(e,t,n){if(n.length<3)return e;if("string"!=typeof n[0]&&0!==n[0]){let i=n[2].value-n[1].value;if(0===t&&e%i!=0)return"";if(t===n.length-1&&e%i!=0)return""}return e}function r(e,t=e.dataOptions){let{chartType:n}=e;return"bar"===n?function({data:e}){let t,n,i;"number"==typeof e[0]?(t=o(e),n=e,i="#FFF"):(t=[],n=[],i=[],e.forEach((function({label:e,value:r,backgroundColor:o="#FFF"}){t.push(e),n.push(r),i.push(o)})));return{labels:t,datasets:[{data:n,backgroundColor:i}]}}(e):"scatter"===n?function(e,{showLine:t}={}){let{data:n,title:i}=e;return{datasets:[{label:i,showLine:t,data:n,borderColor:"#FFF",backgroundColor:"rgba(255, 255, 255, 0.3)",lineTension:0}]}}(e,t):"line"===n?function(e,{showLine:t}={}){let{data:n,title:i,labels:r}=e;return{labels:r||o(n),datasets:[{label:i,data:n,showLine:t,borderColor:"#FFF",backgroundColor:"rgba(255, 255, 255, 0.3)",lineTension:0}]}}(e,t):null}function o(e){let t=[];for(let n=0;n<e.length;n++)t.push(n);return t}return t.prototype.resize=function({height:e=this.height,width:t=this.width}={}){this.height=e,this.width=t;let{style:n}=this.chart.canvas.parentNode;n.height=e,n.width=t},t.prototype.addValue=function(e,{decrementation:t}={}){let{chart:n}=this;var i,o;t&&(i=this.data,o=t,i.map((e=>(e.x-=o,e)))),this.data.push(e),this.limit&&this.data.length>this.limit&&(this.data=this.data.splice(this.data.length-this.limit)),n.data=r(this),n.update()},t.prototype.decrementValues=function(e){let{chart:t}=this;const i=e.x;e.x=0,this.data.map((function(e){return e.x-=i,e})),this.data.push(e),this.limit&&this.data.length>this.limit&&(this.data=this.data.splice(this.data.length-this.limit),t.options.scales.x.min=n(this.data,0)),t.data=r(this),t.options.scales.x.max=n(this.data,this.data.length-1),t.update()},t})),define("render/graph_api",["jquery","event_bus","toxilibs/object_utils","./dom_api","./graph"],(function(e,t,n,i,r){const{clone:o}=n;return function(t){const n=i(t);function s(t){t=o(t);const i=e("<canvas>");t.content=i;const s=n.addBox(t);t.canvas=i,"title"in t||(t.displayLegend=!1);return function(e,t){let n={update:function(n){!function(e,t,n){n.title&&(e.title=n.title);t.update(n)}(e,t,n)},addValue:function(t,n){e.addValue(t,n)},resize:function(t){e.resize(t)}};return t.addValue=n.addValue,t.resize=n.resize,t.updateGraph=n.update,t}(new r(t),s)}return{addGraph:s,addTimeGraph:function(e){let t=s(e),n=t.addValue,i=Date.now(),r=0,o=0;return t.addValue=function(e){r=(Date.now()-i)/1e3;let t=r-o;o=r,n({x:0,y:e},{decrementation:t})},t}}}})),define("toxilibs/toxicode_remote_challenge",["./url_params"],(function(e){function t(e,t,n){let i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}return{goToChallenge:function({url:t,token:n,returnUrl:i}){window.location=e.extendUrlWithParams(t,{token:n,returnUrl:i})},checkRemoteMode:function(){let{returnUrl:n,token:i,status:r}=e();return!(!i&&!n)&&(i?n?{token:i,returnUrl:n,status:r,goBack:function(e){!function({url:e,result:n,token:i}){let r=document.createElement("form");r.setAttribute("method","post"),r.setAttribute("action",e),t(r,"token",i),t(r,"result",n),document.body.appendChild(r),r.submit()}({url:n,result:e,token:i})}}:{error:"no return url has been provided"}:{error:"no token has been provided"})}}})),define("challenge/result",["toxilibs/toxicode_remote_challenge","logger"],(function(e,t){const n=e.checkRemoteMode();return n&&n.error&&console.error(n.error),n&&"success"===n.status&&t.log("Vous avez déjà validé ce challenge"),function(e){e?(t.error("Perdu !"),e.unitTest&&(t.log("Test : "),t.log(e.unitTest)),e.error?t.error(e.error):(t.success("Resultat demandé : "+e.expected),t.warn("Resultat obtenu : "+e.result))):(t.success("Gagné !"),n&&("success"===n.status?t.success("Mais vous aviez déjà validé ce challenge"):(t.success("Vous allez être redirigé vers les challenges..."),setTimeout((()=>{n.goBack("win")}),2e3))))}})),define("render/render_tests",["event_bus","user_code/test_suite","challenge/result"],(function(e,t,n){let i,r=console;function o(e){r.rawLog(`<span class="error">${e}</span>`)}e.on("terminal logger api ready",(e=>{i=e}));let s=!0;return t.hideFailDetails=function(){s=!1},function(e,a){return{createTestUi:function(e){s=!0,r===console&&i&&(r=i.terminal.tests),t.resetAll(),e(),r.clear(),r.log("\n------------------------ Testing..."),t.run((e=>{setTimeout((()=>function(e){let t=e.specs(),i=0;t.forEach((e=>{"failed"===e.status?(o("NO - "+e.fullName),e.failedExpectations.forEach((e=>{i+=1,s&&o("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+e.message.replace(/<jasmine\.(.*?)>/g,"$1"))}))):r.log("OK - "+e.fullName)})),0===i?n():o(`<br>--\x3e Total of ${i} error${i>1?"s":""}`)}(e)),150)}))}}}})),define("toxilibs/vector3d",[],(function(){function e(e,t,n){"number"==typeof e?(this.x=e,this.y=t,this.z=n):(this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z)}return e.prototype.isNull=function(){return 0===this.x&&0===this.y&&0===this.z},e.prototype.clone=function(){return new e(this.x,this.y,this.z)},e.prototype.plus=function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z)},e.prototype.minus=function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z)},e.prototype.multiply=function(t){return new e(this.x*t,this.y*t,this.z*t)},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},e.prototype.setLength=function(e){return this.multiply(e/this.length())},e.prototype.normalize=function(){return this.multiply(1/this.length())},e.prototype.dotProduct=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},e.prototype.projectOn=function(e){return e.multiply(this.dotProduct(e))},e.prototype.crossProduct=function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},e})),define("render/simple_3d_api",["toxilibs/vector3d","toxilibs/object_utils"],(function(e,t){const{clone:n}=t;return function({screenGroup:t}){let i,r,o,s={x:0,y:0,z:0};function a(){let t=new e(i,s),n=t.length,a=t.normalize();r=new e(a.y,-a.x,0),r=r.setLength(1/n),o=r.crossProduct(a),o=o.setLength(1/n)}function c(t){let n=new e(i,t),s=n.length;return{x:150*n.dotProduct(r)/s,y:150*n.dotProduct(o)/s}}function l(e){return e.map(c)}return{setCamera3d:function(e){i=e,a()},setTarget3d:function(e){s=e,a()},project3d:c,rotate3d:function(e,t){return{x:t[0][0]*e.x+t[0][1]*e.y+t[0][2]*e.z,y:t[1][0]*e.x+t[1][1]*e.y+t[1][2]*e.z,z:t[2][0]*e.x+t[2][1]*e.y+t[2][2]*e.z}},drawLines3d:function(e){(e=n(e)).points=l(e.points),t.addLines(e)},drawWireFrame3d:function(e){let i=l((e=n(e)).points),{links:r}=e;delete e.links,r.forEach((function(n){e.origin=i[n[0]],e.end=i[n[1]],t.addLine(e)}))}}}})),define("render/webcam",["user_code/handle_execution_error"],(function(e){const t=e("Explorers - webcam.js");return function(){function e(){return c()}let n,i;e.status="off";let r,o,s=[];function a({whenStarted:r,whenError:o}={}){n=document.createElement("video"),n.addEventListener("canplay",(function(){if("on"!==e.status){let t=n.videoWidth,i=n.videoHeight;isNaN(i)&&(i=3*t/4),n.setAttribute("width",t),n.setAttribute("height",i),e.status="on",s.forEach((e=>e())),s=[]}}),!1),e.status="init",navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){r&&s.push(r),i=e,n.srcObject=i,n.play()})).catch((function(n){e.status="error",t(new Error("Webcam - "+n)),o&&o(n)}))}function c(){return"off"!==e.status||r||a(),"on"===e.status?n:function(){if(!o){o=document.createElement("canvas"),o.width=4,o.height=3;let e=o.getContext("2d");e.fillStyle="black",e.fillRect(0,0,o.width,o.height)}return o}()}return e.getImage=c,e.play=a,e.stop=function(){e.status="off",r=!0,i.getTracks().forEach((e=>e.stop()))},e}})),define("render/video",["user_code/handle_execution_error"],(function(e){const t=e("Explorers - video.js");return function(e){function n(){return l()}n.status="off";const i=document.createElement("video");let r;i.crossOrigin="Anonymous",i.src=e,i.addEventListener("canplay",(()=>{r=!0,i.muted=!0,i.width=i.videoWidth,i.height=i.videoHeight}));let o,s,a=[];function c({whenStarted:o,whenError:s}={}){n.status="init",i.addEventListener("error",(()=>{let r;r=i.networkState===HTMLMediaElement.NETWORK_NO_SOURCE?new Error("Video - could not load url "+e):new Error("Video - "+i.error.message),n.status="error",t(r),s&&s(r)})),o&&a.push(o),i.addEventListener("timeupdate",(function(){"on"!==n.status&&(n.status="on",a.forEach((e=>e())),a=[])}),!1),r?i.play():i.addEventListener("canplay",(()=>i.play()))}function l(){return"off"!==n.status||o||c(),"on"===n.status?i:function(){if(!s){s=document.createElement("canvas"),s.width=4,s.height=3;let e=s.getContext("2d");e.fillStyle="black",e.fillRect(0,0,s.width,s.height)}return s}()}return n.getImage=l,n.play=c,n.pause=function(){o=!0,i.pause()},n}})),define("render/imagine",["event_bus","toxilibs/url_params","toxilibs/random","toxilibs/screen_image","user_code/handle_execution_error","user_code/pause","user_code/http","logger"],(function(e,t,n,i,r,o,s,a){const{urlFor:c,httpPostForImage:l,fetchImageSource:u}=s,h=r("Explorers - imagine.js"),{pushStateRemove:d}=t,f=t();let p,g,m,y=!1;e.on("renderView shown",(e=>{p=e,y&&setTimeout((()=>{L({},e)}),300)}));let x=1e3,b=Date.now()-x;const v={A:{suffix:", intricate, elegant, highly detailed, digital painting, artstation, concept art, smooth, sharp focus, illustration, art by artgerm and Greg Rutkowski and Alphonse Mucha, 8k",guidance:13,steps:150},B:{suffix:", artstation, elegant, highly detailed, digital painting, concept art, smooth, sharp focus, illustration, art by Studio Ghibli, Fujita Goro, Atey Ghailan, Tom Whalen, Jean Giraud 8k",guidance:13,steps:150},C:{suffix:", artstation, elegant, highly detailed, digital painting, concept art, smooth, sharp focus, illustration, art by Don Bluth and Michel Ocelot and Makoto Shinkai and Tom Whalen and Atey Ghailan and Akihiko Yoshida",guidance:13,steps:150},D:{suffix:", path traced,  highly detailed, high quality, digital painting, alena aenami, lilia alvarado, shinji aramaki, karol bak, alphonse mucha, tom bagshaw",guidance:14,steps:150},E:{suffix:", behance hd by jesper ejsing, by rhads, makoto shinkai and lois van baarle, ilya kuvshinov, rossdraws global illumination",guidance:13,steps:150}};if("imagineServer"in f){const{imagineServer:e}=f;!0===e||"true"===e?y=!0:S(e),d("imagineServer"),delete f.imagineServer}async function w(e,{renderView:t=p,noUi:n}={}){return g||function(){if(g=localStorage.imagineServer,g){let e=new URL(g);g=C(e)}m=localStorage.imagineToken}(),g||n||await L({},t),g||O({message:'"imagine" server adress is not set',renderView:t,noUi:n}),g+e}function _({url:e,token:t},{renderView:n=p,noUi:i}={}){e?S(e):O({message:"Server undefined",renderView:n,noUi:i}),t&&(m=t,localStorage.imagineToken=t)}function S(e){const t=(e=new URL(e)).searchParams.get("token");t&&(m=t,localStorage.imagineToken=t),g=C(e),localStorage.imagineServer=g}function C(e){return(e.origin+e.pathname).replace(/\/$/,"")}"imagineToken"in f&&(localStorage.imagineToken=f.imagineToken,d("imagineToken"),delete f.imagineToken);const k=/\[style-(.*?)\]/g;async function M({prompt:e,steps:t=30,seed:n,guidance:r=7,width:o=512,height:s=512,imageGuide:c,strength:l,maskForBlend:u,maskBlur:h=10,returnChangesOnly:d=!1,style:f,noUi:g=!1,mock:y,url:_},S=p){let C,M=Date.now();M<b+x&&O({message:"Imagine request made less than 1000ms ago",renderView:S,noUi:g}),b=M,c&&!u&&o<512&&s<512&&O({message:"image guide must be at least 512px in width or in height",renderView:S,noUi:g});let R=await D(c),L=e;!function({prompt:e,imageGuide:t,maskForBlend:n,steps:i,guidance:r,strength:o,maskBlur:s,seed:c,styleName:l}){a.log("=> prompt:   "+e),l&&a.log("   style:    "+l);c&&a.log("   seed:     "+c);a.log("   steps:    "+i),a.log("   guidance: "+r),t&&(n?a.log("   image guide + mask and maskBlur: "+s):a.log("   image guide with prompt strength: "+o))}({prompt:e,imageGuide:c,maskForBlend:u,guidance:r,steps:t,seed:n,styleName:f,strength:l,maskBlur:h});let N=[];if(e=e.replace(k,((e,t)=>{N.push(t);let n=v[t];return n?n.suffix:""})),f){let t=v[f];t&&(e+=t.suffix)}o%64!=0&&O({message:"Imagine width should be a multiple of 64",renderView:S,noUi:g}),s%64!=0&&O({message:"Imagine height should be a multiple of 64",renderView:S,noUi:g});const F={prompt:e,steps:t,seed:n,guidance:r,imageGuide:R,strength:l,width:o,height:s,samples:1,maskForBlend:u,maskBlur:h,returnChangesOnly:d};_=_||await w("/run"),m&&(F.token=m);let j=Date.now();if(P({renderView:S,noUi:g}),C=y?await E():await T({url:_,params:F},{renderView:S,noUi:g}),A({renderView:S,noUi:g}),!C)return{};n=C.seed;let I=Date.now()-j;a.log("Time : "+Math.round(I/10)/100+"s");const q={prompt:L,guidance:r,steps:t,seed:n};f&&(q.style=f),C.imagineParams=q;const B=new i({source:C});return B.imagineParams=q,{imageSource:C,image:B,params:q}}async function E(){await o(500);let e=n.pick("medieval_old_king-SpzlcIXf.png","kitchen-B1ARB7q2.png"),t=await u(c(e));return t.seed=345,t}async function T({url:e,params:t},{renderView:n,noUi:i}){let r;try{r=await l({url:e,params:t})}catch(e){return O({message:e.message,renderView:n,noUi:i}),null}const{headers:s}=r;let c=s["imagine-error"]||s["diffusion-error"];c&&O({message:c,renderView:n,noUi:i});const u=s["imagine-seed"]||s["diffusion-seed"];u&&a.log("seed : "+u);const h=s["imagine-taskid"]||s["diffusion-taskid"];if(h){const e=s["imagine-fileid"]||s["diffusion-fileid"];a.log("job id : "+h),r=await async function(e){let t=null,n=4e3;for(;!t;)await o(n),a.log("checking queue..."),t=await R(e),n=2e3;return t}({taskId:h,fileId:e})}return r.seed=u,r}function P({renderView:e,noUi:t}){if(!t){const{storageForThisLaunch:t,api:n}=e;t.imagineSpinner=n.ui.addSpinner()}}function A({renderView:e,noUi:t}){if(!t){const{storageForThisLaunch:t}=e,{imagineSpinner:n}=t;n&&(n.remove(),delete t.imagineSpinner)}}function O({message:e,renderView:t,noUi:n}){let i=new Error(e);n&&h(i);const{api:r,storageForThisLaunch:o}=t;e=function(e){if("job too long for a guest"===e)return'Job too long to process (as a guest user).<br>Try reducing image size or number of steps.<br>Or you can host your own server to have no limits :<br>see <a href="https://explorers.toxicode.fr/imagine_faq.html">this faq</a>';if("job too soon for a guest"===e)return"Your last request was too recent.<br>Retry in a few seconds";if("quota expired"===e)return'Your quota expired.<br>You should consider hosting your own server<br>and using it with this interface :<br>see <a href="https://explorers.toxicode.fr/imagine_faq.html">this faq</a>';if("unauthenticated"===e)return"You need to have a token to be able to run this";return e}(e),r.ui.showPopup({title:"Error !",content:e});const{imagineSpinner:s}=o;s&&(s.remove(),delete o.imagineSpinner),h(i)}async function D(e){if(e)return e instanceof Blob?e:e.originalBlob?e.originalBlob:(e.cachedBlob||("toBlob"in e?e.cachedBlob=await e.toBlob():(e=new i({source:e})).cachedBlob=await e.toBlob()),e.cachedBlob)}async function R({taskId:e,fileId:t}){try{let n=await w("/result?taskId="+e+"&fileId="+t);return await u(n)}catch(e){return!1}}async function L({whenClosed:e}={},t=p){await t.api.ui.showForm({fields:{url:{label:"Paste your Imagine server url here :",type:"text",value:localStorage.imagineServer},token:{label:"Access token (if you have one) :",type:"text",value:localStorage.imagineToken||""}},whenReplied:e=>_(e,{renderView:t}),whenClosed:e})}return function(e){return{generateImage:t=>M(t,e),inpaint:t=>async function({image:e,noUi:t=!1,mock:n,url:i},r=p){i=i||await w("/inpaint");let o,s={file:await D(e)};return m&&(s.token=m),a.log("=> inpainting"),P({renderView:r,noUi:t}),o=n?await E():await T({url:i,params:s},{renderView:r,noUi:t}),A({renderView:r,noUi:t}),{imageSource:o}}(t,e),openServerConfig:t=>L(t,e),setServer:t=>_(t,{renderView:e})}}})),define("toxilibs/handle_system",["./screen_group"],(function(e){function t({snap:e,whenDragStarted:t=(()=>{}),whenDragEnded:n=(()=>{})}){this.snap=e,this.whenDragStarted=t,this.whenDragEnded=n,this.handlers=[]}t.prototype.addShapes=function(e){e.forEach((e=>this.addShape(e)))},t.prototype.addShape=function(e){const t=new i({system:this,shape:e});this.handlers.push(t),n(this)},t.prototype.setKeepRatioMode=function(e){this.keepRatio=e};function n(e){const{screenGroup:t,handlers:n}=e;t.reset(),n.forEach((n=>{n.addShapeToScreenGroup(t),n===e.currentHandler&&n.addHandlesToScreenGroup(t)}))}function i({system:e,shape:t}){this.system=e,this.shape=t,this.handles={},d.forEach((e=>{const t=new s({position:e,parent:this});this.handles[e]=t})),c(this)}function r(e){const{drawShapeParams:t,shape:n}=e;if(!t)return;const{width:i,height:r,orientation:o}=n;t.forEach((e=>{e.width=i,e.height=r,e.orientation=o}))}function o(e){e.shapeBeforeDrag=Object.assign({},e.shape),e.shapeBeforeDrag.center=Object.assign({},e.shape.center)}function s({position:e,parent:t}){this.parent=t,this.shape=t.shape,this.coefs=h[e],"orientation"===e&&(this.drag=a)}t.prototype.snapOrientations=function(e){!0===e&&(e=45),this.snapOrientationsValue=e},t.prototype.createScreenGroup=function(){return this.screenGroup=new e({dynamic:!0}),n(this),this.screenGroup},t.prototype.plugToHybridScreen=function(e){e.when("mouseButtonPressed",((e,t)=>this.triggerMouseButtonPressed(e,t))),e.when("mouseMoved",((e,t)=>this.moveCurrentHandle(e,t))),e.when("mouseButtonReleased",(()=>this.stopDrag()))},t.prototype.triggerMouseButtonPressed=function(e,t){const i=this.screenGroup.shapesAt({x:e,y:t});i&&i.forEach((({handler:i,target:r})=>{i!==this.currentHandler&&(this.currentHandler=i,n(this)),this.dragging=!0,i.startDrag(e,t,r)}))},t.prototype.moveCurrentHandle=function(e,t){this.dragging&&this.currentHandler.moveCurrentHandle(e,t)},t.prototype.stopDrag=function(){this.currentHandler&&(this.currentHandler.stopDrag(),delete this.dragging,this.whenDragEnded())},t.prototype.export=function(){let e=[];return this.handlers.forEach((({shape:t})=>{const{id:n,center:i,width:r,height:o,orientation:s}=t,{x:a,y:c}=i;e.push({id:n,center:{x:a,y:c},width:r,height:o,orientation:s})})),e},i.prototype.addShapeToScreenGroup=function(e){const{shape:t}=this,{image:n}=t;this.drawShapeParams=n?[{image:n,center:t.center,watch:!0},{handler:this,target:t,center:t.center,watch:!0,strokeColor:"white"}]:[{handler:this,target:t,center:t.center,watch:!0,strokeColor:"white",fillColor:"rgba(255, 255, 255, 0.2)"}],r(this),n?(e.addImage(this.drawShapeParams[0]),e.addRectangle(this.drawShapeParams[1])):e.addRectangle(this.drawShapeParams[0]),e.addText({text:t.id||"shape",center:t.center,font:"20px serif",color:"white"})},i.prototype.addHandlesToScreenGroup=function(e){const{handles:t}=this;for(let n in t){const i=t[n];e.addCircle({handler:this,target:i,center:i,radius:.2,fillColor:"#da9540",strokeColor:"#292B36",watch:!0})}},i.prototype.startDrag=function(e,t,n){this.dragStartedAt={x:e,y:t},n instanceof s?(this.currentHandle=n,n.startDrag()):this.currentHandle||o(this),this.system.whenDragStarted()},i.prototype.moveCurrentHandle=function(e,t){const{dragStartedAt:n}=this;if(n){const i=e-n.x,r=t-n.y;this.currentHandle?this.currentHandle.drag(i,r):function(e,t,n){const{shape:i,shapeBeforeDrag:r,system:o}=e,{snap:s}=o,{center:a}=r;let{x:l,y:h}=a;if(s){const e=s(a);l=e.x,h=e.y}let d=l+t,f=h+n;if(s){const e=s({x:d,y:f});d=e.x,f=e.y}i.center.x=u(d),i.center.y=u(f),c(e)}(this,i,r)}},i.prototype.stopDrag=function(){const{whenChanged:e}=this.shape;e&&e(this.shape),delete this.currentHandle,delete this.dragStartedAt},s.prototype.startDrag=function(){this.coordsBeforeDrag={x:this.x,y:this.y},o(this.parent)},s.prototype.drag=function(e,t){const{cosOrientation:n=1,sinOrientation:i=0,shape:r,shapeBeforeDrag:o,system:s}=this.parent,{keepRatio:a,snap:l}=s;if(l){let{x:n,y:i}=this.coordsBeforeDrag;const r=l({x:n+e,y:i+t});e=r.x-n,t=r.y-i}let h=e*n+t*i,d=-e*i+t*n,[f,p,g,m]=this.coefs;if(f&&(r.width=o.width+h*f,!p&&a&&(r.height=r.width*o.height/o.width)),p&&(r.height=o.height+d*p,!f&&a&&(r.width=r.height*o.width/o.height)),f&&p&&a){let e=o.width/o.height;r.height=Math.min(r.height,r.width/e),r.width=Math.min(r.width,r.height*e),h=(r.width-o.width)/f,d=(r.height-o.height)/p}r.width=u(r.width),r.height=u(r.height),function(e,t,n){const{shapeBeforeDrag:i,shape:r,cosOrientation:o=1,sinOrientation:s=0}=e;let{x:a,y:c}=i.center;a+=o*(t/2)-s*(n/2),c+=s*(t/2)+o*(n/2),r.center.x=u(a),r.center.y=u(c)}(this.parent,h*g,d*m),c(this.parent)};function a(e,t){const{shape:n,system:i}=this.parent,{snapOrientationsValue:r}=i;let{x:o,y:s}=this.coordsBeforeDrag,a=Math.atan2(s+t-n.center.y,o+e-n.center.x)/l;r&&(a=Math.round(a/r)*r),n.orientation=Math.round(100*(a-90))/100,c(this.parent)}function c(e){!function(e){const{orientation:t}=e.shape;if(t){const n=t*l;e.cosOrientation=Math.cos(n),e.sinOrientation=Math.sin(n)}else e.cosOrientation&&(delete e.cosOrientation,delete e.sinOrientation)}(e),r(e);const{handles:t,shape:n,cosOrientation:i=1,sinOrientation:o=0}=e,{x:s,y:a}=n.center,c=n.height/2,u=n.width/2,h=i*u,d=o*u,f=-o*c,p=i*c,{left:g,right:m,top:y,bottom:x,topLeft:b,topRight:v,bottomLeft:w,bottomRight:_,orientation:S}=t;g.x=s-h,g.y=a-d,m.x=s+h,m.y=a+d,y.x=s+f,y.y=a+p,x.x=s-f,x.y=a-p,b.x=s-h+f,b.y=a-d+p,v.x=s+h+f,v.y=a+d+p,w.x=s-h-f,w.y=a-d-p,_.x=s+h-f,_.y=a+d-p,S.x=s+2*f,S.y=a+2*p}const l=Math.PI/180;function u(e){return Number(e.toPrecision(10))}const h={left:[-1,0,1,0],right:[1,0,1,0],top:[0,1,0,1],bottom:[0,-1,0,1],topLeft:[-1,1,1,1],topRight:[1,1,1,1],bottomLeft:[-1,-1,1,1],bottomRight:[1,-1,1,1]},d=[...Object.keys(h),"orientation"];return t})),define("render/render_api",["user_code/api_manager","user_code/executable_api","user_code/handle_execution_error","toxilibs/event_capabilities_queued","toxilibs/auto_dimensions","./dom_api","./graph_api","./render_tests","./simple_3d_api","./font_awesome_codes","./hybrid_screen","./webcam","./video","./imagine","editor/snippet_tools","toxilibs/handle_system"],(function(e,t,n,i,r,o,s,a,c,l,u,h,d,f,p,g,m){const{addMethodSnippet:y}=p,x=n("Explorers - render_api.js"),b=["screen","screenGroup","toImageData","isEmpty","adaptSizeTo","mouseEventToCoords","mouseEventToSmartTrimmedCoords","smartTrimCoords","onCameraMoved","on"];function v(e){const{hybridScreen:t}=e;return"generic render"===e.name&&(_(t),t.when._snippet="when('${1}', ${2})",function(e){for(let t in e){const n=e[t];"function"!=typeof n&&"object"!=typeof n&&delete e[t]}}(t),b.forEach((e=>{t[e]._hidden=!0}))),t}const w={addCircle:{center:{x:0,y:0},radius:1,fillColor:"'white'"},addGrid:{color:"'grey'",step:1},addRectangle:{center:{x:0,y:0},width:1,height:1,fillColor:"'white'"},addLine:{origin:{x:0,y:0},end:{x:1,y:1},color:"'white'"},addCurve:{points:"[]",strokeColor:"'white'"},addPolygon:{points:"[]",strokeColor:"'white'"},addGroup:{group:"",x:0,y:0},addText:{text:"'Explorers'",center:{x:0,y:0},font:"'2u Nasalization'",color:"'white'"},addIcon:{name:"'heart'",center:{x:0,y:0},size:1,color:"'white'"},addImage:{image:"''",center:{x:0,y:0},width:5},addArrow:{origin:{x:0,y:0},vector:{x:1,y:1},strokeColor:"'white'"},setCamera:{center:{x:0,y:0},scale:10},zoom:2,rotate:20,generateImage:{prompt:"'astronaut on an alien planet'",guidance:7,steps:20,seed:"false"}};function _(e){for(let t in e){let n=w[t];n?y(e[t],t,n):t.startsWith("add")&&(e[t]._snippet=t+"({\n\t${1}\n})")}}function S(e){return'<i class="fas">'+l[e]+"</i>"}function C(...e){return new g(...e)}S.list=Object.keys(l);let k=1;function M(e){const{center:t,widthInPixels:n=200,heightInPixels:i=200}=e;let o;try{o=n/r({width:e.width,height:e.height,sourceWidth:n,sourceHeight:i,preventConflict:!0}).width}catch(e){const t=new Error("Mismatched dimensions : you should specify only width or height... or they should have the same ratio as the pixel dimensions");t.toxiTrace=t.toxiTrace||[],t.toxiTrace.unshift("Explorers - render_api.js - createScreen"),x(t)}const s=window.document.createElement("canvas");s.width=n,s.height=i;const a=new u({name:"screen_"+k,canvas:s,directScreenMode:!0});return k+=1,a.setCamera({center:t,scale:o}),a}return function(n){const r=Object.assign({},o(n),s(n)),{name:l}=n,u=f(n);"generic render"===n.name&&_(u);const p={};i(p);return e({namespace:l,include:[{when:(...e)=>p.when(...e),send:(...e)=>p.emit(...e)},t(n),n.timers,c(n),a(n,r),{ui:r,imagine:u,icon:S,createHandleSystem:C,webcam:h(),createVideo:d,createScreen:M,screen:v(n),hideMouse:()=>{n.hideMouse()},showMouse:()=>{n.showMouse()},directScreenModeApi:()=>(n.disableMouseDrag(),n.disableMouseZoom(),n.setDirectScreenMode(!0),v(n))}],onDestroy:()=>{p.removeAllListeners()}})}})),define("render/render_view_mouse_events",["event_bus","toxilibs/topleft_and_pivot"],(function(e,t){const{containsPositionParam:n}=t;function i(e,t,n,i){const{screenGroup:r}=e.hybridScreen;r&&r.triggerCoordMethodOnShapes(t,n,i)}function r(e,{x:t,y:n,outOfScreen:i}){const{screenGroup:r}=e.hybridScreen;if(!r)return;let o=!i&&r.shapesAt({x:t,y:n})||[];const{lastHovered:s}=e.mouse;s[0]!==o[0]&&(s.forEach((e=>{const{whenMouseMovedOut:i}=e;i&&!o.includes(e)&&i(t,n,e)})),o.forEach((e=>{const{whenMouseMovedIn:i}=e;i&&!s.includes(e)&&i(t,n,e)}))),r.triggerCoordMethodOnShapes("whenMouseMoved",t,n),e.mouse.lastHovered=o}function o(e,{x:t,y:n}){const{dragData:i}=e.storageForThisLaunch;if(i){const{shape:r,objectToMove:o,xMouseStart:s,yMouseStart:a,xOrigin:c,yOrigin:l,positionParam:u}=i;let h;h="root"===u?o:o[u],h.x=c+t,h.y=l+n,r.whenDragged&&r.whenDragged(t-s,n-a,r),e.forceRender()}}function s(e,t,{x:n,y:i,button:r}){t.x=n,t.y=i,t.button=r,t.time=(Date.now()-e.executedAt)/1e3}return{initMouseProperties:function(e){const t={x:1/0,y:1/0,lastClick:{x:1/0,y:1/0,time:-1/0},lastPress:{x:1/0,y:1/0,time:-1/0},lastRelease:{x:1/0,y:1/0,time:-1/0}};Object.defineProperty(t,"lastHovered",{value:[],writable:!0,enumerable:!1}),e.mouse=t},addMouseEventsMethods:function(t){t.prototype.mouseMoved=function(t){const{mouse:n,hybridScreen:i}=this;let{x:s,y:a}=i.mouseEventToSmartTrimmedCoords(t);n.x=s,n.y=a,o(this,{x:s,y:a}),r(this,{x:s,y:a}),e.emit("mouse moved on screen",{renderView:this,event:t,x:s,y:a}),i.emit("mouseMoved",s,a)},t.prototype.mouseMovedOut=function(e){const{x:t,y:n}=this.hybridScreen.mouseEventToSmartTrimmedCoords(e);r(this,{x:t,y:n,outOfScreen:!0})},t.prototype.mouseButtonPressed=function(e,{button:t}){const{mouse:i,hybridScreen:r}=this,{x:o,y:a}=r.mouseEventToSmartTrimmedCoords(e);i.pressed=!0,s(this,i.lastPress,{x:o,y:a,button:t});const c=function(e,{x:t,y:n}){const{screenGroup:i}=e.hybridScreen;if(!i)return null;return i.shapesAt({x:t,y:n})}(this,{x:o,y:a});!function(e,{shapes:t,x:i,y:r}){if(!t)return;let o=t&&t.findLast((e=>e.draggable));if(o){let t,s=n(o),a=o;if(s?t=o[s]:o.image?(s=n(o.image),a=o.image,t=o.image[s]):"x"in o&&"y"in o&&(s="root",t=o),!s)throw new Error("can not drag shape without position param");e.storageForThisLaunch.dragData={shape:o,objectToMove:a,positionParam:s,xMouseStart:i,yMouseStart:r,xOrigin:t.x-i,yOrigin:t.y-r,globalDragWasOn:e.mouseDragEnabled},e.mouseDragEnabled&&e.disableMouseDrag()}}(this,{shapes:c,x:o,y:a}),function(e,{shapes:t,x:n,y:i}){t&&t.forEach((e=>{"whenMouseButtonPressed"in e&&e.whenMouseButtonPressed(n,i,e)}))}(0,{shapes:c,x:o,y:a}),r.emit("mouseButtonPressed",o,a,t),r.emit(t+"MouseButtonPressed",o,a,t)},t.prototype.mouseButtonReleased=function(e,{button:t}){const{mouse:n,hybridScreen:r}=this,{x:a,y:c}=r.mouseEventToSmartTrimmedCoords(e);n.pressed=!1,s(this,n.lastRelease,{x:a,y:c,button:t}),function(e,{x:t,y:n}){o(e,{x:t,y:n});const{storageForThisLaunch:i}=e,{dragData:r}=i;if(r){const{globalDragWasOn:t}=r;t&&e.enableMouseDrag(),delete i.dragData}}(this,{x:a,y:c}),i(this,"whenMouseButtonReleased",a,c),r.emit("mouseButtonReleased",a,c,t),r.emit(t+"MouseButtonReleased",a,c,t)},t.prototype.mouseClicked=function(t,{button:n}){const{mouse:r,hybridScreen:o}=this,{x:a,y:c}=o.mouseEventToSmartTrimmedCoords(t);s(this,r.lastClick,{x:a,y:c,button:n}),e.emit("mouse clicked on screen",{renderView:this,event:t,x:a,y:c,button:n}),i(this,"whenClicked",a,c),o.emit("clicked",a,c,n),o.emit(n+"Clicked",a,c,n)}}}})),define("render/render_view",["event_bus","jquery","toxilibs/alias","./hybrid_screen","./render_api","./render_view_mouse_events"],(function(e,t,n,i,r,o){let s;e.on("app initialized",(e=>{s=e.workspaceId}));const{initMouseProperties:a,addMouseEventsMethods:c}=o;e.on("page ready",(function(){const n=new u({name:"generic render",document:null,container:t("#render_layers")});n.alwaysHidden=!0;let{api:i}=n;e.emit("render api ready",i)}));const l=[];function u({name:n,document:o,container:c,backgroundContainer:u,editorContent:d,cameraControl:p}){var g;this.name=n,this.fullId=`${s}:${n}`,this.storageForThisLaunch={},this.cameraControl=p,a(this),this.mouseDragEnabled=!0,this.mouseZoomEnabled=!0,this.mouseCursorHidden=!1,this.container=c,this.backgroundContainer=u,this.$background=t('<div class="background_parent">'),h(this),function(e){const{container:t}=e,n=t.find(".helper_canvas")[0];if(!n)return;e.helperScreen=new i({name:"helper screen",canvas:n}),e.helperScreen.adaptSizeTo(t)}(this),function(t){function n(){t.resize()}e.on("workspace resized",n)}(this),this.displayed=!1,this.editorContent=d,(g=this).$ui=t('<div class="ui_parent">'),g.$ui.hide(),t("#render_ui").append(g.$ui),o&&f?(f(this,{beforeExecutionStarted:e.emitter("render execution about to start"),onExecutionStarted:e.emitter("render execution started"),onExecutionStopped:e.emitter("render execution stopped")}),this.document=o):(this.start=()=>{},this.restart=()=>{},this.stop=()=>{});let{api:m,destroy:y}=r(this);this.api=m,this.destroyApi=y,l.forEach((e=>e(this)))}e.on("renderView add-on added",(e=>l.push(e))),c(u),u.prototype.updateParams=function({editorContent:e=null}){null!==e&&(this.editorContent=e,this.displayed&&g.setContent(e))},u.prototype.screenStateParams=function(){const{name:e,hybridScreen:t}=this,{xMin:n,xMax:i,yMin:r,yMax:o}=t.boundingBoxForWholeView();return{xMin:n,xMax:i,yMin:r,yMax:o,path:e}},u.prototype.hide=function(){this.clear(),this.visible=!1,this.$background.detach(),this.$ui.hide(),this.pauseRequestAnimationFrames&&this.pauseRequestAnimationFrames(),e.emit("renderView hidden",this)},u.prototype.show=function(){this.visible||(this.visible=!0,this.hybridScreen.screenGroupLastChange=0,this.resumeRequestAnimationFrames&&this.resumeRequestAnimationFrames(),this.backgroundContainer.append(this.$background),requestAnimationFrame((()=>{this.render(),this.$ui.show(),this.synchronizeClasses(),this.editorContent&&function(e){g||function(){p||console.error("showEditor feature is not supported");g=p({container:t("#render_editor")})}();g.setContent(e.editorContent),t("#render_editor").show()}(this),this.cameraControl.screen=this.hybridScreen.screen,this.mouseDragEnabled?this.cameraControl.enableDrag():this.cameraControl.disableDrag(),this.mouseZoomEnabled?this.cameraControl.enableZoom():this.cameraControl.disableZoom(),e.emit("renderView shown",this)})))},u.prototype.clear=function(){this.visible&&(this.hybridScreen.screen.clear(),g&&g.hide())},u.prototype.setTheme=function({theme:e}={}){this.$ui.addClass(e),this.theme=e,"visual-novel"===e&&(this.storageForThisLaunch.disableDefaultPopupBlur=!0)},u.prototype.synchronizeClasses=function(){this.blurredScreen?this.container.addClass("blurry"):this.container.removeClass("blurry"),this.mouseCursorHidden?this.$ui.addClass("no_mouse_cursor"):this.$ui.removeClass("no_mouse_cursor")},u.prototype.hideMouse=function(){this.mouseCursorHidden=!0,this.$ui.addClass("no_mouse_cursor")},u.prototype.showMouse=function(){this.mouseCursorHidden=!1,this.$ui.removeClass("no_mouse_cursor")},u.prototype.blur=function(e){"ui"!==e&&this.blurScreen(),"screen"!==e&&this.blurUi()},u.prototype.blurScreen=function(){this.blurredScreen=!0,this.container.addClass("blurry")},u.prototype.blurUi=function(){this.$ui.addClass("blurry_children")},u.prototype.unblur=function(){delete this.blurredScreen,this.container.removeClass("blurry"),this.$ui.removeClass("blurry_children")},u.prototype.render=function(e=!1){this.visible&&(this.forceNextRender&&(e=!0,delete this.forceNextRender),this.hybridScreen.render(e))},u.prototype.forceRender=function(){this.forceNextRender=!0},u.prototype.reset=function(){a(this),this.theme&&(this.$ui.removeClass(this.theme),delete this.theme),this.storageForThisLaunch={},this.hybridScreen.reset(),this.destroyApi(),this.$ui.empty(),this.$background.empty(),this.$background.removeAttr("style"),this.unblur(),this.showMouse(),this.enableMouseDrag(),this.enableMouseZoom(),this.render()},u.prototype.enableMouseDrag=function(){this.mouseDragEnabled=!0,this.visible&&this.cameraControl.enableDrag()},u.prototype.disableMouseDrag=function(){this.mouseDragEnabled=!1,this.visible&&this.cameraControl.disableDrag()},u.prototype.enableMouseZoom=function(){this.mouseZoomEnabled=!0,this.visible&&this.cameraControl.enableZoom()},u.prototype.disableMouseZoom=function(){this.mouseZoomEnabled=!1,this.visible&&this.cameraControl.disableZoom()};function h(t){const{container:r,directScreenMode:o}=t;t.hybridScreen=new i({name:t.document&&t.document.name||"explorers",canvas:r.find(".render_canvas"),directScreenMode:o,onCameraMoved:()=>e.emit("camera moved",t)}),t.hybridScreen.adaptSizeTo(r),function(e,t){n({target:e,proxy:t,keys:d,fastMode:!0,writable:!1})}(t,t.hybridScreen)}["getCamera","setCamera","freezeCamera","setOptimalView","zoom","rotate","translateCenter","saveAsImage"].forEach((e=>{u.prototype[e]=function(...t){return this.hybridScreen[e](...t)}})),u.prototype.editorGoTo=function({line:e,column:t}){g.goTo({line:e,column:t})},u.prototype.setDirectScreenMode=function(e){this.directScreenMode!==e&&(this.directScreenMode=e,h(this))},u.prototype.synchronizeCamera=function(){const e=this.hybridScreen.screen.getCamera();this.hybridScreen.screenCamera.change(e)},u.prototype.synchronizeHelperScreenCamera=function(){if(!this.helperScreen)return;const e=this.hybridScreen.screen.getCamera();this.helperScreen.setCamera(e),this.helperScreen.isEmpty()||this.helperScreen.forceRender()},u.prototype.resize=function(){this.hybridScreen.adaptSizeTo(this.container)};const d=["renderTime","mouse","enableMouseDrag","disableMouseDrag","enableMouseZoom","disableMouseZoom"];let f,p,g;return e.on("execution_capabilities added",(function(e){f=e})),e.on("view_only_editor added",(function(e){p=e})),u})),define("toxilibs/dom_mouse_events",["jquery"],(function(e){return function({container:t,eventBus:n,namespace:i}){const r=e(t);let o,s=!1,a="";function c(e,t,i){n.emit(e+a,t,i)}i&&(a=" on "+i),r.contextmenu((()=>!1)),r.on("mousedown",(function(e){let t=u(e);s=0,o=e,c("mousedown",e,{button:t}),c(t+" mousedown",e)})),r.on("mouseup",(function(e){e.preventDefault();let t=u(e);c("mouseup",e,{button:t}),c(t+" mouseup",e),!1!==s&&(s<4?(c("click",o,{button:t}),c(t+" click",o)):c("end drag",e),s=!1)}));const l=["left","middle","right"];function u(e){return l[e.button]||"unkownButton"}r.on("mouseleave",(function(){s=!1,c("mouse left",event)})),r.on("mousemove",(function(e){c("mousemove",e),!1!==s&&(s+=1),s>=4&&c("mousedrag",e)}))}})),define("render/mouse_events",["toxilibs/event_capabilities_queued","toxilibs/dom_mouse_events"],(function(e,t){const n={mousedown:"mouseButtonPressed",mousemove:"mouseMoved",mouseup:"mouseButtonReleased",click:"mouseClicked","mouse left":"mouseMovedOut"};return function({container:i,renderViews:r}){const o={};let s;e(o),t({eventBus:o,container:i});for(let e in n){let t=n[e];o.on(e,(function(n,i){if(!n.target.classList.contains("ui_parent")&&!s)return;n.preventDefault(),"mousedown"===e&&(s=!0),"mouseup"===e&&(s=!1);let{currentView:o}=r;o&&o[t](n,i)}))}}})),define("render/render_zone",["event_bus","jquery","libs/collection","libs/swap_view_capabilities","./camera_control","./render_view","./mouse_events"],(function(e,t,n,i,r,o,s){let a,c,l,u,h;e.on("code editor ready",(function(e){a=e})),e.on("start document selection ended",(function(){localStorage.lastRendered&&a.getPage(localStorage.lastRendered,{noWarn:!0})&&p(localStorage.lastRendered)})),e.on("page ready",(function(){c=t("#render_layers"),l=t("#render_background"),u=t("#render_ui"),s({renderViews:f,container:u}),h=r({$uiContainer:u,renderViews:f}),d.followScreenState=h.followScreenState,e.on("coords recorder enabled",(()=>u.addClass("coords_recorder"))),e.on("coords recorder disabled",(()=>u.removeClass("coords_recorder"))),e.on("camera moved",(e=>{e.synchronizeHelperScreenCamera(),f.currentView===e&&m()})),e.on("workspace resized",m),e.on("drawing frame reached",y),g()}));let d={openRenderView:p,closeRenderView:function(e){let t=f.closeView(e);t.reset(),t.stop()},labelRenderer:function(e){let t=a&&a.getPage(e,{noWarn:!0});return t?t.name:e},executeRenderView:function(e){let t=f.find(e);t?(t.reset(),t.restart()):console.warn('can not execute renderView "'+e+'" : not found')}};Object.defineProperty(d,"currentRenderView",{get:()=>f.currentView});let f=new n({name:"renderViews",Constructor:o,indexedKey:"name",uniqueness:!0,existence:!0});function p(e,t={},n=(()=>{})){let i=f.find(e);const{restart:r}=t;function o(t){f.openView(e),t.started&&r?(t.reset(),t.restart()):t.start(),localStorage.lastRendered=e,n(t)}i?(t&&i.updateParams(t),o(i)):function(e,{editorContent:t},n){let i=a&&a.getPage(e,{noWarn:!0});n(f.create({name:e,document:i,container:c,backgroundContainer:l,editorContent:t,cameraControl:h}))}(e,t,o)}function g(){e.emit("drawing frame reached"),requestAnimationFrame(g)}function m(){f.currentView&&(f.currentView.hybridScreen.screenGroupLastChange=0)}function y(){f.currentView&&f.currentView.render()}return i(f),d})),define("assets_bank/api_disabled",[],(function(){return{uploadFile:()=>console.error("uploadFile is disabled in standalone mode"),uploadImagined:()=>console.error("uploadFile is disabled in standalone mode"),uploadIsAllowed:!1}})),define("render/keys",["event_bus","jquery","./render_zone"],(function(e,t,n){let{document:i}=window;function r(e){e.pressedKeys={},e.api.pressedKeys=e.pressedKeys}function o({shiftKey:e,ctrlKey:t,metaKey:n,altKey:i,key:r,keyCode:o}){return{shiftKey:e,ctrlKey:t,metaKey:n,altKey:i,key:r,keyCode:o}}e.on("all scripts loaded",(function(){e.emit("renderView add-on added",r)})),e.on("renderView hidden",(function(e){let{pressedKeys:t}=e;for(let e in t)delete t[e]})),t(window).on("keydown",(function(e){if(e.target===i.body){let t=n.currentRenderView;if(t){const{key:n}=e;"Tab"===n&&e.preventDefault();const{pressedKeys:i,hybridScreen:r}=t;if(n in i)return;i[n]=!0;let s=o(e);r.emit("keyPressed",s)}}})),t(window).on("keyup",(function(e){let t=n.currentRenderView;if(t){delete t.pressedKeys[e.key];const{hybridScreen:n}=t;if(e.target===i.body){let t=o(e);n.emit("keyReleased",t)}}}))})),define("event_bus",["raw_event_bus"],(function(e){return e})),require(["event_bus","jquery","user_code/basic_api","toxilibs/timers_manager","render/render_zone","assets_bank/api_disabled","render/keys"],(function(e,t,n,i,r,o){window.loadModules=function(){const e={},t=new Set;let n;function i(i,r){Object.defineProperty(e,i,{get:()=>{if(t.has(i))throw new Error("Circular dependency detected, from "+n+" to "+i);t.add(i),n=i;let o=r();return t.delete(i),Object.defineProperty(e,i,{writable:!0}),e[i]=o,o},configurable:!0})}for(let e in allModules)i(e,allModules[e]);window.m=e};let s=0,a={};function c(e){Object.assign(n,e.api,o),function(e){const{name:t}=e;if(!(t in a)){let n=i({id:t+s++,requestAnimationFrameHasToBeTriggered:!1});e.pauseRequestAnimationFrames=function(){n.pauseRequestAnimationFrames()},e.resumeRequestAnimationFrames=function(){n.resumeRequestAnimationFrames()},a[t]=n}}(e),n.onEveryFrame=a[e.name].onEveryFrame;for(let e in n)window[e]=n[e]}window.goToRender=function(e,{restart:t}={}){const n="/render/"+e.replace("/render/",""),i=r.currentRenderView;r.openRenderView(n,{},(()=>{require([n],(function(e){i&&i.hide();const n=r.currentRenderView;c(n),n.executedAt&&!t||(n.reset(),n.executedAt=Date.now(),e()),n.show()}))}))},window.restart=function(){const e=r.currentRenderView;e&&window.goToRender(e.name,{restart:!0})},t((function(){e.emit("app initialized",{}),e.emit("page ready"),t(window).on("resize",e.emitter("workspace resized")),window.goToRender(window.renderFileName)})),e.emit("all scripts loaded")})),define("main_standalone",(function(){}));